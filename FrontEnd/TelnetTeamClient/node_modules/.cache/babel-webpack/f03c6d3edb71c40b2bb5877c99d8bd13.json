{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"../auth.service\";\nimport * as i3 from \"@angular/material/dialog\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/common\";\n\nfunction AddEmpComponent_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 14);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const type_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", type_r1.type_Conge_Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r1.Type);\n  }\n}\n\nexport let AddEmpComponent = /*#__PURE__*/(() => {\n  class AddEmpComponent {\n    constructor(http, authService, dialogRef) {\n      this.http = http;\n      this.authService = authService;\n      this.dialogRef = dialogRef;\n      this.typeCongeUrl = 'https://localhost:7216/api/TypeConges/byRole';\n      this.congesUrl = 'https://localhost:7216/api/conges';\n      this.userRole = '';\n      this.leaveTypes = [];\n      this.userId = '';\n      this.form = {\n        dateDebut: '',\n        dateFin: '',\n        type: null // Use null initially\n\n      };\n    }\n\n    ngOnInit() {\n      const token = this.authService.getToken();\n\n      if (token) {\n        const parsedToken = this.parseToken(token);\n        this.userId = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.nameid;\n\n        if (this.userId) {\n          this.authService.getUserById(this.userId).subscribe(data => {\n            this.userRole = data.role;\n            this.getLeaveTypesByRole(this.userRole).subscribe(types => {\n              this.leaveTypes = types;\n            });\n          }, error => console.error('Error fetching user data:', error));\n        }\n      }\n    }\n\n    parseToken(token) {\n      try {\n        const payload = atob(token.split('.')[1]);\n        return JSON.parse(payload);\n      } catch (error) {\n        console.error('Error parsing token:', error);\n        return null;\n      }\n    }\n\n    getLeaveTypesByRole(role) {\n      const url = `${this.typeCongeUrl}/${role}`;\n      return this.http.get(url);\n    }\n\n    onSubmit() {\n      const typeCongeId = Number(this.form.type); // Ensure this is a number\n\n      if (isNaN(typeCongeId)) {\n        console.error('Invalid type_Conge_Id:', this.form.type);\n        return;\n      }\n\n      const requestBody = {\n        date_Debut: this.form.dateDebut,\n        date_Fin: this.form.dateFin,\n        statut: 'pending',\n        type_Conge_Id: typeCongeId,\n        matricule: this.userId\n      };\n      this.http.post(this.congesUrl, requestBody).subscribe(response => {\n        console.log('Request added successfully:', response);\n        this.dialogRef.close(true); // Close the dialog on success\n      }, error => console.error('Error adding request:', error));\n    }\n\n  }\n\n  AddEmpComponent.ɵfac = function AddEmpComponent_Factory(t) {\n    return new (t || AddEmpComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.MatDialogRef));\n  };\n\n  AddEmpComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddEmpComponent,\n    selectors: [[\"app-add-emp\"]],\n    decls: 20,\n    vars: 4,\n    consts: [[1, \"form-container\"], [3, \"ngSubmit\"], [1, \"date-inputs\"], [1, \"form-group\"], [\"for\", \"dateDebut\"], [\"type\", \"date\", \"id\", \"dateDebut\", \"name\", \"dateDebut\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"dateFin\"], [\"type\", \"date\", \"id\", \"dateFin\", \"name\", \"dateFin\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-group\", \"type-input\"], [\"for\", \"type\"], [\"id\", \"type\", \"name\", \"type\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [3, \"value\"]],\n    template: function AddEmpComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function AddEmpComponent_Template_form_ngSubmit_1_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"label\", 4);\n        i0.ɵɵtext(5, \"Date Debut:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"input\", 5);\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_input_ngModelChange_6_listener($event) {\n          return ctx.form.dateDebut = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 3);\n        i0.ɵɵelementStart(8, \"label\", 6);\n        i0.ɵɵtext(9, \"Date Fin:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(10, \"input\", 7);\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_input_ngModelChange_10_listener($event) {\n          return ctx.form.dateFin = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 8);\n        i0.ɵɵelementStart(12, \"label\", 9);\n        i0.ɵɵtext(13, \"Type:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(14, \"select\", 10);\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_select_ngModelChange_14_listener($event) {\n          return ctx.form.type = $event;\n        });\n        i0.ɵɵelementStart(15, \"option\", 11);\n        i0.ɵɵtext(16, \"Select Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(17, AddEmpComponent_option_17_Template, 2, 2, \"option\", 12);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"button\", 13);\n        i0.ɵɵtext(19, \"Add Employee\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"ngModel\", ctx.form.dateDebut);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.form.dateFin);\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.form.type);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", ctx.leaveTypes);\n      }\n    },\n    directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i4.DefaultValueAccessor, i4.RequiredValidator, i4.NgControlStatus, i4.NgModel, i4.SelectControlValueAccessor, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i5.NgForOf],\n    styles: [\".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:35px}.date-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:500px;margin-bottom:20px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;margin-right:10px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-child{margin-right:0}.type-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:500px;margin-bottom:20px}button[_ngcontent-%COMP%]{display:block;margin:0 auto}\"]\n  });\n  return AddEmpComponent;\n})();","map":{"version":3,"sources":["C:/Users/pprod/Desktop/satge PFE/satge PFE/TelnetTeamClient/src/app/add-emp/add-emp.component.ts"],"names":["i0","i1","i2","i3","i4","i5","AddEmpComponent_option_17_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","type_r1","$implicit","ɵɵproperty","type_Conge_Id","ɵɵadvance","ɵɵtextInterpolate","Type","AddEmpComponent","constructor","http","authService","dialogRef","typeCongeUrl","congesUrl","userRole","leaveTypes","userId","form","dateDebut","dateFin","type","ngOnInit","token","getToken","parsedToken","parseToken","nameid","getUserById","subscribe","data","role","getLeaveTypesByRole","types","error","console","payload","atob","split","JSON","parse","url","get","onSubmit","typeCongeId","Number","isNaN","requestBody","date_Debut","date_Fin","statut","matricule","post","response","log","close","ɵfac","AddEmpComponent_Factory","t","ɵɵdirectiveInject","HttpClient","AuthService","MatDialogRef","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","template","AddEmpComponent_Template","ɵɵlistener","AddEmpComponent_Template_form_ngSubmit_1_listener","AddEmpComponent_Template_input_ngModelChange_6_listener","$event","AddEmpComponent_Template_input_ngModelChange_10_listener","AddEmpComponent_Template_select_ngModelChange_14_listener","ɵɵtemplate","directives","ɵNgNoValidate","NgControlStatusGroup","NgForm","DefaultValueAccessor","RequiredValidator","NgControlStatus","NgModel","SelectControlValueAccessor","NgSelectOption","ɵNgSelectMultipleOption","NgForOf","styles"],"mappings":"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","sourcesContent":["import * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/common/http\";\r\nimport * as i2 from \"../auth.service\";\r\nimport * as i3 from \"@angular/material/dialog\";\r\nimport * as i4 from \"@angular/forms\";\r\nimport * as i5 from \"@angular/common\";\r\nfunction AddEmpComponent_option_17_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"option\", 14);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const type_r1 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", type_r1.type_Conge_Id);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate(type_r1.Type);\r\n} }\r\nexport class AddEmpComponent {\r\n    constructor(http, authService, dialogRef) {\r\n        this.http = http;\r\n        this.authService = authService;\r\n        this.dialogRef = dialogRef;\r\n        this.typeCongeUrl = 'https://localhost:7216/api/TypeConges/byRole';\r\n        this.congesUrl = 'https://localhost:7216/api/conges';\r\n        this.userRole = '';\r\n        this.leaveTypes = [];\r\n        this.userId = '';\r\n        this.form = {\r\n            dateDebut: '',\r\n            dateFin: '',\r\n            type: null // Use null initially\r\n        };\r\n    }\r\n    ngOnInit() {\r\n        const token = this.authService.getToken();\r\n        if (token) {\r\n            const parsedToken = this.parseToken(token);\r\n            this.userId = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.nameid;\r\n            if (this.userId) {\r\n                this.authService.getUserById(this.userId).subscribe((data) => {\r\n                    this.userRole = data.role;\r\n                    this.getLeaveTypesByRole(this.userRole).subscribe(types => {\r\n                        this.leaveTypes = types;\r\n                    });\r\n                }, (error) => console.error('Error fetching user data:', error));\r\n            }\r\n        }\r\n    }\r\n    parseToken(token) {\r\n        try {\r\n            const payload = atob(token.split('.')[1]);\r\n            return JSON.parse(payload);\r\n        }\r\n        catch (error) {\r\n            console.error('Error parsing token:', error);\r\n            return null;\r\n        }\r\n    }\r\n    getLeaveTypesByRole(role) {\r\n        const url = `${this.typeCongeUrl}/${role}`;\r\n        return this.http.get(url);\r\n    }\r\n    onSubmit() {\r\n        const typeCongeId = Number(this.form.type); // Ensure this is a number\r\n        if (isNaN(typeCongeId)) {\r\n            console.error('Invalid type_Conge_Id:', this.form.type);\r\n            return;\r\n        }\r\n        const requestBody = {\r\n            date_Debut: this.form.dateDebut,\r\n            date_Fin: this.form.dateFin,\r\n            statut: 'pending',\r\n            type_Conge_Id: typeCongeId,\r\n            matricule: this.userId\r\n        };\r\n        this.http.post(this.congesUrl, requestBody).subscribe(response => {\r\n            console.log('Request added successfully:', response);\r\n            this.dialogRef.close(true); // Close the dialog on success\r\n        }, error => console.error('Error adding request:', error));\r\n    }\r\n}\r\nAddEmpComponent.ɵfac = function AddEmpComponent_Factory(t) { return new (t || AddEmpComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.AuthService), i0.ɵɵdirectiveInject(i3.MatDialogRef)); };\r\nAddEmpComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AddEmpComponent, selectors: [[\"app-add-emp\"]], decls: 20, vars: 4, consts: [[1, \"form-container\"], [3, \"ngSubmit\"], [1, \"date-inputs\"], [1, \"form-group\"], [\"for\", \"dateDebut\"], [\"type\", \"date\", \"id\", \"dateDebut\", \"name\", \"dateDebut\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"for\", \"dateFin\"], [\"type\", \"date\", \"id\", \"dateFin\", \"name\", \"dateFin\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [1, \"form-group\", \"type-input\"], [\"for\", \"type\"], [\"id\", \"type\", \"name\", \"type\", \"required\", \"\", 1, \"form-control\", 3, \"ngModel\", \"ngModelChange\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\"], [3, \"value\"]], template: function AddEmpComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"form\", 1);\r\n        i0.ɵɵlistener(\"ngSubmit\", function AddEmpComponent_Template_form_ngSubmit_1_listener() { return ctx.onSubmit(); });\r\n        i0.ɵɵelementStart(2, \"div\", 2);\r\n        i0.ɵɵelementStart(3, \"div\", 3);\r\n        i0.ɵɵelementStart(4, \"label\", 4);\r\n        i0.ɵɵtext(5, \"Date Debut:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(6, \"input\", 5);\r\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_input_ngModelChange_6_listener($event) { return ctx.form.dateDebut = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(7, \"div\", 3);\r\n        i0.ɵɵelementStart(8, \"label\", 6);\r\n        i0.ɵɵtext(9, \"Date Fin:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(10, \"input\", 7);\r\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_input_ngModelChange_10_listener($event) { return ctx.form.dateFin = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(11, \"div\", 8);\r\n        i0.ɵɵelementStart(12, \"label\", 9);\r\n        i0.ɵɵtext(13, \"Type:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(14, \"select\", 10);\r\n        i0.ɵɵlistener(\"ngModelChange\", function AddEmpComponent_Template_select_ngModelChange_14_listener($event) { return ctx.form.type = $event; });\r\n        i0.ɵɵelementStart(15, \"option\", 11);\r\n        i0.ɵɵtext(16, \"Select Type\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(17, AddEmpComponent_option_17_Template, 2, 2, \"option\", 12);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(18, \"button\", 13);\r\n        i0.ɵɵtext(19, \"Add Employee\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(6);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.form.dateDebut);\r\n        i0.ɵɵadvance(4);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.form.dateFin);\r\n        i0.ɵɵadvance(4);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.form.type);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.leaveTypes);\r\n    } }, directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i4.DefaultValueAccessor, i4.RequiredValidator, i4.NgControlStatus, i4.NgModel, i4.SelectControlValueAccessor, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i5.NgForOf], styles: [\".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:35px}.date-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:500px;margin-bottom:20px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;margin-right:10px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-child{margin-right:0}.type-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:500px;margin-bottom:20px}button[_ngcontent-%COMP%]{display:block;margin:0 auto}\"] });\r\n"]},"metadata":{},"sourceType":"module"}
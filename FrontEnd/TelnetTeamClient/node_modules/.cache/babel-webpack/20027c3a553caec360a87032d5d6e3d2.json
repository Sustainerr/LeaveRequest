{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { catchError } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"../auth.service\";\nimport * as i4 from \"@angular/common\";\n\nfunction AddEmpSomeoneComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 16);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const type_r1 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", type_r1.type_Conge_Id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(type_r1.type);\n  }\n}\n\nexport let AddEmpSomeoneComponent = /*#__PURE__*/(() => {\n  class AddEmpSomeoneComponent {\n    constructor(fb, http, authService) {\n      this.fb = fb;\n      this.http = http;\n      this.authService = authService;\n      this.congesUrl = 'https://localhost:7216/api/conges'; // Replace with your backend URL\n\n      this.leaveForm = this.fb.group({\n        dateDebut: ['', Validators.required],\n        dateFin: ['', Validators.required],\n        type: ['', Validators.required],\n        matricule: ['', Validators.required]\n      });\n    }\n\n    ngOnInit() {// Initialization logic if needed\n    }\n\n    onSubmit() {\n      if (this.leaveForm.valid) {\n        const token = this.authService.getToken();\n\n        if (token) {\n          const parsedToken = this.parseToken(token);\n          const userId = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.nameid;\n          const userRole = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.role; // Assuming the role is included in the token\n          // Check if the user has the necessary role to approve\n\n          if (userRole === 'Admin' || userRole === 'Chef') {\n            const leaveRequest = {\n              conge_Id: 0,\n              date_Debut: this.leaveForm.value.dateDebut,\n              date_Fin: this.leaveForm.value.dateFin,\n              statut: 'Approved',\n              type_Conge_Id: this.leaveForm.value.type,\n              matricule: this.leaveForm.value.matricule\n            };\n            console.log('Submitting leave request:', leaveRequest);\n            this.http.post(this.congesUrl, leaveRequest).pipe(catchError(error => {\n              console.error('Error submitting leave request:', error);\n              throw error; // Propagate error to subscriber\n            })).subscribe(response => {\n              console.log('Leave request submitted successfully:', response); // Optionally reset the form after successful submission\n\n              this.leaveForm.reset();\n            }, error => {\n              console.error('Error submitting leave request:', error);\n              alert(error.error); // Display the error message returned from the backend\n            });\n          } else {\n            alert('Unauthorized role.');\n          }\n        } else {\n          console.error('Token is not available.');\n        }\n      } else {\n        console.error('Form is invalid.');\n      }\n    }\n\n    parseToken(token) {\n      try {\n        const payload = atob(token.split('.')[1]);\n        return JSON.parse(payload);\n      } catch (error) {\n        console.error('Error parsing token:', error);\n        return null;\n      }\n    }\n\n  }\n\n  AddEmpSomeoneComponent.ɵfac = function AddEmpSomeoneComponent_Factory(t) {\n    return new (t || AddEmpSomeoneComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.AuthService));\n  };\n\n  AddEmpSomeoneComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AddEmpSomeoneComponent,\n    selectors: [[\"app-add-emp-someone\"]],\n    decls: 24,\n    vars: 3,\n    consts: [[1, \"form-container\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"date-inputs\"], [1, \"form-group\"], [\"for\", \"dateDebut\"], [\"type\", \"date\", \"id\", \"dateDebut\", \"formControlName\", \"dateDebut\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"dateFin\"], [\"type\", \"date\", \"id\", \"dateFin\", \"formControlName\", \"dateFin\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"matricule\"], [\"type\", \"text\", \"id\", \"matricule\", \"formControlName\", \"matricule\", \"required\", \"\", 1, \"form-control\"], [1, \"form-group\", \"type-input\"], [\"for\", \"type\"], [\"id\", \"type\", \"formControlName\", \"type\", \"required\", \"\", 1, \"form-control\"], [\"value\", \"\", \"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [3, \"value\"]],\n    template: function AddEmpSomeoneComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"form\", 1);\n        i0.ɵɵlistener(\"ngSubmit\", function AddEmpSomeoneComponent_Template_form_ngSubmit_1_listener() {\n          return ctx.onSubmit();\n        });\n        i0.ɵɵelementStart(2, \"div\", 2);\n        i0.ɵɵelementStart(3, \"div\", 3);\n        i0.ɵɵelementStart(4, \"label\", 4);\n        i0.ɵɵtext(5, \"Date Debut:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(6, \"input\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(7, \"div\", 3);\n        i0.ɵɵelementStart(8, \"label\", 6);\n        i0.ɵɵtext(9, \"Date Fin:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(10, \"input\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"div\", 3);\n        i0.ɵɵelementStart(12, \"label\", 8);\n        i0.ɵɵtext(13, \"Matricule:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(14, \"input\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"div\", 10);\n        i0.ɵɵelementStart(16, \"label\", 11);\n        i0.ɵɵtext(17, \"Type:\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"select\", 12);\n        i0.ɵɵelementStart(19, \"option\", 13);\n        i0.ɵɵtext(20, \"Select Type\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(21, AddEmpSomeoneComponent_option_21_Template, 2, 2, \"option\", 14);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(22, \"button\", 15);\n        i0.ɵɵtext(23, \"Add Employee\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"formGroup\", ctx.leaveForm);\n        i0.ɵɵadvance(20);\n        i0.ɵɵproperty(\"ngForOf\", ctx.leaveTypes);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"disabled\", ctx.leaveForm.invalid);\n      }\n    },\n    directives: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i1.RequiredValidator, i1.SelectControlValueAccessor, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i4.NgForOf],\n    styles: [\".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:35px}.date-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:500px;margin-bottom:20px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;margin-right:10px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-child{margin-right:0}.type-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:500px;margin-bottom:20px}button[_ngcontent-%COMP%]{display:block;margin:0 auto}\"]\n  });\n  return AddEmpSomeoneComponent;\n})();","map":{"version":3,"sources":["C:/Users/pprod/Desktop/satge PFE/satge PFE/TelnetTeamClient/src/app/add-emp-someone/add-emp-someone.component.ts"],"names":["Validators","catchError","i0","i1","i2","i3","i4","AddEmpSomeoneComponent_option_21_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","type_r1","$implicit","ɵɵproperty","type_Conge_Id","ɵɵadvance","ɵɵtextInterpolate","type","AddEmpSomeoneComponent","constructor","fb","http","authService","congesUrl","leaveForm","group","dateDebut","required","dateFin","matricule","ngOnInit","onSubmit","valid","token","getToken","parsedToken","parseToken","userId","nameid","userRole","role","leaveRequest","conge_Id","date_Debut","value","date_Fin","statut","console","log","post","pipe","error","subscribe","response","reset","alert","payload","atob","split","JSON","parse","ɵfac","AddEmpSomeoneComponent_Factory","t","ɵɵdirectiveInject","FormBuilder","HttpClient","AuthService","ɵcmp","ɵɵdefineComponent","selectors","decls","vars","consts","template","AddEmpSomeoneComponent_Template","ɵɵlistener","AddEmpSomeoneComponent_Template_form_ngSubmit_1_listener","ɵɵelement","ɵɵtemplate","leaveTypes","invalid","directives","ɵNgNoValidate","NgControlStatusGroup","FormGroupDirective","DefaultValueAccessor","NgControlStatus","FormControlName","RequiredValidator","SelectControlValueAccessor","NgSelectOption","ɵNgSelectMultipleOption","NgForOf","styles"],"mappings":"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","sourcesContent":["import { Validators } from '@angular/forms';\r\nimport { catchError } from 'rxjs/operators';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"@angular/forms\";\r\nimport * as i2 from \"@angular/common/http\";\r\nimport * as i3 from \"../auth.service\";\r\nimport * as i4 from \"@angular/common\";\r\nfunction AddEmpSomeoneComponent_option_21_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"option\", 16);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const type_r1 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", type_r1.type_Conge_Id);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate(type_r1.type);\r\n} }\r\nexport class AddEmpSomeoneComponent {\r\n    constructor(fb, http, authService) {\r\n        this.fb = fb;\r\n        this.http = http;\r\n        this.authService = authService;\r\n        this.congesUrl = 'https://localhost:7216/api/conges'; // Replace with your backend URL\r\n        this.leaveForm = this.fb.group({\r\n            dateDebut: ['', Validators.required],\r\n            dateFin: ['', Validators.required],\r\n            type: ['', Validators.required],\r\n            matricule: ['', Validators.required]\r\n        });\r\n    }\r\n    ngOnInit() {\r\n        // Initialization logic if needed\r\n    }\r\n    onSubmit() {\r\n        if (this.leaveForm.valid) {\r\n            const token = this.authService.getToken();\r\n            if (token) {\r\n                const parsedToken = this.parseToken(token);\r\n                const userId = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.nameid;\r\n                const userRole = parsedToken === null || parsedToken === void 0 ? void 0 : parsedToken.role; // Assuming the role is included in the token\r\n                // Check if the user has the necessary role to approve\r\n                if (userRole === 'Admin' || userRole === 'Chef') {\r\n                    const leaveRequest = {\r\n                        conge_Id: 0,\r\n                        date_Debut: this.leaveForm.value.dateDebut,\r\n                        date_Fin: this.leaveForm.value.dateFin,\r\n                        statut: 'Approved',\r\n                        type_Conge_Id: this.leaveForm.value.type,\r\n                        matricule: this.leaveForm.value.matricule\r\n                    };\r\n                    console.log('Submitting leave request:', leaveRequest);\r\n                    this.http.post(this.congesUrl, leaveRequest).pipe(catchError((error) => {\r\n                        console.error('Error submitting leave request:', error);\r\n                        throw error; // Propagate error to subscriber\r\n                    })).subscribe((response) => {\r\n                        console.log('Leave request submitted successfully:', response);\r\n                        // Optionally reset the form after successful submission\r\n                        this.leaveForm.reset();\r\n                    }, (error) => {\r\n                        console.error('Error submitting leave request:', error);\r\n                        alert(error.error); // Display the error message returned from the backend\r\n                    });\r\n                }\r\n                else {\r\n                    alert('Unauthorized role.');\r\n                }\r\n            }\r\n            else {\r\n                console.error('Token is not available.');\r\n            }\r\n        }\r\n        else {\r\n            console.error('Form is invalid.');\r\n        }\r\n    }\r\n    parseToken(token) {\r\n        try {\r\n            const payload = atob(token.split('.')[1]);\r\n            return JSON.parse(payload);\r\n        }\r\n        catch (error) {\r\n            console.error('Error parsing token:', error);\r\n            return null;\r\n        }\r\n    }\r\n}\r\nAddEmpSomeoneComponent.ɵfac = function AddEmpSomeoneComponent_Factory(t) { return new (t || AddEmpSomeoneComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.HttpClient), i0.ɵɵdirectiveInject(i3.AuthService)); };\r\nAddEmpSomeoneComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: AddEmpSomeoneComponent, selectors: [[\"app-add-emp-someone\"]], decls: 24, vars: 3, consts: [[1, \"form-container\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"date-inputs\"], [1, \"form-group\"], [\"for\", \"dateDebut\"], [\"type\", \"date\", \"id\", \"dateDebut\", \"formControlName\", \"dateDebut\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"dateFin\"], [\"type\", \"date\", \"id\", \"dateFin\", \"formControlName\", \"dateFin\", \"required\", \"\", 1, \"form-control\"], [\"for\", \"matricule\"], [\"type\", \"text\", \"id\", \"matricule\", \"formControlName\", \"matricule\", \"required\", \"\", 1, \"form-control\"], [1, \"form-group\", \"type-input\"], [\"for\", \"type\"], [\"id\", \"type\", \"formControlName\", \"type\", \"required\", \"\", 1, \"form-control\"], [\"value\", \"\", \"disabled\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-primary\", 3, \"disabled\"], [3, \"value\"]], template: function AddEmpSomeoneComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"form\", 1);\r\n        i0.ɵɵlistener(\"ngSubmit\", function AddEmpSomeoneComponent_Template_form_ngSubmit_1_listener() { return ctx.onSubmit(); });\r\n        i0.ɵɵelementStart(2, \"div\", 2);\r\n        i0.ɵɵelementStart(3, \"div\", 3);\r\n        i0.ɵɵelementStart(4, \"label\", 4);\r\n        i0.ɵɵtext(5, \"Date Debut:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(6, \"input\", 5);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(7, \"div\", 3);\r\n        i0.ɵɵelementStart(8, \"label\", 6);\r\n        i0.ɵɵtext(9, \"Date Fin:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(10, \"input\", 7);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(11, \"div\", 3);\r\n        i0.ɵɵelementStart(12, \"label\", 8);\r\n        i0.ɵɵtext(13, \"Matricule:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(14, \"input\", 9);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(15, \"div\", 10);\r\n        i0.ɵɵelementStart(16, \"label\", 11);\r\n        i0.ɵɵtext(17, \"Type:\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(18, \"select\", 12);\r\n        i0.ɵɵelementStart(19, \"option\", 13);\r\n        i0.ɵɵtext(20, \"Select Type\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(21, AddEmpSomeoneComponent_option_21_Template, 2, 2, \"option\", 14);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(22, \"button\", 15);\r\n        i0.ɵɵtext(23, \"Add Employee\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"formGroup\", ctx.leaveForm);\r\n        i0.ɵɵadvance(20);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.leaveTypes);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"disabled\", ctx.leaveForm.invalid);\r\n    } }, directives: [i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.DefaultValueAccessor, i1.NgControlStatus, i1.FormControlName, i1.RequiredValidator, i1.SelectControlValueAccessor, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i4.NgForOf], styles: [\".form-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:35px}.date-inputs[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:500px;margin-bottom:20px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1;margin-right:10px}.date-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]:last-child{margin-right:0}.type-input[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:100%;max-width:500px;margin-bottom:20px}button[_ngcontent-%COMP%]{display:block;margin:0 auto}\"] });\r\n"]},"metadata":{},"sourceType":"module"}
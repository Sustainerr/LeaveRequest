{"ast":null,"code":"import { FormControl } from '@angular/forms';\nimport { Subject, ReplaySubject, Subscription } from 'rxjs/index';\nimport { takeUntil } from 'rxjs/operators';\nimport { Reference } from 'app/models/project-management/project';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"app/services/shared\";\nimport * as i2 from \"app/services/project-management/project\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/forms\";\nimport * as i5 from \"@angular/material/form-field\";\nimport * as i6 from \"@angular/material/select\";\nimport * as i7 from \"@angular/material/core\";\nimport * as i8 from \"ngx-mat-select-search\";\nimport * as i9 from \"@angular/material/icon\";\nimport * as i10 from \"@angular/common\";\nimport * as i11 from \"@angular/material/input\";\nimport * as i12 from \"@angular/material/datepicker\";\nimport * as i13 from \"../../../../../directives/shared/number-validator.directive\";\nconst _c0 = [\"referenceForm\"];\n\nfunction EditReferenceComponent_mat_option_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const documentType_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", documentType_r7.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", documentType_r7.description, \" \");\n  }\n}\n\nfunction EditReferenceComponent_mat_option_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const activity_r8 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", activity_r8.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", activity_r8.description, \" \");\n  }\n}\n\nfunction EditReferenceComponent_mat_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const documentConfidentiality_r9 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", documentConfidentiality_r9.code);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", documentConfidentiality_r9.name, \" \");\n  }\n}\n\nfunction EditReferenceComponent_mat_option_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const projectAbrreviation_r10 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", projectAbrreviation_r10.value);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", projectAbrreviation_r10.value, \" \");\n  }\n}\n\nfunction EditReferenceComponent_mat_option_43_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const documentstate_r11 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", documentstate_r11.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", documentstate_r11.description, \" \");\n  }\n}\n\nexport let EditReferenceComponent = /*#__PURE__*/(() => {\n  class EditReferenceComponent {\n    constructor(notificationService, referenceService, _avRoute, router, dateTimeService) {\n      this.notificationService = notificationService;\n      this.referenceService = referenceService;\n      this._avRoute = _avRoute;\n      this.router = router;\n      this.dateTimeService = dateTimeService;\n      this.reference = new Reference();\n      this.disableGenerator = true;\n      this.subscription = new Subscription();\n      this.isSameActivity = true;\n      this.filteredDocumentTypes = new ReplaySubject(1);\n      this.documentTypeFilterCtrl = new FormControl();\n      this.filteredAbbreviations = new ReplaySubject(1);\n      this.abbrivationFilterCtrl = new FormControl();\n      this._onDestroy = new Subject();\n      this.previousState = {\n        getPrevious: false,\n        pageIndex: null,\n        pageSize: null\n      };\n    }\n\n    ngOnInit() {\n      if (this.reference.referenceId !== 0) {\n        this.isSameActivity = this.reference.activityId === JSON.parse(localStorage.getItem('currentUser')).activityId;\n      } else {\n        this.disableGenerator = false;\n      }\n\n      this._avRoute.params.subscribe(param => {\n        if (param.referenceId !== undefined && param.referenceId !== null) {\n          this.getReferenceProject(+param.referenceId);\n        }\n      });\n\n      this.currentUser = JSON.parse(localStorage.getItem('currentUser'));\n      this.reference.creationDate = this.dateTimeService.today();\n      this.getDocumentTypes();\n      this.getStates();\n      this.getConfidentialities();\n      this.abbrivationFilterCtrl.valueChanges.pipe(takeUntil(this._onDestroy)).subscribe(() => {\n        this.filterAbbreviations();\n      });\n      this.documentTypeFilterCtrl.valueChanges.pipe(takeUntil(this._onDestroy)).subscribe(() => {\n        this.filterDocumentTypes();\n      });\n      this.subscription.add(this.referenceService.savedReference.subscribe(data => {\n        if (data) {\n          this.previousState = data;\n        }\n      }));\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n    getDocumentTypes() {\n      this.referenceService.getTypesDocuments().subscribe(data => {\n        if (data != null) {\n          this.documentTypesIdentifiers = data;\n          this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice());\n        }\n      });\n    }\n\n    getStates() {\n      this.referenceService.getDocumentStates().subscribe(data => {\n        if (data != null) {\n          this.documentStatesIdentifiers = data;\n        }\n      });\n    }\n\n    getConfidentialities() {\n      this.referenceService.GetDocumentConfidentialities().subscribe(data => {\n        if (data != null) {\n          this.documentConfidentialitiesIdentifiers = data;\n        }\n      });\n    }\n\n    getProjectAbbreviationByActivity(activityId) {\n      this.referenceService.getActivityAbbriviations(activityId).subscribe(data => {\n        if (data != null) {\n          this.projectsAbrreviation = data;\n          this.filteredAbbreviations.next(this.projectsAbrreviation.slice());\n        }\n      });\n    }\n\n    getReferenceProject(referenceId) {\n      this.disableGenerator = true;\n      this.referenceService.getReferenceProject(referenceId).subscribe(data => {\n        this.reference = Object.assign(new Reference(), data[0]);\n        this.isSameActivity = this.reference.activityId === JSON.parse(localStorage.getItem('currentUser')).activityId;\n        const splittedReferenceParts = this.getReferenceParts(this.reference.referenceCode);\n        this.projectAbrreviation = splittedReferenceParts[2];\n        this.confidentialityCode = splittedReferenceParts[4].split(' ')[1];\n      });\n    }\n\n    onActivtyChange(activityId) {\n      this.getProjectAbbreviationByActivity(activityId);\n    }\n\n    buildReferenceToSave(activityCode) {\n      const referenceToSave = new Reference();\n      referenceToSave.referenceId = this.reference.referenceId;\n      referenceToSave.referenceCode = this.reference.referenceCode;\n      referenceToSave.title = this.reference.title;\n      referenceToSave.edition = this.reference.edition;\n      referenceToSave.creationDate = this.reference.creationDate;\n      referenceToSave.stateId = this.reference.stateId;\n      referenceToSave.note = this.reference.note;\n      referenceToSave.archiving = this.reference.archiving;\n      referenceToSave.userId = this.reference.userId;\n      referenceToSave.activityId = this.reference.activityId;\n      referenceToSave.typeId = this.reference.typeId;\n\n      if (this.reference.referenceId === 0) {\n        // if new reference build new reference code\n        const typeAbbreviation = this.documentTypesIdentifiers.filter(document => document.id === this.reference.typeId)[0].description.split('/')[0];\n        const creationYear = new Date(this.reference.creationDate).getFullYear().toString().substring(2); // expression ***** will be replaced by incremented counter in the stored procedure\n\n        referenceToSave.referenceCode = typeAbbreviation + '.' + activityCode + '.' + this.projectAbrreviation.toUpperCase() + '.*****.' + creationYear + ' ' + this.confidentialityCode;\n      }\n\n      return referenceToSave;\n    }\n\n    getLabelSubmit() {\n      return this.disableGenerator ? 'Save' : 'Generate & Save';\n    }\n\n    saveReference() {\n      if (this.referenceForm.valid) {\n        this.referenceService.getActivityCode(this.reference.activityId).subscribe(data => {\n          const activityCode = data.length !== 0 ? data[0].activityCode : 'TXA';\n          this.reference.userId = +this.currentUser.userId;\n          this.reference.edition = +this.reference.edition.toString().replace(',', '.');\n          const referenceToSave = this.buildReferenceToSave(activityCode);\n          this.referenceService.saveReferenceGenerator(referenceToSave).subscribe(referenceId => {\n            this.notificationService.success('Reference saved successfully');\n\n            if (this.reference.referenceId === 0) {\n              this.getReferenceProject(+referenceId);\n            } else {\n              this.close();\n            }\n          });\n        });\n      } else {\n        this.notificationService.danger('Please fill all required fields');\n      }\n    }\n\n    close() {\n      if (this.previousState.pageIndex != null) {\n        this.previousState.getPrevious = true;\n        this.referenceService.savedReference.next(this.previousState);\n      }\n\n      this.router.navigate(['/project-management/project/references']);\n    }\n\n    filterAbbreviations() {\n      if (!this.projectsAbrreviation) {\n        return;\n      }\n\n      let search = this.abbrivationFilterCtrl.value;\n\n      if (!search) {\n        this.filteredAbbreviations.next(this.projectsAbrreviation.slice());\n        return;\n      } else {\n        search = search.toLowerCase();\n      }\n\n      this.filteredAbbreviations.next(this.projectsAbrreviation.filter(abbriviation => abbriviation.value.toLowerCase().indexOf(search) > -1));\n    }\n\n    filterDocumentTypes() {\n      if (!this.documentTypesIdentifiers) {\n        return;\n      }\n\n      let search = this.documentTypeFilterCtrl.value;\n\n      if (!search) {\n        this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice());\n        return;\n      } else {\n        search = search.toLowerCase();\n      }\n\n      this.filteredDocumentTypes.next(this.documentTypesIdentifiers.filter(documentType => documentType.description.toLowerCase().indexOf(search) > -1));\n    }\n\n    getReferenceParts(reference) {\n      const referenceElements = reference.split('.');\n      const referenceElementsNumber = referenceElements.length;\n      let referenceParts = [];\n\n      if (referenceElementsNumber > 5) {\n        let position = 1;\n        let part = '';\n        referenceElements.forEach(element => {\n          if (part === '') {\n            part += element;\n          } else {\n            part += '.' + element;\n          }\n\n          if (position < 3 || position >= referenceElementsNumber - 2) {\n            referenceParts.push(part);\n            part = '';\n          }\n\n          position++;\n        });\n      } else {\n        referenceParts = referenceElements;\n      }\n\n      return referenceParts;\n    }\n\n  }\n\n  EditReferenceComponent.ɵfac = function EditReferenceComponent_Factory(t) {\n    return new (t || EditReferenceComponent)(i0.ɵɵdirectiveInject(i1.NotificationService), i0.ɵɵdirectiveInject(i2.ReferenceService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i1.DateTimeService));\n  };\n\n  EditReferenceComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: EditReferenceComponent,\n    selectors: [[\"app-edit-reference\"]],\n    viewQuery: function EditReferenceComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 7);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.referenceForm = _t.first);\n      }\n    },\n    decls: 55,\n    vars: 39,\n    consts: [[1, \"card\"], [1, \"card-body\"], [\"id\", \"referenceForm\"], [\"referenceForm\", \"ngForm\"], [1, \"row\", \"m-b-15\"], [1, \"col-sm-6\"], [\"placeholder\", \"Document Type\", \"name\", \"documentType\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [3, \"formControl\", \"placeholderLabel\", \"noEntriesFoundLabel\"], [\"ngxMatSelectSearchClear\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-sm-4\"], [\"placeholder\", \"Activity\", \"name\", \"activity\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\", \"selectionChange\"], [1, \"col-sm-2\"], [\"placeholder\", \"Confidentiality\", \"name\", \"confidentiality\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Project Abreviation\", \"name\", \"projectAbreviation\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Project Abreviation\", \"name\", \"projectAbreviationInput\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Creation Date\", \"name\", \"creationDate\", \"required\", \"\", 3, \"disabled\", \"matDatepicker\", \"ngModel\", \"ngModelChange\"], [\"matSuffix\", \"\", 3, \"for\"], [3, \"startView\"], [\"PickerCreationDate\", \"\"], [\"matInput\", \"\", \"disabled\", \"\", \"laceholder\", \"Reference Value\", \"name\", \"referenceCode\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-sm-8\"], [\"matInput\", \"\", \"placeholder\", \"Title\", \"name\", \"title\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"appNumberValidator\", \"\", \"placeholder\", \"Edition\", \"name\", \"edition\", \"required\", \"\", 3, \"inputValue\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Status\", \"name\", \"state\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-sm-12\"], [\"matInput\", \"\", \"placeholder\", \"Remarks\", \"name\", \"Remarks\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Archiving\", \"name\", \"Archiving\", 3, \"ngModel\", \"ngModelChange\"], [1, \"text-center\"], [\"type\", \"submit\", 1, \"btn\", \"btn-md\", \"btn-primary\", \"ripple\", \"light\", \"m-r-20\", 3, \"disabled\", \"click\"], [\"type\", \"reset\", 1, \"btn\", \"btn-md\", \"btn-default\", \"ripple\", 3, \"click\"], [3, \"value\"]],\n    template: function EditReferenceComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"form\", 2, 3);\n        i0.ɵɵelementStart(4, \"div\", 4);\n        i0.ɵɵelementStart(5, \"mat-form-field\", 5);\n        i0.ɵɵelementStart(6, \"mat-select\", 6);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_6_listener($event) {\n          return ctx.reference.typeId = $event;\n        });\n        i0.ɵɵelementStart(7, \"mat-option\");\n        i0.ɵɵelementStart(8, \"ngx-mat-select-search\", 7);\n        i0.ɵɵelementStart(9, \"mat-icon\", 8);\n        i0.ɵɵtext(10, \"close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(11, EditReferenceComponent_mat_option_11_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵpipe(12, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"mat-form-field\", 10);\n        i0.ɵɵelementStart(14, \"mat-select\", 11);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_14_listener($event) {\n          return ctx.reference.activityId = $event;\n        })(\"selectionChange\", function EditReferenceComponent_Template_mat_select_selectionChange_14_listener($event) {\n          return ctx.onActivtyChange($event.value);\n        });\n        i0.ɵɵtemplate(15, EditReferenceComponent_mat_option_15_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(16, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(17, \"mat-select\", 13);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_17_listener($event) {\n          return ctx.confidentialityCode = $event;\n        });\n        i0.ɵɵtemplate(18, EditReferenceComponent_mat_option_18_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(20, \"mat-select\", 14);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_20_listener($event) {\n          return ctx.projectAbrreviation = $event;\n        });\n        i0.ɵɵelementStart(21, \"mat-option\");\n        i0.ɵɵelementStart(22, \"ngx-mat-select-search\", 7);\n        i0.ɵɵelementStart(23, \"mat-icon\", 8);\n        i0.ɵɵtext(24, \"close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(25, EditReferenceComponent_mat_option_25_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵpipe(26, \"async\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(27, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(28, \"input\", 15);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_28_listener($event) {\n          return ctx.projectAbrreviation = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(29, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(30, \"input\", 16);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_30_listener($event) {\n          return ctx.reference.creationDate = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelement(31, \"mat-datepicker-toggle\", 17);\n        i0.ɵɵelement(32, \"mat-datepicker\", 18, 19);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(34, \"mat-form-field\", 5);\n        i0.ɵɵelementStart(35, \"input\", 20);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_35_listener($event) {\n          return ctx.reference.referenceCode = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(36, \"div\", 4);\n        i0.ɵɵelementStart(37, \"mat-form-field\", 21);\n        i0.ɵɵelementStart(38, \"input\", 22);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_38_listener($event) {\n          return ctx.reference.title = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(39, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(40, \"input\", 23);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_40_listener($event) {\n          return ctx.reference.edition = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(41, \"mat-form-field\", 12);\n        i0.ɵɵelementStart(42, \"mat-select\", 24);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_42_listener($event) {\n          return ctx.reference.stateId = $event;\n        });\n        i0.ɵɵtemplate(43, EditReferenceComponent_mat_option_43_Template, 2, 2, \"mat-option\", 9);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(44, \"div\", 4);\n        i0.ɵɵelementStart(45, \"mat-form-field\", 25);\n        i0.ɵɵelementStart(46, \"input\", 26);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_46_listener($event) {\n          return ctx.reference.note = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(47, \"div\", 4);\n        i0.ɵɵelementStart(48, \"mat-form-field\", 25);\n        i0.ɵɵelementStart(49, \"input\", 27);\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_49_listener($event) {\n          return ctx.reference.archiving = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(50, \"div\", 28);\n        i0.ɵɵelementStart(51, \"button\", 29);\n        i0.ɵɵlistener(\"click\", function EditReferenceComponent_Template_button_click_51_listener() {\n          return ctx.saveReference();\n        });\n        i0.ɵɵtext(52);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(53, \"button\", 30);\n        i0.ɵɵlistener(\"click\", function EditReferenceComponent_Template_button_click_53_listener() {\n          return ctx.close();\n        });\n        i0.ɵɵtext(54, \"Close\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        const _r5 = i0.ɵɵreference(33);\n\n        i0.ɵɵadvance(6);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.reference.typeId);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formControl\", ctx.documentTypeFilterCtrl)(\"placeholderLabel\", \"Search\")(\"noEntriesFoundLabel\", \"No options found\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 35, ctx.filteredDocumentTypes));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.reference.activityId);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.activitiesIdentifiers);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.confidentialityCode);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.documentConfidentialitiesIdentifiers);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.projectAbrreviation);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"formControl\", ctx.abbrivationFilterCtrl)(\"placeholderLabel\", \"Search\")(\"noEntriesFoundLabel\", \"No options found\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(26, 37, ctx.filteredAbbreviations));\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.projectAbrreviation);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"matDatepicker\", _r5)(\"ngModel\", ctx.reference.creationDate);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"for\", _r5);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"startView\", \"month\");\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.referenceCode);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.title);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"inputValue\", ctx.reference.edition)(\"ngModel\", ctx.reference.edition);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.stateId);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.documentStatesIdentifiers);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.note);\n        i0.ɵɵadvance(3);\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.archiving);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"disabled\", !ctx.isSameActivity);\n        i0.ɵɵadvance(1);\n        i0.ɵɵtextInterpolate(ctx.getLabelSubmit());\n      }\n    },\n    directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i5.MatFormField, i6.MatSelect, i4.RequiredValidator, i4.NgControlStatus, i4.NgModel, i7.MatOption, i8.MatSelectSearchComponent, i4.FormControlDirective, i9.MatIcon, i8.ɵa, i10.NgForOf, i11.MatInput, i4.DefaultValueAccessor, i12.MatDatepickerInput, i12.MatDatepickerToggle, i5.MatSuffix, i12.MatDatepicker, i13.NumbrerValidatorDirective],\n    pipes: [i10.AsyncPipe],\n    styles: [\".mat-button[_ngcontent-%COMP%]{min-width:0px}\"]\n  });\n  return EditReferenceComponent;\n})();","map":{"version":3,"sources":["C:/Users/pprod/Desktop/satge PFE/satge PFE/TelnetTeamClient/src/app/components/project-management/project/references/edit-reference/edit-reference.component.ts"],"names":["FormControl","Subject","ReplaySubject","Subscription","takeUntil","Reference","i0","i1","i2","i3","i4","i5","i6","i7","i8","i9","i10","i11","i12","i13","_c0","EditReferenceComponent_mat_option_11_Template","rf","ctx","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","documentType_r7","$implicit","ɵɵproperty","id","ɵɵadvance","ɵɵtextInterpolate1","description","EditReferenceComponent_mat_option_15_Template","activity_r8","EditReferenceComponent_mat_option_18_Template","documentConfidentiality_r9","code","name","EditReferenceComponent_mat_option_25_Template","projectAbrreviation_r10","value","EditReferenceComponent_mat_option_43_Template","documentstate_r11","EditReferenceComponent","constructor","notificationService","referenceService","_avRoute","router","dateTimeService","reference","disableGenerator","subscription","isSameActivity","filteredDocumentTypes","documentTypeFilterCtrl","filteredAbbreviations","abbrivationFilterCtrl","_onDestroy","previousState","getPrevious","pageIndex","pageSize","ngOnInit","referenceId","activityId","JSON","parse","localStorage","getItem","params","subscribe","param","undefined","getReferenceProject","currentUser","creationDate","today","getDocumentTypes","getStates","getConfidentialities","valueChanges","pipe","filterAbbreviations","filterDocumentTypes","add","savedReference","data","ngOnDestroy","unsubscribe","getTypesDocuments","documentTypesIdentifiers","next","slice","getDocumentStates","documentStatesIdentifiers","GetDocumentConfidentialities","documentConfidentialitiesIdentifiers","getProjectAbbreviationByActivity","getActivityAbbriviations","projectsAbrreviation","Object","assign","splittedReferenceParts","getReferenceParts","referenceCode","projectAbrreviation","confidentialityCode","split","onActivtyChange","buildReferenceToSave","activityCode","referenceToSave","title","edition","stateId","note","archiving","userId","typeId","typeAbbreviation","filter","document","creationYear","Date","getFullYear","toString","substring","toUpperCase","getLabelSubmit","saveReference","referenceForm","valid","getActivityCode","length","replace","saveReferenceGenerator","success","close","danger","navigate","search","toLowerCase","abbriviation","indexOf","documentType","referenceElements","referenceElementsNumber","referenceParts","position","part","forEach","element","push","ɵfac","EditReferenceComponent_Factory","t","ɵɵdirectiveInject","NotificationService","ReferenceService","ActivatedRoute","Router","DateTimeService","ɵcmp","ɵɵdefineComponent","type","selectors","viewQuery","EditReferenceComponent_Query","ɵɵviewQuery","_t","ɵɵqueryRefresh","ɵɵloadQuery","first","decls","vars","consts","template","EditReferenceComponent_Template","ɵɵlistener","EditReferenceComponent_Template_mat_select_ngModelChange_6_listener","$event","ɵɵtemplate","ɵɵpipe","EditReferenceComponent_Template_mat_select_ngModelChange_14_listener","EditReferenceComponent_Template_mat_select_selectionChange_14_listener","EditReferenceComponent_Template_mat_select_ngModelChange_17_listener","EditReferenceComponent_Template_mat_select_ngModelChange_20_listener","EditReferenceComponent_Template_input_ngModelChange_28_listener","EditReferenceComponent_Template_input_ngModelChange_30_listener","ɵɵelement","EditReferenceComponent_Template_input_ngModelChange_35_listener","EditReferenceComponent_Template_input_ngModelChange_38_listener","EditReferenceComponent_Template_input_ngModelChange_40_listener","EditReferenceComponent_Template_mat_select_ngModelChange_42_listener","EditReferenceComponent_Template_input_ngModelChange_46_listener","EditReferenceComponent_Template_input_ngModelChange_49_listener","EditReferenceComponent_Template_button_click_51_listener","EditReferenceComponent_Template_button_click_53_listener","_r5","ɵɵreference","ɵɵpipeBind1","activitiesIdentifiers","ɵɵtextInterpolate","directives","ɵNgNoValidate","NgControlStatusGroup","NgForm","MatFormField","MatSelect","RequiredValidator","NgControlStatus","NgModel","MatOption","MatSelectSearchComponent","FormControlDirective","MatIcon","ɵa","NgForOf","MatInput","DefaultValueAccessor","MatDatepickerInput","MatDatepickerToggle","MatSuffix","MatDatepicker","NumbrerValidatorDirective","pipes","AsyncPipe","styles"],"mappings":"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","sourcesContent":["import { FormControl } from '@angular/forms';\r\nimport { Subject, ReplaySubject, Subscription } from 'rxjs/index';\r\nimport { takeUntil } from 'rxjs/operators';\r\nimport { Reference } from 'app/models/project-management/project';\r\nimport * as i0 from \"@angular/core\";\r\nimport * as i1 from \"app/services/shared\";\r\nimport * as i2 from \"app/services/project-management/project\";\r\nimport * as i3 from \"@angular/router\";\r\nimport * as i4 from \"@angular/forms\";\r\nimport * as i5 from \"@angular/material/form-field\";\r\nimport * as i6 from \"@angular/material/select\";\r\nimport * as i7 from \"@angular/material/core\";\r\nimport * as i8 from \"ngx-mat-select-search\";\r\nimport * as i9 from \"@angular/material/icon\";\r\nimport * as i10 from \"@angular/common\";\r\nimport * as i11 from \"@angular/material/input\";\r\nimport * as i12 from \"@angular/material/datepicker\";\r\nimport * as i13 from \"../../../../../directives/shared/number-validator.directive\";\r\nconst _c0 = [\"referenceForm\"];\r\nfunction EditReferenceComponent_mat_option_11_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const documentType_r7 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", documentType_r7.id);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", documentType_r7.description, \" \");\r\n} }\r\nfunction EditReferenceComponent_mat_option_15_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const activity_r8 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", activity_r8.id);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", activity_r8.description, \" \");\r\n} }\r\nfunction EditReferenceComponent_mat_option_18_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const documentConfidentiality_r9 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", documentConfidentiality_r9.code);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", documentConfidentiality_r9.name, \" \");\r\n} }\r\nfunction EditReferenceComponent_mat_option_25_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const projectAbrreviation_r10 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", projectAbrreviation_r10.value);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", projectAbrreviation_r10.value, \" \");\r\n} }\r\nfunction EditReferenceComponent_mat_option_43_Template(rf, ctx) { if (rf & 1) {\r\n    i0.ɵɵelementStart(0, \"mat-option\", 31);\r\n    i0.ɵɵtext(1);\r\n    i0.ɵɵelementEnd();\r\n} if (rf & 2) {\r\n    const documentstate_r11 = ctx.$implicit;\r\n    i0.ɵɵproperty(\"value\", documentstate_r11.id);\r\n    i0.ɵɵadvance(1);\r\n    i0.ɵɵtextInterpolate1(\" \", documentstate_r11.description, \" \");\r\n} }\r\nexport class EditReferenceComponent {\r\n    constructor(notificationService, referenceService, _avRoute, router, dateTimeService) {\r\n        this.notificationService = notificationService;\r\n        this.referenceService = referenceService;\r\n        this._avRoute = _avRoute;\r\n        this.router = router;\r\n        this.dateTimeService = dateTimeService;\r\n        this.reference = new Reference();\r\n        this.disableGenerator = true;\r\n        this.subscription = new Subscription();\r\n        this.isSameActivity = true;\r\n        this.filteredDocumentTypes = new ReplaySubject(1);\r\n        this.documentTypeFilterCtrl = new FormControl();\r\n        this.filteredAbbreviations = new ReplaySubject(1);\r\n        this.abbrivationFilterCtrl = new FormControl();\r\n        this._onDestroy = new Subject();\r\n        this.previousState = {\r\n            getPrevious: false,\r\n            pageIndex: null,\r\n            pageSize: null,\r\n        };\r\n    }\r\n    ngOnInit() {\r\n        if (this.reference.referenceId !== 0) {\r\n            this.isSameActivity = this.reference.activityId === JSON.parse(localStorage.getItem('currentUser')).activityId;\r\n        }\r\n        else {\r\n            this.disableGenerator = false;\r\n        }\r\n        this._avRoute.params.subscribe(param => {\r\n            if (param.referenceId !== undefined && param.referenceId !== null) {\r\n                this.getReferenceProject(+param.referenceId);\r\n            }\r\n        });\r\n        this.currentUser = JSON.parse(localStorage.getItem('currentUser'));\r\n        this.reference.creationDate = this.dateTimeService.today();\r\n        this.getDocumentTypes();\r\n        this.getStates();\r\n        this.getConfidentialities();\r\n        this.abbrivationFilterCtrl.valueChanges\r\n            .pipe(takeUntil(this._onDestroy))\r\n            .subscribe(() => {\r\n            this.filterAbbreviations();\r\n        });\r\n        this.documentTypeFilterCtrl.valueChanges\r\n            .pipe(takeUntil(this._onDestroy))\r\n            .subscribe(() => {\r\n            this.filterDocumentTypes();\r\n        });\r\n        this.subscription.add(this.referenceService.savedReference.subscribe((data) => {\r\n            if (data) {\r\n                this.previousState = data;\r\n            }\r\n        }));\r\n    }\r\n    ngOnDestroy() {\r\n        this.subscription.unsubscribe();\r\n    }\r\n    getDocumentTypes() {\r\n        this.referenceService.getTypesDocuments()\r\n            .subscribe(data => {\r\n            if (data != null) {\r\n                this.documentTypesIdentifiers = data;\r\n                this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice());\r\n            }\r\n        });\r\n    }\r\n    getStates() {\r\n        this.referenceService.getDocumentStates()\r\n            .subscribe(data => {\r\n            if (data != null) {\r\n                this.documentStatesIdentifiers = data;\r\n            }\r\n        });\r\n    }\r\n    getConfidentialities() {\r\n        this.referenceService.GetDocumentConfidentialities()\r\n            .subscribe(data => {\r\n            if (data != null) {\r\n                this.documentConfidentialitiesIdentifiers = data;\r\n            }\r\n        });\r\n    }\r\n    getProjectAbbreviationByActivity(activityId) {\r\n        this.referenceService.getActivityAbbriviations(activityId)\r\n            .subscribe(data => {\r\n            if (data != null) {\r\n                this.projectsAbrreviation = data;\r\n                this.filteredAbbreviations.next(this.projectsAbrreviation.slice());\r\n            }\r\n        });\r\n    }\r\n    getReferenceProject(referenceId) {\r\n        this.disableGenerator = true;\r\n        this.referenceService.getReferenceProject(referenceId).subscribe(data => {\r\n            this.reference = Object.assign(new Reference, data[0]);\r\n            this.isSameActivity = this.reference.activityId === JSON.parse(localStorage.getItem('currentUser')).activityId;\r\n            const splittedReferenceParts = this.getReferenceParts(this.reference.referenceCode);\r\n            this.projectAbrreviation = splittedReferenceParts[2];\r\n            this.confidentialityCode = splittedReferenceParts[4].split(' ')[1];\r\n        });\r\n    }\r\n    onActivtyChange(activityId) {\r\n        this.getProjectAbbreviationByActivity(activityId);\r\n    }\r\n    buildReferenceToSave(activityCode) {\r\n        const referenceToSave = new Reference();\r\n        referenceToSave.referenceId = this.reference.referenceId;\r\n        referenceToSave.referenceCode = this.reference.referenceCode;\r\n        referenceToSave.title = this.reference.title;\r\n        referenceToSave.edition = this.reference.edition;\r\n        referenceToSave.creationDate = this.reference.creationDate;\r\n        referenceToSave.stateId = this.reference.stateId;\r\n        referenceToSave.note = this.reference.note;\r\n        referenceToSave.archiving = this.reference.archiving;\r\n        referenceToSave.userId = this.reference.userId;\r\n        referenceToSave.activityId = this.reference.activityId;\r\n        referenceToSave.typeId = this.reference.typeId;\r\n        if (this.reference.referenceId === 0) {\r\n            // if new reference build new reference code\r\n            const typeAbbreviation = this.documentTypesIdentifiers.filter(document => document.id === this.reference.typeId)[0].description.split('/')[0];\r\n            const creationYear = new Date(this.reference.creationDate).getFullYear().toString().substring(2);\r\n            // expression ***** will be replaced by incremented counter in the stored procedure\r\n            referenceToSave.referenceCode = typeAbbreviation + '.' + activityCode + '.' +\r\n                this.projectAbrreviation.toUpperCase() + '.*****.' + creationYear + ' ' + this.confidentialityCode;\r\n        }\r\n        return referenceToSave;\r\n    }\r\n    getLabelSubmit() {\r\n        return this.disableGenerator ? 'Save' : 'Generate & Save';\r\n    }\r\n    saveReference() {\r\n        if (this.referenceForm.valid) {\r\n            this.referenceService.getActivityCode(this.reference.activityId).subscribe(data => {\r\n                const activityCode = (data.length !== 0) ? data[0].activityCode : 'TXA';\r\n                this.reference.userId = +this.currentUser.userId;\r\n                this.reference.edition = +this.reference.edition.toString().replace(',', '.');\r\n                const referenceToSave = this.buildReferenceToSave(activityCode);\r\n                this.referenceService.saveReferenceGenerator(referenceToSave).subscribe((referenceId) => {\r\n                    this.notificationService.success('Reference saved successfully');\r\n                    if (this.reference.referenceId === 0) {\r\n                        this.getReferenceProject(+referenceId);\r\n                    }\r\n                    else {\r\n                        this.close();\r\n                    }\r\n                });\r\n            });\r\n        }\r\n        else {\r\n            this.notificationService.danger('Please fill all required fields');\r\n        }\r\n    }\r\n    close() {\r\n        if (this.previousState.pageIndex != null) {\r\n            this.previousState.getPrevious = true;\r\n            this.referenceService.savedReference.next(this.previousState);\r\n        }\r\n        this.router.navigate(['/project-management/project/references']);\r\n    }\r\n    filterAbbreviations() {\r\n        if (!this.projectsAbrreviation) {\r\n            return;\r\n        }\r\n        let search = this.abbrivationFilterCtrl.value;\r\n        if (!search) {\r\n            this.filteredAbbreviations.next(this.projectsAbrreviation.slice());\r\n            return;\r\n        }\r\n        else {\r\n            search = search.toLowerCase();\r\n        }\r\n        this.filteredAbbreviations.next(this.projectsAbrreviation.filter(abbriviation => abbriviation.value.toLowerCase().indexOf(search) > -1));\r\n    }\r\n    filterDocumentTypes() {\r\n        if (!this.documentTypesIdentifiers) {\r\n            return;\r\n        }\r\n        let search = this.documentTypeFilterCtrl.value;\r\n        if (!search) {\r\n            this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice());\r\n            return;\r\n        }\r\n        else {\r\n            search = search.toLowerCase();\r\n        }\r\n        this.filteredDocumentTypes.next(this.documentTypesIdentifiers.filter(documentType => documentType.description.toLowerCase().indexOf(search) > -1));\r\n    }\r\n    getReferenceParts(reference) {\r\n        const referenceElements = reference.split('.');\r\n        const referenceElementsNumber = referenceElements.length;\r\n        let referenceParts = [];\r\n        if (referenceElementsNumber > 5) {\r\n            let position = 1;\r\n            let part = '';\r\n            referenceElements.forEach(element => {\r\n                if (part === '') {\r\n                    part += element;\r\n                }\r\n                else {\r\n                    part += '.' + element;\r\n                }\r\n                if (position < 3 || position >= referenceElementsNumber - 2) {\r\n                    referenceParts.push(part);\r\n                    part = '';\r\n                }\r\n                position++;\r\n            });\r\n        }\r\n        else {\r\n            referenceParts = referenceElements;\r\n        }\r\n        return referenceParts;\r\n    }\r\n}\r\nEditReferenceComponent.ɵfac = function EditReferenceComponent_Factory(t) { return new (t || EditReferenceComponent)(i0.ɵɵdirectiveInject(i1.NotificationService), i0.ɵɵdirectiveInject(i2.ReferenceService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i1.DateTimeService)); };\r\nEditReferenceComponent.ɵcmp = /*@__PURE__*/ i0.ɵɵdefineComponent({ type: EditReferenceComponent, selectors: [[\"app-edit-reference\"]], viewQuery: function EditReferenceComponent_Query(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵviewQuery(_c0, 7);\r\n    } if (rf & 2) {\r\n        let _t;\r\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.referenceForm = _t.first);\r\n    } }, decls: 55, vars: 39, consts: [[1, \"card\"], [1, \"card-body\"], [\"id\", \"referenceForm\"], [\"referenceForm\", \"ngForm\"], [1, \"row\", \"m-b-15\"], [1, \"col-sm-6\"], [\"placeholder\", \"Document Type\", \"name\", \"documentType\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [3, \"formControl\", \"placeholderLabel\", \"noEntriesFoundLabel\"], [\"ngxMatSelectSearchClear\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"col-sm-4\"], [\"placeholder\", \"Activity\", \"name\", \"activity\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\", \"selectionChange\"], [1, \"col-sm-2\"], [\"placeholder\", \"Confidentiality\", \"name\", \"confidentiality\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Project Abreviation\", \"name\", \"projectAbreviation\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Project Abreviation\", \"name\", \"projectAbreviationInput\", \"required\", \"\", 3, \"disabled\", \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Creation Date\", \"name\", \"creationDate\", \"required\", \"\", 3, \"disabled\", \"matDatepicker\", \"ngModel\", \"ngModelChange\"], [\"matSuffix\", \"\", 3, \"for\"], [3, \"startView\"], [\"PickerCreationDate\", \"\"], [\"matInput\", \"\", \"disabled\", \"\", \"laceholder\", \"Reference Value\", \"name\", \"referenceCode\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-sm-8\"], [\"matInput\", \"\", \"placeholder\", \"Title\", \"name\", \"title\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"appNumberValidator\", \"\", \"placeholder\", \"Edition\", \"name\", \"edition\", \"required\", \"\", 3, \"inputValue\", \"ngModel\", \"ngModelChange\"], [\"placeholder\", \"Status\", \"name\", \"state\", \"required\", \"\", 3, \"ngModel\", \"ngModelChange\"], [1, \"col-sm-12\"], [\"matInput\", \"\", \"placeholder\", \"Remarks\", \"name\", \"Remarks\", 3, \"ngModel\", \"ngModelChange\"], [\"matInput\", \"\", \"placeholder\", \"Archiving\", \"name\", \"Archiving\", 3, \"ngModel\", \"ngModelChange\"], [1, \"text-center\"], [\"type\", \"submit\", 1, \"btn\", \"btn-md\", \"btn-primary\", \"ripple\", \"light\", \"m-r-20\", 3, \"disabled\", \"click\"], [\"type\", \"reset\", 1, \"btn\", \"btn-md\", \"btn-default\", \"ripple\", 3, \"click\"], [3, \"value\"]], template: function EditReferenceComponent_Template(rf, ctx) { if (rf & 1) {\r\n        i0.ɵɵelementStart(0, \"div\", 0);\r\n        i0.ɵɵelementStart(1, \"div\", 1);\r\n        i0.ɵɵelementStart(2, \"form\", 2, 3);\r\n        i0.ɵɵelementStart(4, \"div\", 4);\r\n        i0.ɵɵelementStart(5, \"mat-form-field\", 5);\r\n        i0.ɵɵelementStart(6, \"mat-select\", 6);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_6_listener($event) { return ctx.reference.typeId = $event; });\r\n        i0.ɵɵelementStart(7, \"mat-option\");\r\n        i0.ɵɵelementStart(8, \"ngx-mat-select-search\", 7);\r\n        i0.ɵɵelementStart(9, \"mat-icon\", 8);\r\n        i0.ɵɵtext(10, \"close\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(11, EditReferenceComponent_mat_option_11_Template, 2, 2, \"mat-option\", 9);\r\n        i0.ɵɵpipe(12, \"async\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(13, \"mat-form-field\", 10);\r\n        i0.ɵɵelementStart(14, \"mat-select\", 11);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_14_listener($event) { return ctx.reference.activityId = $event; })(\"selectionChange\", function EditReferenceComponent_Template_mat_select_selectionChange_14_listener($event) { return ctx.onActivtyChange($event.value); });\r\n        i0.ɵɵtemplate(15, EditReferenceComponent_mat_option_15_Template, 2, 2, \"mat-option\", 9);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(16, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(17, \"mat-select\", 13);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_17_listener($event) { return ctx.confidentialityCode = $event; });\r\n        i0.ɵɵtemplate(18, EditReferenceComponent_mat_option_18_Template, 2, 2, \"mat-option\", 9);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(19, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(20, \"mat-select\", 14);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_20_listener($event) { return ctx.projectAbrreviation = $event; });\r\n        i0.ɵɵelementStart(21, \"mat-option\");\r\n        i0.ɵɵelementStart(22, \"ngx-mat-select-search\", 7);\r\n        i0.ɵɵelementStart(23, \"mat-icon\", 8);\r\n        i0.ɵɵtext(24, \"close\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵtemplate(25, EditReferenceComponent_mat_option_25_Template, 2, 2, \"mat-option\", 9);\r\n        i0.ɵɵpipe(26, \"async\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(27, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(28, \"input\", 15);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_28_listener($event) { return ctx.projectAbrreviation = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(29, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(30, \"input\", 16);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_30_listener($event) { return ctx.reference.creationDate = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelement(31, \"mat-datepicker-toggle\", 17);\r\n        i0.ɵɵelement(32, \"mat-datepicker\", 18, 19);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(34, \"mat-form-field\", 5);\r\n        i0.ɵɵelementStart(35, \"input\", 20);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_35_listener($event) { return ctx.reference.referenceCode = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(36, \"div\", 4);\r\n        i0.ɵɵelementStart(37, \"mat-form-field\", 21);\r\n        i0.ɵɵelementStart(38, \"input\", 22);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_38_listener($event) { return ctx.reference.title = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(39, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(40, \"input\", 23);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_40_listener($event) { return ctx.reference.edition = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(41, \"mat-form-field\", 12);\r\n        i0.ɵɵelementStart(42, \"mat-select\", 24);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_mat_select_ngModelChange_42_listener($event) { return ctx.reference.stateId = $event; });\r\n        i0.ɵɵtemplate(43, EditReferenceComponent_mat_option_43_Template, 2, 2, \"mat-option\", 9);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(44, \"div\", 4);\r\n        i0.ɵɵelementStart(45, \"mat-form-field\", 25);\r\n        i0.ɵɵelementStart(46, \"input\", 26);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_46_listener($event) { return ctx.reference.note = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(47, \"div\", 4);\r\n        i0.ɵɵelementStart(48, \"mat-form-field\", 25);\r\n        i0.ɵɵelementStart(49, \"input\", 27);\r\n        i0.ɵɵlistener(\"ngModelChange\", function EditReferenceComponent_Template_input_ngModelChange_49_listener($event) { return ctx.reference.archiving = $event; });\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(50, \"div\", 28);\r\n        i0.ɵɵelementStart(51, \"button\", 29);\r\n        i0.ɵɵlistener(\"click\", function EditReferenceComponent_Template_button_click_51_listener() { return ctx.saveReference(); });\r\n        i0.ɵɵtext(52);\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementStart(53, \"button\", 30);\r\n        i0.ɵɵlistener(\"click\", function EditReferenceComponent_Template_button_click_53_listener() { return ctx.close(); });\r\n        i0.ɵɵtext(54, \"Close\");\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n        i0.ɵɵelementEnd();\r\n    } if (rf & 2) {\r\n        const _r5 = i0.ɵɵreference(33);\r\n        i0.ɵɵadvance(6);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.reference.typeId);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"formControl\", ctx.documentTypeFilterCtrl)(\"placeholderLabel\", \"Search\")(\"noEntriesFoundLabel\", \"No options found\");\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(12, 35, ctx.filteredDocumentTypes));\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.reference.activityId);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.activitiesIdentifiers);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.confidentialityCode);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.documentConfidentialitiesIdentifiers);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.projectAbrreviation);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"formControl\", ctx.abbrivationFilterCtrl)(\"placeholderLabel\", \"Search\")(\"noEntriesFoundLabel\", \"No options found\");\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngForOf\", i0.ɵɵpipeBind1(26, 37, ctx.filteredAbbreviations));\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"ngModel\", ctx.projectAbrreviation);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"disabled\", ctx.disableGenerator)(\"matDatepicker\", _r5)(\"ngModel\", ctx.reference.creationDate);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"for\", _r5);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"startView\", \"month\");\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.referenceCode);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.title);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"inputValue\", ctx.reference.edition)(\"ngModel\", ctx.reference.edition);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.stateId);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵproperty(\"ngForOf\", ctx.documentStatesIdentifiers);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.note);\r\n        i0.ɵɵadvance(3);\r\n        i0.ɵɵproperty(\"ngModel\", ctx.reference.archiving);\r\n        i0.ɵɵadvance(2);\r\n        i0.ɵɵproperty(\"disabled\", !ctx.isSameActivity);\r\n        i0.ɵɵadvance(1);\r\n        i0.ɵɵtextInterpolate(ctx.getLabelSubmit());\r\n    } }, directives: [i4.ɵNgNoValidate, i4.NgControlStatusGroup, i4.NgForm, i5.MatFormField, i6.MatSelect, i4.RequiredValidator, i4.NgControlStatus, i4.NgModel, i7.MatOption, i8.MatSelectSearchComponent, i4.FormControlDirective, i9.MatIcon, i8.ɵa, i10.NgForOf, i11.MatInput, i4.DefaultValueAccessor, i12.MatDatepickerInput, i12.MatDatepickerToggle, i5.MatSuffix, i12.MatDatepicker, i13.NumbrerValidatorDirective], pipes: [i10.AsyncPipe], styles: [\".mat-button[_ngcontent-%COMP%]{min-width:0px}\"] });\r\n"]},"metadata":{},"sourceType":"module"}
"use strict";(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[538],{59538:function(e,t,n){n.r(t),n.d(t,{CUSTOM_DT_FORMATS:function(){return uc},ProjectModule:function(){return gc}});var i=n(38583),r=n(32403),a=n(88452),o=n(3679),s=n(17238),l=n(22238),c=n(70833),d=n(10337),m=n(24438),p=n(44995),h=n(62028),u=n(35929),g=n(37716),f=n(5566),v=n(65939),S=n(85718),b=n(98295),C=n(49983),y=n(67441),E=n(43220),x=n(72458);function I(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e," ")}}function w(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,I,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("name")))}}function M(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function P(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,M,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("description")))}}function D(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",33),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function j(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e," ")}}function O(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,j,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("selectedPhaseId")))}}function F(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",33),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function k(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e," ")}}function A(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,k,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("selectedCategoryId")))}}function _(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function V(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,_,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("plannedStartDate")))}}function N(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function R(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,N,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("plannedEndDate")))}}function T(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function B(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,T,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("plannedDuration")))}}function z(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function q(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,z,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("elapsedDuration")))}}function L(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function Q(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,L,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("estimatedCharge")))}}function $(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function U(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,$,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.detailsForm.get("advancement")))}}const H=function(e){return{"btn-disabled":e}};function G(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",34),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().revert()}),g.\u0275\u0275text(1," Cancel "),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("disabled",e.isCancelBtnDisabled())("ngClass",g.\u0275\u0275pureFunction1(2,H,e.isCancelBtnDisabled()))}}function W(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",35),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().saveActivityDetails()}),g.\u0275\u0275text(1," Save "),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("disabled",e.isSaveBtnDisabled()||e.mutliClickDisable)("ngClass",g.\u0275\u0275pureFunction1(2,H,e.isSaveBtnDisabled()))}}let J=(()=>{class e{constructor(e,t,n,i,r){this.notificationService=e,this.projectService=t,this.dtService=n,this.fb=i,this.showErrorService=r,this.refresh=new g.EventEmitter,this.close=new g.EventEmitter,this.phasesIdentifiers=[],this.phasesCategories=[],this.mutliClickDisable=!1}ngOnInit(){this.rebuildForm(),this.updateDateRangeValue(),this.isReadOnlyMode=1===this.activity.level,this.disableFormControls(),this.departmentId!==m.vH.Mecanic&&this.departmentId!==m.vH.DATABOX&&(this.departmentId=m.vH.ProjectTelnet),this.getPhases(this.departmentId),this.isEditMode&&this.projectService.getPhaseCategories().subscribe(e=>{this.phasesCategories=e,this.phasesCategories=this.phasesCategories.filter(e=>e.phaseId===this.activity.phaseId)})}disableFormControls(){this.isReadOnlyMode&&Object.entries(this.detailsForm.controls).forEach(([e])=>{this.detailsForm.controls[e].disable()}),this.detailsForm.controls.elapsedDuration.disable(),this.detailsForm.controls.estimatedCharge.disable(),this.detailsForm.controls.actualCost.disable(),this.detailsForm.controls.advancement.disable(),this.detailsForm.controls.plannedDuration.disable()}updateDateRangeValue(){this.minStartDate=this.parentStartDate,this.maxStartDate=this.dtService.getMinDate(this.parentEndDate,this.detailsForm.controls.plannedEndDate.value),this.minEndDate=this.dtService.getMaxDate(this.parentStartDate,this.detailsForm.controls.plannedStartDate.value),this.maxEndDate=this.parentEndDate}insertNewActivityDetails(){const e=this.activity;this.activity.activityNumber=e.hasChilds?e.activityNumber+"."+(e.subActivities.length+1):e.activityNumber+".1",this.activity.projectId=e.projectId,this.activity.level=e.level+1,this.activity.parentId=e.activityId,this.activity.subActivities=[],this.activity.assignments=[],this.activity.hasChilds=!1}rebuildForm(){this.detailsForm.reset({name:this.activity.name,description:this.activity.description,selectedPhaseId:this.activity.phaseId,selectedCategoryId:this.activity.categoryId,plannedStartDate:this.activity.plannedStartDate,plannedEndDate:this.activity.plannedEndDate,estimatedCharge:this.activity.estimatedCharge,plannedDuration:this.activity.plannedDuration,elapsedDuration:this.activity.elapsedDuration,advancement:this.activity.advancement,actualCost:this.activity.actualCost})}prepareSaveActivity(){const e=this.detailsForm.value,t=new m.cS;return t.activityId=this.activity.activityId,t.projectId=this.activity.projectId,t.phaseId=this.detailsForm.controls.selectedPhaseId.value,t.categoryId=this.detailsForm.controls.selectedCategoryId.value,t.name=e.name,t.description=e.description,t.plannedStartDate=e.plannedStartDate,t.plannedEndDate=e.plannedEndDate,t.estimatedCharge=e.estimatedCharge,t.advancement=e.advancement,t.actualCost=e.actualCost,t.elapsedDuration=e.elapsedDuration,t}revert(){this.rebuildForm(),this.close.emit()}updateOriginalActivity(e){this.activity.activityId=e.activityId,this.activity.name=e.name,this.activity.description=e.description,this.activity.phaseId=e.phaseId,this.activity.categoryId=e.categoryId,this.activity.plannedStartDate=e.plannedStartDate,this.activity.plannedEndDate=e.plannedEndDate,this.activity.estimatedCharge=e.estimatedCharge,this.activity.advancement=e.advancement,this.activity.actualCost=e.actualCost,this.activity.realEndDate=e.realEndDate,this.activity.status=e.status,this.activity.earnedValue=e.earnedValue,this.activity.spi=e.spi,this.activity.cpi=e.cpi,this.activity.elapsedDuration=e.elapsedDuration}saveActivityDetails(){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3);const e=this.prepareSaveActivity();this.activity.advancement!==e.advancement?100===e.advancement?(e.realEndDate=this.dtService.today(),e.status=m.fU.Completed):(e.status=m.fU.Started,e.realEndDate=null):(e.status=this.activity.status,e.realEndDate=this.activity.realEndDate),this.projectService.saveActivity(e).subscribe(t=>{0===this.activity.activityId&&(e.activityId=t,this.isEditMode=!0),this.updateOriginalActivity(e),this.updateAllKpis(),this.rebuildForm(),this.notificationService.success("Task saved successfully."),this.refresh.emit()},e=>{this.notificationService.danger("Save task failed")})}updateEstimatedCharge(){let e=0;this.activity.assignments.forEach(t=>{e+=+t.estimatedCharge}),this.detailsForm.patchValue({estimatedCharge:e}),this.detailsForm.controls.estimatedCharge.markAsDirty()}activityDateChange(){this.detailsForm.controls.plannedStartDate.valid&&this.detailsForm.controls.plannedEndDate.valid&&(this.updatePlannedDuration(),this.updateDateRangeValue(),this.updateElapsedDuration())}updatePlannedDuration(){this.detailsForm.patchValue({plannedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.detailsForm.controls.plannedEndDate.value)}),this.detailsForm.controls.plannedDuration.markAsDirty()}updateElapsedDuration(){switch(this.activity.status){case m.fU.NotStarted:this.detailsForm.patchValue({elapsedDuration:0});break;case m.fU.Started:this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.dtService.today(),!1)});break;case m.fU.Completed:if(this.activity.hasChilds){let e=null;this.activity.subActivities.forEach(t=>{e=this.dtService.getMaxDate(e,t.realEndDate)}),this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,e)})}else this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.activity.realEndDate)})}}updateAllKpis(){this.updateEarnedValue(),this.updateSpi(),this.updateCpi()}updateEarnedValue(){const e=+(this.activity.advancement/100*this.activity.estimatedCharge).toFixed(2);this.activity.earnedValue=isNaN(e)?0:e}updateSpi(){if(0!==this.activity.elapsedDuration){const e=+(this.activity.advancement/100*this.activity.plannedDuration/this.activity.elapsedDuration).toFixed(2);this.activity.spi=isNaN(e)?0:e}else this.activity.spi=0}updateCpi(){if(0!==this.activity.actualCost){const e=+(this.activity.earnedValue/this.activity.actualCost).toFixed(2);this.activity.cpi=isNaN(e)?0:e}else this.activity.cpi=0}isSaveBtnDisabled(){return this.isReadOnlyMode||this.detailsForm.invalid}isCancelBtnDisabled(){return this.isReadOnlyMode}isCloseBtnDisabled(){return this.detailsForm.dirty||this.detailsForm.touched}getPhases(e){this.projectService.getProjectPhases(e).subscribe(e=>{e.forEach(e=>{this.phasesIdentifiers.push(Object.assign(new S.x,e))})})}onChangePhase(e){this.projectService.getPhaseCategories().subscribe(t=>{this.phasesCategories=t,this.phasesCategories=this.phasesCategories.filter(t=>t.phaseId===e)}),this.activity.phaseId=e,this.detailsForm.controls.selectedCategoryId.setValue(0)}onChangeCategory(e){this.activity.categoryId=e}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(o.FormBuilder),g.\u0275\u0275directiveInject(d.n4))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-activity-details"]],inputs:{departmentId:"departmentId",activity:"activity",isEditMode:"isEditMode",isReadOnlyMode:"isReadOnlyMode",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",detailsForm:"detailsForm"},outputs:{refresh:"refresh",close:"close"},decls:46,vars:26,consts:[[1,"activity-details"],["id","detailsForm",3,"formGroup"],[1,"details-form"],[1,"name"],["placeholder","Task Name","matInput","","name","name","formControlName","name","required","","maxlength","50","appTextValidator",""],[4,"ngIf"],[1,"description"],["placeholder","Description","matInput","","name","activityDesc","formControlName","description","required",""],[1,"phases"],["placeholder","Phases","formControlName","selectedPhaseId","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"categories"],["placeholder","Categories","formControlName","selectedCategoryId","required","",3,"selectionChange"],[1,"start-end-date"],["matInput","","placeholder","Start Date","formControlName","plannedStartDate","required","",3,"min","max","matDatepicker","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End Date","formControlName","plannedEndDate","required","",3,"min","max","matDatepicker","dateChange"],["PickerEndDay",""],[1,"duration"],["placeholder","Planned duration (Days):","matInput","","name","plannedDuration","formControlName","plannedDuration"],["placeholder","Elapsed duration (Days):","matInput","","name","elapsedDuration","formControlName","elapsedDuration"],[1,"charge"],["placeholder","Charge (MD):","matInput","","name","estimatedCharge","formControlName","estimatedCharge"],[1,"advancement"],["placeholder","Progress (%):","matInput","","name","advancement",3,"formControlName"],[1,"actual-cost"],["placeholder","Actual Cost (MD)","matInput","","name","actualCost","formControlName","actualCost"],[1,"activity-btn"],["type","button","class","btn btn-outline-primary m-r-10",3,"disabled","ngClass","click",4,"ngIf"],["class","btn btn-primary",3,"disabled","ngClass","click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],["type","button",1,"btn","btn-outline-primary","m-r-10",3,"disabled","ngClass","click"],[1,"btn","btn-primary",3,"disabled","ngClass","click"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"form",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"mat-form-field",3),g.\u0275\u0275element(4,"input",4),g.\u0275\u0275template(5,w,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"mat-form-field",6),g.\u0275\u0275element(7,"input",7),g.\u0275\u0275template(8,P,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"mat-form-field",8),g.\u0275\u0275elementStart(10,"mat-select",9),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangePhase(e.value)}),g.\u0275\u0275template(11,D,2,2,"mat-option",10),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(12,O,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"mat-form-field",11),g.\u0275\u0275elementStart(14,"mat-select",12),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCategory(e.value)}),g.\u0275\u0275template(15,F,2,2,"mat-option",10),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(16,A,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"mat-form-field",13),g.\u0275\u0275elementStart(18,"input",14),g.\u0275\u0275listener("dateChange",function(){return t.activityDateChange()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(19,"mat-datepicker-toggle",15),g.\u0275\u0275element(20,"mat-datepicker",16,17),g.\u0275\u0275template(22,V,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"mat-form-field",13),g.\u0275\u0275elementStart(24,"input",18),g.\u0275\u0275listener("dateChange",function(){return t.activityDateChange()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(25,"mat-datepicker-toggle",15),g.\u0275\u0275element(26,"mat-datepicker",16,19),g.\u0275\u0275template(28,R,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"mat-form-field",20),g.\u0275\u0275element(30,"input",21),g.\u0275\u0275template(31,B,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"mat-form-field",20),g.\u0275\u0275element(33,"input",22),g.\u0275\u0275template(34,q,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"mat-form-field",23),g.\u0275\u0275element(36,"input",24),g.\u0275\u0275template(37,Q,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"mat-form-field",25),g.\u0275\u0275element(39,"input",26),g.\u0275\u0275template(40,U,2,1,"mat-error",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"mat-form-field",27),g.\u0275\u0275element(42,"input",28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"div",29),g.\u0275\u0275template(44,G,2,4,"button",30),g.\u0275\u0275template(45,W,2,4,"button",31),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(21),n=g.\u0275\u0275reference(27);g.\u0275\u0275advance(1),g.\u0275\u0275property("formGroup",t.detailsForm),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("name"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("description"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",t.phasesIdentifiers),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("selectedPhaseId"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",t.phasesCategories),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("selectedCategoryId"))),g.\u0275\u0275advance(2),g.\u0275\u0275property("min",t.minStartDate)("max",t.maxStartDate)("matDatepicker",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedStartDate"))),g.\u0275\u0275advance(2),g.\u0275\u0275property("min",t.minEndDate)("max",t.maxEndDate)("matDatepicker",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedEndDate"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedDuration"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("elapsedDuration"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("estimatedCharge"))),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControlName","advancement"),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("advancement"))),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",!t.isReadOnlyMode),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.isReadOnlyMode)}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.FormGroupDirective,b.KE,C.Nt,o.DefaultValueAccessor,o.NgControlStatus,o.FormControlName,o.RequiredValidator,o.MaxLengthValidator,i.NgIf,y.gD,i.NgForOf,E.hl,E.nW,b.R9,E.Mq,b.TO,x.ey,i.NgClass],styles:["activity-details[_ngcontent-%COMP%]{overflow:hidden}.activity-btn[_ngcontent-%COMP%]{float:right;padding-right:20px;margin-top:60px}.details-form[_ngcontent-%COMP%]{display:inline-block;padding:10px}.details-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:0 5px}.details-form[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:97%}.details-form[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{width:97%}.details-form[_ngcontent-%COMP%]   .phases[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .start-end-date[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .duration[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .charge[_ngcontent-%COMP%]{width:30%}.details-form[_ngcontent-%COMP%]   .advancement[_ngcontent-%COMP%]{width:30%}.details-form[_ngcontent-%COMP%]   .actual-cost[_ngcontent-%COMP%]{width:31%}"]}),e})(),Y=(()=>{class e{getLabelCssClass(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-activity-kpi"]],inputs:{activity:"activity"},decls:53,vars:5,consts:[[1,"table-responsive"],[1,"table","table-border","table-xs"],[2,"padding","0px"],["scope","col"],["colspan","2",1,"text-right"],[1,"text-right",2,"padding-right","0"],[3,"className"],[2,"width","10px","padding-right","0"],[1,"kpi-tooltip"],[1,"material-icons"],[1,"kpi-tooltip-content"],[1,"kpi-tooltip-text"],[1,"kpi-tooltip-inner"],[2,"display","block"],[1,"li-danger"],[1,"li-default"],[1,"li-success"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"table",1),g.\u0275\u0275element(2,"caption",2),g.\u0275\u0275elementStart(3,"tbody"),g.\u0275\u0275elementStart(4,"tr"),g.\u0275\u0275elementStart(5,"th",3),g.\u0275\u0275text(6,"Earned Value:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",4),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"tr"),g.\u0275\u0275elementStart(10,"th",3),g.\u0275\u0275text(11,"SPI:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"td",5),g.\u0275\u0275elementStart(13,"label",6),g.\u0275\u0275text(14),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"td",7),g.\u0275\u0275elementStart(16,"a",8),g.\u0275\u0275elementStart(17,"em",9),g.\u0275\u0275text(18,"info_outline"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"span",10),g.\u0275\u0275elementStart(20,"span",11),g.\u0275\u0275elementStart(21,"span",12),g.\u0275\u0275elementStart(22,"span",13),g.\u0275\u0275text(23,"Schedule Performance Index (SPI) :"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"ul"),g.\u0275\u0275elementStart(25,"li",14),g.\u0275\u0275text(26,"\xa0- SPI < 1 : ahead of schedule"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"li",15),g.\u0275\u0275text(28,"\xa0- SPI = 1 : on time"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"li",16),g.\u0275\u0275text(30,"\xa0- SPI > 1 : behind schedule"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"tr"),g.\u0275\u0275elementStart(32,"th",3),g.\u0275\u0275text(33,"CPI:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"td",5),g.\u0275\u0275elementStart(35,"label",6),g.\u0275\u0275text(36),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(37,"td",7),g.\u0275\u0275elementStart(38,"a",8),g.\u0275\u0275elementStart(39,"em",9),g.\u0275\u0275text(40,"info_outline"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"span",10),g.\u0275\u0275elementStart(42,"span",11),g.\u0275\u0275elementStart(43,"span",12),g.\u0275\u0275elementStart(44,"span",13),g.\u0275\u0275text(45,"Cost Performance Index (CPI) :"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"ul"),g.\u0275\u0275elementStart(47,"li",14),g.\u0275\u0275text(48,"\xa0- CPI < 1 : over budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(49,"li",15),g.\u0275\u0275text(50,"\xa0- CPI = 1 : on budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"li",16),g.\u0275\u0275text(52,"\xa0- CPI > 1 : under budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(8),g.\u0275\u0275textInterpolate1("",t.activity.earnedValue," MD"),g.\u0275\u0275advance(5),g.\u0275\u0275property("className",t.getLabelCssClass(t.activity.spi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.activity.spi," "),g.\u0275\u0275advance(21),g.\u0275\u0275property("className",t.getLabelCssClass(t.activity.cpi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.activity.cpi," "))},styles:['.table[_ngcontent-%COMP%]{margin:0}.table.table-xs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table.table-xs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px}.td-kpi-value[_ngcontent-%COMP%]{padding-right:0}.td-kpi-info[_ngcontent-%COMP%]{width:10px;padding-right:0}.mat-tab-header[_ngcontent-%COMP%]{overflow:visible}.table-responsive[_ngcontent-%COMP%]{overflow:visible;padding:35px 15px}.kpi-tooltip[_ngcontent-%COMP%]{display:inline;position:relative;z-index:999}.kpi-tooltip[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-text[_ngcontent-%COMP%]{transition-delay:0s;transform:scale(1)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-inner[_ngcontent-%COMP%]{transition-delay:.3s;transform:translate(0)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-content[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;transition-delay:0s}.kpi-tooltip-content[_ngcontent-%COMP%]{position:absolute;z-index:9999;width:220px;left:50%;bottom:100%;font-size:12px;line-height:1.4;font-weight:400;color:#fff;background:0 0;opacity:0;margin:0 0 20px -205px;cursor:default;pointer-events:none;-webkit-font-smoothing:antialiased;transition:opacity .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.kpi-tooltip-content[_ngcontent-%COMP%]:after{content:"";bottom:-20px;left:50%;border:solid transparent;height:0;width:0;position:absolute;pointer-events:none;border-color:#007bff transparent transparent;border-width:10px;margin-left:85px}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-text[_ngcontent-%COMP%]{border-bottom:10px solid #007bff;overflow:hidden;transform:scaleX(0);transition:transform .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]{background:#2b2b2b;padding:10px;transform:translateY(100%);transition:transform .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-danger[_ngcontent-%COMP%]{color:#ff5252}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-success[_ngcontent-%COMP%]{color:#11c15b}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-default[_ngcontent-%COMP%]{color:#d6d6d6}a.kpi-tooltip[_ngcontent-%COMP%]{font-weight:700;color:#007bff;z-index:9}']}),e})();var K=n(88259),X=n.n(K),Z=n(5963),ee=n(52110),te=n(51095),ne=n(38590);function ie(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",34),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.Id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.Description," ")}}function re(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e," ")}}function ae(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,re,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("selectedUsersId")))}}function oe(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",34),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.roleId),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.roleName," ")}}function se(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e," ")}}function le(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,se,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("selectedRoleId")))}}function ce(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function de(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,ce,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("userPlannedStartDate")))}}function me(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e,"")}}function pe(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,me,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("userPlannedEndDate")))}}function he(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e," ")}}function ue(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,he,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("estimatedCharge")))}}function ge(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",35),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().updateUserEstimatedCharge()}),g.\u0275\u0275element(1,"em",36),g.\u0275\u0275elementEnd()}}function fe(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e," ")}}function ve(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-error"),g.\u0275\u0275template(1,fe,2,1,"mat-error",32),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.showErrorService.getErrors(e.assignmentForm.get("budgetedCharge")))}}function Se(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",35),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().updateUserBudgetedCharge()}),g.\u0275\u0275element(1,"em",36),g.\u0275\u0275elementEnd()}}function be(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"tr"),g.\u0275\u0275elementStart(1,"td",37),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(3,"td",37),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"td",38),g.\u0275\u0275text(6),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",38),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",39),g.\u0275\u0275text(10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"td",39),g.\u0275\u0275text(12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"td",40),g.\u0275\u0275elementStart(14,"em",41),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().editAssignment(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"td",40),g.\u0275\u0275elementStart(16,"em",42),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().deleteAssignment(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.memberName,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.memberName),g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.roleName,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.roleName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(n.dtService.getShortFormat(e.userPlannedStartDate)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(n.dtService.getShortFormat(e.userPlannedEndDate)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.estimatedCharge),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.budgetedCharge)}}const Ce=function(e){return{active:e}};function ye(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"li",44),g.\u0275\u0275elementStart(1,"a",45),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).setPage(t)}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(2,Ce,n.pager.currentPage===e)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e)}}const Ee=function(e){return{disabled:e}};function xe(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"ul",43),g.\u0275\u0275elementStart(1,"li",44),g.\u0275\u0275elementStart(2,"a",45),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().setPage(1)}),g.\u0275\u0275text(3,"First"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"li",44),g.\u0275\u0275elementStart(5,"a",45),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.currentPage-1)}),g.\u0275\u0275text(6,"Previous"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,ye,3,4,"li",46),g.\u0275\u0275elementStart(8,"li",44),g.\u0275\u0275elementStart(9,"a",45),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setNextPage(t.pager.currentPage+1)}),g.\u0275\u0275text(10,"Next"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"li",44),g.\u0275\u0275elementStart(12,"a",45),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.totalPages)}),g.\u0275\u0275text(13,"Last"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(5,Ee,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(7,Ee,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",e.pager.pages),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(9,Ee,e.pager.currentPage===e.pager.totalPages)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(11,Ee,e.pager.currentPage===e.pager.totalPages))}}const Ie=function(e){return{"btn-disabled":e}};let we=(()=>{class e{constructor(e,t,n,i,r,a){this.mailService=e,this.projectService=t,this.notificationService=n,this.pagerService=i,this.dtService=r,this.showErrorService=a,this.users=[],this.pager={},this.rolesList=[],this.isEditAssignmentMode=!1}ngOnInit(){this.getProjectMembers(),this.getAllRoles(),0!==this.activity.activityId&&(this.getActivityDetails(this.activity.activityId),this.rebuildForm())}updateDateRangeValue(){this.minStartDate=this.activity.plannedStartDate,this.maxStartDate=this.dtService.getMinDate(this.activity.plannedEndDate,this.assignmentForm.controls.userPlannedEndDate.value),this.minEndDate=this.dtService.getMaxDate(this.activity.plannedStartDate,this.assignmentForm.controls.userPlannedStartDate.value),this.maxEndDate=this.activity.plannedEndDate}rebuildForm(){this.isEditAssignmentMode=!1,this.assignmentForm.reset({selectedUsersId:null,selectedRoleId:null,userPlannedStartDate:this.activity.plannedStartDate,userPlannedEndDate:this.activity.plannedEndDate}),this.updateUserEstimatedCharge(),this.updateUserBudgetedCharge(),this.assignmentForm.controls.selectedUsersId.markAsPristine(),this.assignmentForm.controls.selectedUsersId.markAsUntouched(),this.assignmentForm.controls.selectedUsersId.enable(),this.assignmentForm.controls.selectedRoleId.markAsPristine(),this.assignmentForm.controls.selectedRoleId.markAsUntouched()}getActivityDetails(e){this.projectService.getProjectActivityAssignments(e).subscribe(e=>{this.activity.assignments=[],null!=e&&(e.forEach(e=>{this.activity.assignments.push(Object.assign(new m.ot,e))}),this.setPage(1))})}clear(){this.rebuildForm()}getSaveBtnLabel(){return this.isEditAssignmentMode?"Save":"Add"}saveAssignment(){const e=new m.ot;let t="";e.activityId=this.activity.activityId,e.projectId=this.activity.projectId,e.usersIds=this.assignmentForm.controls.selectedUsersId.value,e.roleId=this.assignmentForm.controls.selectedRoleId.value,e.userPlannedStartDate=this.assignmentForm.controls.userPlannedStartDate.value,e.userPlannedEndDate=this.assignmentForm.controls.userPlannedEndDate.value,e.estimatedCharge=this.assignmentForm.controls.estimatedCharge.value,e.budgetedCharge=this.assignmentForm.controls.budgetedCharge.value,this.projectService.saveAssignments(e).subscribe(n=>{0!==n?this.projectService.getProjectActivityAssignments(this.activity.activityId).subscribe(n=>{this.activity.assignments=[],null!=n&&n.forEach(e=>{this.activity.assignments.push(Object.assign(new m.ot,e)),t="",t=e.projectName}),!1===this.isEditAssignmentMode&&this.mailService.taskAssigned(this.activity.name,e.usersIds,t),this.activity.hasAssignment=!0,this.setPage(1),this.rebuildForm()},()=>{this.notificationService.danger("Save assignment failed")}):this.notificationService.danger("Failed to save assignments")},()=>{this.notificationService.danger("Failed to save assignments")})}editAssignment(e){this.isEditAssignmentMode=!0;const t=[];t.push(e.userId),this.assignmentForm.reset({selectedUsersId:t,selectedRoleId:e.roleId,userPlannedStartDate:e.userPlannedStartDate,userPlannedEndDate:e.userPlannedEndDate,estimatedCharge:e.estimatedCharge,budgetedCharge:e.budgetedCharge}),this.assignmentForm.controls.selectedUsersId.markAsPristine(),this.assignmentForm.controls.selectedUsersId.markAsUntouched(),this.assignmentForm.controls.selectedUsersId.disable(),this.assignmentForm.controls.selectedRoleId.markAsPristine(),this.assignmentForm.controls.selectedRoleId.markAsUntouched()}deleteAssignment(e){X().fire({text:"Are you sure to delete this assignment ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{e.activityId=this.activity.activityId,e.projectId=this.activity.projectId,this.projectService.deleteAssignment(e).subscribe(t=>{0!==t?(this.notificationService.success("Delete assignment succeeded."),this.activity.assignments=this.activity.assignments.filter(t=>t.userId!==e.userId),0===this.activity.assignments.length&&(this.activity.hasAssignment=!1),this.setPage(1),this.rebuildForm()):this.notificationService.danger("Delete assignment failed.")},()=>{this.notificationService.danger("Delete assignment failed.")})}})}getProjectMembers(){this.projectService.getProjectMembers(this.activity.projectId).subscribe(e=>{this.users=e})}setPage(e){e<1||(this.pager=this.pagerService.getPager(this.activity.assignments.length,e),this.pagedItems=this.activity.assignments.slice(this.pager.startIndex,this.pager.endIndex+1))}setNextPage(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.activity.assignments.length,e),this.pagedItems=this.activity.assignments.slice(this.pager.startIndex,this.pager.endIndex+1)}assignmentDateChange(){this.assignmentForm.controls.userPlannedStartDate.valid&&this.assignmentForm.controls.userPlannedEndDate.valid&&(this.updateUserEstimatedCharge(),this.updateUserBudgetedCharge())}updateUserEstimatedCharge(){this.assignmentForm.patchValue({estimatedCharge:8*this.dtService.getBusinessDays(this.assignmentForm.controls.userPlannedStartDate.value,this.assignmentForm.controls.userPlannedEndDate.value)}),this.assignmentForm.controls.estimatedCharge.markAsDirty()}updateUserBudgetedCharge(){this.assignmentForm.patchValue({budgetedCharge:8*this.dtService.getBusinessDays(this.assignmentForm.controls.userPlannedStartDate.value,this.assignmentForm.controls.userPlannedEndDate.value)}),this.assignmentForm.controls.budgetedCharge.markAsDirty()}getAllRoles(){this.projectService.getAllRoles().subscribe(e=>{this.rolesList=[],e.forEach(e=>{this.rolesList.push(Object.assign(new m.jg,e))}),this.rolesList=this.rolesList.filter(e=>e.roleId!==h.G7.SQA)})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.YT),g.\u0275\u0275directiveInject(Z.Y),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(ee.e),g.\u0275\u0275directiveInject(f.C),g.\u0275\u0275directiveInject(d.n4))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-activity-assignment"]],inputs:{activity:"activity",isEditMode:"isEditMode",isReadOnlyMode:"isReadOnlyMode",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",assignmentForm:"assignmentForm"},decls:59,vars:28,consts:[[1,"activity-assignment"],[3,"submit"],[1,"assignment-form",3,"formGroup"],["assign","ngForm"],[1,"users-list"],["multiple","","placeholder","Resources","formControlName","selectedUsersId","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"roles-list"],["placeholder","Role","formControlName","selectedRoleId","required",""],[1,"start-date"],["matInput","","placeholder","Start Date","formControlName","userPlannedStartDate","required","",3,"matDatepicker","min","max","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerAssgPlannedStartDay",""],[1,"end-date"],["matInput","","placeholder","End Date","formControlName","userPlannedEndDate","required","",3,"min","max","matDatepicker","dateChange"],["PickerAssgPlannedEndDay",""],[1,"user-charge"],["placeholder","Estimate (h)","matInput","","name","estimatedCharge","formControlName","estimatedCharge","required",""],["mat-button","","type","button","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["placeholder","Budget (h)","matInput","","name","budgetedCharge","formControlName","budgetedCharge","required",""],[1,"assignment-btn"],["type","button",1,"btn","btn-outline-primary","m-r-10",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","ngClass"],[1,"assignment-table","table-responsive"],["id","resourceTable",1,"table","table-striped","table-no-bordered"],[2,"padding","0px"],["scope","row",1,"table-name"],["scope","row",1,"table-date"],["scope","row",1,"table-charge"],["scope","row",1,"table-btn"],[4,"ngFor","ngForOf"],["class","pagination pointer","style","float:right",4,"ngIf"],[3,"value"],["mat-button","","type","button","matSuffix","","mat-icon-button","",3,"click"],[1,"icofont","icofont-refresh"],[1,"table-name","span-ellipsis",3,"matTooltip"],[1,"table-date"],[1,"table-charge"],[1,"table-btn"],[1,"icofont","icofont-ui-edit","pointer",3,"click"],[1,"icofont","icofont-ui-delete","pointer",3,"click"],[1,"pagination","pointer",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"form",1),g.\u0275\u0275listener("submit",function(){return t.saveAssignment()}),g.\u0275\u0275elementStart(2,"div",2,3),g.\u0275\u0275elementStart(4,"mat-form-field",4),g.\u0275\u0275elementStart(5,"mat-select",5),g.\u0275\u0275template(6,ie,2,2,"mat-option",6),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,ae,2,1,"mat-error",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(8,"mat-form-field",8),g.\u0275\u0275elementStart(9,"mat-select",9),g.\u0275\u0275template(10,oe,2,2,"mat-option",6),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(11,le,2,1,"mat-error",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"mat-form-field",10),g.\u0275\u0275elementStart(13,"input",11),g.\u0275\u0275listener("dateChange",function(){return t.assignmentDateChange()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(14,de,2,1,"mat-error",7),g.\u0275\u0275element(15,"mat-datepicker-toggle",12),g.\u0275\u0275element(16,"mat-datepicker",13,14),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"mat-form-field",15),g.\u0275\u0275elementStart(19,"input",16),g.\u0275\u0275listener("dateChange",function(){return t.assignmentDateChange()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(20,pe,2,1,"mat-error",7),g.\u0275\u0275element(21,"mat-datepicker-toggle",12),g.\u0275\u0275element(22,"mat-datepicker",13,17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",18),g.\u0275\u0275element(25,"input",19),g.\u0275\u0275template(26,ue,2,1,"mat-error",7),g.\u0275\u0275template(27,ge,2,0,"button",20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"mat-form-field",18),g.\u0275\u0275element(29,"input",21),g.\u0275\u0275template(30,ve,2,1,"mat-error",7),g.\u0275\u0275template(31,Se,2,0,"button",20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"div",22),g.\u0275\u0275elementStart(33,"button",23),g.\u0275\u0275listener("click",function(){return t.clear()}),g.\u0275\u0275text(34,"Clear "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"button",24),g.\u0275\u0275text(36),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(37,"div",25),g.\u0275\u0275elementStart(38,"table",26),g.\u0275\u0275element(39,"caption",27),g.\u0275\u0275elementStart(40,"thead"),g.\u0275\u0275elementStart(41,"tr"),g.\u0275\u0275elementStart(42,"th",28),g.\u0275\u0275text(43,"Member"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"th",28),g.\u0275\u0275text(45,"Role"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"th",29),g.\u0275\u0275text(47,"Start Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"th",29),g.\u0275\u0275text(49,"End Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(50,"th",30),g.\u0275\u0275text(51,"Estimate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(52,"th",30),g.\u0275\u0275text(53,"Budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(54,"th",31),g.\u0275\u0275element(55,"th",31),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(56,"tbody"),g.\u0275\u0275template(57,be,17,8,"tr",32),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(58,xe,14,13,"ul",33),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(17),n=g.\u0275\u0275reference(23);g.\u0275\u0275advance(2),g.\u0275\u0275property("formGroup",t.assignmentForm),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngForOf",t.users),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("selectedUsersId"))),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",t.rolesList),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("selectedRoleId"))),g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",e)("min",t.activity.plannedStartDate)("max",t.dtService.getMinDate(t.activity.plannedEndDate,t.assignmentForm.controls.userPlannedEndDate.value)),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("userPlannedStartDate"))),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("min",t.dtService.getMaxDate(t.activity.plannedStartDate,t.assignmentForm.controls.userPlannedStartDate.value))("max",t.activity.plannedEndDate)("matDatepicker",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("userPlannedEndDate"))),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("estimatedCharge"))),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.assignmentForm.controls.userPlannedStartDate.valid&&t.assignmentForm.controls.userPlannedEndDate.valid),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("budgetedCharge"))),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.assignmentForm.controls.userPlannedStartDate.valid&&t.assignmentForm.controls.userPlannedEndDate.valid),g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!t.assignmentForm.valid)("ngClass",g.\u0275\u0275pureFunction1(26,Ie,!t.assignmentForm.valid)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.getSaveBtnLabel()," "),g.\u0275\u0275advance(21),g.\u0275\u0275property("ngForOf",t.pagedItems),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.pager.pages&&t.pager.pages.length)}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,o.FormGroupDirective,b.KE,y.gD,o.NgControlStatus,o.FormControlName,o.RequiredValidator,i.NgForOf,i.NgIf,C.Nt,o.DefaultValueAccessor,E.hl,E.nW,b.R9,E.Mq,i.NgClass,x.ey,b.TO,te.lW,ne.gM],styles:[".activity-assignment[_ngcontent-%COMP%]{overflow:hidden}.assignment-form[_ngcontent-%COMP%]{display:inline-block;padding:10px}.assignment-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:0 5px}.assignment-form[_ngcontent-%COMP%]   .users-list[_ngcontent-%COMP%]{width:65%}.assignment-form[_ngcontent-%COMP%]   .roles-list[_ngcontent-%COMP%]{width:30%;margin-left:2%}.assignment-form[_ngcontent-%COMP%]   .start-date[_ngcontent-%COMP%]{width:25%}.assignment-form[_ngcontent-%COMP%]   .end-date[_ngcontent-%COMP%]{width:25%;margin-left:2%}.assignment-form[_ngcontent-%COMP%]   .user-charge[_ngcontent-%COMP%]{width:20%;margin-left:2%}.assignment-btn[_ngcontent-%COMP%]{float:right}.assignment-table[_ngcontent-%COMP%]{text-align:center;padding-left:15px;padding-right:15px}.assignment-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}.pointer[_ngcontent-%COMP%]{cursor:pointer}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.table-name[_ngcontent-%COMP%]{width:20%!important}.table-date[_ngcontent-%COMP%]{width:15%!important}.table-charge[_ngcontent-%COMP%]{width:10%!important}.table-btn[_ngcontent-%COMP%]{width:5%!important}"]}),e})();function Me(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-tab",10),g.\u0275\u0275element(1,"app-activity-assignment",11),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275propertyInterpolate("label",e.assignmentTabLabel),g.\u0275\u0275property("disabled",!e.activity.activityId),g.\u0275\u0275advance(1),g.\u0275\u0275property("activity",e.activity)("assignmentForm",e.assignmentForm)("isEditMode",e.isEditMode)("isReadOnlyMode",e.isReadOnlyMode)}}let Pe=(()=>{class e{constructor(e,t,n,i,r){this.dialogRef=e,this.dialogData=t,this.fb=n,this.dtService=i,this.showErrorService=r,this.activity=new m.cS,this.assignmentTabLabel="Assignment",this.isEditMode="edit"===this.dialogData.mode,this.parentStartDate=this.dialogData.parentStartDate,this.parentEndDate=this.dialogData.parentEndDate,this.createDetailsForm(),this.createAssignmentForm(),this.departmentId=this.dialogData.departmentId,this.isEditMode?this.activity=this.dialogData.activity:this.insertNewActivityDetails()}ngOnInit(){this.isReadOnlyMode=1===this.activity.level}ngOnDestroy(){this.close()}insertNewActivityDetails(){const e=this.dialogData.activity;this.activity.activityNumber=e.hasChilds?e.activityNumber+"."+(e.subActivities.length+1):e.activityNumber+".1",this.activity.projectId=e.projectId,this.activity.level=e.level+1,this.activity.parentId=e.activityId,this.activity.subActivities=[],this.activity.assignments=[],this.activity.hasChilds=!1}createDetailsForm(){this.detailsForm=this.fb.group({name:new o.FormControl("",o.Validators.required),description:new o.FormControl("",o.Validators.required),selectedPhaseId:new o.FormControl("",o.Validators.required),selectedCategoryId:new o.FormControl("",o.Validators.required),plannedStartDate:new o.FormControl("",[o.Validators.required,De(this)]),plannedEndDate:new o.FormControl("",[o.Validators.required,je(this)]),estimatedCharge:new o.FormControl("",[u.d.numeric,o.Validators.min(0)]),plannedDuration:new o.FormControl("",[u.d.numeric,o.Validators.min(0)]),elapsedDuration:new o.FormControl("",[u.d.numeric,o.Validators.min(0)]),advancement:new o.FormControl("",[u.d.numeric,o.Validators.min(0),o.Validators.max(100)]),actualCost:new o.FormControl("",[u.d.numeric,o.Validators.min(0)])})}createAssignmentForm(){this.assignmentForm=this.fb.group({selectedUsersId:new o.FormControl("",o.Validators.required),selectedRoleId:new o.FormControl("",o.Validators.required),userPlannedStartDate:new o.FormControl("",[o.Validators.required,Oe(this)]),userPlannedEndDate:new o.FormControl("",[o.Validators.required,Fe(this)]),estimatedCharge:new o.FormControl("",[u.d.numeric,o.Validators.min(0)]),budgetedCharge:new o.FormControl("",[u.d.numeric,o.Validators.min(0)])})}refresh(){const e=8*this.dtService.getBusinessDays(this.activity.plannedStartDate,this.activity.plannedEndDate);this.assignmentForm.reset({selectedUsersId:null,selectedRoleId:null,userPlannedStartDate:this.activity.plannedStartDate,userPlannedEndDate:this.activity.plannedEndDate,estimatedCharge:e,budgetedCharge:e})}close(){this.dialogRef.close()}isCloseBtnDisabled(){return void 0!==this.detailsForm&&(this.detailsForm.dirty||this.detailsForm.touched)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(l.WI),g.\u0275\u0275directiveInject(o.FormBuilder),g.\u0275\u0275directiveInject(f.C),g.\u0275\u0275directiveInject(d.n4))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-editactivity"]],decls:15,vars:12,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["label","Details"],[3,"isEditMode","departmentId","activity","detailsForm","isReadOnlyMode","parentStartDate","parentEndDate","close","refresh"],[3,"label","disabled",4,"ngIf"],["label","KPI",3,"disabled"],[2,"padding","15px 0"],[3,"activity"],[3,"label","disabled"],[3,"activity","assignmentForm","isEditMode","isReadOnlyMode"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"span"),g.\u0275\u0275elementStart(5,"em",2),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(6,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",3),g.\u0275\u0275elementStart(8,"mat-tab-group"),g.\u0275\u0275elementStart(9,"mat-tab",4),g.\u0275\u0275elementStart(10,"app-activity-details",5),g.\u0275\u0275listener("close",function(){return t.close()})("refresh",function(){return t.refresh()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(11,Me,2,6,"mat-tab",6),g.\u0275\u0275elementStart(12,"mat-tab",7),g.\u0275\u0275elementStart(13,"div",8),g.\u0275\u0275element(14,"app-activity-kpi",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate2(" ",t.activity.name," [",t.activity.activityNumber,"] "),g.\u0275\u0275advance(7),g.\u0275\u0275property("isEditMode",t.isEditMode)("departmentId",t.departmentId)("activity",t.activity)("detailsForm",t.detailsForm)("isReadOnlyMode",t.isReadOnlyMode)("parentStartDate",t.parentStartDate)("parentEndDate",t.parentEndDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.activity.hasChilds&&1!=t.activity.level),g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",!t.activity.activityId),g.\u0275\u0275advance(2),g.\u0275\u0275property("activity",t.activity))},directives:[v.SP,v.uX,J,i.NgIf,Y,we],styles:[".mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{padding:0;margin:0}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-weight:bold}"]}),e})();function De(e){return t=>{const n=t.value,i=e.activity;return i.hasChilds&&i.subActivities.some(t=>e.dtService.isBefore(t.plannedStartDate,n))?{childStartDate:!0}:i.assignments&&i.assignments.some(t=>e.dtService.isBefore(t.userPlannedStartDate,n))?{assingnmentStartDate:!0}:null}}function je(e){return t=>{const n=t.value,i=e.activity;return e.dtService.isBefore(e.parentEndDate,n)?{parentEndDate:!0}:i.hasChilds&&i.subActivities.some(t=>e.dtService.isAfter(t.plannedEndDate,n)&&!e.dtService.areEqual(t.plannedEndDate,n))?{childEndDate:!0}:i.assignments&&i.assignments.some(t=>e.dtService.isAfter(t.userPlannedEndDate,n)&&!e.dtService.areEqual(t.userPlannedEndDate,n))?{assingnmentEndDate:!0}:null}}function Oe(e){return t=>e.dtService.isBefore(t.value,e.activity.plannedStartDate)?{activityStartDate:!0}:null}function Fe(e){return t=>e.dtService.isAfter(t.value,e.activity.plannedEndDate)?{activityEndDate:!0}:null}var ke=n(96523),Ae=n(76627),_e=n(62758);let Ve=(()=>{class e{constructor(e,t){this.dtService=e,this.projectService=t}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(p.Y4))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-details"]],inputs:{isProject:"isProject",project:"project"},decls:67,vars:15,consts:[[1,"row"],[1,"col-sm-6"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"],[1,"technologies"],[1,"label","label-pink"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"table",3),g.\u0275\u0275element(4,"caption",4),g.\u0275\u0275elementStart(5,"tbody"),g.\u0275\u0275elementStart(6,"tr"),g.\u0275\u0275elementStart(7,"th",5),g.\u0275\u0275text(8,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",6),g.\u0275\u0275text(10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"tr"),g.\u0275\u0275elementStart(12,"th",5),g.\u0275\u0275text(13,"Customer"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"td",6),g.\u0275\u0275text(15),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"tr"),g.\u0275\u0275elementStart(17,"th",5),g.\u0275\u0275text(18,"Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"td",7),g.\u0275\u0275text(20),g.\u0275\u0275pipe(21,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"th",5),g.\u0275\u0275text(23,"End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"td",7),g.\u0275\u0275text(25),g.\u0275\u0275pipe(26,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"tr"),g.\u0275\u0275elementStart(28,"th",5),g.\u0275\u0275text(29,"Technology"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"td",6),g.\u0275\u0275elementStart(31,"div",8),g.\u0275\u0275elementStart(32,"label",9),g.\u0275\u0275text(33),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"div",1),g.\u0275\u0275elementStart(35,"div",2),g.\u0275\u0275elementStart(36,"table",3),g.\u0275\u0275element(37,"caption",4),g.\u0275\u0275elementStart(38,"tbody"),g.\u0275\u0275elementStart(39,"tr"),g.\u0275\u0275elementStart(40,"th",5),g.\u0275\u0275text(41,"Company"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(42,"td",6),g.\u0275\u0275text(43),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"tr"),g.\u0275\u0275elementStart(45,"th",5),g.\u0275\u0275text(46,"Contact"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"td",7),g.\u0275\u0275text(48),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(49,"th",5),g.\u0275\u0275text(50,"Place"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"td",7),g.\u0275\u0275text(52),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"tr"),g.\u0275\u0275elementStart(54,"th",5),g.\u0275\u0275text(55,"Category"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(56,"td",7),g.\u0275\u0275text(57),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(58,"th",5),g.\u0275\u0275text(59,"Cost (MD)"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(60,"td",7),g.\u0275\u0275text(61),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(62,"tr"),g.\u0275\u0275elementStart(63,"th",5),g.\u0275\u0275text(64,"Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(65,"td",6),g.\u0275\u0275text(66),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate(t.project.activityName),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.project.customerName),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(21,11,t.project.plannedStartDate)),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(26,13,t.project.plannedEndDate)),g.\u0275\u0275advance(8),g.\u0275\u0275textInterpolate(t.project.technologieName),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate(t.project.companyName),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.project.customerContact),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate(t.project.customerPlace),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.project.categoryName),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate(t.project.cost),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.project.reference))},pipes:[_e.M],styles:[".td-description[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}.technologies[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.technologies[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{border-radius:9px;font-size:85%;padding:4px 8px;margin-right:4px}.technologies[_ngcontent-%COMP%]   .label-pink[_ngcontent-%COMP%]{background:#e83e8c}"]}),e})();var Ne=n(46782),Re=n(15257),Te=n(36144),Be=n(52218),ze=n(72172);const qe=["techSelect"],Le=["pifDetailsForm"],Qe=["clientSelect"];function $e(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Ue(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function He(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Ge(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function We(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Je(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",36),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Ye(e,t){1&e&&(g.\u0275\u0275elementStart(0,"button",37),g.\u0275\u0275text(1,"Save"),g.\u0275\u0275elementEnd())}function Ke(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"button",38),g.\u0275\u0275text(1,"Create"),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("disabled",e.mutliClickDisable)}}function Xe(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",39),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onCancel()}),g.\u0275\u0275text(1,"Cancel"),g.\u0275\u0275elementEnd()}}function Ze(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",39),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().loadProjects()}),g.\u0275\u0275text(1,"Cancel"),g.\u0275\u0275elementEnd()}}let et=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.notificationService=t,this._router=n,this.dateTimeService=i,this.projectEvent=new g.EventEmitter,this.statusIdentifiers=[],this.mutliClickDisable=!1,this.clientFilterCtrl=new o.FormControl,this.technologyFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ,this.filteredClients=new c.tq(1),this.filteredTechnologies=new c.tq(1)}toggleEditDetails(){this.projectService.toggleEditDetails.emit()}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.isQA=this.currentUser.activityId===h.RS.Quality,0!==this.pifId?this.projectService.getProjectDetails(this.pifId,this.projectId).subscribe(e=>{null!=e&&(this.project=Object.assign(new m.IK,e[0]),this.getActivities(),this.getCompanies(),this.getCategories(),this.getClients(),this.getTechnologies(),this.getStatus())}):(this.getActivities(),this.getCompanies(),this.getCategories(),this.getClients(),this.getTechnologies(),this.getStatus()),this.clientFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterClients()}),this.technologyFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterTechnologies()})}ngOnDestroy(){this.activitiesIdentifiers=[],this.companiesIdentifiers=[],this.clientsIdentifiers=[],this.categoriesIdentifiers=[],this.technologiesIdentifiers=[]}ngAfterViewInit(){this.setInitialValue()}getActivities(){this.projectService.getActivities().subscribe(e=>{null!=e&&(this.activitiesIdentifiers=e,this.onChangeActivity(this.project.activityId))})}getCompanies(){this.projectService.getCompanies().subscribe(e=>{null!=e&&(this.companiesIdentifiers=e,this.onChangeCompany(this.project.companyId))})}getCategories(){this.projectService.getCategories().subscribe(e=>{null!=e&&(this.categoriesIdentifiers=e,this.onChangeCategory(this.project.categoryId))})}getClients(){this.projectService.getClients().subscribe(e=>{null!=e&&(this.clientsIdentifiers=e,this.onChangeCustomer(this.project.customerId),this.filteredClients.next(this.clientsIdentifiers.slice()))})}getTechnologies(){this.projectService.getTechnologies().subscribe(e=>{null!=e&&(this.technologiesIdentifiers=e,this.onChangeTechnologie(this.project.technologieId),this.filteredTechnologies.next(this.technologiesIdentifiers.slice()))}),this.groupsSelect.value=this.project.technologieId}getStatus(){this.projectService.getProjectStates().subscribe(e=>{null!=e&&(this.statusIdentifiers=e,null==this.project.statusId||this.onChangeStatus(this.project.statusId),this.isProject?this.statusIdentifiers=this.statusIdentifiers.filter(e=>e.id!==m.kJ.Planned):this.project.statusId=m.kJ.Planned)})}save(e,t){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3),this.validDetails()&&(this.project.cost=+this.project.cost.toString().replace(",","."),this.projectService.saveProjectDetails(this.project).subscribe(e=>{null!=e&&(0!==e?0===this.project.projectId?(this.project.pifId=e,this.project.categoryName=this.selectedCategoryIdentifier.description,this.project.activityName=this.selectedActivityIdentifier.description,this.project.companyName=this.selectedCompanyIdentifier.description,this.project.customerName=this.selectedCustomerIdentifier.description,this.notificationService.success("The project [ "+this.project.name+" ] was saved successfully."),this.projectEvent.emit(this.project),this._router.navigate(["/project-management/project/edit/"+e+"/0"])):(this.project.categoryName=this.selectedCategoryIdentifier.description,this.project.activityName=this.selectedActivityIdentifier.description,this.project.companyName=this.selectedCompanyIdentifier.description,this.project.customerName=this.selectedCustomerIdentifier.description,this.notificationService.success("The project [ "+this.project.name+" ] was saved successfully."),this.projectEvent.emit(this.project),this.projectService.toggleEditDetails.emit()):this.notificationService.danger("Save project failed"))}))}validDetails(){if(this.detailsForm.valid){if(this.addEvent())return!0;this.notificationService.danger("Please check dates")}else this.notificationService.danger("Please fill all required fields");return!1}onCancel(){this.projectService.toggleEditDetails.emit()}onChangeCategory(e){this.selectedCategoryIdentifier=this.categoriesIdentifiers.find(t=>t.id===e)}onChangeActivity(e){this.selectedActivityIdentifier=this.activitiesIdentifiers.find(t=>t.id===e)}onChangeCompany(e){this.selectedCompanyIdentifier=this.companiesIdentifiers.find(t=>t.id===e)}onChangeCustomer(e){this.selectedCustomerIdentifier=this.clientsIdentifiers.find(t=>t.id===e)}onChangeTechnologie(e){this.selectedTechnologyIdentifier=this.technologiesIdentifiers.find(t=>t.id===e)}onChangeStatus(e){this.selectedStatusIdentifier=this.statusIdentifiers.find(t=>t.id===e),this.isProject&&(this.project.status=this.selectedStatusIdentifier.description)}addEvent(){return this.project.plannedEndDate&&(this.project.plannedEndDate=new Date(this.project.plannedEndDate)),this.project.plannedStartDate&&(this.project.plannedStartDate=new Date(this.project.plannedStartDate)),this.project.realEndDate&&(this.project.realEndDate=new Date(this.project.realEndDate)),this.project.realStartDate&&(this.project.realStartDate=new Date(this.project.realStartDate)),!(this.project.plannedStartDate&&this.project.plannedEndDate||this.project.realStartDate&&this.project.realEndDate)||!(this.isNewPif&&this.project.plannedStartDate>this.project.plannedEndDate||!this.isNewPif&&(this.project.realStartDate>this.project.realEndDate||this.project.plannedStartDate>this.project.plannedEndDate))||(this.notificationService.danger("End Date must be greater than Start Date"),!1)}numberOnly(e){const t=e.which?e.which:e.keyCode;return!(t>31&&(t<44||t>57)||45===t||47===t)}dateOnly(e){return this.dateTimeService.dateOnly(e)}loadProjects(){this._router.navigate(["/project-management/project/list"])}setInitialValue(){this.filteredClients.pipe((0,Re.q)(1),(0,Ne.R)(this._onDestroy)),this.filteredTechnologies.pipe((0,Re.q)(1),(0,Ne.R)(this._onDestroy))}filterClients(){if(!this.clientsIdentifiers)return;let e=this.clientFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredClients.next(this.clientsIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredClients.next(this.clientsIdentifiers.slice())}filterTechnologies(){if(!this.technologiesIdentifiers)return;let e=this.technologyFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredTechnologies.next(this.technologiesIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredTechnologies.next(this.technologiesIdentifiers.slice())}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(d.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-details"]],viewQuery:function(e,t){if(1&e&&(g.\u0275\u0275viewQuery(qe,7),g.\u0275\u0275viewQuery(Le,7),g.\u0275\u0275viewQuery(Qe,7)),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.groupsSelect=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.detailsForm=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.clientSelect=e.first)}},inputs:{projectId:"projectId",pifId:"pifId",project:"project",isNewPif:"isNewPif",isProject:"isProject"},outputs:{projectEvent:"projectEvent"},decls:68,vars:44,consts:[["id","pifDetailsForm",3,"submit"],["pifDetailsForm","ngForm"],[1,"row"],[1,"col-sm-6"],["placeholder","Name","matInput","","name","name","required","","maxlength","100","appTextValidator","",3,"ngModel","ngModelChange"],[1,"col-sm-3"],["placeholder","Abreviation","matInput","","name","abreviation","required","","maxlength","20","appTextValidator","",3,"ngModel","ngModelChange"],["placeholder","Status","name","status","required","",3,"ngModel","disabled","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-12"],["matInput","","placeholder","Description","name","description","required","",3,"ngModel","ngModelChange"],["placeholder","Activity","name","activity","required","",3,"ngModel","ngModelChange","selectionChange"],["placeholder","Company","name","company","required","",3,"ngModel","ngModelChange","selectionChange"],["placeholder","Customer","name","customer","required","",3,"ngModel","ngModelChange","selectionChange"],["clientSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],["placeholder","Contact","matInput","","name","customerContact","maxlength","100","appTextValidator","","required","",3,"ngModel","ngModelChange"],["placeholder","Place","matInput","","name","customerPlace","maxlength","100","appTextValidator","","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Start","name","plannedStartDate","required","",3,"matDatepicker","ngModel","keypress","ngModelChange","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End","name","plannedEndDate","required","",3,"matDatepicker","ngModel","keypress","ngModelChange","dateChange"],["PickerEndDay",""],["placeholder","Category","name","category","required","",3,"ngModel","ngModelChange","selectionChange"],["selectcategory",""],["color","red",1,"col-sm-3"],["placeholder","Cost (MD)","matInput","","name","cost","required","","appNumberValidator","",3,"ngModel","inputValue","ngModelChange","keypress"],["placeholder","Technology","name","technologies","required","",3,"ngModel","ngModelChange","selectionChange"],["techSelect",""],["placeholder","Reference","matInput","","name","reference",3,"ngModel","disabled","ngModelChange"],[1,"text-center"],["type","submit","class","btn btn-md btn-primary ripple light m-r-20",4,"ngIf"],["type","submit","class","btn btn-md btn-primary ripple light m-r-20",3,"disabled",4,"ngIf"],["type","reset","class","btn btn-md btn-default ripple",3,"click",4,"ngIf"],[3,"value"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled"],["type","reset",1,"btn","btn-md","btn-default","ripple",3,"click"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"form",0,1),g.\u0275\u0275listener("submit",function(){return t.save()}),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"mat-form-field",3),g.\u0275\u0275elementStart(4,"input",4),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.name=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"mat-form-field",5),g.\u0275\u0275elementStart(6,"input",6),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.abreviation=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"mat-form-field",5),g.\u0275\u0275elementStart(8,"mat-select",7),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.statusId=e})("selectionChange",function(e){return t.onChangeStatus(e.value)}),g.\u0275\u0275template(9,$e,2,2,"mat-option",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(10,"div",2),g.\u0275\u0275elementStart(11,"mat-form-field",9),g.\u0275\u0275elementStart(12,"textarea",10),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.description=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"div",2),g.\u0275\u0275elementStart(14,"mat-form-field",3),g.\u0275\u0275elementStart(15,"mat-select",11),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.activityId=e})("selectionChange",function(e){return t.onChangeActivity(e.value)}),g.\u0275\u0275template(16,Ue,2,2,"mat-option",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"mat-form-field",3),g.\u0275\u0275elementStart(18,"mat-select",12),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.companyId=e})("selectionChange",function(e){return t.onChangeCompany(e.value)}),g.\u0275\u0275template(19,He,2,2,"mat-option",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(20,"div",2),g.\u0275\u0275elementStart(21,"mat-form-field",3),g.\u0275\u0275elementStart(22,"mat-select",13,14),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerId=e})("selectionChange",function(e){return t.onChangeCustomer(e.value)}),g.\u0275\u0275elementStart(24,"mat-option"),g.\u0275\u0275elementStart(25,"ngx-mat-select-search",15),g.\u0275\u0275elementStart(26,"mat-icon",16),g.\u0275\u0275text(27,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(28,Ge,2,2,"mat-option",8),g.\u0275\u0275pipe(29,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"mat-form-field",5),g.\u0275\u0275elementStart(31,"input",17),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerContact=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"mat-form-field",5),g.\u0275\u0275elementStart(33,"input",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerPlace=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"div",2),g.\u0275\u0275elementStart(35,"mat-form-field",5),g.\u0275\u0275elementStart(36,"input",19),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.project.plannedStartDate=e})("dateChange",function(){return t.addEvent()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(37,"mat-datepicker-toggle",20),g.\u0275\u0275element(38,"mat-datepicker",21,22),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"mat-form-field",5),g.\u0275\u0275elementStart(41,"input",23),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.project.plannedEndDate=e})("dateChange",function(){return t.addEvent()}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(42,"mat-datepicker-toggle",20),g.\u0275\u0275element(43,"mat-datepicker",21,24),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"mat-form-field",5),g.\u0275\u0275elementStart(46,"mat-select",25,26),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.categoryId=e})("selectionChange",function(e){return t.onChangeCategory(e.value)}),g.\u0275\u0275template(48,We,2,2,"mat-option",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(49,"mat-form-field",27),g.\u0275\u0275elementStart(50,"input",28),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.cost=e})("keypress",function(e){return t.numberOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"div",2),g.\u0275\u0275elementStart(52,"mat-form-field",3),g.\u0275\u0275elementStart(53,"mat-select",29,30),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.technologieId=e})("selectionChange",function(e){return t.onChangeTechnologie(e.value)}),g.\u0275\u0275elementStart(55,"mat-option"),g.\u0275\u0275elementStart(56,"ngx-mat-select-search",15),g.\u0275\u0275elementStart(57,"mat-icon",16),g.\u0275\u0275text(58,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(59,Je,2,2,"mat-option",8),g.\u0275\u0275pipe(60,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(61,"mat-form-field",3),g.\u0275\u0275elementStart(62,"input",31),g.\u0275\u0275listener("ngModelChange",function(e){return t.project.reference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(63,"div",32),g.\u0275\u0275template(64,Ye,2,0,"button",33),g.\u0275\u0275template(65,Ke,2,1,"button",34),g.\u0275\u0275template(66,Xe,2,0,"button",35),g.\u0275\u0275template(67,Ze,2,0,"button",35),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(39),n=g.\u0275\u0275reference(44);g.\u0275\u0275advance(4),g.\u0275\u0275property("ngModel",t.project.name),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.project.abreviation),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.project.statusId)("disabled",!t.isProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.statusIdentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.description),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.activityId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.activitiesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.project.companyId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.companiesIdentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.customerId),g.\u0275\u0275advance(3),g.\u0275\u0275property("formControl",t.clientFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(29,40,t.filteredClients)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.customerContact),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.project.customerPlace),g.\u0275\u0275advance(3),g.\u0275\u0275property("matDatepicker",e)("ngModel",t.project.plannedStartDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("matDatepicker",n)("ngModel",t.project.plannedEndDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.categoryId),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngForOf",t.categoriesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.project.cost)("inputValue",t.project.cost),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.technologieId),g.\u0275\u0275advance(3),g.\u0275\u0275property("formControl",t.technologyFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(60,42,t.filteredTechnologies)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.project.reference)("disabled",!t.isQA),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!t.isNewPif),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isNewPif),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.isNewPif),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isNewPif)}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,C.Nt,o.DefaultValueAccessor,o.RequiredValidator,o.MaxLengthValidator,Te.s,o.NgControlStatus,o.NgModel,y.gD,i.NgForOf,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,E.hl,E.nW,b.R9,E.Mq,ze.z,i.NgIf],pipes:[i.AsyncPipe],styles:["form[_ngcontent-%COMP%]{padding:10px 20px}"]}),e})();var tt=n(97832);const nt=["stepper"];function it(e,t){1&e&&g.\u0275\u0275text(0,"Project Manager")}function rt(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-icon"),g.\u0275\u0275text(1,"check"),g.\u0275\u0275elementEnd())}function at(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",29),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.Id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.Name," ")}}const ot=function(e){return{"btn-disabled":e}};function st(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"button",30),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().sendForValidation()}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",e.isSendForValidationBtnDisabled())("ngClass",g.\u0275\u0275pureFunction1(3,ot,e.isSendForValidationBtnDisabled())),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.pmActionName)}}function lt(e,t){1&e&&g.\u0275\u0275text(0,"Department Head")}function ct(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",29),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.description),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function dt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"button",30),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().sendToSQA()}),g.\u0275\u0275text(2,"Send to SQA"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",e.isSendToSQABtnDisabled())("ngClass",g.\u0275\u0275pureFunction1(2,ot,e.isSendToSQABtnDisabled()))}}function mt(e,t){1&e&&g.\u0275\u0275text(0,"SQA")}function pt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",31),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().generateSQAReference()}),g.\u0275\u0275element(1,"em",32),g.\u0275\u0275text(2,"Generate "),g.\u0275\u0275elementEnd()}}function ht(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",29),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.description),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ut(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"button",30),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().validate()}),g.\u0275\u0275text(2,"Validate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",e.isValidateBtnDisabled()||e.mutliClickDisable)("ngClass",g.\u0275\u0275pureFunction1(2,ot,e.isValidateBtnDisabled()))}}let gt=(()=>{class e{constructor(e,t,n){this.dialogRef=t,this.dialogData=n,this.canEditProject=!0,this.observationStatusesIdentifiers=[],this.pifValidationDetails=new m.C2,this.isLinear=!1,this.conditionDepartHead=!1,this.conditionSQA=!1,this.conditionPM=!1,this.mutliClickDisable=!1,this.pmActionName="Send for validation",this.coreDataService=e.get(d.YY),this.mailerService=e.get(d.YT),this.notificationService=e.get(d.gq),this.projectService=e.get(p.Y4),this.dtService=e.get(d.Cv),this._formBuilder=e.get(o.FormBuilder),this.pifId=this.dialogData.pifId}ngAfterViewInit(){this.getPifValidationDetails()}ngOnInit(){this.getPifDetails(),this.getDepartmentHeads(),this.getObservationStatuses(),this.user=JSON.parse(localStorage.getItem("currentUser")),this.projectManagerFormGroup=this._formBuilder.group({name:["",o.Validators.required],date:[this.dtService.today(),o.Validators.required],departmentHead:[null,o.Validators.required]}),this.departmentHeadFormGroup=this._formBuilder.group({comment:[""],date:[this.dtService.today(),o.Validators.required],visa:["",o.Validators.required]}),this.SQAFormGroup=this._formBuilder.group({comment:[""],date:[this.dtService.today(),o.Validators.required],reference:["",o.Validators.required],visa:["",o.Validators.required]}),this.projectManagerFormGroup.controls.name.disable()}rebuildStepperForms(){this.projectManagerFormGroup.reset({name:this.pifValidationDetails.projectMngName,date:this.pifValidationDetails.projectMngCommentDate,departmentHead:this.pifValidationDetails.departHeadId}),this.departmentHeadFormGroup.reset({comment:this.pifValidationDetails.departHeadComment,date:this.pifValidationDetails.departHeadCommentDate,visa:this.pifValidationDetails.departHeadVisa}),this.SQAFormGroup.reset({comment:this.pifValidationDetails.SQAComment,date:this.pifValidationDetails.SQACommentDate,reference:this.pifValidationDetails.projectReference,visa:this.pifValidationDetails.SQAVisa})}getObservationStatuses(){this.projectService.getObservationStatuses().subscribe(e=>{null!=e&&(this.observationStatusesIdentifiers=e)})}disableStepperForms(){this.disableProjectManagerForm(),this.disabledDepartmentHeadForm(),this.disabledSQAForm()}getDepartmentHeads(){this.departmentHeadList=[],this.projectService.getDepartmentHeads().subscribe(e=>{e.forEach(e=>{this.departmentHeadList.push({Id:e.USER_ID,Name:e.USER_FIRSTNAME+" "+e.USER_LASTNAME})})})}getPifDetails(){this.projectService.getProjectDetails(this.pifId,0).subscribe(e=>{this.pif=Object.assign(new m.IK,e[0])})}getPifValidationDetails(){this.projectService.getPifValidationDetails(this.pifId).subscribe(e=>{this.pifValidationDetails=Object.assign(new m.C2,e[0]),this.rebuildStepperForms(),this.disableStepperForms(),setTimeout(()=>{this.selectStep(this.pifValidationDetails)},400),this.pifValidationDetails.projectMngVisa===m.CB.Valid&&(this.pmActionName="Resend For Validation")})}generateSQAReference(){this.projectService.generateSQAReference(this.pifId.toString()).subscribe(e=>{this.pifValidationDetails.projectReference=e.value,this.projectService.pifIsApproved.emit(0),this.notificationService.success("Generate reference succeeded.")},e=>{this.notificationService.danger("Generate reference failed.")})}sendForValidation(){this.pifValidationDetails.projectMngVisa===m.CB.Valid?this.coreDataService.getUser(this.user.hierarchicalHead1).subscribe(e=>{this.mailerService.projectValidation(this.pif,e[0].email),this.disableProjectManagerForm(),this.close()}):(this.pifValidationDetails.projectMngVisa=m.ZW.Valide,this.pifValidationDetails.projectMngCommentDate=this.projectManagerFormGroup.controls.date.value,this.pifValidationDetails.departHeadId=this.projectManagerFormGroup.controls.departmentHead.value,this.pifValidationDetails.statusIdP=m.Es.Valid,this.projectService.updatePifValidDetailsPM(this.pifValidationDetails).subscribe(e=>{this.notificationService.success("Sent for validation performed"),this.disableProjectManagerForm(),this.close(),this.coreDataService.getUser(this.user.hierarchicalHead1).subscribe(e=>{this.mailerService.projectValidation(this.pif,e[0].email)})}))}sendToSQA(){this.disableValidationDepartmentHead()?(this.pifValidationDetails.departHeadComment=this.departmentHeadFormGroup.controls.comment.value,this.pifValidationDetails.departHeadCommentDate=this.departmentHeadFormGroup.controls.date.value,this.pifValidationDetails.departHeadVisa=this.departmentHeadFormGroup.controls.visa.value,this.pifValidationDetails.statusIdD=this.getPifStatusId(this.pifValidationDetails.departHeadVisa),this.pifValidationDetails.departHeadVisa=this.convertPifVisaFromEnglishToFrench(this.pifValidationDetails.departHeadVisa),this.projectService.updatePifValidDetailsDH(this.pifValidationDetails).subscribe(e=>{(-1!==this.pifValidationDetails.departHeadVisa.indexOf(m.CB.Valid)||-1!==this.pifValidationDetails.departHeadVisa.indexOf(m.CB.Invalid))&&this.notificationService.success("Sent for Validation performed"),this.disabledDepartmentHeadForm(),this.close()},e=>{this.notificationService.danger("Sent for Validation failed")})):this.notificationService.danger("You can not change visa to In progress")}validate(){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3),this.disableValidationSQA()?(this.pifValidationDetails.SQAComment=this.SQAFormGroup.controls.comment.value,this.pifValidationDetails.SQACommentDate=this.SQAFormGroup.controls.date.value,this.pifValidationDetails.projectReference=this.SQAFormGroup.controls.reference.value,this.pifValidationDetails.SQAVisa=this.SQAFormGroup.controls.visa.value,this.pifValidationDetails.SQAVisa=this.convertPifVisaFromEnglishToFrench(this.pifValidationDetails.SQAVisa),this.pifValidationDetails.SQAId=+this.user.userId,this.projectService.updatePifSQACreateProject(this.pifValidationDetails).subscribe(e=>{this.disabledSQAForm(),(-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.Valid)||-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.Invalid))&&this.notificationService.success("Validation performed"),this.projectService.pifIsApproved.emit(e),this.close(),this.mailerService.projectValidated(this.pif,this.pifValidationDetails.SQAVisa)},e=>{this.notificationService.danger("Validation failed")})):this.notificationService.danger("You can not change visa to In progress")}convertPifVisaFromEnglishToFrench(e){switch(e){case m.CB.InProgress:e=m.ZW.EnCours;break;case m.CB.Valid:e=m.ZW.Valide;break;case m.CB.Invalid:e=m.ZW.Invalide}return e}disableValidationSQA(){return-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.InProgress)||(-1===this.pifValidationDetails.SQAVisa.indexOf(m.CB.Valid)||-1===this.pifValidationDetails.SQAVisa.indexOf(m.CB.Invalid)||-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.InProgress))&&-1===this.SQAFormGroup.controls.visa.value.indexOf(m.CB.InProgress)}disableValidationDepartmentHead(){return-1!==this.pifValidationDetails.departHeadVisa.indexOf(m.CB.InProgress)||(-1===this.pifValidationDetails.departHeadVisa.indexOf(m.CB.Valid)||-1===this.pifValidationDetails.departHeadVisa.indexOf(m.CB.Invalid))&&-1===this.departmentHeadFormGroup.controls.visa.value.indexOf(m.CB.InProgress)}disableProjectManagerForm(){(this.isManageProjectStepCompleted()||this.isNotProjectManager())&&(this.projectManagerFormGroup.controls.name.disable(),this.projectManagerFormGroup.controls.date.disable(),this.projectManagerFormGroup.controls.departmentHead.disable())}disabledDepartmentHeadForm(){(this.isNotQualityManagerOrDH()||!this.isManageProjectStepCompleted()||-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.Valid))&&(this.departmentHeadFormGroup.controls.comment.disable(),this.departmentHeadFormGroup.controls.date.disable(),this.departmentHeadFormGroup.controls.visa.disable())}disabledSQAForm(){(!this.isManageProjectStepCompleted()||this.isNotQualityManager()||-1!==this.pifValidationDetails.SQAVisa.indexOf(m.CB.Valid))&&(this.SQAFormGroup.controls.comment.disable(),this.SQAFormGroup.controls.date.disable(),this.SQAFormGroup.controls.reference.disable(),this.SQAFormGroup.controls.visa.disable())}isSendForValidationBtnDisabled(){return!this.projectManagerFormGroup.valid&&this.isNotProjectManager()||this.pifValidationDetails.SQAVisa===m.CB.Valid}isSendToSQABtnDisabled(){return!this.departmentHeadFormGroup.valid}isGenerateBtnVisible(){return this.isManageProjectStepCompleted()&&this.isQualityManager()&&-1===this.pifValidationDetails.SQAVisa.indexOf(m.CB.Valid)}isValidateBtnDisabled(){return!this.SQAFormGroup.valid}isManageProjectStepCompleted(){return this.pifValidationDetails&&this.pifValidationDetails.projectMngVisa===m.CB.Valid}isDepartmentHeadStepCompleted(){return this.pifValidationDetails&&(this.pifValidationDetails.departHeadVisa===m.CB.Valid||this.pifValidationDetails.departHeadVisa===m.CB.Invalid)}isSQAStepCompleted(){return this.pifValidationDetails&&(this.pifValidationDetails.SQAVisa===m.CB.Valid||this.pifValidationDetails.SQAVisa===m.CB.Invalid)}isNotProjectManager(){return this.pifValidationDetails.projectMngId!==+this.user.userId}isNotQualityManagerOrDH(){return this.user.activityId!==h.RS.Quality&&this.user.qualification!==h._W.DepartmentHead}isNotQualityManager(){return this.user.activityId!==h.RS.Quality}isQualityManager(){return this.user.activityId===h.RS.Quality}close(){this.dialogRef.close(),this.projectService.reloadDecisions.next()}getPifStatusId(e){return this.observationStatusesIdentifiers.find(t=>t.description===e).id}selectStep(e){e.projectMngVisa===m.CB.Valid&&(this.stepper.selectedIndex=1),e.departHeadVisa===m.CB.Valid&&(this.stepper.selectedIndex=2)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(g.Injector),g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-decision"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(nt,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.stepper=e.first)}},inputs:{pifId:"pifId"},decls:57,vars:25,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],[3,"linear"],["stepper",""],[3,"stepControl","editable"],[3,"formGroup"],["matStepLabel",""],["matStepperIcon","edit"],[1,"col-sm-12"],["matInput","","placeholder","Project Manager","formControlName","name"],[1,"col-sm-6"],["matInput","","placeholder","Date","formControlName","date","required","",3,"matDatepicker"],["matSuffix","",3,"for"],[3,"startView"],["PickerProjectManagerDate",""],["placeholder","Department Head","formControlName","departmentHead","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"stepControl"],["matInput","","placeholder","Comment","formControlName","comment","maxlength","255"],[1,"col-md-12"],["PickerDepartmentHeadDate",""],["placeholder","Visa","formControlName","visa","required",""],["matInput","","placeholder","Reference","formControlName","reference","required","",3,"ngModel","ngModelChange"],["class","btn btn-md btn-primary ripple light text-center","type","button","mat-button","","matSuffix","",3,"click",4,"ngIf"],["PickerSQADate",""],[3,"value"],["type","submit",1,"btn","btn-primary","m-l-15","f-right",3,"disabled","ngClass","click"],["type","button","mat-button","","matSuffix","",1,"btn","btn-md","btn-primary","ripple","light","text-center",3,"click"],[1,"fa","fa-cog",2,"font-size","medium"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3," Edit Manager Decision "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"span"),g.\u0275\u0275elementStart(5,"em",2),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(6,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",3),g.\u0275\u0275elementStart(8,"div",4),g.\u0275\u0275elementStart(9,"mat-horizontal-stepper",5,6),g.\u0275\u0275elementStart(11,"mat-step",7),g.\u0275\u0275elementStart(12,"form",8),g.\u0275\u0275template(13,it,1,0,"ng-template",9),g.\u0275\u0275template(14,rt,2,0,"ng-template",10),g.\u0275\u0275elementStart(15,"mat-form-field",11),g.\u0275\u0275element(16,"input",12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"mat-form-field",13),g.\u0275\u0275element(18,"input",14),g.\u0275\u0275element(19,"mat-datepicker-toggle",15),g.\u0275\u0275element(20,"mat-datepicker",16,17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"mat-form-field",11),g.\u0275\u0275elementStart(23,"mat-select",18),g.\u0275\u0275template(24,at,2,2,"mat-option",19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(25,st,3,5,"div",20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"mat-step",21),g.\u0275\u0275elementStart(27,"form",8),g.\u0275\u0275template(28,lt,1,0,"ng-template",9),g.\u0275\u0275elementStart(29,"mat-form-field",11),g.\u0275\u0275element(30,"input",22),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"mat-form-field",23),g.\u0275\u0275element(32,"input",14),g.\u0275\u0275element(33,"mat-datepicker-toggle",15),g.\u0275\u0275element(34,"mat-datepicker",16,24),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-form-field",11),g.\u0275\u0275elementStart(37,"mat-select",25),g.\u0275\u0275template(38,ct,2,2,"mat-option",19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(39,dt,3,4,"div",20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"mat-step",21),g.\u0275\u0275elementStart(41,"form",8),g.\u0275\u0275template(42,mt,1,0,"ng-template",9),g.\u0275\u0275elementStart(43,"mat-form-field",11),g.\u0275\u0275element(44,"input",22),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"mat-form-field",11),g.\u0275\u0275elementStart(46,"input",26),g.\u0275\u0275listener("ngModelChange",function(e){return t.pifValidationDetails.projectReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(47,pt,3,0,"button",27),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"mat-form-field",11),g.\u0275\u0275element(49,"input",14),g.\u0275\u0275element(50,"mat-datepicker-toggle",15),g.\u0275\u0275element(51,"mat-datepicker",16,28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"mat-form-field",11),g.\u0275\u0275elementStart(54,"mat-select",25),g.\u0275\u0275template(55,ht,2,2,"mat-option",19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(56,ut,3,4,"div",20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(21),n=g.\u0275\u0275reference(35),i=g.\u0275\u0275reference(52);g.\u0275\u0275advance(9),g.\u0275\u0275property("linear",t.isLinear),g.\u0275\u0275advance(2),g.\u0275\u0275property("stepControl",t.projectManagerFormGroup)("editable",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("formGroup",t.projectManagerFormGroup),g.\u0275\u0275advance(6),g.\u0275\u0275property("matDatepicker",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngForOf",t.departmentHeadList),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.canEditProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("stepControl",t.departmentHeadFormGroup),g.\u0275\u0275advance(1),g.\u0275\u0275property("formGroup",t.departmentHeadFormGroup),g.\u0275\u0275advance(5),g.\u0275\u0275property("matDatepicker",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngForOf",t.observationStatusesIdentifiers),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.canEditProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("stepControl",t.SQAFormGroup),g.\u0275\u0275advance(1),g.\u0275\u0275property("formGroup",t.SQAFormGroup),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngModel",t.pifValidationDetails.projectReference),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isGenerateBtnVisible()),g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",i),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",i),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngForOf",t.observationStatusesIdentifiers),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.canEditProject)}},directives:[tt.Vq,tt.C0,o.\u0275NgNoValidate,o.NgControlStatusGroup,o.FormGroupDirective,tt.VY,tt.z9,b.KE,C.Nt,o.DefaultValueAccessor,o.NgControlStatus,o.FormControlName,E.hl,o.RequiredValidator,E.nW,b.R9,E.Mq,y.gD,i.NgForOf,i.NgIf,o.MaxLengthValidator,Ae.Hw,x.ey,i.NgClass,te.lW],styles:[".mat-step-icon[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}mat-option.mat-selected[_ngcontent-%COMP%]{background-color:#3f629d}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.btn-disabled[_ngcontent-%COMP%]{background-color:#3f629d;border-color:#3f629d}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray;background-color:#3f629d}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e})();var ft=n(69517);function vt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",11),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().editDecision()}),g.\u0275\u0275text(1," edit"),g.\u0275\u0275elementEnd()}}const St=function(e,t,n){return{"label-info":e,"label-danger":t,"label-success":n}};function bt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"h6"),g.\u0275\u0275text(1,"Project Manager"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(2," \xa0 "),g.\u0275\u0275elementStart(3,"label",12),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(2,St,e.pifValidationDetails.projectMngVisa===e.PifVisa.InProgress,e.pifValidationDetails.projectMngVisa===e.PifVisa.Invalid,e.pifValidationDetails.projectMngVisa===e.PifVisa.Valid)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e.pifValidationDetails.projectMngVisa," ")}}function Ct(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",13),g.\u0275\u0275elementStart(1,"table",14),g.\u0275\u0275element(2,"caption",15),g.\u0275\u0275elementStart(3,"tbody"),g.\u0275\u0275elementStart(4,"tr"),g.\u0275\u0275elementStart(5,"th",16),g.\u0275\u0275text(6,"Name"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",17),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"th",16),g.\u0275\u0275text(10,"Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"td",18),g.\u0275\u0275text(12),g.\u0275\u0275pipe(13,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(8),g.\u0275\u0275textInterpolate(e.pifValidationDetails.projectMngName),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(13,2,e.pifValidationDetails.projectMngCommentDate))}}function yt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"h6"),g.\u0275\u0275text(1,"Department Manager"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(2," \xa0 "),g.\u0275\u0275elementStart(3,"label",12),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(2,St,e.pifValidationDetails.departHeadVisa===e.PifVisa.InProgress,e.pifValidationDetails.departHeadVisa===e.PifVisa.Invalid,e.pifValidationDetails.departHeadVisa===e.PifVisa.Valid)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e.pifValidationDetails.departHeadVisa," ")}}function Et(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",13),g.\u0275\u0275elementStart(1,"table",14),g.\u0275\u0275element(2,"caption",15),g.\u0275\u0275elementStart(3,"tbody"),g.\u0275\u0275elementStart(4,"tr"),g.\u0275\u0275elementStart(5,"th",16),g.\u0275\u0275text(6,"Name"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",17),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"th",16),g.\u0275\u0275text(10,"Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"td",18),g.\u0275\u0275text(12),g.\u0275\u0275pipe(13,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"tr"),g.\u0275\u0275elementStart(15,"th",16),g.\u0275\u0275text(16,"Comment"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"td",19),g.\u0275\u0275text(18),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(8),g.\u0275\u0275textInterpolate(e.pifValidationDetails.departHeadName),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(13,3,e.pifValidationDetails.departHeadCommentDate)),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate(e.pifValidationDetails.departHeadComment)}}function xt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"h6"),g.\u0275\u0275text(1,"SQA"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(2," \xa0 "),g.\u0275\u0275elementStart(3,"label",12),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(2,St,e.pifValidationDetails.SQAVisa===e.PifVisa.InProgress,e.pifValidationDetails.SQAVisa===e.PifVisa.Invalid,e.pifValidationDetails.SQAVisa===e.PifVisa.Valid)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e.pifValidationDetails.SQAVisa," ")}}function It(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",13),g.\u0275\u0275elementStart(1,"table",14),g.\u0275\u0275element(2,"caption",15),g.\u0275\u0275elementStart(3,"tbody"),g.\u0275\u0275elementStart(4,"tr"),g.\u0275\u0275elementStart(5,"th",16),g.\u0275\u0275text(6,"Name"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",17),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"th",16),g.\u0275\u0275text(10,"Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"td",18),g.\u0275\u0275text(12),g.\u0275\u0275pipe(13,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"tr"),g.\u0275\u0275elementStart(15,"th",16),g.\u0275\u0275text(16,"Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"td",19),g.\u0275\u0275text(18),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"tr"),g.\u0275\u0275elementStart(20,"th",16),g.\u0275\u0275text(21,"Comment"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"td",19),g.\u0275\u0275text(23),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(8),g.\u0275\u0275textInterpolate(e.pifValidationDetails.SQAName),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(13,4,e.pifValidationDetails.SQACommentDate)),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate(e.pifValidationDetails.projectReference),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(e.pifValidationDetails.SQAComment)}}let wt=(()=>{class e{constructor(e,t,n,i){this.notificationService=e,this.projectService=t,this.dtService=n,this.dialog=i,this.PifVisa=m.CB,this.pifValidationDetails=new m.C2,this.isLinear=!0,this.isValidated=!1}ngOnInit(){this.reloadDecisionsSubscription=this.projectService.reloadDecisions.subscribe(()=>{this.getPifValidationDetails()}),this.getPifValidationDetails()}ngOnDestroy(){this.reloadDecisionsSubscription.unsubscribe(),this.dialog.closeAll()}getPifValidationDetails(){this.projectService.getPifValidationDetails(this.pifId).subscribe(e=>{this.pifValidationDetails=Object.assign(new m.C2,e[0]),this.pifValidationDetails.SQAVisa===m.CB.Valid&&(this.isValidated=!0)})}isManageProjectStepCompleted(){return this.pifValidationDetails&&this.pifValidationDetails.projectMngVisa===m.CB.Valid}isDepartmentHeadStepCompleted(){return this.isManageProjectStepCompleted()&&this.pifValidationDetails&&this.pifValidationDetails.departHeadVisa===m.CB.Valid}isSQAStepCompleted(){return this.isDepartmentHeadStepCompleted()&&this.pifValidationDetails&&this.pifValidationDetails.SQAVisa===m.CB.Valid}editDecision(){this.editDecisionDialog=this.dialog.open(gt,{disableClose:!1,hasBackdrop:!0,width:"900px",height:"460px",data:{pifId:this.pifId}})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(l.uw))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-decision"]],inputs:{pifId:"pifId",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},decls:17,vars:2,consts:[[1,"card"],[1,"card-header"],["matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-body"],[1,"ngb-accordion",3,"closeOthers"],["acc","ngbAccordion"],["id","ngb-open-p1"],["ngbPanelTitle",""],["ngbPanelContent",""],["id","ngb-open-p2"],["id","ngb-open-p3"],["matTooltip","Edit",3,"click"],[1,"label","f-right",3,"ngClass"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table","m-0"],[2,"padding","0px"],["scope","row"],[1,"text-left"],[1,"text-right"],["colspan","3",1,"text-left"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"h5"),g.\u0275\u0275text(3,"Manager Decision"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(4,vt,2,0,"mat-icon",2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"div",3),g.\u0275\u0275elementStart(6,"ngb-accordion",4,5),g.\u0275\u0275elementStart(8,"ngb-panel",6),g.\u0275\u0275template(9,bt,5,6,"ng-template",7),g.\u0275\u0275template(10,Ct,14,4,"ng-template",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"ngb-panel",9),g.\u0275\u0275template(12,yt,5,6,"ng-template",7),g.\u0275\u0275template(13,Et,19,5,"ng-template",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"ngb-panel",10),g.\u0275\u0275template(15,xt,5,6,"ng-template",7),g.\u0275\u0275template(16,It,24,6,"ng-template",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",t.canEditProject&&t.isvisibleEditProject&&!t.isValidated),g.\u0275\u0275advance(2),g.\u0275\u0275property("closeOthers",!0))},directives:[i.NgIf,ft.gY,ft.Gk,ft.Cu,ft.gW,Ae.Hw,ne.gM,i.NgClass],pipes:[_e.M],styles:["ngb-accordion[_ngcontent-%COMP%]     .card-body{padding:0 20px}ngb-accordion[_ngcontent-%COMP%]     .btn{padding:0}h6[_ngcontent-%COMP%]{position:relative;display:inline}.mat-step-icon[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}mat-option.mat-selected[_ngcontent-%COMP%]{background-color:#3f629d}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.collapse[_ngcontent-%COMP%], .collapse.in[_ngcontent-%COMP%]{display:block!important;transition:all .25s ease-in-out}.collapse[_ngcontent-%COMP%]{opacity:0;height:0}.collapse.in[_ngcontent-%COMP%]{opacity:1;height:100%}"]}),e})();const Mt=["documentForm"],Pt=["document"];function Dt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",27),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function jt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"tr"),g.\u0275\u0275elementStart(1,"td",28),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(3,"td",28),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"td",29),g.\u0275\u0275text(6),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",28),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",28),g.\u0275\u0275elementStart(10,"em",30),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().deleteTypeElement(t.id)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.typeDesc),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.reference),g.\u0275\u0275advance(1),g.\u0275\u0275property("matTooltip",e.title),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.title),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.editionDate)}}const Ot=function(e){return{active:e}};function Ft(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"li",32),g.\u0275\u0275elementStart(1,"a",33),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).setPage(t)}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(2,Ot,n.pager.currentPage===e)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e)}}const kt=function(e){return{disabled:e}};function At(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"ul",31),g.\u0275\u0275elementStart(1,"li",32),g.\u0275\u0275elementStart(2,"a",33),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().setPage(1)}),g.\u0275\u0275text(3,"First"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"li",32),g.\u0275\u0275elementStart(5,"a",33),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.currentPage-1)}),g.\u0275\u0275text(6,"Previous"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,Ft,3,4,"li",34),g.\u0275\u0275elementStart(8,"li",32),g.\u0275\u0275elementStart(9,"a",33),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setNextPage(t.pager.currentPage+1)}),g.\u0275\u0275text(10,"Next"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"li",32),g.\u0275\u0275elementStart(12,"a",33),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.totalPages)}),g.\u0275\u0275text(13,"Last"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(5,kt,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(7,kt,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",e.pager.pages),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(9,kt,e.pager.currentPage===e.pager.totalPages)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(11,kt,e.pager.currentPage===e.pager.totalPages))}}let _t=(()=>{class e{constructor(e,t,n,i,r){this.projectService=e,this.notificationService=t,this.dialogRef=n,this.pagerService=i,this.dialogData=r,this.documents=new Array,this.pager={},this.document=new m.BB,this.pifId=this.dialogData.pifId}ngOnInit(){this.GetTypeEntries(),0!==this.pifId&&void 0!==this.pifId&&this.getEntries(this.pifId)}ngOnDestroy(){this.close()}setPage(e){e<1||(this.pager=this.pagerService.getPager(this.documents.length,e),this.pagedItems=this.documents.slice(this.pager.startIndex,this.pager.endIndex+1))}GetTypeEntries(){this.projectService.getTypeEntries().subscribe(e=>{this.typeEntriesIdentifiers=e})}add(e,t){this.documentForm.valid?(this.document.pifId=this.pifId,this.document.typeId=this.selectedTypeEntrieIdentifier.id,this.projectService.insertTypeElement(this.document).subscribe(e=>{this.document.id=e,this.document.typeDesc=this.selectedTypeEntrieIdentifier.description,this.documents.unshift(this.document),this.selectedTypeEntrieIdentifier=new S.x,this.document=new m.BB,this.notificationService.success("Document added successfully!"),this.setPage(1),this.documentForm.resetForm()})):this.notificationService.danger("Please fill all required fields")}getEntries(e){this.projectService.getEntries(e).subscribe(e=>{this.documents=[],e.forEach(e=>{this.documents.push(Object.assign(new m.BB,e))}),this.setPage(1)})}deleteTypeElement(e){this.projectService.deleteTypeElement(e).subscribe(t=>{this.documents=this.documents.filter(t=>t.id!==e),this.setPage(1)})}close(){this.dialogRef.close(),this.projectService.reloadDocs.next()}setPageDetails(){return this.documents.length>3}setNextPage(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.documents.length,e),this.pagedItems=this.documents.slice(this.pager.startIndex,this.pager.endIndex+1)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(d.e9),g.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-document"]],viewQuery:function(e,t){if(1&e&&(g.\u0275\u0275viewQuery(Mt,7),g.\u0275\u0275viewQuery(Pt,7)),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.documentForm=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.selectedDocument=e.first)}},inputs:{pifId:"pifId"},decls:48,vars:7,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["id","documentForm",3,"submit"],["documentForm","ngForm"],[1,"row"],[1,"col-sm-6"],["placeholder","Type","name","typeEntry","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Title","matInput","","name","title","required","","maxlength","200",3,"ngModel","ngModelChange"],["placeholder","Reference","matInput","","name","reference","maxlength","100","required","",3,"ngModel","ngModelChange"],["placeholder","Edition/Date","matInput","","name","editionDate","required","",3,"ngModel","ngModelChange"],[1,"col-lg-12"],[1,"row","f-right"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md"],[1,"row",2,"margin-top","25px"],[1,"col-sm-12"],["placement","bottom",1,"p-20","z-depth-bottom-5","waves-effect"],[1,"table-responsive"],[1,"table"],[2,"padding","0px"],["scope","col",1,"col-sm-2","th-table-style"],["scope","col",1,"col-sm-2","text-right"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[3,"value"],[1,"td-table-style"],[1,"td-title-style",3,"matTooltip"],[1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"],[1,"pagination",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3," Inputs Entries "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"span"),g.\u0275\u0275elementStart(5,"em",2),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(6,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",3),g.\u0275\u0275elementStart(8,"div",4),g.\u0275\u0275elementStart(9,"form",5,6),g.\u0275\u0275listener("submit",function(){return t.add()}),g.\u0275\u0275elementStart(11,"div",7),g.\u0275\u0275elementStart(12,"mat-form-field",8),g.\u0275\u0275elementStart(13,"mat-select",9),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedTypeEntrieIdentifier=e}),g.\u0275\u0275template(14,Dt,2,2,"mat-option",10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"mat-form-field",8),g.\u0275\u0275elementStart(16,"input",11),g.\u0275\u0275listener("ngModelChange",function(e){return t.document.title=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"div",7),g.\u0275\u0275elementStart(18,"mat-form-field",8),g.\u0275\u0275elementStart(19,"input",12),g.\u0275\u0275listener("ngModelChange",function(e){return t.document.reference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(20,"mat-form-field",8),g.\u0275\u0275elementStart(21,"input",13),g.\u0275\u0275listener("ngModelChange",function(e){return t.document.editionDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"div",7),g.\u0275\u0275elementStart(23,"div",14),g.\u0275\u0275elementStart(24,"div",15),g.\u0275\u0275elementStart(25,"div",14),g.\u0275\u0275elementStart(26,"button",16),g.\u0275\u0275text(27,"Add"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"div",17),g.\u0275\u0275elementStart(29,"div",18),g.\u0275\u0275elementStart(30,"div",19),g.\u0275\u0275elementStart(31,"div",20),g.\u0275\u0275elementStart(32,"table",21),g.\u0275\u0275element(33,"caption",22),g.\u0275\u0275elementStart(34,"thead"),g.\u0275\u0275elementStart(35,"tr"),g.\u0275\u0275elementStart(36,"th",23),g.\u0275\u0275text(37,"Type"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"th",23),g.\u0275\u0275text(39,"Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"th",23),g.\u0275\u0275text(41,"Title"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(42,"th",23),g.\u0275\u0275text(43,"Edition/Date"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(44,"th",24),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"tbody"),g.\u0275\u0275template(46,jt,11,5,"tr",25),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(47,At,14,13,"ul",26),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(13),g.\u0275\u0275property("ngModel",t.selectedTypeEntrieIdentifier),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.typeEntriesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.document.title),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.document.reference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.document.editionDate),g.\u0275\u0275advance(25),g.\u0275\u0275property("ngForOf",t.pagedItems),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,y.gD,o.RequiredValidator,o.NgControlStatus,o.NgModel,i.NgForOf,C.Nt,o.DefaultValueAccessor,o.MaxLengthValidator,i.NgIf,x.ey,ne.gM,i.NgClass],styles:[".col-sm-2[_ngcontent-%COMP%]{width:auto}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-title-style[_ngcontent-%COMP%]{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e})();function Vt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).onClickEdit()}),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.getEditIcon(),"")}}function Nt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",4),g.\u0275\u0275elementStart(1,"h5"),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(3,Vt,2,1,"mat-icon",5),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate2("",e.title," ",e.getItemsCount(),""),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.canEditProject&&e.isvisibleEditProject)}}const Rt=function(e){return{active:e}};function Tt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"li",10),g.\u0275\u0275elementStart(1,"a",13),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(3).setPage(t)}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(3);g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(2,Rt,n.pager.currentPage===e)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e)}}const Bt=function(e){return{disabled:e}};function zt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"ul",9),g.\u0275\u0275elementStart(1,"li",10),g.\u0275\u0275elementStart(2,"em",11),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext(2);return 1!==t.pager.currentPage&&t.setPage(1)}),g.\u0275\u0275text(3,"first_page"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"li",10),g.\u0275\u0275elementStart(5,"em",11),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext(2);return 1!==t.pager.currentPage&&t.setPage(t.pager.currentPage-1)}),g.\u0275\u0275text(6,"chevron_left"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,Tt,3,4,"li",12),g.\u0275\u0275elementStart(8,"li",10),g.\u0275\u0275elementStart(9,"em",11),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext(2);return t.pager.currentPage!==t.pager.totalPages&&t.setPage(t.pager.currentPage+1)}),g.\u0275\u0275text(10,"chevron_right"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"li",10),g.\u0275\u0275elementStart(12,"em",11),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext(2);return t.pager.currentPage!==t.pager.totalPages&&t.setPage(t.pager.totalPages)}),g.\u0275\u0275text(13,"last_page"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(5,Bt,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(7,Bt,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",e.pager.pages),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(9,Bt,e.pager.currentPage===e.pager.totalPages)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(11,Bt,e.pager.currentPage===e.pager.totalPages))}}function qt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",7),g.\u0275\u0275template(1,zt,14,13,"ul",8),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.pager.pages&&e.pager.pages.length)}}const Lt=["*"];let Qt=(()=>{class e{constructor(e){this.pagerService=e,this.editEvent=new g.EventEmitter,this.itemsPerPage=5}ngOnInit(){}getItemsCount(){return this.itemsList&&this.itemsList.length>0?"("+this.itemsList.length+")":""}setpagedItems(e){this.itemsList=e}setPage(e){e<1||(this.pager=this.pagerService.getPager(this.itemsList.length,e,this.itemsPerPage),this.pagedItems=this.itemsList.slice(this.pager.startIndex,this.pager.endIndex+1))}isPagerRequired(){return this.itemsList&&this.itemsList.length>this.itemsPerPage}getEditIcon(){return this.itemsList&&this.itemsList.length>0?"edit":"add"}onClickEdit(){this.editEvent.emit()}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.e9))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-card"]],inputs:{title:"title",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},outputs:{editEvent:"editEvent"},ngContentSelectors:Lt,decls:5,vars:2,consts:[[1,"card"],["class","card-header ripple",4,"ngIf"],[1,"card-body"],["class","card-footer",4,"ngIf"],[1,"card-header","ripple"],["class","add-edit-ico","matTooltip","add",3,"click",4,"ngIf"],["matTooltip","add",1,"add-edit-ico",3,"click"],[1,"card-footer"],["class","pagination","style","float:right",4,"ngIf"],[1,"pagination",2,"float","right"],[3,"ngClass"],[1,"material-icons",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275projectionDef(),g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275template(1,Nt,4,3,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275projection(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(4,qt,2,1,"div",3),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.title),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",t.isPagerRequired()))},directives:[i.NgIf,Ae.Hw,ne.gM,i.NgClass,i.NgForOf],styles:[".card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .add-edit-ico[_ngcontent-%COMP%]{font-size:20px;margin-right:15px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .show-hide-ico[_ngcontent-%COMP%]{font-size:25px;position:relative;top:-4px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{height:220px}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:pointer;vertical-align:middle;position:relative;top:3px;margin:0 15px}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}"]}),e})();function $t(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"ul",2),g.\u0275\u0275elementStart(1,"li",3),g.\u0275\u0275elementStart(2,"div",4),g.\u0275\u0275element(3,"em",5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"div",6),g.\u0275\u0275elementStart(5,"h6"),g.\u0275\u0275text(6),g.\u0275\u0275elementStart(7,"em",7),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate2("",e.title," - ",e.typeDesc,": "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate2(" ",e.reference," (",e.editionDate,")")}}let Ut=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.notificationService=t,this.dialog=n,this.dateTimeService=i,this.documents=new Array}ngOnInit(){this.reloadDocumentSubscription=this.projectService.reloadDocs.subscribe(()=>{this.getEntries()}),this.getEntries()}ngOnDestroy(){this.reloadDocumentSubscription.unsubscribe(),this.dialog.closeAll()}editDocument(){this.editDocumentDialog=this.dialog.open(_t,{disableClose:!1,hasBackdrop:!0,width:"900px",height:"570px",data:{pifId:this.project.pifId}})}getEntries(){this.projectService.getEntries(this.project.pifId).subscribe(e=>{this.documents=[],e.forEach(e=>{this.documents.push(Object.assign(new m.BB,e))}),this.viewCard.setpagedItems(this.documents),this.viewCard.setPage(1)})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(d.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-attached-document"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Qt,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.viewCard=e.first)}},inputs:{project:"project",isProject:"isProject",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},decls:2,vars:4,consts:[[3,"title","isvisibleEditProject","canEditProject","editEvent"],["class","media-list",4,"ngFor","ngForOf"],[1,"media-list"],[1,"media","d-flex","m-b-10"],[1,"m-r-5","v-middle","doc-icon"],[1,"text-muted","icofont","icofont-file-document"],[1,"media-body"],[1,"text-muted","m-b-0"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"app-view-card",0),g.\u0275\u0275listener("editEvent",function(){return t.editDocument()}),g.\u0275\u0275template(1,$t,9,4,"ul",1),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275property("title","Inputs Entries")("isvisibleEditProject",t.isvisibleEditProject)("canEditProject",t.canEditProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.viewCard.pagedItems))},directives:[Qt,i.NgForOf],styles:["h6[_ngcontent-%COMP%]{position:relative;display:inline-block;font-size:14px}.doc-icon[_ngcontent-%COMP%]   .icofont[_ngcontent-%COMP%]{font-size:25px}"]}),e})();const Ht=["memberSelect"],Gt=["t"];function Wt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",29),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.memberName," ")}}function Jt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",29),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.roleName," ")}}function Yt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"em",34),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().deletePifMember(t)}),g.\u0275\u0275elementEnd()}}function Kt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"tr"),g.\u0275\u0275elementStart(1,"td",30),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(3,"td",30),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"td",31),g.\u0275\u0275elementStart(6,"em",32),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().editPifMember(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",31),g.\u0275\u0275template(8,Yt,1,0,"em",33),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.memberName,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.memberName),g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.role,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.role),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",e.memberName!=n.pifValidationDetails.projectMngName)}}const Xt=function(e){return{active:e}};function Zt(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"li",36),g.\u0275\u0275elementStart(1,"a",37),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).setPage(t)}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(2,Xt,n.pager.currentPage===e)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e)}}const en=function(e){return{disabled:e}};function tn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"ul",35),g.\u0275\u0275elementStart(1,"li",36),g.\u0275\u0275elementStart(2,"a",37),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().setPage(1)}),g.\u0275\u0275text(3,"First"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"li",36),g.\u0275\u0275elementStart(5,"a",37),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.currentPage-1)}),g.\u0275\u0275text(6,"Previous"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,Zt,3,4,"li",38),g.\u0275\u0275elementStart(8,"li",36),g.\u0275\u0275elementStart(9,"a",37),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setNextPage(t.pager.currentPage+1)}),g.\u0275\u0275text(10,"Next"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"li",36),g.\u0275\u0275elementStart(12,"a",37),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.totalPages)}),g.\u0275\u0275text(13,"Last"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(5,en,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(7,en,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",e.pager.pages),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(9,en,e.pager.currentPage===e.pager.totalPages)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(11,en,e.pager.currentPage===e.pager.totalPages))}}let nn=(()=>{class e{constructor(e,t,n,i,r,a){this.projectService=e,this.dateTimeService=t,this.notificationService=n,this.pagerService=i,this.dialogRef=r,this.dialogData=a,this.members=[],this.selectedMembers=[],this.roles=[],this.selectedRole=this.roles[0],this.pifMembers=[],this.pager={},this.isEdit=!1,this.memberFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ,this.filteredMembers=new c.tq(1),this.pifValidationDetails=new m.C2,this.pifId=this.dialogData.pifId,this.projectId=this.dialogData.projectId}ngOnInit(){this.getPifValidationDetails(),this.getAllRoles(),this.getMembers(),0!==this.pifId&&void 0!==this.pifId&&this.getPifProjectMembers(this.pifId),this.memberFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterMembers()})}ngOnDestroy(){this.close()}ngAfterViewInit(){this.setInitialValue()}setPage(e){e<1||(this.pager=this.pagerService.getPager(this.pifMembers.length,e),this.pagedItems=this.pifMembers.slice(this.pager.startIndex,this.pager.endIndex+1))}getPifValidationDetails(){this.projectService.getPifValidationDetails(this.pifId).subscribe(e=>{this.pifValidationDetails=Object.assign(new m.C2,e[0])})}getAllRoles(){this.projectService.getAllRoles().subscribe(e=>{this.roles=[],e.forEach(e=>{this.roles.push(Object.assign(new m.jg,e))})})}getPifProjectMembers(e){this.projectService.getPifProjectMembers(e).subscribe(e=>{this.pifMembers=[],e.forEach(e=>{this.pifMembers.push(Object.assign(new m.J3,e))}),this.setPage(1)})}insertOrUpdatePifProjectMembers(e,t,n){if(e.valid&&this.selectedMembers.length>0)if(!1===this.isEdit){const t=new m.sA(this.pifId,this.selectedRole.roleId);t.membersId=this.selectedMembers.map(({memberId:e})=>e),t.membersName=this.selectedMembers.map(({memberName:e})=>e),this.projectService.insertPifProjectMembers(t).subscribe(t=>{if(this.getPifProjectMembers(this.pifId.toString()),this.setPage(1),0===t)this.selectedMembers=[],this.notificationService.success("Members added successfully.");else{const e=t.value.split(",");let n="";e.forEach(e=>{const t=this.selectedMembers.find(t=>t.memberId===+e);n+="<br>- "+t.memberName}),this.notificationService.warning("Members already exist:"+n)}e.resetForm()},()=>{this.notificationService.danger("Add members fails.")})}else{const t=new m.J3;t.memberId=this.selectedMembers[0].memberId,t.pifId=this.pifId,t.roleId=this.selectedRole.roleId,this.projectService.updatePifProjectMember(t).subscribe(t=>{this.getPifProjectMembers(this.pifId.toString()),this.setPage(1),e.resetForm(),this.isEdit=!1,this.selectedMembers=[],this.form.controls.selectedMembers.enable(),this.notificationService.success("Save member succeeded.")},()=>{this.notificationService.danger("Save member fails.")})}else this.notificationService.danger("Please fill all required fields.")}editPifMember(e){this.isEdit=!0,this.selectedMembers=[],this.selectedMembers.push(e),this.selectedRole=this.roles.find(t=>t.roleId===e.roleId),this.form.controls.selectedMembers.disable()}deletePifMember(e){e.pifId=this.pifId,this.projectService.deletePifMember(e).subscribe(t=>{this.pifMembers=this.pifMembers.filter(t=>t.memberId!==e.memberId),this.setPage(1)},e=>{this.notificationService.danger("Failed to delete member")})}getMembers(){this.projectService.getMembers().subscribe(e=>{this.members=[],e.forEach(e=>{this.members.push(Object.assign(new m.J3,e))}),this.filteredMembers.next(this.members.slice())})}close(){this.projectService.reloadTeam.next(),this.dialogRef.close()}dateOnly(e){return this.dateTimeService.dateOnly(e)}setPageDetails(){return this.pifMembers.length>3}setNextPage(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.pifMembers.length,e),this.pagedItems=this.pifMembers.slice(this.pager.startIndex,this.pager.endIndex+1)}setInitialValue(){this.filteredMembers.pipe((0,Re.q)(1),(0,Ne.R)(this._onDestroy)).subscribe(()=>{this.memberSelect.compareWith=(e,t)=>e&&t&&e.memberId===t.memberId})}filterMembers(){if(!this.members)return;let e=this.memberFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredMembers.next(this.members.filter(t=>t.memberName.toLowerCase().indexOf(e)>-1))):this.filteredMembers.next(this.members.slice())}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.e9),g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-team"]],viewQuery:function(e,t){if(1&e&&(g.\u0275\u0275viewQuery(Ht,7),g.\u0275\u0275viewQuery(Gt,7)),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.memberSelect=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.form=e.first)}},decls:47,vars:11,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["novalidate","",3,"submit"],["t","ngForm"],[1,"row"],[1,"col-sm-10"],["placeholder","Members","name","selectedMembers","multiple","","required","",3,"ngModel","ngModelChange"],["memberSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-lg-2"],[1,"row","f-right"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md"],["placeholder","Roles","name","selectedRole","required","",3,"ngModel","ngModelChange"],[1,"row",2,"margin-top","25px"],[1,"col-lg-12"],["placement","bottom",1,"p-20","z-depth-bottom-5","waves-effect"],[1,"team-table","table-responsive"],[1,"table"],[2,"padding","0px"],["scope","col",1,"table-name","th-table-style"],["scope","col",1,"table-role","th-table-style"],["scope","col",1,"table-btn","th-table-style"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[3,"value"],[1,"td-table-style","span-ellipsis",3,"matTooltip"],[1,"td-table-style"],[1,"icofont","icofont-ui-edit","icon-pointer",3,"click"],["class","icofont icofont-ui-delete icon-pointer","style","color:#d84315",3,"click",4,"ngIf"],[1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"],[1,"pagination",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3," Team Members "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"span"),g.\u0275\u0275elementStart(5,"em",2),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(6,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",3),g.\u0275\u0275elementStart(8,"div",4),g.\u0275\u0275elementStart(9,"form",5,6),g.\u0275\u0275listener("submit",function(){g.\u0275\u0275restoreView(e);const n=g.\u0275\u0275reference(10);return t.insertOrUpdatePifProjectMembers(n)}),g.\u0275\u0275elementStart(11,"div",7),g.\u0275\u0275elementStart(12,"mat-form-field",8),g.\u0275\u0275elementStart(13,"mat-select",9,10),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedMembers=e}),g.\u0275\u0275elementStart(15,"mat-option"),g.\u0275\u0275elementStart(16,"ngx-mat-select-search",11),g.\u0275\u0275elementStart(17,"mat-icon",12),g.\u0275\u0275text(18,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(19,Wt,2,2,"mat-option",13),g.\u0275\u0275pipe(20,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"div",14),g.\u0275\u0275elementStart(22,"div",15),g.\u0275\u0275elementStart(23,"div",14),g.\u0275\u0275elementStart(24,"button",16),g.\u0275\u0275text(25,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",7),g.\u0275\u0275elementStart(27,"mat-form-field",8),g.\u0275\u0275elementStart(28,"mat-select",17),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedRole=e}),g.\u0275\u0275template(29,Jt,2,2,"mat-option",13),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"div",18),g.\u0275\u0275elementStart(31,"div",19),g.\u0275\u0275elementStart(32,"div",20),g.\u0275\u0275elementStart(33,"div",21),g.\u0275\u0275elementStart(34,"table",22),g.\u0275\u0275element(35,"caption",23),g.\u0275\u0275elementStart(36,"thead"),g.\u0275\u0275elementStart(37,"tr"),g.\u0275\u0275elementStart(38,"th",24),g.\u0275\u0275text(39,"Members"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"th",25),g.\u0275\u0275text(41,"Roles"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(42,"th",26),g.\u0275\u0275element(43,"th",26),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"tbody"),g.\u0275\u0275template(45,Kt,9,5,"tr",27),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(46,tn,14,13,"ul",28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}2&e&&(g.\u0275\u0275advance(13),g.\u0275\u0275property("ngModel",t.selectedMembers),g.\u0275\u0275advance(3),g.\u0275\u0275property("formControl",t.memberFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(20,9,t.filteredMembers)),g.\u0275\u0275advance(9),g.\u0275\u0275property("ngModel",t.selectedRole),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.roles),g.\u0275\u0275advance(16),g.\u0275\u0275property("ngForOf",t.pagedItems),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,y.gD,o.RequiredValidator,o.NgControlStatus,o.NgModel,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,i.NgIf,ne.gM,i.NgClass],pipes:[i.AsyncPipe],styles:[".icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.team-table[_ngcontent-%COMP%]{text-align:center}.team-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.table-name[_ngcontent-%COMP%]{width:35%!important}.table-role[_ngcontent-%COMP%]{width:35%!important}.table-btn[_ngcontent-%COMP%]{width:10%!important}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.mat-select-panel[_ngcontent-%COMP%]{margin-bottom:1%}"]}),e})();function rn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"em",7),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext().$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.role," ")}}function an(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"ul",2),g.\u0275\u0275elementStart(1,"li",3),g.\u0275\u0275element(2,"img",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"h6"),g.\u0275\u0275text(5),g.\u0275\u0275template(6,rn,2,1,"em",6),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",e.memberName,": "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.role)}}let on=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.notificationService=t,this.dateTimeService=n,this.dialog=i,this.pifMembers=[]}ngOnInit(){this.reloadTeamSubscription=this.projectService.reloadTeam.subscribe(()=>{this.getPifProjectMembers(this.project.pifId)}),this.getPifProjectMembers(this.project.pifId)}ngOnDestroy(){this.reloadTeamSubscription.unsubscribe(),this.dialog.closeAll()}getPifProjectMembers(e){this.projectService.getPifProjectMembers(e).subscribe(e=>{this.pifMembers=[],e.forEach(e=>{this.pifMembers.push(Object.assign(new m.J3,e))}),this.viewCard.setpagedItems(this.pifMembers),this.viewCard.setPage(1)})}editTeamMembers(){this.editTeamMembersDialog=this.dialog.open(nn,{disableClose:!1,hasBackdrop:!0,width:"600px",height:"570px",data:{pifId:this.project.pifId,projectId:this.project.projectId,activityId:this.project.activityId}})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(l.uw))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-team-members"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Qt,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.viewCard=e.first)}},inputs:{project:"project",canEditProject:"canEditProject",isProject:"isProject",isvisibleEditProject:"isvisibleEditProject"},decls:2,vars:4,consts:[[3,"title","canEditProject","isvisibleEditProject","editEvent"],["class","media-list",4,"ngFor","ngForOf"],[1,"media-list"],[1,"media","d-flex","m-b-10"],["src","assets/images/avatar.png","alt","user image",1,"m-r-5"],[1,"d-inline-block"],["class","text-muted m-b-0",4,"ngIf"],[1,"text-muted","m-b-0"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"app-view-card",0),g.\u0275\u0275listener("editEvent",function(){return t.editTeamMembers()}),g.\u0275\u0275template(1,an,7,2,"ul",1),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275property("title","Team Members")("canEditProject",t.canEditProject)("isvisibleEditProject",t.isvisibleEditProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.viewCard.pagedItems))},directives:[Qt,i.NgForOf,i.NgIf],styles:["img[_ngcontent-%COMP%]{vertical-align:middle;border-radius:100%;width:25px}h6[_ngcontent-%COMP%]{position:relative;display:inline-block;font-size:14px}"]}),e})();function sn(e,t){1&e&&g.\u0275\u0275element(0,"th",24)}function ln(e,t){1&e&&g.\u0275\u0275element(0,"th",25)}function cn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"span"),g.\u0275\u0275elementStart(1,"i",9),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().expandSubActivities(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(2,"i",10),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().compressSubActivities(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext().$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275property("hidden",!e.hidden),g.\u0275\u0275advance(1),g.\u0275\u0275property("hidden",e.hidden)}}function dn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"td",34),g.\u0275\u0275elementStart(1,"em",35),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().editActivity(t)}),g.\u0275\u0275text(2,"create"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(3," \xa0 "),g.\u0275\u0275elementStart(4,"em",36),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().deleteActivity(t)}),g.\u0275\u0275text(5,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}}function mn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"td",34),g.\u0275\u0275elementStart(1,"em",39),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext(2).editActivity(t)}),g.\u0275\u0275text(2,"create"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(3," \xa0 "),g.\u0275\u0275elementStart(4,"em",40),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext(2).deleteActivity(t)}),g.\u0275\u0275text(5,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}}function pn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"tr",37),g.\u0275\u0275element(1,"td",27),g.\u0275\u0275elementStart(2,"td",29),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"td",30),g.\u0275\u0275text(5),g.\u0275\u0275pipe(6,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",30),g.\u0275\u0275text(8),g.\u0275\u0275pipe(9,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(10,"td"),g.\u0275\u0275text(11),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"td",30),g.\u0275\u0275text(13),g.\u0275\u0275pipe(14,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"td",30),g.\u0275\u0275text(16),g.\u0275\u0275pipe(17,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"td",30),g.\u0275\u0275text(19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(20,"td"),g.\u0275\u0275text(21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"td"),g.\u0275\u0275text(23),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"td"),g.\u0275\u0275text(25),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"td",38),g.\u0275\u0275text(27),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(28,mn,6,0,"td",32),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext().$implicit,i=g.\u0275\u0275nextContext();g.\u0275\u0275property("hidden",n.hidden),g.\u0275\u0275advance(2),g.\u0275\u0275property("matTooltip",e.name),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.name," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(6,14,e.plannedStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(9,16,e.plannedEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",e.estimatedCharge," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(14,18,e.realStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(17,20,e.realEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",e.actualCost," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.advancement," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.spi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.cpi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.usersName," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",i.isSuperAdminOrManagerOrDH())}}function hn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"tbody"),g.\u0275\u0275elementStart(1,"tr",26),g.\u0275\u0275elementStart(2,"td",27),g.\u0275\u0275template(3,cn,3,2,"span",28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"td",29),g.\u0275\u0275text(5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"td",30),g.\u0275\u0275text(7),g.\u0275\u0275pipe(8,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",30),g.\u0275\u0275text(10),g.\u0275\u0275pipe(11,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"td"),g.\u0275\u0275text(13),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"td",30),g.\u0275\u0275text(15),g.\u0275\u0275pipe(16,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"td",30),g.\u0275\u0275text(18),g.\u0275\u0275pipe(19,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(20,"td",30),g.\u0275\u0275text(21),g.\u0275\u0275pipe(22,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"td"),g.\u0275\u0275text(24),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"td"),g.\u0275\u0275text(26),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"td"),g.\u0275\u0275text(28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"td",31),g.\u0275\u0275text(30),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(31,dn,6,0,"td",32),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(32,pn,29,22,"tr",33),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275property("ngIf",0!=e.subActivities.length),g.\u0275\u0275advance(1),g.\u0275\u0275property("matTooltip",e.name),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.name," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(8,15,e.plannedStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(11,17,e.plannedEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",e.estimatedCharge," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(16,19,e.realStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(19,21,e.realEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(22,23,e.actualCost,"1.2-2")," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",e.advancement," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.spi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.cpi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.usersName," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",n.isSuperAdminOrManagerOrDH()),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",e.subActivities)}}let un=(()=>{class e{constructor(e,t,n,i,r){this.dialog=e,this.projectService=t,this.dtService=n,this.notificationService=i,this.wbsGanttService=r,this.initializeTopActivityEvent=new g.EventEmitter,this.topActivity=new m.cS,this.activities=[],this.previousActivities=[],this.isSubActivitiesDisplayed=!1,this.compressedActivitiesCount=0,this.currentCompressedActivitiesCount=0}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.getProjectActivities(this.project.projectId)}ngOnDestroy(){this.dialog.closeAll()}ngAfterViewInit(){this.updateWbsData.subscribe(()=>{this.getProjectActivities(this.project.projectId)})}initializeTopActivity(e){this.topActivity=new m.cS,this.topActivity.projectId=+this.project.projectId,this.topActivity.name=this.project.name,this.topActivity.plannedStartDate=this.project.plannedStartDate,this.topActivity.plannedEndDate=this.project.plannedEndDate,this.topActivity.description=this.project.description,this.topActivity.activityId=0,this.topActivity.level=1,this.topActivity.activityNumber="1",this.topActivity.showChilds=!0,this.topActivity.hasParent=!1,null!=e&&e.length>0&&(this.topActivity.subActivities=this.getSubActivities(e,this.topActivity),this.topActivity.hasChilds=this.topActivity.subActivities.length>0),this.initializeTopActivityEvent.emit(this.topActivity),this.calculateWbsAutoValues(),0===this.previousActivities.length&&this.topActivity.subActivities&&this.topActivity.subActivities.forEach(e=>{!0===e.hasChilds&&(this.compressedActivitiesCount++,this.currentCompressedActivitiesCount++)})}getSubActivities(e,t){const n=[];let i=1;return e.forEach(r=>{if(null===r.parentId&&(r.parentId=0),r.parentId===t.activityId){const a=new m.cS;a.phaseId=r.phaseId,a.categoryId=r.categoryId,a.projectId=r.projectId,a.activityId=r.activityId,a.parentId=r.parentId,a.name=r.name,a.description=r.description,a.activityNumber=t.activityNumber+"."+i.toString(),a.level=r.level+1,a.showChilds=r.level<2,a.hasAssignment=r.hasAssignment,a.estimatedCharge=r.estimatedCharge,a.plannedStartDate=r.plannedStartDate,a.plannedEndDate=r.plannedEndDate,a.advancement=r.advancement,a.actualCost=r.actualCost,a.realStartDate=r.realStartDate,a.realEndDate=r.realEndDate,a.hasParent=!0,a.hidden=r.hidden,a.usersName=r.usersName,a.subActivities=this.getSubActivities(e,a),a.hasChilds=a.subActivities.length>0,i++,n.push(a)}}),n}getProjectActivities(e){this.projectService.getProjectActivities(e).subscribe(e=>{0!==this.activities.length&&(this.previousActivities=this.topActivity.subActivities),this.activities=[],e.forEach(e=>{if(0!==this.previousActivities.length){const t=this.previousActivities.find(t=>t.activityId===e.activityId);t&&(e.hidden=t.hidden)}this.activities.push(Object.assign(new m.cS,e))}),this.initializeTopActivity(this.activities)})}editActivity(e){this.openEditActivityDialog(e,"edit"),this.onActivityClick(e)}openEditActivityDialog(e,t){this.addEditActivitydialogRef=this.dialog.open(Pe,{disableClose:!1,hasBackdrop:!0,width:"800px",height:"590px",data:{mode:t,activity:e,departmentId:this.project.departmentId,parentStartDate:!0===e.hasChilds||e.level<=2?this.topActivity.plannedStartDate:e.plannedStartDate,parentEndDate:!0===e.hasChilds||e.level<=2?this.topActivity.plannedEndDate:e.plannedEndDate}}),this.addEditActivitydialogRef.afterClosed().subscribe(()=>{this.getProjectActivities(this.project.projectId)})}deleteActivity(e){X().fire({text:"Are you sure to delete this task ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.projectService.deleteActivity(e.activityId).subscribe(()=>{this.projectService.ActivityDeleted.next(e),this.notificationService.success("The task '"+e.name+"' is deleted successfully !"),this.getProjectActivities(this.project.projectId)},()=>{this.notificationService.danger("Delete task failed")})}})}calculateWbsAutoValues(){this.wbsGanttService.calculateWbsEstimCharge(this.topActivity),this.wbsGanttService.calculateWbsProgress(this.topActivity),this.wbsGanttService.calculateWbsStatus(this.topActivity),this.wbsGanttService.calculateWbsAcwpBcwpKpis(this.topActivity),this.wbsGanttService.calculateRealDates(this.topActivity),this.wbsGanttService.calculateElapsedDuration(this.topActivity),this.wbsGanttService.calculateWbsSpiCpiKpis(this.topActivity)}onActivityClick(e){this.projectService.ActivitySelected.emit(e)}isSuperAdminOrManagerOrDH(){return this.user.groupId===h.Fl.ProjectManager&&this.project.activityId===this.user.activityId||this.user.groupId===h.Fl.SuperAdmin||this.user.qualification===h._W.DepartmentHead}expandSubActivities(e){if(0===e.activityId)return void 0!==this.topActivity.subActivities&&this.topActivity.subActivities.forEach(e=>{e.hidden=!1,this.currentCompressedActivitiesCount=0}),this.isSubActivitiesDisplayed=!0,this.isSubActivitiesDisplayed;e.hidden=!1,this.currentCompressedActivitiesCount--,0===this.currentCompressedActivitiesCount&&(this.isSubActivitiesDisplayed=!0)}compressSubActivities(e){if(void 0!==this.topActivity.subActivities){if(0===e.activityId)return this.topActivity.subActivities.forEach(e=>{e.hidden=!0,this.currentCompressedActivitiesCount=this.compressedActivitiesCount}),this.isSubActivitiesDisplayed=!1,this.isSubActivitiesDisplayed;e.hidden=!0,this.currentCompressedActivitiesCount++,this.currentCompressedActivitiesCount===this.compressedActivitiesCount&&(this.isSubActivitiesDisplayed=!1)}}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(p.u2))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-wbs-gantt"]],inputs:{project:"project",activity:"activity",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",smallSize:"smallSize",updateWbsData:"updateWbsData"},outputs:{initializeTopActivityEvent:"initializeTopActivityEvent"},decls:68,vars:26,consts:[[1,"main-content","m-t-10"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"table","table-bordered","text-center","m-b-10"],[2,"padding","0px"],[1,"th"],["scope","row",2,"width","45px"],["aria-hidden","true",1,"fa","fa-plus","pointer",3,"hidden","click"],["aria-hidden","true",1,"fa","fa-minus","pointer",3,"hidden","click"],["scope","row","colspan","7"],["scope","row","colspan","2"],["scope","row"],["scope","row","colspan","4"],["scope","row","style","width:85px;",4,"ngIf"],["scope","row",1,"total",2,"width","45px"],["scope","row","colspan","7",1,"total",2,"text-align","left"],["scope","row","colspan","2",1,"total"],["scope","row",1,"total"],["scope","row","colspan","4",1,"total",2,"white-space","pre-line","text-align","left"],["scope","row","class","total","style","width:85px;",4,"ngIf"],[1,"tbody"],[4,"ngFor","ngForOf"],["scope","row",2,"width","85px"],["scope","row",1,"total",2,"width","85px"],[2,"text-align","center"],[2,"width","45px"],[4,"ngIf"],["colspan","7",2,"text-align","left",3,"matTooltip"],["colspan","2"],["colspan","4",2,"white-space","pre-line","text-align","left"],["class","pointer","style","width:85px;",4,"ngIf"],["style","background-color: #CAC7C5;",3,"hidden",4,"ngFor","ngForOf"],[1,"pointer",2,"width","85px"],["matTooltip","Edit Task",1,"material-icons",3,"click"],["matTooltip","Delete Task",1,"material-icons",3,"click"],[2,"background-color","#CAC7C5",3,"hidden"],["colspan","4",2,"text-align","left","white-space","pre-line"],["matTooltip","Edit Subtask",1,"material-icons",3,"click"],["matTooltip","Delete Subtask",1,"material-icons",3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"div",1),g.\u0275\u0275elementStart(6,"div",2),g.\u0275\u0275elementStart(7,"table",5),g.\u0275\u0275element(8,"caption",6),g.\u0275\u0275elementStart(9,"thead",7),g.\u0275\u0275elementStart(10,"th",8),g.\u0275\u0275elementStart(11,"i",9),g.\u0275\u0275listener("click",function(){return t.expandSubActivities(t.topActivity)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"i",10),g.\u0275\u0275listener("click",function(){return t.compressSubActivities(t.topActivity)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"th",11),g.\u0275\u0275text(14,"Name"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"th",12),g.\u0275\u0275text(16,"Est. Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"th",12),g.\u0275\u0275text(18,"Est. End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"th",13),g.\u0275\u0275text(20,"Est."),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"th",12),g.\u0275\u0275text(22,"Real Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"th",12),g.\u0275\u0275text(24,"Real End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"th",12),g.\u0275\u0275text(26,"Cost"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"th",13),g.\u0275\u0275text(28,"Prog."),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"th",13),g.\u0275\u0275text(30,"Spi"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"th",13),g.\u0275\u0275text(32,"Cpi"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"th",14),g.\u0275\u0275text(34,"Ressources"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(35,sn,1,0,"th",15),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"thead",7),g.\u0275\u0275element(37,"th",16),g.\u0275\u0275elementStart(38,"th",17),g.\u0275\u0275text(39," Total "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"th",18),g.\u0275\u0275text(41),g.\u0275\u0275pipe(42,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"th",18),g.\u0275\u0275text(44),g.\u0275\u0275pipe(45,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"th",19),g.\u0275\u0275text(47),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"th",18),g.\u0275\u0275text(49),g.\u0275\u0275pipe(50,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"th",18),g.\u0275\u0275text(52),g.\u0275\u0275pipe(53,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(54,"th",18),g.\u0275\u0275text(55),g.\u0275\u0275pipe(56,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"th",19),g.\u0275\u0275text(58),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(59,"th",19),g.\u0275\u0275text(60),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(61,"th",19),g.\u0275\u0275text(62),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(63,"th",20),g.\u0275\u0275text(64),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(65,ln,1,0,"th",21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(66,"span",22),g.\u0275\u0275template(67,hn,33,26,"tbody",23),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(11),g.\u0275\u0275property("hidden",t.isSubActivitiesDisplayed),g.\u0275\u0275advance(1),g.\u0275\u0275property("hidden",!t.isSubActivitiesDisplayed),g.\u0275\u0275advance(23),g.\u0275\u0275property("ngIf",t.isSuperAdminOrManagerOrDH()),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(42,15,t.topActivity.plannedStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(45,17,t.topActivity.plannedEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",t.topActivity.estimatedCharge," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(50,19,t.topActivity.realStartDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(53,21,t.topActivity.realEndDate)," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(56,23,t.topActivity.actualCost,"1.2-2")," "),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",t.topActivity.advancement," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",t.topActivity.spi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",t.topActivity.cpi," "),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",t.topActivity.usersName," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isSuperAdminOrManagerOrDH()),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngForOf",t.topActivity.subActivities))},directives:[i.NgIf,i.NgForOf,ne.gM],pipes:[_e.M,i.DecimalPipe],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.63rem .18rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0 .18rem;vertical-align:middle;position:relative;font-size:.875em}.th[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6;font-size:.9em}td[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6;height:40px}th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.tr[_ngcontent-%COMP%]{text-align:center}.pointer[_ngcontent-%COMP%]{cursor:pointer}tbody[_ngcontent-%COMP%]{overflow:auto;overflow-y:scroll;width:100%}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}thead[_ngcontent-%COMP%]{width:calc(100% - 1.2em)}.tbody[_ngcontent-%COMP%]{display:block;max-height:calc(100vh - 392px);height:auto;overflow:auto;overflow-y:scroll}.total[_ngcontent-%COMP%]{color:#000;text-align:center;background-color:#fafad2}.icone-total[_ngcontent-%COMP%]{color:#455a64}"]}),e})();var gn=n(70480);let fn=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.data=t,this.notificationService=n,this.activity=new m.cS,this.pager={},this.activity=this.data.activity}getLabelCssClass(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(l.WI),g.\u0275\u0275directiveInject(d.gq))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-display"]],decls:73,vars:10,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-border","table-xs"],[2,"padding","0px"],["scope",""],["colspan","2",1,"text-right"],["scope","col"],[1,"text-right",2,"padding-right","0"],[3,"className"],[2,"width","10px","padding-right","0"],[1,"kpi-tooltip"],[1,"material-icons"],[1,"kpi-tooltip-content"],[1,"kpi-tooltip-text"],[1,"kpi-tooltip-inner"],[2,"display","block"],[1,"li-danger"],[1,"li-default"],[1,"li-success"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"div",2),g.\u0275\u0275elementStart(5,"div",3),g.\u0275\u0275elementStart(6,"table",4),g.\u0275\u0275element(7,"caption",5),g.\u0275\u0275elementStart(8,"tbody"),g.\u0275\u0275elementStart(9,"tr"),g.\u0275\u0275elementStart(10,"th",6),g.\u0275\u0275text(11,"Charge:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(12,"td",7),g.\u0275\u0275text(13),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"tr"),g.\u0275\u0275elementStart(15,"th",8),g.\u0275\u0275text(16,"Duration:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"td",7),g.\u0275\u0275text(18),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"tr"),g.\u0275\u0275elementStart(20,"th",8),g.\u0275\u0275text(21,"Progress:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"td",7),g.\u0275\u0275text(23),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"tr"),g.\u0275\u0275elementStart(25,"th",8),g.\u0275\u0275text(26,"Actual Cost:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"td",7),g.\u0275\u0275text(28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"tr"),g.\u0275\u0275elementStart(30,"th",8),g.\u0275\u0275text(31,"SPI:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"td",9),g.\u0275\u0275elementStart(33,"label",10),g.\u0275\u0275text(34),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"td",11),g.\u0275\u0275elementStart(36,"a",12),g.\u0275\u0275elementStart(37,"em",13),g.\u0275\u0275text(38,"info_outline"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(39,"span",14),g.\u0275\u0275elementStart(40,"span",15),g.\u0275\u0275elementStart(41,"span",16),g.\u0275\u0275elementStart(42,"span",17),g.\u0275\u0275text(43,"Schedule Performance Index (SPI) :"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"ul"),g.\u0275\u0275elementStart(45,"li",18),g.\u0275\u0275text(46,"\xa0- SPI < 1 : ahead of schedule"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"li",19),g.\u0275\u0275text(48,"\xa0- SPI = 1 : on time"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(49,"li",20),g.\u0275\u0275text(50,"\xa0- SPI > 1 : behind schedule"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"tr"),g.\u0275\u0275elementStart(52,"th",8),g.\u0275\u0275text(53,"CPI:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(54,"td",9),g.\u0275\u0275elementStart(55,"label",10),g.\u0275\u0275text(56),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"td",11),g.\u0275\u0275elementStart(58,"a",12),g.\u0275\u0275elementStart(59,"em",13),g.\u0275\u0275text(60,"info_outline"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(61,"span",14),g.\u0275\u0275elementStart(62,"span",15),g.\u0275\u0275elementStart(63,"span",16),g.\u0275\u0275elementStart(64,"span",17),g.\u0275\u0275text(65,"Cost Performance Index (CPI) :"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(66,"ul"),g.\u0275\u0275elementStart(67,"li",18),g.\u0275\u0275text(68,"\xa0- CPI < 1 : over budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(69,"li",19),g.\u0275\u0275text(70,"\xa0- CPI = 1 : on budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(71,"li",20),g.\u0275\u0275text(72,"\xa0- CPI > 1 : under budget"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate2("",t.activity.name," [",t.activity.activityNumber,"]"),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate1("",t.activity.estimatedCharge," MD"),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",t.activity.plannedDuration," Days"),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",t.activity.advancement," %"),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",t.activity.actualCost," MD"),g.\u0275\u0275advance(5),g.\u0275\u0275property("className",t.getLabelCssClass(t.activity.spi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.activity.spi," "),g.\u0275\u0275advance(21),g.\u0275\u0275property("className",t.getLabelCssClass(t.activity.cpi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.activity.cpi," "))},styles:['.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important}.modal-header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal-body[_ngcontent-%COMP%]{overflow:hidden}.modal-title[_ngcontent-%COMP%]{color:#fff;line-height:1}.table[_ngcontent-%COMP%]{margin:0}.table.table-xs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table.table-xs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px}.td-kpi-value[_ngcontent-%COMP%]{padding-right:0}.td-kpi-info[_ngcontent-%COMP%]{width:10px;padding-right:0}.table-responsive[_ngcontent-%COMP%]{overflow:visible}.kpi-tooltip[_ngcontent-%COMP%]{display:inline;position:relative;z-index:999}.kpi-tooltip[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-text[_ngcontent-%COMP%]{transition-delay:0s;transform:scale(1)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-inner[_ngcontent-%COMP%]{transition-delay:.3s;transform:translate(0)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-content[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;transition-delay:0s}.kpi-tooltip-content[_ngcontent-%COMP%]{position:absolute;z-index:9999;width:220px;left:50%;bottom:100%;font-size:12px;line-height:1.4;font-weight:400;color:#fff;background:0 0;opacity:0;margin:0 0 20px -205px;cursor:default;pointer-events:none;-webkit-font-smoothing:antialiased;transition:opacity .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.kpi-tooltip-content[_ngcontent-%COMP%]:after{content:"";bottom:-20px;left:50%;border:solid transparent;height:0;width:0;position:absolute;pointer-events:none;border-color:#007bff transparent transparent;border-width:10px;margin-left:85px}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-text[_ngcontent-%COMP%]{border-bottom:10px solid #007bff;overflow:hidden;transform:scaleX(0);transition:transform .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]{background:#2b2b2b;padding:10px;transform:translateY(100%);transition:transform .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-danger[_ngcontent-%COMP%]{color:#ff5252}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-success[_ngcontent-%COMP%]{color:#11c15b}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-default[_ngcontent-%COMP%]{color:#d6d6d6}a.kpi-tooltip[_ngcontent-%COMP%]{font-weight:700;color:#007bff;z-index:9}']}),e})(),vn=(()=>{class e{constructor(){this.defaultColor="transparent"}ngOnInit(){switch(this.levelNumber){case 1:this.backgroungColor="#FFF7C2",this.borderColor="#FECB16";break;case 2:this.backgroungColor="#CCECFF",this.borderColor="#5AB6FF";break;case 3:this.backgroungColor="#D2ECD2",this.borderColor="#2B920E";break;case 4:this.backgroungColor="#E5D4EB",this.borderColor="#A02A95";break;case 5:this.backgroungColor="#FFD9DA",this.borderColor="#A62B39";break;default:this.backgroungColor=this.defaultColor,this.borderColor="#0000"}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=g.\u0275\u0275defineDirective({type:e,selectors:[["","activity-color",""]],hostVars:4,hostBindings:function(e,t){2&e&&g.\u0275\u0275styleProp("background-color",t.backgroungColor)("border-color",t.borderColor)},inputs:{defaultColor:"defaultColor",levelNumber:["activity-color","levelNumber"]}}),e})();const Sn=["activityCard"];function bn(e,t){1&e&&g.\u0275\u0275element(0,"div",15)}function Cn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",16),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",null==e.activity?null:e.activity.activityNumber,"\n")}}function yn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"tr",17),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onActivityClick()}),g.\u0275\u0275elementStart(1,"td",18),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" Charge: ",e.activity.estimatedCharge," MD ")}}function En(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"tr",19),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onActivityClick()}),g.\u0275\u0275elementStart(1,"td",20),g.\u0275\u0275elementStart(2,"label",21),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"label",22),g.\u0275\u0275text(5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"label",22),g.\u0275\u0275text(7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",e.activity.advancement,"% "),g.\u0275\u0275advance(1),g.\u0275\u0275property("className",e.getLabelCssClass(e.activity.spi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" SPI: ",e.activity.spi," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("className",e.getLabelCssClass(e.activity.cpi)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" CPI: ",e.activity.cpi," ")}}function xn(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"em",25),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).showChilds(!0)}),g.\u0275\u0275text(1," add_circle_outline"),g.\u0275\u0275elementEnd()}}function In(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"em",25),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).showChilds(!1)}),g.\u0275\u0275text(1," remove_circle_outline"),g.\u0275\u0275elementEnd()}}function wn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",23),g.\u0275\u0275template(1,xn,2,0,"em",24),g.\u0275\u0275template(2,In,2,0,"em",24),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!e.activity.showChilds),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.activity.showChilds)}}function Mn(e,t){1&e&&g.\u0275\u0275element(0,"div",15)}const Pn=function(e,t){return{"selected-activity":e,"small-size-activity":t}},Dn=function(e){return{"tr-actions-shown":e}},jn=function(e){return{"disabled-action":e}},On=function(e,t){return{"disabled-action":e,"danger-action":t}};let Fn=(()=>{class e{constructor(e,t,n){this.dialog=e,this.projectService=t,this.notificationService=n}showChilds(e){this.activity.showChilds=e}ngOnDestroy(){this.dialog.closeAll()}displayActivity(){const e={disableClose:!1,hasBackdrop:!0,width:"350px",height:"330px",data:{activity:this.activity}};this.onActivityClick(),this.displayActivityDialogRef=this.dialog.open(fn,e)}editActivity(){this.onActivityClick()}addActivity(){this.onActivityClick()}deleteActivity(){X().fire({text:"Are you sure to delete this activity ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.projectService.deleteActivity(this.activity.activityId).subscribe(()=>{this.projectService.ActivityDeleted.next(this.activity),this.notificationService.success("The task '"+this.activity.name+"' is deleted successfully !")},()=>{this.notificationService.danger("Delete activity failed")})}})}getLabelCssClass(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}onActivityClick(){this.activity.isSelected=!this.activity.isSelected,this.activity.isSelected&&this.projectService.ActivitySelected.emit(this.activity)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-oc-activity"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Sn,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.activityCard=e.first)}},inputs:{activity:"activity",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",smallSize:"smallSize"},decls:38,vars:22,consts:[["class","activity-h-bar line-border",4,"ngIf"],["class","div-number",4,"ngIf"],[1,"activity-card",3,"activity-color","ngClass"],["activityCard",""],[1,"activity-card-table"],[2,"padding","0px"],[1,"tr-name",3,"click"],["colspan","4","scope","col",1,"activity-name"],["class","tr-charge",3,"click",4,"ngIf"],["class","tr-kpi-advancement",3,"click",4,"ngIf"],[1,"tr-actions",3,"ngClass"],[3,"click"],[1,"material-icons"],[3,"ngClass","click"],["class","show-childs-icon",4,"ngIf"],[1,"activity-h-bar","line-border"],[1,"div-number"],[1,"tr-charge",3,"click"],["colspan","4",1,"activity-charge"],[1,"tr-kpi-advancement",3,"click"],["colspan","4"],[1,"badge","badge-info"],[3,"className"],[1,"show-childs-icon"],["class","material-icons",3,"click",4,"ngIf"],[1,"material-icons",3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,bn,1,0,"div",0),g.\u0275\u0275template(1,Cn,2,1,"div",1),g.\u0275\u0275elementStart(2,"div",2,3),g.\u0275\u0275elementStart(4,"table",4),g.\u0275\u0275element(5,"caption",5),g.\u0275\u0275elementStart(6,"tr",6),g.\u0275\u0275listener("click",function(){return t.onActivityClick()}),g.\u0275\u0275elementStart(7,"th",7),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(9,yn,3,1,"tr",8),g.\u0275\u0275template(10,En,8,5,"tr",9),g.\u0275\u0275elementStart(11,"tr",10),g.\u0275\u0275elementStart(12,"td",11),g.\u0275\u0275listener("click",function(){return t.displayActivity()}),g.\u0275\u0275elementStart(13,"em",12),g.\u0275\u0275text(14,"visibility"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(15,"br"),g.\u0275\u0275elementStart(16,"label"),g.\u0275\u0275text(17,"Display"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"td",11),g.\u0275\u0275listener("click",function(){return t.editActivity()}),g.\u0275\u0275elementStart(19,"em",12),g.\u0275\u0275text(20,"create"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(21,"br"),g.\u0275\u0275elementStart(22,"label"),g.\u0275\u0275text(23,"Edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"td",13),g.\u0275\u0275listener("click",function(){return!t.activity.hasAssignment&&5!=t.activity.level&&t.addActivity()}),g.\u0275\u0275elementStart(25,"em",12),g.\u0275\u0275text(26,"add"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(27,"br"),g.\u0275\u0275elementStart(28,"label"),g.\u0275\u0275text(29,"Add"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"td",13),g.\u0275\u0275listener("click",function(){return!t.activity.hasChilds&&t.deleteActivity()}),g.\u0275\u0275elementStart(31,"em",12),g.\u0275\u0275text(32,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(33,"br"),g.\u0275\u0275elementStart(34,"label"),g.\u0275\u0275text(35,"Delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(36,wn,3,2,"div",14),g.\u0275\u0275template(37,Mn,1,0,"div",0)),2&e&&(g.\u0275\u0275property("ngIf",t.activity.hasParent),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",1!=(null==t.activity?null:t.activity.level)),g.\u0275\u0275advance(1),g.\u0275\u0275property("activity-color",null==t.activity?null:t.activity.level)("ngClass",g.\u0275\u0275pureFunction2(12,Pn,t.activity.isSelected,t.smallSize&&!t.activity.isSelected)),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate1(" ",t.activity.name," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.smallSize||t.activity.isSelected),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.smallSize||t.activity.isSelected),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(15,Dn,t.activity.isSelected)),g.\u0275\u0275advance(13),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(17,jn,t.activity.hasAssignment||5==t.activity.level)),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction2(19,On,t.activity.hasChilds,!t.activity.hasChilds)),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngIf",t.activity.hasChilds),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.activity.hasChilds&&t.activity.showChilds))},directives:[i.NgIf,vn,i.NgClass],styles:["[_nghost-%COMP%]{margin:3px;display:flex;flex-direction:column;align-items:center}.activity-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1.5px solid;border-radius:6px;width:182px;height:100px;position:relative;transition-duration:1s}.selected-activity[_ngcontent-%COMP%]{height:140px}.small-size-activity[_ngcontent-%COMP%]{width:120px;height:50px}.activity-card-table[_ngcontent-%COMP%]{widows:180px;height:100px;border:1.5px;overflow:hidden;vertical-align:middle;text-align:center}.activity-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px #000}.activity-h-bar[_ngcontent-%COMP%]{height:.5em;z-index:2}.show-childs-icon[_ngcontent-%COMP%]{color:#555;cursor:pointer;z-index:1000}.line-border[_ngcontent-%COMP%]{border:1px solid gray}.div-number[_ngcontent-%COMP%]{font-family:sans-serif;font-size:11px}.tr-name[_ngcontent-%COMP%]{height:35px;vertical-align:middle}.tr-name[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:15px;font-family:sans-serif;font-weight:bold;color:#000}.tr-charge[_ngcontent-%COMP%]{height:20px;vertical-align:top}.tr-charge[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:sans-serif;font-size:12px;margin:3px}.tr-kpi-advancement[_ngcontent-%COMP%]{height:40px;vertical-align:top}.tr-actions[_ngcontent-%COMP%]{overflow:hidden;text-align:center;transition-duration:.2s;transition-delay:.2s;opacity:0;visibility:hidden}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:10px;padding:5px 5px 0;line-height:15px;overflow:hidden;z-index:10000;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#007bff}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#007bff}.tr-actions[_ngcontent-%COMP%]   .danger-action[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#dc3545}.tr-actions[_ngcontent-%COMP%]   .danger-action[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#dc3545}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]{cursor:not-allowed}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:gray}.tr-actions-shown[_ngcontent-%COMP%]{visibility:visible;opacity:1;transition-duration:.3s;transition-delay:.3s}.tr-actions-shown[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]{width:182px;height:100px}"]}),e})();function kn(e,t){if(1&e&&g.\u0275\u0275element(0,"app-oc-activity",2),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("activity",e.topActivity)("parentStartDate",e.topActivityStartDate)("parentEndDate",e.topActivityEndDate)("smallSize",e.smallSize)}}function An(e,t){if(1&e&&(g.\u0275\u0275elementContainerStart(0),g.\u0275\u0275elementStart(1,"div",5),g.\u0275\u0275elementStart(2,"div",6),g.\u0275\u0275element(3,"div",7),g.\u0275\u0275element(4,"div",8),g.\u0275\u0275element(5,"div",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(6,"app-org-chart",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementContainerEnd()),2&e){const e=t.$implicit,n=t.first,i=t.last,r=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(3),g.\u0275\u0275styleProp("border-color",n?"transparent":""),g.\u0275\u0275advance(2),g.\u0275\u0275styleProp("border-color",i?"transparent":""),g.\u0275\u0275advance(1),g.\u0275\u0275property("topActivity",e)("topActivityStartDate",r.topActivity.plannedStartDate)("topActivityEndDate",r.topActivity.plannedEndDate)("smallSize",r.smallSize)}}function _n(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",3),g.\u0275\u0275template(1,An,7,8,"ng-container",4),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("@expandCollapse",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",null==e.topActivity?null:e.topActivity.subActivities)}}let Vn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-org-chart"]],inputs:{topActivity:"topActivity",topActivityStartDate:"topActivityStartDate",topActivityEndDate:"topActivityEndDate",smallSize:"smallSize"},decls:2,vars:2,consts:[[3,"activity","parentStartDate","parentEndDate","smallSize",4,"ngIf"],["class","oc-reports","style","overflow: visible",4,"ngIf"],[3,"activity","parentStartDate","parentEndDate","smallSize"],[1,"oc-reports",2,"overflow","visible"],[4,"ngFor","ngForOf"],[1,"oc-org-container"],[1,"oc-h-bar-container"],[1,"oc-h-bar","oc-border"],[1,"oc-border"],[2,"margin-bottom","25px",3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,kn,1,4,"app-oc-activity",0),g.\u0275\u0275template(1,_n,2,2,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.topActivity),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.topActivity.showChilds))},directives:[i.NgIf,Fn,i.NgForOf,e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.oc-reports[_ngcontent-%COMP%]{display:flex;flex:1;overflow:visible}.oc-org-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.oc-h-bar-container[_ngcontent-%COMP%]{display:flex}.oc-h-bar[_ngcontent-%COMP%]{flex:1}.oc-border[_ngcontent-%COMP%]{border:1px solid gray}"],data:{animation:[gn.D]}}),e})();const Nn=["wbsContainer"];function Rn(e,t){if(1&e&&g.\u0275\u0275element(0,"app-org-chart",10),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("topActivity",e.topActivity)("topActivityStartDate",e.topActivity.plannedStartDate)("topActivityEndDate",e.topActivity.plannedEndDate)("smallSize",e.wbsService.smallSize)}}let Tn=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.notificationService=t,this.dtService=n,this.wbsService=i,this.topActivity=new m.cS,this.selectedActivity=new m.cS,this.displayChildsOffset=400}ngOnInit(){this.GetActivitiesById(this.project.projectId),this.projectService.ActivityDetailsChanged.subscribe(()=>{this.calculateWbsEstimCharge(this.topActivity),this.calculateWbsProgress(this.topActivity),this.calculateWbsAcwpBcwpKpis(this.topActivity)}),this.projectService.ActivitySelected.subscribe(e=>{this.deselectActivity(this.topActivity,e.activityId)}),this.addActivitySubscrip=this.projectService.ActivityAdded.subscribe(e=>{this.addActivity(e)}),this.deleteActivitySubscrip=this.projectService.ActivityDeleted.subscribe(e=>{this.deleteActivity(e)})}ngOnDestroy(){this.deleteActivitySubscrip.unsubscribe(),this.addActivitySubscrip.unsubscribe()}onResize(e){this.wbsService.onWbsContainerResize()}addActivity(e){const t=this.getParentActivity(e.activityNumber);t.subActivities.push(e),t.showChilds=!0,t.hasChilds=!0,e.hasParent=!0,this.calculateWbsAutoValues(),this.wbsService.autoZooming()}deleteActivity(e){const t=this.getParentActivity(e.activityNumber);t.subActivities=t.subActivities.filter(t=>t.activityId!==e.activityId),t.subActivities.length>0?this.updateSubActivitiesNumber(t):(t.estimatedCharge=0,t.advancement=0,t.hasChilds=!1),this.calculateWbsAutoValues()}GetActivitiesById(e){this.projectService.getProjectActivities(e).subscribe(e=>{const t=[];e.forEach(e=>{t.push(Object.assign(new m.cS,e))}),this.initializeTopActivity(t),this.calculateWbsAutoValues(),this.wbsService.init(this.wbsContainer,this.topActivity),this.wbsService.autoZooming()})}initializeTopActivity(e){this.topActivity.projectId=+this.project.projectId,this.topActivity.name=this.project.name,this.topActivity.plannedStartDate=this.project.plannedStartDate,this.topActivity.plannedEndDate=this.project.plannedEndDate,this.topActivity.description=this.project.description,this.topActivity.activityId=0,this.topActivity.level=1,this.topActivity.activityNumber="1",this.topActivity.showChilds=!0,this.topActivity.hasParent=!1,null!=e&&e.length>0&&(this.topActivity.subActivities=this.getSubActivities(e,this.topActivity),this.topActivity.hasChilds=this.topActivity.subActivities.length>0)}getSubActivities(e,t){const n=[];let i=1;return e.forEach(r=>{if(null===r.parentId&&(r.parentId=0),r.parentId===t.activityId){const a=new m.cS;a.projectId=r.projectId,a.activityId=r.activityId,a.parentId=r.parentId,a.name=r.name,a.description=r.description,a.activityNumber=t.activityNumber+"."+i.toString(),a.level=r.level+1,a.showChilds=r.level<2,a.hasAssignment=r.hasAssignment,a.estimatedCharge=r.estimatedCharge,a.plannedStartDate=r.plannedStartDate,a.plannedEndDate=r.plannedEndDate,a.advancement=r.advancement,a.actualCost=r.actualCost,a.realStartDate=r.realStartDate,a.realEndDate=r.realEndDate,a.hasParent=!0,a.subActivities=this.getSubActivities(e,a),a.hasChilds=a.subActivities.length>0,i++,n.push(a)}}),n}getParentActivity(e){const t=e.split(".");let n=this.topActivity;if(t.length>2)for(let i=1;i<t.length-1;i++)n=n.subActivities[+t[i]-1];return n}updateSubActivitiesNumber(e){for(let t=0;t<e.subActivities.length;t++)e.subActivities[t].activityNumber=e.activityNumber+"."+(t+1).toString(),e.subActivities[t].subActivities.length>0&&this.updateSubActivitiesNumber(e.subActivities[t])}calculateWbsAutoValues(){this.calculateWbsEstimCharge(this.topActivity),this.calculateWbsProgress(this.topActivity),this.calculateWbsStatus(this.topActivity),this.calculateWbsAcwpBcwpKpis(this.topActivity),this.calculateElapsedDuration(this.topActivity),this.calculateWbsSpiCpiKpis(this.topActivity),this.calculateWbsColumnNumber(this.topActivity),this.calculateWbsColumnNumberDisplayed(this.topActivity),this.calculateWbsMaxLevel(this.topActivity),this.calculateWbsMaxLevelDisplayed(this.topActivity)}calculateWbsEstimCharge(e){e.hasChilds&&(e.estimatedCharge=0,e.subActivities.forEach(t=>{this.calculateWbsEstimCharge(t),e.estimatedCharge+=+t.estimatedCharge}))}calculateWbsProgress(e){e.hasChilds&&e.estimatedCharge>0&&(e.advancement=0,e.subActivities.forEach(t=>{this.calculateWbsProgress(t),e.advancement+=t.estimatedCharge/e.estimatedCharge*t.advancement}),e.advancement=+e.advancement.toFixed())}calculateWbsStatus(e){e.status=this.dtService.isAfter(e.plannedStartDate,this.dtService.today())?m.fU.NotStarted:100===e.advancement?m.fU.Completed:m.fU.Started,e.hasChilds&&e.subActivities.forEach(e=>{this.calculateWbsStatus(e)})}calculateWbsAcwpBcwpKpis(e){e.hasChilds?(e.actualCost=0,e.earnedValue=0,e.subActivities.forEach(t=>{this.calculateWbsAcwpBcwpKpis(t),e.actualCost+=t.actualCost,e.earnedValue+=t.earnedValue})):e.earnedValue=+(e.advancement/100*e.estimatedCharge).toFixed(2)}calculateWbsSpiCpiKpis(e){e.spi=e.elapsedDuration>0?+(e.advancement/100*e.plannedDuration/e.elapsedDuration).toFixed(2):0,e.cpi=e.actualCost>0?+(e.earnedValue/e.actualCost).toFixed(2):0,e.hasChilds&&e.subActivities.forEach(e=>{this.calculateWbsSpiCpiKpis(e)})}calculateElapsedDuration(e){switch(e.status){case m.fU.NotStarted:e.elapsedDuration=0;break;case m.fU.Started:e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,this.dtService.today(),!1);break;case m.fU.Completed:if(e.hasChilds){let t=null;e.subActivities.forEach(e=>{this.calculateElapsedDuration(e),100===e.advancement&&(t=this.dtService.getMaxDate(t,e.realEndDate))}),e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,t),e.realEndDate=t}else e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,e.realEndDate)}e.hasChilds&&e.subActivities.forEach(e=>{this.calculateElapsedDuration(e)})}calculateWbsColumnNumber(e){e.hasChilds?(e.columnNumber=0,e.subActivities.forEach(t=>{this.calculateWbsColumnNumber(t),e.columnNumber+=t.columnNumber})):e.columnNumber=1}calculateWbsColumnNumberDisplayed(e){e.hasChilds&&e.showChilds?(e.columnNumberDisplayed=0,e.subActivities.forEach(t=>{this.calculateWbsColumnNumberDisplayed(t),e.columnNumberDisplayed+=t.columnNumberDisplayed})):e.columnNumberDisplayed=1}calculateWbsMaxLevel(e){e.hasChilds?(e.maxLevel=0,e.subActivities.forEach(t=>{this.calculateWbsMaxLevel(t),e.maxLevel=Math.max(e.maxLevel,+t.level)})):e.maxLevel=+e.level}calculateWbsMaxLevelDisplayed(e){e.hasChilds&&e.showChilds?(e.maxLevelDisplayed=0,e.subActivities.forEach(t=>{this.calculateWbsMaxLevelDisplayed(t),e.maxLevelDisplayed=Math.max(e.maxLevelDisplayed,t.maxLevelDisplayed)})):e.maxLevelDisplayed=+e.level}showAllChilds(){this.topActivity.hasChilds&&(this.showChilds(this.topActivity,0),this.topActivity.columnNumberDisplayed=this.topActivity.columnNumber)}showChilds(e,t){if(setTimeout(()=>{e.showChilds=!0},t),e.hasChilds){const n=t+this.displayChildsOffset;e.subActivities.forEach(e=>{this.showChilds(e,n)})}}hideAllChilds(){this.topActivity.hasChilds&&(this.calculateWbsMaxLevelDisplayed(this.topActivity),this.hideChilds(this.topActivity,this.displayChildsOffset*(this.topActivity.maxLevelDisplayed-1)))}hideChilds(e,t){if(setTimeout(()=>{e.showChilds=!1},t),e.hasChilds){const n=t-this.displayChildsOffset;e.subActivities.forEach(e=>{this.hideChilds(e,n)})}}autoSizing(){this.calculateWbsColumnNumberDisplayed(this.topActivity),this.wbsService.autoSizing()}zoomIn(){this.wbsService.zoomIn()}zoomOut(){this.wbsService.zoomOut()}moveLeft(){this.wbsService.moveLeft()}moveRight(){this.wbsService.moveRight()}deselectActivity(e,t){e.isSelected=e.activityId===t,e.hasChilds&&e.subActivities.forEach(e=>{this.deselectActivity(e,t)})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(p.Bo))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-wbs"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Nn,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.wbsContainer=e.first)}},hostBindings:function(e,t){1&e&&g.\u0275\u0275listener("resize",function(e){return t.onResize(e)},!1,g.\u0275\u0275resolveWindow)},inputs:{project:"project"},decls:23,vars:5,consts:[[1,"row","m-b-15","m-t-15"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"wbs-actions"],[3,"click"],[1,"wbs-container"],[1,"col-md-12","wbs-transition"],["wbsContainer",""],[3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize",4,"ngIf"],[3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.moveLeft()}),g.\u0275\u0275text(6,"chevron_left"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.moveRight()}),g.\u0275\u0275text(8,"chevron_right"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.hideAllChilds()}),g.\u0275\u0275text(10,"unfold_less"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.showAllChilds()}),g.\u0275\u0275text(12,"unfold_more"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.autoSizing()}),g.\u0275\u0275text(14,"zoom_out_map"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.zoomOut()}),g.\u0275\u0275text(16,"zoom_out"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"mat-icon",5),g.\u0275\u0275listener("click",function(){return t.zoomIn()}),g.\u0275\u0275text(18,"zoom_in"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"div",6),g.\u0275\u0275elementStart(20,"div",7,8),g.\u0275\u0275template(22,Rn,1,4,"app-org-chart",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(20),g.\u0275\u0275styleProp("zoom",t.wbsService.zoomValue,"%")("transform","translateX("+t.wbsService.translateValue+"px)"),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.topActivity))},directives:[Ae.Hw,i.NgIf,Vn],styles:[".wbs-container[_ngcontent-%COMP%]{padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#3f629d;padding:13px;color:#fff;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.card-body[_ngcontent-%COMP%]{padding:25px}table[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border:1px solid #BBBBBB}.tr-project[_ngcontent-%COMP%]{text-align:left;color:#fff;font-weight:600}.generic[_ngcontent-%COMP%]{background-color:#8e0089}.non-generic[_ngcontent-%COMP%]{background-color:#5489a5}.th-days[_ngcontent-%COMP%]{background-color:#069;color:#fff}.th-totals[_ngcontent-%COMP%]{background-color:#ccc;color:#000}.td-total-activity[_ngcontent-%COMP%]{font-weight:600;color:#000}mat-icon[_ngcontent-%COMP%]{cursor:pointer}.select-current-week[_ngcontent-%COMP%]{color:#3f629d}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] + tbody[_ngcontent-%COMP%]{border-top:0px}.select-row[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:40px}.label[_ngcontent-%COMP%]{padding:5px}.f-w-600[_ngcontent-%COMP%]{cursor:pointer}.modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer;margin:0}.modal-close[_ngcontent-%COMP%]:hover{color:red}.md-dialog-container[_ngcontent-%COMP%]{width:1400px;height:700px}"]}),e})();var Bn=n(4885),zn=n(55750),qn=n(39924),Ln=n(11494),Qn=n(32789);function $n(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Resource"),g.\u0275\u0275elementEnd())}function Un(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",27),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.userName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.userName)}}function Hn(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Qualification"),g.\u0275\u0275elementEnd())}function Gn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",27),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.userQualification),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.userQualification)}}function Wn(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Role"),g.\u0275\u0275elementEnd())}function Jn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",27),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.userRole),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.userRole)}}function Yn(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Year"),g.\u0275\u0275elementEnd())}function Kn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.year," ")}}function Xn(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Jan"),g.\u0275\u0275elementEnd())}function Zn(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month1," ",e.currencySymbol," ")}}function ei(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Feb"),g.\u0275\u0275elementEnd())}function ti(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month2," ",e.currencySymbol," ")}}function ni(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Mar"),g.\u0275\u0275elementEnd())}function ii(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month3," ",e.currencySymbol," ")}}function ri(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Apr"),g.\u0275\u0275elementEnd())}function ai(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month4," ",e.currencySymbol," ")}}function oi(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"May"),g.\u0275\u0275elementEnd())}function si(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month5," ",e.currencySymbol," ")}}function li(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Jun"),g.\u0275\u0275elementEnd())}function ci(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month6," ",e.currencySymbol," ")}}function di(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Jul"),g.\u0275\u0275elementEnd())}function mi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month7," ",e.currencySymbol," ")}}function pi(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Aug"),g.\u0275\u0275elementEnd())}function hi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month8," ",e.currencySymbol," ")}}function ui(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Sep"),g.\u0275\u0275elementEnd())}function gi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month9," ",e.currencySymbol," ")}}function fi(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Oct"),g.\u0275\u0275elementEnd())}function vi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month10," ",e.currencySymbol," ")}}function Si(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Nov"),g.\u0275\u0275elementEnd())}function bi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month11," ",e.currencySymbol," ")}}function Ci(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",25),g.\u0275\u0275text(1,"Dec"),g.\u0275\u0275elementEnd())}function yi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.month12," ",e.currencySymbol," ")}}function Ei(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function xi(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",28),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275elementStart(2,"em",29),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(4," \xa0\xa0 "),g.\u0275\u0275elementStart(5,"button",30),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().deletePrice(t)}),g.\u0275\u0275elementStart(6,"em",29),g.\u0275\u0275text(7,"delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",!n.allowDeletePrice(e.userQuit))}}function Ii(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",31)}function wi(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}let Mi=(()=>{class e{constructor(e,t,n,i){this.invoicingService=e,this.notificationService=t,this.dialog=n,this.searchFilterService=i,this.displayedColumns=["userName","userQualification","userRole","year","month1","month2","month3","month4","month5","month6","month7","month8","month9","month10","month11","month12","buttons"],this.dataSource=new Qn.by,this.priceState=new g.EventEmitter}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditPrice=!1,this.listView=!0,this.dataSource=new Qn.by(this.prices),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}ngAfterViewInit(){this.dataSource.sort=this.sort}toggleEditDetails(e){this.isEditPrice=!0,this.priceState.emit(e)}deletePrice(e){X().fire({text:"Are you sure to delete this price?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.invoicingService.deleteUserPrices(e.priceId).subscribe(()=>{this.notificationService.success("User prices deleted"),this.invoicingService.reloadPrices.next()},()=>{this.notificationService.danger("Delete prices failed")})}})}onSortData(e){this.invoicingService.sortPrices.next(e)}allowDeletePrice(e){return(null==this.isvisibleEditProject||this.isvisibleEditProject)&&0===e}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-prices"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ln.YE,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{project:"project",prices:"prices",priceEditable:"priceEditable",isvisibleEditProject:"isvisibleEditProject"},outputs:{priceState:"priceState"},decls:55,vars:4,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","userName"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","userQualification"],["matColumnDef","userRole"],["matColumnDef","year"],[4,"matCellDef"],["matColumnDef","month1"],["matColumnDef","month2"],["matColumnDef","month3"],["matColumnDef","month4"],["matColumnDef","month5"],["matColumnDef","month6"],["matColumnDef","month7"],["matColumnDef","month8"],["matColumnDef","month9"],["matColumnDef","month10"],["matColumnDef","month11"],["matColumnDef","month12"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit price",1,"btn","btn-mini","btn-primary","ripple","f-center","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete price",1,"btn","btn-mini","btn-danger","ripple","f-center","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-table",0,1),g.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),g.\u0275\u0275elementContainerStart(2,2),g.\u0275\u0275template(3,$n,2,0,"mat-header-cell",3),g.\u0275\u0275template(4,Un,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(5,5),g.\u0275\u0275template(6,Hn,2,0,"mat-header-cell",3),g.\u0275\u0275template(7,Gn,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(8,6),g.\u0275\u0275template(9,Wn,2,0,"mat-header-cell",3),g.\u0275\u0275template(10,Jn,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(11,7),g.\u0275\u0275template(12,Yn,2,0,"mat-header-cell",3),g.\u0275\u0275template(13,Kn,2,1,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(14,9),g.\u0275\u0275template(15,Xn,2,0,"mat-header-cell",3),g.\u0275\u0275template(16,Zn,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(17,10),g.\u0275\u0275template(18,ei,2,0,"mat-header-cell",3),g.\u0275\u0275template(19,ti,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(20,11),g.\u0275\u0275template(21,ni,2,0,"mat-header-cell",3),g.\u0275\u0275template(22,ii,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(23,12),g.\u0275\u0275template(24,ri,2,0,"mat-header-cell",3),g.\u0275\u0275template(25,ai,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(26,13),g.\u0275\u0275template(27,oi,2,0,"mat-header-cell",3),g.\u0275\u0275template(28,si,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(29,14),g.\u0275\u0275template(30,li,2,0,"mat-header-cell",3),g.\u0275\u0275template(31,ci,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(32,15),g.\u0275\u0275template(33,di,2,0,"mat-header-cell",3),g.\u0275\u0275template(34,mi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(35,16),g.\u0275\u0275template(36,pi,2,0,"mat-header-cell",3),g.\u0275\u0275template(37,hi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(38,17),g.\u0275\u0275template(39,ui,2,0,"mat-header-cell",3),g.\u0275\u0275template(40,gi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(41,18),g.\u0275\u0275template(42,fi,2,0,"mat-header-cell",3),g.\u0275\u0275template(43,vi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(44,19),g.\u0275\u0275template(45,Si,2,0,"mat-header-cell",3),g.\u0275\u0275template(46,bi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(47,20),g.\u0275\u0275template(48,Ci,2,0,"mat-header-cell",3),g.\u0275\u0275template(49,yi,2,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(50,21),g.\u0275\u0275template(51,Ei,1,0,"mat-header-cell",22),g.\u0275\u0275template(52,xi,8,1,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(53,Ii,1,0,"mat-header-row",23),g.\u0275\u0275template(54,wi,1,0,"mat-row",24),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275property("dataSource",t.dataSource),g.\u0275\u0275advance(53),g.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,Qn.XQ,Qn.Gk],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-userName[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-userQualification[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-userRole[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-year[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month1[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month2[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month3[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month4[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month5[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month6[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month7[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month8[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month9[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month10[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month11[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month12[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e})();var Pi=n(90046),Di=n(64576);const ji=["priceDetailsForm"];function Oi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",18),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.memberName," ")}}function Fi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",18),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ki(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",18),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let Ai=(()=>{class e{constructor(e,t,n){this.projectService=e,this.notificationService=t,this.invoicingService=n,this.isSavedPrice=new g.EventEmitter,this.mutliClickDisable=!1,this.servicesDisabled=!1,this.projectMembers=[],this.selectedProjectMembers=[],this.months=[{id:1,description:"January"},{id:2,description:"February"},{id:3,description:"Mars"},{id:4,description:"April"},{id:5,description:"May"},{id:6,description:"June"},{id:7,description:"July"},{id:8,description:"August"},{id:9,description:"September"},{id:10,description:"October"},{id:11,description:"November"},{id:12,description:"December"}],this.fromMonth={id:1,description:"January"},this.toMonth={id:12,description:"December"}}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.year=this.isEditPrice?this.selectedPrice.year:(new Date).getFullYear(),this.isNewPrice=!this.isEditPrice,this.yearMin=(new Date).getFullYear()-10,this.yearMax=(new Date).getFullYear()+10,this.getProjectMembers(this.project.pifId)}getProjectMembers(e){this.projectService.getPifProjectMembers(e).subscribe(e=>{if(this.projectMembers=[],e.forEach(e=>{this.projectMembers.push(Object.assign(new m.J3,e))}),this.isEditPrice){let e=this.projectMembers.find(e=>e.memberId===+this.selectedPrice.userId);void 0===e&&(e=new m.J3,e.memberId=+this.selectedPrice.userId,e.memberName=this.selectedPrice.userName),this.projectMembers.push(e),this.projectMembers.sort((e,t)=>e.memberName.localeCompare(t.memberName)),this.selectedProjectMembers.push(e),this.detailsForm.controls.selectedProjectMembers.disable()}})}save(){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3),this.validPrice()&&this.invoicingService.saveUsersPrices(this.getNewPrice()).subscribe(e=>{0!==e?(this.notificationService.success("Prices saved successfully"),this.isSavedPrice.emit(!0)):this.notificationService.danger("Prices not saved!")},()=>{this.notificationService.danger("Prices not saved!")})}validPrice(){if(this.detailsForm.valid)if(this.fromMonth.id<=this.toMonth.id){if(this.year>=this.yearMin&&this.year<=this.yearMax)return!0;this.notificationService.danger(`Year must be between ${this.yearMin} and ${this.yearMax}!`)}else this.notificationService.danger("To Month must be greater than From Month!");else this.notificationService.danger("Please fill all required fields!");return!1}getNewPrice(){const e=new Pi.tA;return e.projectId=this.project.projectId,e.userId=this.selectedProjectMembers.map(e=>e.memberId).join(","),e.year=this.year,e.month1=this.getMonthPrice(1),e.month2=this.getMonthPrice(2),e.month3=this.getMonthPrice(3),e.month4=this.getMonthPrice(4),e.month5=this.getMonthPrice(5),e.month6=this.getMonthPrice(6),e.month7=this.getMonthPrice(7),e.month8=this.getMonthPrice(8),e.month9=this.getMonthPrice(9),e.month10=this.getMonthPrice(10),e.month11=this.getMonthPrice(11),e.month12=this.getMonthPrice(12),e}getMonthPrice(e){return this.fromMonth.id<=e&&this.toMonth.id>=e?+this.monthPrice:-1}yearChanged(e){this.year=new Date(e).getFullYear()}numberOnly(e){const t=e.which?e.which:e.keyCode;return!(t>31&&(t<44||t>57)||45===t||47===t)}onCancel(){this.isSavedPrice.emit(!0)}allowSavePrice(){return null==this.isvisibleEditProject||this.isvisibleEditProject}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(ke.X))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-price"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(ji,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.detailsForm=e.first)}},inputs:{project:"project",isNewPrice:"isNewPrice",isEditPrice:"isEditPrice",selectedPrice:"selectedPrice",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedPrice:"isSavedPrice"},decls:29,vars:12,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"main-color","card-header"],[1,"card-header-text",2,"color","white"],[1,"card-body"],["id","priceDetailsForm"],["priceDetailsForm","ngForm"],["placeholder","Project Members","name","selectedProjectMembers","multiple","","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-3"],[3,"enabled","year","displayPlaceHolder","yearChange"],["placeholder","From Month","name","fromMonth","required","",3,"ngModel","ngModelChange"],["placeholder","To Month","name","toMonth","required","",3,"ngModel","ngModelChange"],["placeholder","Price","matInput","","name","monthPrice","required","","appNumberValidator","",3,"ngModel","inputValue","ngModelChange","keypress"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"h5",4),g.\u0275\u0275text(5," Add / Update Price "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"form",6,7),g.\u0275\u0275elementStart(9,"div",0),g.\u0275\u0275elementStart(10,"mat-form-field",1),g.\u0275\u0275elementStart(11,"mat-select",8),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedProjectMembers=e}),g.\u0275\u0275template(12,Oi,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"div",0),g.\u0275\u0275elementStart(14,"div",10),g.\u0275\u0275elementStart(15,"app-input-year",11),g.\u0275\u0275listener("yearChange",function(e){return t.yearChanged(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",10),g.\u0275\u0275elementStart(17,"mat-select",12),g.\u0275\u0275listener("ngModelChange",function(e){return t.fromMonth.id=e}),g.\u0275\u0275template(18,Fi,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"mat-form-field",10),g.\u0275\u0275elementStart(20,"mat-select",13),g.\u0275\u0275listener("ngModelChange",function(e){return t.toMonth.id=e}),g.\u0275\u0275template(21,ki,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"mat-form-field",10),g.\u0275\u0275elementStart(23,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.monthPrice=e})("keypress",function(e){return t.numberOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"div",15),g.\u0275\u0275elementStart(25,"button",16),g.\u0275\u0275listener("click",function(){return t.save()}),g.\u0275\u0275text(26,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"button",17),g.\u0275\u0275listener("click",function(){return t.onCancel()}),g.\u0275\u0275text(28,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(11),g.\u0275\u0275property("ngModel",t.selectedProjectMembers),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.projectMembers),g.\u0275\u0275advance(3),g.\u0275\u0275property("enabled",t.isNewPrice)("year",t.year)("displayPlaceHolder",!0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.fromMonth.id),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.months),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.toMonth.id),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.months),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.monthPrice)("inputValue",t.monthPrice),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",!t.allowSavePrice()||t.mutliClickDisable))},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,y.gD,o.RequiredValidator,o.NgControlStatus,o.NgModel,i.NgForOf,Di.G,C.Nt,o.DefaultValueAccessor,ze.z,x.ey],styles:["form[_ngcontent-%COMP%]{padding:10px 20px}.main-color[_ngcontent-%COMP%]{background:#3f629d}"]}),e})();var _i=n(34239);function Vi(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",2),g.\u0275\u0275elementStart(1,"div",3),g.\u0275\u0275elementStart(2,"nav",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"button",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().AddPriceView()}),g.\u0275\u0275element(5,"em",7),g.\u0275\u0275text(6," Price "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",8),g.\u0275\u0275element(8,"app-paginator",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",e.searchFilterService.pageSize)("pageIndex",e.searchFilterService.pageIndex)("length",e.lengthPrices)}}function Ni(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-prices",11),g.\u0275\u0275listener("priceState",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("prices",g.\u0275\u0275pipeBind3(2,3,e.prices,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function Ri(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-edit-price",12),g.\u0275\u0275listener("isSavedPrice",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().savedPrice(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isNewPrice",!e.listView)("isEditPrice",e.isEditPrice)("selectedPrice",e.selectedPrice)("isvisibleEditProject",e.isvisibleEditProject)}}let Ti=(()=>{class e{constructor(e,t,n){this.sortService=e,this.invoicingService=t,this.searchFilterService=n,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.subscription=new c.w0}ngOnInit(){this.listView=!0,this.isEditPrice=!1,this.subscription.add(this.invoicingService.sortPrices.subscribe(e=>{this.onSortData(e)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.getPricesByProject(),this.subscription.add(this.invoicingService.reloadPrices.subscribe(()=>{this.getPricesByProject()}))}ngOnDestroy(){this.subscription.unsubscribe()}AddPriceView(){this.listView=!1,this.isEditPrice=!1}toggleEditDetails(e){this.isEditPrice=!0,this.selectedPrice=e}savedPrice(e){this.invoicingService.getPricesByProject(this.project.projectId).subscribe(t=>{this.prices=t,this.listView=e,this.isEditPrice=!e,this.lengthPrices=this.prices.length})}getPricesByProject(){this.invoicingService.getPricesByProject(this.project.projectId).subscribe(e=>{this.prices=e,this.lengthPrices=this.prices.length})}onSortData(e){e.active&&""!==e.direction&&void 0!==this.prices&&this.prices.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"userName":return this.sortService.compare(t.userName,n.userName,i,!1);case"userQualification":return this.sortService.compare(t.userQualification,n.userQualification,i,!1);case"userRole":return this.sortService.compare(t.userRole,n.userRole,i,!1);case"year":return this.sortService.compare(t.year,n.year,i,!0);case"month1":return this.sortService.compare(t.month1,n.month1,i,!0);case"month2":return this.sortService.compare(t.month2,n.month2,i,!0);case"month3":return this.sortService.compare(t.month3,n.month3,i,!0);case"month4":return this.sortService.compare(t.month4,n.month4,i,!0);case"month5":return this.sortService.compare(t.month5,n.month5,i,!0);case"month6":return this.sortService.compare(t.month6,n.month6,i,!0);case"month7":return this.sortService.compare(t.month7,n.month7,i,!0);case"month8":return this.sortService.compare(t.month8,n.month8,i,!0);case"month9":return this.sortService.compare(t.month9,n.month9,i,!0);case"month10":return this.sortService.compare(t.month10,n.month10,i,!0);case"month11":return this.sortService.compare(t.month11,n.month11,i,!0);case"month12":return this.sortService.compare(t.month12,n.month12,i,!0);default:return 0}}),this.paginatorPipe.transform(this.prices,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-price"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-edit"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"prices","project","isvisibleEditProject","priceState"],[3,"project","isNewPrice","isEditPrice","selectedPrice","isvisibleEditProject","isSavedPrice"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,Vi,9,4,"div",0),g.\u0275\u0275template(1,Ni,3,7,"div",1),g.\u0275\u0275template(2,Ri,2,5,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.listView&&!t.isEditPrice),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView&&!t.isEditPrice),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.listView||t.isEditPrice))},directives:[i.NgIf,ft.M2,qn.J,Mi,Ai],pipes:[_i.R],encapsulation:2}),e})();var Bi=n(60657),zi=n(42352),qi=n(88136);function Li(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",2),g.\u0275\u0275elementStart(1,"div",3),g.\u0275\u0275elementStart(2,"nav",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"button",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().AddEstimateView()}),g.\u0275\u0275element(5,"em",7),g.\u0275\u0275text(6," Quotation "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",8),g.\u0275\u0275element(8,"app-paginator",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",e.searchFilterService.pageSize)("pageIndex",e.searchFilterService.pageIndex)("length",e.lengthEstimates)}}function Qi(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-estimates",11),g.\u0275\u0275listener("estimateState",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("contractDetails",!1)("estimates",g.\u0275\u0275pipeBind3(2,4,e.estimates,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("project",e.projects)("isvisibleEditProject",e.isvisibleEditProject)}}function $i(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-edit-estimate",12),g.\u0275\u0275listener("isSavedEstimate",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().savedEstimate(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isNewEstimate",!e.listView)("isEditEstimate",e.isEditEstimate)("selectedEstimate",e.selectedEstimate)("isvisibleEditProject",e.isvisibleEditProject)}}let Ui=(()=>{class e{constructor(e,t,n,i){this.sortService=e,this.invoicingService=t,this._avRoute=n,this.searchFilterService=i,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.estimateEditable=!1,this.subscription=new c.w0}ngOnInit(){const e=this._avRoute.snapshot.paramMap.get("title");null!=e&&"estimates"===e?(this.listView=!1,this.isEditEstimate=!0):(this.listView=!0,this.isEditEstimate=!1),this.subscription.add(this.invoicingService.sortEstimates.subscribe(e=>{this.onSortData(e)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.projects=this.project,this.getEstimateListByProject(),this.subscription.add(this.invoicingService.reloadEstimates.subscribe(e=>{this.getEstimateListByProject()}))}ngOnDestroy(){this.subscription.unsubscribe()}AddEstimateView(){this.listView=!1,this.isEditEstimate=!1}toggleEditDetails(e){this.isEditEstimate=!0,this.selectedEstimate=e}savedEstimate(e){this.invoicingService.getEstimateListByProject(this.project.projectId).subscribe(t=>{this.estimates=t,this.listView=e,this.isEditEstimate=!e,this.lengthEstimates=this.estimates.length})}getEstimateListByProject(){this.invoicingService.getEstimateListByProject(this.project.projectId).subscribe(e=>{this.estimates=e,this.lengthEstimates=this.estimates.length})}onSortData(e){e.active&&""!==e.direction&&void 0!==this.estimates&&this.estimates.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"estimateReference":return this.sortService.compare(t.estimateReference,n.estimateReference,i,!1);case"estimateDesc":return this.sortService.compare(t.estimateDesc,n.estimateDesc,i,!1);case"estimateEdit":return this.sortService.compare(t.estimateEdit,n.estimateEdit,i,!1);case"estimateDate":return this.sortService.compare(t.estimateDate,n.estimateDate,i,!1);case"clientName":return this.sortService.compare(t.clientName,n.clientName,i,!1);case"estimateState":return this.sortService.compare(t.estimateState,n.estimateState,i,!1);case"contractReference":return this.sortService.compare(t.contractReference,n.contractReference,i,!1);case"orderDate":return this.sortService.compare(t.orderDate,n.orderDate,i,!1);case"amount":return this.sortService.compare(t.estimateAmount,n.estimateAmount,i,!0);default:return 0}}),this.paginatorPipe.transform(this.estimates,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(Bi.K),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-estimate"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"contractDetails","estimates","project","isvisibleEditProject","estimateState"],[3,"project","isNewEstimate","isEditEstimate","selectedEstimate","isvisibleEditProject","isSavedEstimate"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,Li,9,4,"div",0),g.\u0275\u0275template(1,Qi,3,8,"div",1),g.\u0275\u0275template(2,$i,2,5,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.listView&&!t.isEditEstimate),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView&&!t.isEditEstimate),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.listView||t.isEditEstimate))},directives:[i.NgIf,ft.M2,qn.J,zi.N,qi.c],pipes:[_i.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.wbs-container[_ngcontent-%COMP%]{min-height:75vh;padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.ngb-accordion[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding-left:5px}.ngb-accordion[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .a[_ngcontent-%COMP%]{font-size:15px}"]}),e})();var Hi=n(17224);function Gi(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Order Reference"),g.\u0275\u0275elementEnd())}function Wi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",19),g.\u0275\u0275elementStart(1,"span",20),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.contractReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.contractReference)}}function Ji(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Quotation Reference"),g.\u0275\u0275elementEnd())}function Yi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",19),g.\u0275\u0275elementStart(1,"span",20),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.estimateRef),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1("",e.estimateRef," ")}}function Ki(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Followed By"),g.\u0275\u0275elementEnd())}function Xi(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",19),g.\u0275\u0275elementStart(1,"span",20),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.contractName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.contractName,"")}}function Zi(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Type"),g.\u0275\u0275elementEnd())}function er(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.contractTypeName," ")}}function tr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Date"),g.\u0275\u0275elementEnd())}function nr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.contractDate)," ")}}function ir(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Amount"),g.\u0275\u0275elementEnd())}function rr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"numberForm"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.contractAmount)," ")}}function ar(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Conforme?"),g.\u0275\u0275elementEnd())}function or(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.offreConfDesc,"")}}function sr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1," Addressed to "),g.\u0275\u0275elementEnd())}function lr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.contractClientRef," ")}}function cr(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function dr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",21),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().EditDetails(t)}),g.\u0275\u0275elementStart(2,"em",22),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(4," \xa0\xa0 "),g.\u0275\u0275elementStart(5,"button",23),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().deleteOrder(t.contractId)}),g.\u0275\u0275elementStart(6,"em",22),g.\u0275\u0275text(7,"delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",!e.isvisibleEditProject)}}function mr(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",24)}function pr(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}let hr=(()=>{class e{constructor(e,t,n,i){this.searchFilterService=e,this.invoicingService=t,this.notificationService=n,this.dialog=i,this.displayedColumns=["Contract-Reference","Estimate-Reference","Name","Reference-Client","Amount","Type","Date","Conforme","buttons"],this.dataSource=new Qn.by,this.OrderState=new g.EventEmitter,this.isEditableOrder=!1}ngOnInit(){this.listView=!0,this.user=JSON.parse(localStorage.getItem("currentUser")),this.dataSource=new Qn.by(this.orders),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}ngAfterViewInit(){this.dataSource.sort=this.sort}EditDetails(e){this.isEditableOrder=!0,this.OrderState.emit(e),this.selectedOrder=e}deleteOrder(e){this.invoicingService.getContractBatches(e).subscribe(t=>{0===t[0].batchesCount?X().fire({text:"Are you sure to delete this order ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.invoicingService.deleteConract(e).subscribe(()=>{this.invoicingService.reloadOrders.next(),this.notificationService.success("This Order is deleted")},()=>{this.notificationService.danger("Delete order failed")})}}):this.notificationService.danger("Delete order failed,this order has a batch")})}onSortData(e){this.invoicingService.sortOrders.next(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.uw))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-orders"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ln.YE,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{project:"project",orders:"orders",orderEditable:"orderEditable",isvisibleEditProject:"isvisibleEditProject"},outputs:{OrderState:"OrderState"},decls:32,vars:4,consts:[[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","Contract-Reference"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","Estimate-Reference"],["matColumnDef","Name"],["matColumnDef","Type"],[4,"matCellDef"],["matColumnDef","Date"],["matColumnDef","Amount"],["matColumnDef","Conforme"],["matColumnDef","Reference-Client"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit Order",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete order ",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"mat-table",1,2),g.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),g.\u0275\u0275elementContainerStart(3,3),g.\u0275\u0275template(4,Gi,2,0,"mat-header-cell",4),g.\u0275\u0275template(5,Wi,3,2,"mat-cell",5),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,6),g.\u0275\u0275template(7,Ji,2,0,"mat-header-cell",4),g.\u0275\u0275template(8,Yi,3,2,"mat-cell",5),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,7),g.\u0275\u0275template(10,Ki,2,0,"mat-header-cell",4),g.\u0275\u0275template(11,Xi,3,2,"mat-cell",5),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,8),g.\u0275\u0275template(13,Zi,2,0,"mat-header-cell",4),g.\u0275\u0275template(14,er,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,10),g.\u0275\u0275template(16,tr,2,0,"mat-header-cell",4),g.\u0275\u0275template(17,nr,3,3,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,11),g.\u0275\u0275template(19,ir,2,0,"mat-header-cell",4),g.\u0275\u0275template(20,rr,3,3,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,12),g.\u0275\u0275template(22,ar,2,0,"mat-header-cell",4),g.\u0275\u0275template(23,or,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(24,13),g.\u0275\u0275template(25,sr,2,0,"mat-header-cell",4),g.\u0275\u0275template(26,lr,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(27,14),g.\u0275\u0275template(28,cr,1,0,"mat-header-cell",15),g.\u0275\u0275template(29,dr,8,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(30,mr,1,0,"mat-header-row",16),g.\u0275\u0275template(31,pr,1,0,"mat-row",17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",t.dataSource),g.\u0275\u0275advance(29),g.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,Qn.XQ,Qn.Gk],pipes:[_e.M,Hi.$],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.mat-column-Contract-Reference[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-Estimate-Reference[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-Date[_ngcontent-%COMP%]{justify-content:center}.mat-column-Type[_ngcontent-%COMP%]{justify-content:center}.mat-column-Conforme[_ngcontent-%COMP%]{justify-content:center}.mat-column-Amount[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e})();var ur=n(92340);const gr=["editOrderForm"],fr=["EstimateSelect"];function vr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"h5",45),g.\u0275\u0275text(1," Add Order "),g.\u0275\u0275elementEnd())}function Sr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"h5",45),g.\u0275\u0275text(1," Edit Order "),g.\u0275\u0275elementEnd())}function br(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"div",46),g.\u0275\u0275elementStart(2,"h5"),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate(e.order.projectName)}}function Cr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",47),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function yr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",47),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Er(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",47),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function xr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",36),g.\u0275\u0275elementStart(1,"button",48),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().previewFile()}),g.\u0275\u0275element(2,"em",49),g.\u0275\u0275text(3,"Preview"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",e.fileChange||null===e.order.contractFileName)}}let Ir=(()=>{class e{constructor(e,t,n,i,r){this.invoicingService=e,this.notificationService=t,this.dateTimeService=n,this._avRoute=i,this.fileService=r,this.isSavedOrder=new g.EventEmitter,this.conformesIdentifiers=[{id:1,description:"Ok"},{id:2,description:"Exemption"}],this.fileChange=!1,this.mutliClickDisable=!1,this.order=new Pi.KM,this.estimateFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ,this.filteredEstimates=new c.tq(1)}ngOnDestroy(){this.invoicingService.goToOrder.next()}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.getRefEstimateByProject(),this.getContractsType();const e=+this._avRoute.snapshot.paramMap.get("contractId");this.isEditableOrder&&void 0===this.selectedOrder&&this.invoicingService.getContract(e).subscribe(e=>{this.order=Object.assign(new Pi.KM,e[0])}),this.isEditableOrder?(this.order=Object.assign(new Pi.KM,this.selectedOrder),this.invoicingService.getContractFile(this.order.contractId).subscribe(e=>{0!==e.length&&(this.order.contractFileData=e[0].contractFileData,this.order.contractFileName=e[0].contractFileName,this.order.contractFileType=e[0].contractFileType)})):this.isEditableOrder||(this.order=new Pi.KM,(1===this.project.categoryId||2===this.project.categoryId)&&(this.order.contractTypeId=this.project.categoryId)),this.estimateFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterEstimates()})}getRefEstimateByProject(){this.invoicingService.getRefEstimateByProject(this.project.projectId).subscribe(e=>{null!=e&&(this.estimatesIdentifiers=e,1===this.estimatesIdentifiers.length&&0===this.order.contractId&&(this.order.estimateId=this.estimatesIdentifiers[0].id),this.filteredEstimates.next(this.estimatesIdentifiers.slice()))})}getContractsType(){this.invoicingService.getContractsType().subscribe(e=>{null!=e&&(this.ordersTypesIndentifiers=e)})}onFileChange(e){const t=new FileReader;if(e.target.files&&e.target.files.length>0){const n=e.target.files[0];n.size<1024*ur.N.maxOrderFileSize?(this.fileChange=!0,t.readAsDataURL(n),t.onload=()=>{this.order.contractFileName=n.name,this.order.contractFileType=n.type,this.order.contractFileData=this.fileService.FromFileToDbFormat(t.result.toString().split(",")[1]),this.order.contractFileChanged=1}):(this.order.contractFileData=null,this.notificationService.warning(`File must be lower the size of ${ur.N.maxOrderFileSize} Kilobytes`))}}previewFile(){const e=this.fileService.FromDbToFileFormat(this.order.contractFileData,this.order.contractFileType),t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=this.order.contractFileName,n.click(),window.URL.revokeObjectURL(t)}save(){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3),this.editOrder.valid&&0!==this.order.offreConfId?2===this.order.offreConfId&&null===this.order.offreConfDesc?this.notificationService.warning("Please fill Comment"):(null==this.project||(this.order.projectId=this.project.projectId),this.order.contractAmount=+this.order.contractAmount.toString().replace(",","."),this.invoicingService.insertOrUpdateContract(this.order).subscribe(()=>{this.isSavedOrder.emit(!0),this.notificationService.success("Order is saved successfully")},e=>{this.notificationService.danger("Save order failed")})):this.notificationService.danger("Please fill all required fields")}cancel(){this.isSavedOrder.emit(!0)}isDespliyedTitle(){return null==this.project}dateOnly(e){return this.dateTimeService.dateOnly(e)}filterEstimates(){if(!this.estimatesIdentifiers)return;let e=this.estimateFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredEstimates.next(this.estimatesIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredEstimates.next(this.estimatesIdentifiers.slice())}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(d.Ip))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-order"]],viewQuery:function(e,t){if(1&e&&(g.\u0275\u0275viewQuery(gr,7),g.\u0275\u0275viewQuery(fr,7)),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.editOrder=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.EstimateSelect=e.first)}},inputs:{project:"project",isEditableOrder:"isEditableOrder",selectedOrder:"selectedOrder",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedOrder:"isSavedOrder"},decls:66,vars:29,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],["_ngcontent-c17","",1,"main-color","card-header","ng-tns-c17-6","ng-star-inserted"],["_ngcontent-c17","","class","card-header-text","style","color: #ffffff;",4,"ngIf"],[1,"card-body"],[1,"wbs-actions"],["id","editOrderForm"],["editOrderForm","ngForm"],["class","row m-b-15",4,"ngIf"],[1,"row","m-b-15"],[1,"col-sm-4"],["placeholder","Order Reference","matInput","","name","orderRef","required","",3,"ngModel","ngModelChange"],["required","","placeholder","Quotation Reference","name","estimateReference",3,"ngModel","ngModelChange"],["EstimateSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["color","red",1,"col-sm-2"],["placeholder","Amount","matInput","","name","amount","appNumberValidator","","required","",3,"ngModel","inputValue","ngModelChange"],[1,"col-sm-2"],["placeholder","Type","name","type",3,"ngModel","ngModelChange"],["placeholder","Followed By","matInput","","name","name","appTextValidator","","maxlength","50","required","",3,"ngModel","ngModelChange"],["color","red",1,"col-sm-4"],["placeholder","Addressed To","matInput","","name","client","appTextValidator","","maxlength","50","required","","type","text",3,"ngModel","ngModelChange"],["matInput","","placeholder","Date","name","date","required","",3,"matDatepicker","ngModel","ngModelChange","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["placeholder","Conformity","name","orderConforme","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Description","name","description","maxlength","255","required","",3,"ngModel","ngModelChange"],["placeholder","Path","matInput","","name","Link","disabled","",3,"ngModel","ngModelChange"],["color","red",1,"col-sm-12"],["placeholder","Comment","matInput","","name","comment",3,"ngModel","ngModelChange"],[1,"col-sm-10"],["required","","placeholder","File Name","matInput","","name","File","disabled","",3,"ngModel","ngModelChange"],[1,"col-sm-1"],[1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple","file-upload-button",2,"font-size","inherit"],["type","file","id","av","accept","application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",3,"click","change"],["fileInput",""],[1,"icofont","icofont-upload-alt","mr-0","mr-md-2"],["class","col-sm-1",4,"ngIf"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],["_ngcontent-c17","",1,"card-header-text",2,"color","#ffffff"],[1,"card-header"],[3,"value"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-eye-alt","mr-0","mr-md-2"]],template:function(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275template(4,vr,2,0,"h5",4),g.\u0275\u0275template(5,Sr,2,0,"h5",4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"div",6),g.\u0275\u0275elementStart(8,"form",7,8),g.\u0275\u0275template(10,br,4,1,"div",9),g.\u0275\u0275elementStart(11,"div",10),g.\u0275\u0275elementStart(12,"mat-form-field",11),g.\u0275\u0275elementStart(13,"input",12),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"mat-form-field",11),g.\u0275\u0275elementStart(15,"mat-select",13,14),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.estimateId=e}),g.\u0275\u0275elementStart(17,"mat-option"),g.\u0275\u0275elementStart(18,"ngx-mat-select-search",15),g.\u0275\u0275elementStart(19,"mat-icon",16),g.\u0275\u0275text(20,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(21,Cr,2,2,"mat-option",17),g.\u0275\u0275pipe(22,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"mat-form-field",18),g.\u0275\u0275elementStart(24,"input",19),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractAmount=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"mat-form-field",20),g.\u0275\u0275elementStart(26,"mat-select",21),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractTypeId=e}),g.\u0275\u0275template(27,yr,2,2,"mat-option",17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"div",10),g.\u0275\u0275elementStart(29,"mat-form-field",11),g.\u0275\u0275elementStart(30,"input",22),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractName=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"mat-form-field",23),g.\u0275\u0275elementStart(32,"input",24),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractClientRef=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"mat-form-field",20),g.\u0275\u0275elementStart(34,"input",25),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractDate=e})("keypress",function(e){return t.dateOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(35,"mat-datepicker-toggle",26),g.\u0275\u0275element(36,"mat-datepicker",27,28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"mat-form-field",18),g.\u0275\u0275elementStart(39,"mat-select",29),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.offreConfId=e}),g.\u0275\u0275template(40,Er,2,2,"mat-option",17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"div",10),g.\u0275\u0275elementStart(42,"mat-form-field",1),g.\u0275\u0275elementStart(43,"textarea",30),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractDesc=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"div",10),g.\u0275\u0275elementStart(45,"mat-form-field",1),g.\u0275\u0275elementStart(46,"input",31),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractLink=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"div",10),g.\u0275\u0275elementStart(48,"mat-form-field",32),g.\u0275\u0275elementStart(49,"textarea",33),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.commentaire=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(50,"div",10),g.\u0275\u0275elementStart(51,"mat-form-field",34),g.\u0275\u0275elementStart(52,"input",35),g.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractFileName=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"div",36),g.\u0275\u0275elementStart(54,"button",37),g.\u0275\u0275elementStart(55,"input",38,39),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275reference(56).value=null})("change",function(e){return t.onFileChange(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"span"),g.\u0275\u0275element(58,"em",40),g.\u0275\u0275text(59,"Select"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(60,xr,4,1,"div",41),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(61,"div",42),g.\u0275\u0275elementStart(62,"button",43),g.\u0275\u0275listener("click",function(){return t.save()}),g.\u0275\u0275text(63,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(64,"button",44),g.\u0275\u0275listener("click",function(){return t.cancel()}),g.\u0275\u0275text(65,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275reference(37);g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",!t.isEditableOrder),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isEditableOrder),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngIf",t.isDespliyedTitle()),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.order.estimateId),g.\u0275\u0275advance(3),g.\u0275\u0275property("formControl",t.estimateFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(22,27,t.filteredEstimates)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractAmount)("inputValue",t.order.contractAmount),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.order.contractTypeId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.ordersTypesIndentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractName),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.order.contractClientRef),g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",e)("ngModel",t.order.contractDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.offreConfId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.conformesIdentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractDesc),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractLink),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.commentaire),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.order.contractFileName),g.\u0275\u0275advance(8),g.\u0275\u0275property("ngIf",t.isEditableOrder),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",!t.isvisibleEditProject||t.mutliClickDisable)}},directives:[i.NgIf,o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,C.Nt,o.DefaultValueAccessor,o.RequiredValidator,o.NgControlStatus,o.NgModel,y.gD,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,ze.z,Te.s,o.MaxLengthValidator,E.hl,E.nW,b.R9,E.Mq],pipes:[i.AsyncPipe],styles:['.mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.file-upload-button[_ngcontent-%COMP%]{overflow:hidden;position:relative}.file-upload-button[_ngcontent-%COMP%]:after{content:"Upload";color:#fff;font-size:1.5rem;text-align:center}.file-upload-button[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{font-size:100px;left:0;opacity:0;position:absolute;top:0}.file-info[_ngcontent-%COMP%]{color:#999;font-family:Arial,Helvetica,sans-serif;margin-left:.3rem}.main-color[_ngcontent-%COMP%]{background:#3f629d}']}),e})();function wr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",2),g.\u0275\u0275elementStart(1,"div",3),g.\u0275\u0275elementStart(2,"nav",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"button",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().addOrderView()}),g.\u0275\u0275element(5,"em",7),g.\u0275\u0275text(6," Order "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",8),g.\u0275\u0275element(8,"app-paginator",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",e.searchFilterService.pageSize)("pageIndex",e.searchFilterService.pageIndex)("length",e.lengthOrders)}}function Mr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-orders",11),g.\u0275\u0275listener("OrderState",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("orders",g.\u0275\u0275pipeBind3(2,4,e.orders,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("orderEditable",e.orderEditable)("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function Pr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-edit-order",12),g.\u0275\u0275listener("isSavedOrder",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().savedOrder(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isEditableOrder",e.isEditableOrder)("selectedOrder",e.selectedOrder)("isvisibleEditProject",e.isvisibleEditProject)}}let Dr=(()=>{class e{constructor(e,t,n,i){this.sortService=e,this.searchFilterService=t,this.invoicingService=n,this._avRoute=i,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.isEditableOrder=!1,this.orderEditable=!1,this.subscription=new c.w0}ngOnInit(){const e=this._avRoute.snapshot.paramMap.get("title");null!=e&&"orders"===e?(this.listView=!1,this.isEditableOrder=!0):(this.listView=!0,this.isEditableOrder=!1),this.subscription.add(this.invoicingService.sortOrders.subscribe(e=>{this.onSortData(e)})),this.invoicingService.getContractsByProject(this.project.projectId).subscribe(e=>{if(this.orders=e,this.lengthOrders=this.orders.length,null!=this.orderId){const e=this.orders.find(e=>e.contractId===this.orderId);this.toggleEditDetails(e)}}),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.OrderEditable(),this.getContractsByProject(),this.subscription.add(this.invoicingService.reloadOrders.subscribe(e=>{this.getContractsByProject()}))}ngOnDestroy(){this.subscription.unsubscribe()}addOrderView(){this.listView=!1,this.isEditableOrder=!1}toggleEditDetails(e){this.isEditableOrder=!0,this.selectedOrder=e}OrderEditable(){return this.orderEditable=this.user.groupId===h.Fl.ProjectManager||this.user.groupId===h.Fl.SuperAdmin||this.user.groupId===h.Fl.Finance||this.user.groupId===h.Fl.Facturation||this.user.qualification===h._W.DepartmentHead,this.orderEditable}savedOrder(e){this.getContractsByProject(),this.listView=e,this.isEditableOrder=!e}getContractsByProject(){this.invoicingService.getContractsByProject(this.project.projectId).subscribe(e=>{this.orders=e,this.lengthOrders=this.orders.length})}onSortData(e){e.active&&""!==e.direction&&void 0!==this.orders&&this.orders.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"Contract-Reference":return this.sortService.compare(t.contractReference,n.contractReference,i,!1);case"Estimate-Reference":return this.sortService.compare(t.estimateRef,n.estimateRef,i,!1);case"Name":return this.sortService.compare(t.contractName,n.contractName,i,!1);case"Type":return this.sortService.compare(t.contractTypeName,n.contractTypeName,i,!1);case"Date":return this.sortService.compare(t.contractDate,n.contractDate,i,!1);case"Amount":return this.sortService.compare(t.contractAmount,n.contractAmount,i,!0);case"Conforme":return this.sortService.compare(t.offreConfDesc,n.offreConfDesc,i,!1);case"Reference-Client":return this.sortService.compare(t.contractClientRef,n.contractClientRef,i,!1);default:return 0}}),this.paginatorPipe.transform(this.orders,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(a.gz))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-order"]],inputs:{orderId:"orderId",project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"orders","orderEditable","project","isvisibleEditProject","OrderState"],[3,"project","isEditableOrder","selectedOrder","isvisibleEditProject","isSavedOrder"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,wr,9,4,"div",0),g.\u0275\u0275template(1,Mr,3,8,"div",1),g.\u0275\u0275template(2,Pr,2,4,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.listView&&!t.isEditableOrder),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView&&!t.isEditableOrder),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.listView||t.isEditableOrder))},directives:[i.NgIf,ft.M2,qn.J,hr,Ir],pipes:[_i.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;color:#0f65fa;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}"]}),e})();function jr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Reference"),g.\u0275\u0275elementEnd())}const Or=function(e){return{background:e}};function Fr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",16),g.\u0275\u0275elementStart(1,"span",17),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275propertyInterpolate("matTooltip",e.batchReference),g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(3,Or,n.color(e))),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.batchReference," ")}}function kr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Quotation Reference"),g.\u0275\u0275elementEnd())}function Ar(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",16),g.\u0275\u0275elementStart(1,"span",17),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275propertyInterpolate("matTooltip",e.estimateReference),g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(3,Or,n.color(e))),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.estimateReference," ")}}function _r(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Order Reference"),g.\u0275\u0275elementEnd())}function Vr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",16),g.\u0275\u0275elementStart(1,"span",17),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275propertyInterpolate("matTooltip",e.contractReference),g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(3,Or,n.color(e))),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.contractReference," ")}}function Nr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Delivery Date"),g.\u0275\u0275elementEnd())}function Rr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(4,Or,n.color(e))),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,2,e.batchDeliveryDate)," ")}}function Tr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Addressed To"),g.\u0275\u0275elementEnd())}function Br(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(2,Or,n.color(e))),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.batchAdressedTo," ")}}function zr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",15),g.\u0275\u0275text(1,"Amount"),g.\u0275\u0275elementEnd())}function qr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(3,Or,n.color(e))),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.batchAmount," ",e.currency," ")}}function Lr(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function Qr(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275elementStart(1,"button",19),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275elementStart(2,"em",20),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(4," \xa0 "),g.\u0275\u0275elementStart(5,"button",21),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().deleteBatch(t)}),g.\u0275\u0275elementStart(6,"em",20),g.\u0275\u0275text(7,"delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(8," \xa0 "),g.\u0275\u0275elementStart(9,"button",22),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext().invoicingBatch(t)}),g.\u0275\u0275elementStart(10,"em",20),g.\u0275\u0275text(11,"attach_money"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275property("ngStyle",g.\u0275\u0275pureFunction1(3,Or,n.color(e))),g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",null!==e.invoiceSaariReference||!n.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",n.invoicedBatch(e))}}function $r(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",23)}function Ur(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}let Hr=(()=>{class e{constructor(e,t,n,i,r){this.invoicingService=e,this.dialog=t,this.searchFilterService=n,this.notificationService=i,this.mailService=r,this.displayedColumns=["batchReference","estimateRefference","contractReference","batchDelevryDate","batchAdressedTo","batchAmount","buttons"],this.dataSource=new Qn.by,this.batchState=new g.EventEmitter,this.isSavedBatch=new g.EventEmitter,this.checked=!0,this.invoicingBatches=[]}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.selectedBatchId=0,this.dataSource=new Qn.by(this.batches),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}toggleEditDetails(e){this.isEditBatch=!0,this.batchState.emit(e)}deleteBatch(e){X().fire({text:"Are you sure to delete this batch ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{let t;0!==e.invoiceId&&null!=e.invoiceId&&this.invoicingService.getInvoice(e.invoiceId).subscribe(e=>{t=Object.assign(new Pi.mw,e[0])}),this.invoicingService.deleteBatch(e.batchId).subscribe(()=>{this.notificationService.success("this Batch is deleted"),this.invoicingService.reloadBatches.next(),0!==e.invoiceId&&this.mailService.invoiceDeleted(t)},()=>{this.notificationService.danger("Delete batch failed")})}})}invoicingBatch(e){this.invoicingService.invoiceBatch.next(e.batchId)}color(e){return 0===e.invoiceId||null==e.invoiceId?"white":"lightgray"}invoicedBatch(e){return!(0===e.invoiceId||null==e.invoiceId)}onSortData(e){this.invoicingService.sortBatches.next(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.YT))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-batches"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ln.YE,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{project:"project",batches:"batches",isvisibleEditProject:"isvisibleEditProject"},outputs:{batchState:"batchState",isSavedBatch:"isSavedBatch"},decls:25,vars:4,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","batchReference"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"ngStyle","matTooltip",4,"matCellDef"],["matColumnDef","estimateRefference"],["matColumnDef","contractReference"],["matColumnDef","batchDelevryDate"],[3,"ngStyle",4,"matCellDef"],["matColumnDef","batchAdressedTo"],["matColumnDef","batchAmount"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"ngStyle","matTooltip"],[1,"span-ellipsis"],[3,"ngStyle"],["type","button","matTooltip","Edit",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],["type","button","matTooltip","Invoice",1,"btn","btn-mini","btn-primary","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-table",0,1),g.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),g.\u0275\u0275elementContainerStart(2,2),g.\u0275\u0275template(3,jr,2,0,"mat-header-cell",3),g.\u0275\u0275template(4,Fr,3,5,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(5,5),g.\u0275\u0275template(6,kr,2,0,"mat-header-cell",3),g.\u0275\u0275template(7,Ar,3,5,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(8,6),g.\u0275\u0275template(9,_r,2,0,"mat-header-cell",3),g.\u0275\u0275template(10,Vr,3,5,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(11,7),g.\u0275\u0275template(12,Nr,2,0,"mat-header-cell",3),g.\u0275\u0275template(13,Rr,3,6,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(14,9),g.\u0275\u0275template(15,Tr,2,0,"mat-header-cell",3),g.\u0275\u0275template(16,Br,2,4,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(17,10),g.\u0275\u0275template(18,zr,2,0,"mat-header-cell",3),g.\u0275\u0275template(19,qr,2,5,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(20,11),g.\u0275\u0275template(21,Lr,1,0,"mat-header-cell",12),g.\u0275\u0275template(22,Qr,12,5,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(23,$r,1,0,"mat-header-row",13),g.\u0275\u0275template(24,Ur,1,0,"mat-row",14),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275property("dataSource",t.dataSource),g.\u0275\u0275advance(23),g.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,i.NgStyle,ne.gM,Qn.XQ,Qn.Gk],pipes:[_e.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 16%!important;width:16%!important}.mat-column-estimateRefference[_ngcontent-%COMP%]{flex:0 0 20%!important;width:20%!important}.mat-column-contractReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-batchDelevryDate[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important;justify-content:center}.mat-column-batchAdressedTo[_ngcontent-%COMP%]{flex:0 0 16%!important;width:16%!important}.mat-column-batchAmount[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%;text-align:right;padding-right:1%;justify-content:flex-end}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important;justify-content:center}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}  .mat-sort-header-arrow{color:#fff}"]}),e})();const Gr=["batchDetailsForm"],Wr=["EstimateSelect"],Jr=["OrderSelect"];function Yr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"h5",30),g.\u0275\u0275text(1," Add Invoicing Batch "),g.\u0275\u0275elementEnd())}function Kr(e,t){1&e&&(g.\u0275\u0275elementStart(0,"h5",30),g.\u0275\u0275text(1," Edit Invoicing Batch "),g.\u0275\u0275elementEnd())}function Xr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",9),g.\u0275\u0275elementStart(1,"div",31),g.\u0275\u0275elementStart(2,"h5"),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate(e.batch.projectName)}}function Zr(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",32),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ea(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",32),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ta(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",32),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let na=(()=>{class e{constructor(e,t,n,i,r){this.notificationService=e,this.dateTimeService=t,this.invoicingService=n,this._avRoute=i,this.mailService=r,this.isSavedBatch=new g.EventEmitter,this.batch=new Pi.El,this.mutliClickDisable=!1,this.estimateFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ,this.filteredEstimates=new c.tq(1),this.orderFilterCtrl=new o.FormControl,this.filteredOrders=new c.tq(1)}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.getBatchesType(),this.getListCurrency();const e=+this._avRoute.snapshot.paramMap.get("batchId");this.isEditBatch&&void 0===this.selectedBatch?this.invoicingService.getBatch(e).subscribe(e=>{this.batch=Object.assign(new Pi.El,e[0]),this.getContracts(this.project.projectId)}):this.isEditBatch&&0===e||void 0!==this.selectedBatch?(this.batch=Object.assign(new Pi.El,this.selectedBatch),this.getContracts(this.project.projectId)):(this.getContracts(this.project.projectId),this.batch=new Pi.El,this.batch.currencyId=Pi.F.Euro),this.orderFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterOrders()})}getContracts(e){this.invoicingService.getContracts(e).subscribe(e=>{null!=e&&(this.ordersIdentifiers=e,this.filteredOrders.next(this.ordersIdentifiers.slice()),1===this.ordersIdentifiers.length&&0===this.batch.batchId&&(this.selectedOrderIdentifier=this.ordersIdentifiers[0],this.batch.contractId=this.selectedOrderIdentifier.id,this.batch.estimateId=this.selectedOrderIdentifier.estimateId,this.batch.estimateReference=this.selectedOrderIdentifier.estimateReference,this.hasOrderFile()))})}getBatchesType(){this.invoicingService.getBatchesType().subscribe(e=>{this.batchesTypesIdentifiers=e})}getListCurrency(){this.invoicingService.getCurrencies().subscribe(e=>{this.currenciesIdentifiers=e})}onChangeOrder(e){this.selectedOrderIdentifier=this.ordersIdentifiers.find(t=>t.id===e),this.batch.estimateId=this.selectedOrderIdentifier.estimateId,this.batch.estimateReference=this.selectedOrderIdentifier.estimateReference,this.hasOrderFile()}save(e){this.mutliClickDisable=!0,setTimeout(()=>{this.mutliClickDisable=!1},1e3),this.detailsForm.valid?(this.selectedOrderIdentifier=this.ordersIdentifiers.find(e=>e.id===this.batch.contractId),!this.isEditBatch&&!(null==this.project)&&(this.batch.projectId=this.project.projectId),this.batch.invoiceId||(this.batch.invoiceId=0),this.batch.batchAmount=+this.batch.batchAmount.toString().replace(",","."),this.invoicingService.saveBatchDetails(this.batch).subscribe(()=>{this.notificationService.success("Invoicing Batch is saved successfully"),this.isSavedBatch.emit(!0)},e=>{this.notificationService.danger("Save batch failed")})):this.notificationService.danger("Please fill all required fields")}onCancel(){this.isSavedBatch.emit(!0)}isDespliyedTitle(){return null==this.project}dateOnly(e){return this.dateTimeService.dateOnly(e)}filterOrders(){if(!this.ordersIdentifiers)return;let e=this.orderFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredOrders.next(this.ordersIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredOrders.next(this.ordersIdentifiers.slice())}hasOrderFile(){null==this.selectedOrderIdentifier.contractFileName&&(this.notificationService.warning("You will be redirected to the selected order. Please select a document."),this.invoicingService.goToOrder.next(this.selectedOrderIdentifier.id))}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(d.YT))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-batch"]],viewQuery:function(e,t){if(1&e&&(g.\u0275\u0275viewQuery(Gr,7),g.\u0275\u0275viewQuery(Wr,7),g.\u0275\u0275viewQuery(Jr,7)),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.detailsForm=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.EstimateSelect=e.first),g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.OrderSelect=e.first)}},inputs:{project:"project",isNewBatch:"isNewBatch",selectedBatch:"selectedBatch",isEditBatch:"isEditBatch",selectedBatchId:"selectedBatchId",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedBatch:"isSavedBatch"},decls:48,vars:25,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],["_ngcontent-c17","",1,"main-color","card-header","ng-tns-c17-6","ng-star-inserted"],["_ngcontent-c17","","class","card-header-text","style","color: #ffffff;",4,"ngIf"],[1,"card-body"],["id","batchDetailsForm"],["batchDetailsForm","ngForm"],["class","row m-b-15",4,"ngIf"],[1,"row","m-b-15"],[1,"col-sm-3"],["placeholder","Batch Reference","matInput","","name","batchReference","maxlength","20","required","",3,"ngModel","ngModelChange"],["placeholder","Order Reference","name","orderReference","required","",3,"ngModel","selectionChange","ngModelChange"],["OrderSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["placeholder","Quotation Reference","matInput","","name","EstimateReference","disabled","",3,"ngModel","ngModelChange"],["placeholder","Type","name","type","required","",3,"ngModel","ngModelChange"],["placeholder","Amount","matInput","","name","Amount","appNumberValidator","","required","",3,"ngModel","inputValue","ngModelChange"],["placeholder","Currency","name","currency","required","",3,"ngModel","ngModelChange"],["placeholder","Addressed To","matInput","","name","AdressedTo","appTextValidator","","maxlength","50","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Delivery Date","name","batchDeliveryDate","required","",3,"matDatepicker","ngModel","ngModelChange","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","Description","name","description","maxlength","255","required","",3,"ngModel","ngModelChange"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],["_ngcontent-c17","",1,"card-header-text",2,"color","#ffffff"],[1,"card-header"],[3,"value"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275template(4,Yr,2,0,"h5",4),g.\u0275\u0275template(5,Kr,2,0,"h5",4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"form",6,7),g.\u0275\u0275template(9,Xr,4,1,"div",8),g.\u0275\u0275elementStart(10,"div",9),g.\u0275\u0275elementStart(11,"mat-form-field",10),g.\u0275\u0275elementStart(12,"input",11),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"mat-form-field",10),g.\u0275\u0275elementStart(14,"mat-select",12,13),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangeOrder(e.value)})("ngModelChange",function(e){return t.batch.contractId=e}),g.\u0275\u0275elementStart(16,"mat-option"),g.\u0275\u0275elementStart(17,"ngx-mat-select-search",14),g.\u0275\u0275elementStart(18,"mat-icon",15),g.\u0275\u0275text(19,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(20,Zr,2,2,"mat-option",16),g.\u0275\u0275pipe(21,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"mat-form-field",10),g.\u0275\u0275elementStart(23,"input",17),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.estimateReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",10),g.\u0275\u0275elementStart(25,"mat-select",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchTypeId=e}),g.\u0275\u0275template(26,ea,2,2,"mat-option",16),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"div",9),g.\u0275\u0275elementStart(28,"mat-form-field",10),g.\u0275\u0275elementStart(29,"input",19),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchAmount=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"mat-form-field",10),g.\u0275\u0275elementStart(31,"mat-select",20),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.currencyId=e}),g.\u0275\u0275template(32,ta,2,2,"mat-option",16),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"mat-form-field",10),g.\u0275\u0275elementStart(34,"input",21),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchAdressedTo=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"mat-form-field",10),g.\u0275\u0275elementStart(36,"input",22),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchDeliveryDate=e})("keypress",function(e){return t.dateOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(37,"mat-datepicker-toggle",23),g.\u0275\u0275element(38,"mat-datepicker",24,25),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"div",9),g.\u0275\u0275elementStart(41,"mat-form-field",1),g.\u0275\u0275elementStart(42,"textarea",26),g.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchDescription=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"div",27),g.\u0275\u0275elementStart(44,"button",28),g.\u0275\u0275listener("click",function(){return t.save(t.batch)}),g.\u0275\u0275text(45,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"button",29),g.\u0275\u0275listener("click",function(){return t.onCancel()}),g.\u0275\u0275text(47,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(39);g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",!t.isEditBatch),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isEditBatch),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",t.isDespliyedTitle()),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.batch.batchReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.batch.contractId),g.\u0275\u0275advance(3),g.\u0275\u0275property("formControl",t.orderFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(21,23,t.filteredOrders)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.batch.estimateReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.batch.batchTypeId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.batchesTypesIdentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.batch.batchAmount)("inputValue",t.batch.batchAmount),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.batch.currencyId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.currenciesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.batch.batchAdressedTo),g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",e)("ngModel",t.batch.batchDeliveryDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngModel",t.batch.batchDescription),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",!t.isvisibleEditProject||null!==t.batch.invoiceSaariReference||t.mutliClickDisable)}},directives:[i.NgIf,o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,C.Nt,o.DefaultValueAccessor,o.MaxLengthValidator,o.RequiredValidator,o.NgControlStatus,o.NgModel,y.gD,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,ze.z,Te.s,E.hl,E.nW,b.R9,E.Mq],pipes:[i.AsyncPipe],styles:[".main-color[_ngcontent-%COMP%]{background:#3f629d}"]}),e})();function ia(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",2),g.\u0275\u0275elementStart(1,"div",3),g.\u0275\u0275elementStart(2,"nav",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"button",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().AddBatchView()}),g.\u0275\u0275element(5,"em",7),g.\u0275\u0275text(6," Batch "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",8),g.\u0275\u0275element(8,"app-paginator",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",e.searchFilterService.pageSize)("pageIndex",e.searchFilterService.pageIndex)("length",e.lengthBatches)}}function ra(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-batches",11),g.\u0275\u0275listener("batchEditable",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().InvoicingbatchEditable})("batchState",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("batches",g.\u0275\u0275pipeBind3(2,3,e.batches,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function aa(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-edit-batch",12),g.\u0275\u0275listener("isSavedBatch",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().savedBatch(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isNewBatch",!e.listView)("isEditBatch",e.isEditBatch)("selectedBatch",e.selectedBatch)("isvisibleEditProject",e.isvisibleEditProject)}}let oa=(()=>{class e{constructor(e,t,n,i){this.sortService=e,this.invoicingService=t,this._avRoute=n,this.searchFilterService=i,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.subscription=new c.w0}ngOnInit(){const e=this._avRoute.snapshot.paramMap.get("title");null!=e&&"batches"===e?(this.listView=!1,this.isEditBatch=!0):(this.listView=!0,this.isEditBatch=!1),this.subscription.add(this.invoicingService.sortBatches.subscribe(e=>{this.onSortData(e)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.InvoicingbatchEditable(),this.subscription.add(this.invoicingService.reloadBatches.subscribe(e=>{this.getBatchesByProject()})),null==this.project||this.getBatchesByProject()}ngOnDestroy(){this.subscription.unsubscribe()}AddBatchView(){this.listView=!1,this.isEditBatch=!1,this.selectedBatch=void 0}InvoicingbatchEditable(){return this.batchEditable=this.user.groupId===h.Fl.ProjectManager||this.user.groupId===h.Fl.SuperAdmin||this.user.groupId===h.Fl.Finance||this.user.groupId===h.Fl.Facturation||this.user.qualification===h._W.DepartmentHead,this.batchEditable}toggleEditDetails(e){this.isEditBatch=!0,this.selectedBatch=e}savedBatch(e){this.getBatchesByProject(),this.listView=e,this.isEditBatch=!e}getBatchesByProject(){this.invoicingService.getBatchesByProject(this.project.projectId).subscribe(e=>{this.batches=e,this.lengthBatches=this.batches.length})}onSortData(e){e.active&&""!==e.direction&&void 0!==this.batches&&this.batches.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"batchReference":return this.sortService.compare(t.batchReference,n.batchReference,i,!1);case"estimateRefference":return this.sortService.compare(t.estimateRefference,n.estimateRefference,i,!1);case"contractReference":return this.sortService.compare(t.contractReference,n.contractReference,i,!1);case"batchDelevryDate":return this.sortService.compare(t.batchDeliveryDate,n.batchDeliveryDate,i,!1);case"batchAdressedTo":return this.sortService.compare(t.batchAdressedTo,n.batchAdressedTo,i,!1);case"batchAmount":return this.sortService.compare(t.batchAmount,n.batchAmount,i,!0);default:return 0}}),this.paginatorPipe.transform(this.batches,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-batch"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"batches","project","isvisibleEditProject","batchEditable","batchState"],[3,"project","isNewBatch","isEditBatch","selectedBatch","isvisibleEditProject","isSavedBatch"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,ia,9,4,"div",0),g.\u0275\u0275template(1,ra,3,7,"div",1),g.\u0275\u0275template(2,aa,2,5,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.listView&&!t.isEditBatch),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView&&!t.isEditBatch),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.listView||t.isEditBatch))},directives:[i.NgIf,ft.M2,qn.J,Hr,na],pipes:[_i.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 70px}.mat-column-batchAdressedTo[_ngcontent-%COMP%]{flex:0 0 120px;margin-left:50px}.amount-right[_ngcontent-%COMP%]{justify-content:flex-end}.mat-column-batchAmount[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-batchDelevryDate[_ngcontent-%COMP%]{flex:0 0 250px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.wbs-container[_ngcontent-%COMP%]{min-height:75vh;padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;color:#0f65fa;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}"]}),e})();function sa(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Invoice Ref."),g.\u0275\u0275elementEnd())}function la(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",23),g.\u0275\u0275elementStart(1,"span",24),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.invoiceReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.invoiceReference)}}function ca(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Batch Ref."),g.\u0275\u0275elementEnd())}function da(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",23),g.\u0275\u0275elementStart(1,"span",24),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.batchReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.batchReference)}}function ma(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Order Ref."),g.\u0275\u0275elementEnd())}function pa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",23),g.\u0275\u0275elementStart(1,"span",24),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.contractReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.contractReference)}}function ha(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Addressed To"),g.\u0275\u0275elementEnd())}function ua(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.invoiceAdressedTo," ")}}function ga(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Amount"),g.\u0275\u0275elementEnd())}function fa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.invoiceAmount," ",e.currency," ")}}function va(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Net to pay"),g.\u0275\u0275elementEnd())}function Sa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",e.invoiceNetToBePayed," ",e.currency," ")}}function ba(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Delivery"),g.\u0275\u0275elementEnd())}function Ca(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.invoiceDeliveryDate)," ")}}function ya(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Status"),g.\u0275\u0275elementEnd())}const Ea=function(e,t){return{"label-success":e,"label-danger":t}};function xa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"label",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction2(2,Ea,1===e.invoiceDeposit,1!==e.invoiceDeposit)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(n.getValidationState(e.invoiceDeposit))}}function Ia(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Saari Ref."),g.\u0275\u0275elementEnd())}function wa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.invoiceSaariReference," ")}}function Ma(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",22),g.\u0275\u0275text(1,"Cashed On"),g.\u0275\u0275elementEnd())}function Pa(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.invoiceCashedOn)," ")}}function Da(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function ja(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",27),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).toggleEditDetails(t)}),g.\u0275\u0275elementStart(2,"em",28),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(4," \xa0\xa0 "),g.\u0275\u0275elementStart(5,"button",29),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).deleteInvoice(t)}),g.\u0275\u0275elementStart(6,"em",28),g.\u0275\u0275text(7,"delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",null!==e.invoiceSaariReference||!n.isvisibleEditProject)}}function Oa(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",30)}function Fa(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function ka(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275elementStart(1,"mat-table",2,3),g.\u0275\u0275listener("matSortChange",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onSortData(t)}),g.\u0275\u0275elementContainerStart(3,4),g.\u0275\u0275template(4,sa,2,0,"mat-header-cell",5),g.\u0275\u0275template(5,la,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,7),g.\u0275\u0275template(7,ca,2,0,"mat-header-cell",5),g.\u0275\u0275template(8,da,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,8),g.\u0275\u0275template(10,ma,2,0,"mat-header-cell",5),g.\u0275\u0275template(11,pa,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,9),g.\u0275\u0275template(13,ha,2,0,"mat-header-cell",5),g.\u0275\u0275template(14,ua,2,1,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,11),g.\u0275\u0275template(16,ga,2,0,"mat-header-cell",5),g.\u0275\u0275template(17,fa,2,2,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,12),g.\u0275\u0275template(19,va,2,0,"mat-header-cell",5),g.\u0275\u0275template(20,Sa,2,2,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,13),g.\u0275\u0275template(22,ba,2,0,"mat-header-cell",5),g.\u0275\u0275template(23,Ca,3,3,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(24,14),g.\u0275\u0275template(25,ya,2,0,"mat-header-cell",5),g.\u0275\u0275template(26,xa,3,5,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(27,15),g.\u0275\u0275template(28,Ia,2,0,"mat-header-cell",5),g.\u0275\u0275template(29,wa,2,1,"mat-cell",16),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(30,17),g.\u0275\u0275template(31,Ma,2,0,"mat-header-cell",5),g.\u0275\u0275template(32,Pa,3,3,"mat-cell",16),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(33,18),g.\u0275\u0275template(34,Da,1,0,"mat-header-cell",19),g.\u0275\u0275template(35,ja,8,1,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(36,Oa,1,0,"mat-header-row",20),g.\u0275\u0275template(37,Fa,1,0,"mat-row",21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",e.dataSource),g.\u0275\u0275advance(35),g.\u0275\u0275property("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",e.displayedColumns)}}let Aa=(()=>{class e{constructor(e,t,n,i,r){this.invoicingService=e,this.dialog=t,this.notificationService=n,this.searchFilterService=i,this.mailService=r,this.invoiceState=new g.EventEmitter,this.displayedColumns=["invoiceReference","batchReference","contractReference","invoiceAdressedTo","invoiceAmount","invoiceNetToBePayed","invoiceDeliveryDate","validation","invoiceSaariReference","invoiceCashedOn","buttons"],this.dataSource=new Qn.by}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditInvoice=!1,this.listView=!0,this.dataSource=new Qn.by(this.invoices),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}toggleEditDetails(e){this.isEditInvoice=!0,this.invoiceState.emit(e),this.selectedInvoice=e}deleteInvoice(e){X().fire({text:"Are you sure to delete this invoice ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.invoicingService.deleteInvoice(e.invoiceId).subscribe(()=>{this.notificationService.success("This Invoice is deleted"),this.mailService.invoiceDeleted(e),this.invoicingService.reloadInvoices.next()},()=>{this.notificationService.danger("Delete invoice failed")})}})}getValidationState(e){return 1===e?"validated":"pending"}onSortData(e){this.invoicingService.sortInvoices.next(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(d.YT))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-invoices"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ln.YE,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{project:"project",InvoiceEditable:"InvoiceEditable",invoices:"invoices",isvisibleEditProject:"isvisibleEditProject"},outputs:{invoiceState:"invoiceState"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","invoiceReference",1,"table-hover","table-striped","table-styling"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","batchReference"],["matColumnDef","contractReference"],["matColumnDef","invoiceAdressedTo"],[4,"matCellDef"],["matColumnDef","invoiceAmount"],["matColumnDef","invoiceNetToBePayed"],["matColumnDef","invoiceDeliveryDate"],["matColumnDef","validation"],["matColumnDef","invoiceSaariReference"],["floatLabel","never",4,"matCellDef"],["matColumnDef","invoiceCashedOn"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],[1,"label",3,"ngClass"],["floatLabel","never"],["type","button","matTooltip","Edit Invoice",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete Invoice",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&g.\u0275\u0275template(0,ka,38,4,"div",0),2&e&&g.\u0275\u0275property("ngIf",t.listView)},directives:[i.NgIf,Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,i.NgClass,Qn.XQ,Qn.Gk],pipes:[_e.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-groupHeader[_ngcontent-%COMP%]{color:#030303;background-color:#eceaea;font-weight:bolder;font-size:medium;font-family:Arial,Helvetica,sans-serif}.mat-column-invoiceReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-contractReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceAdressedTo[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceSaariReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceAmount[_ngcontent-%COMP%]{flex:0 0 7%!important;width:7%!important;text-align:right;justify-content:flex-end}.mat-column-invoiceNetToBePayed[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;text-align:right;justify-content:flex-end}.mat-column-invoiceDeliveryDate[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}.mat-column-validation[_ngcontent-%COMP%]{justify-content:center}.mat-column-invoiceCashedOn[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e})();var _a=n(27205);function Va(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",2),g.\u0275\u0275elementStart(1,"div",3),g.\u0275\u0275elementStart(2,"nav",4),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"button",6),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().addInvoiceView()}),g.\u0275\u0275element(5,"em",7),g.\u0275\u0275text(6," Invoice "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",8),g.\u0275\u0275element(8,"app-paginator",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",!e.hasBatches||!e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",e.searchFilterService.pageSize)("pageIndex",e.searchFilterService.pageIndex)("length",e.lengthInvoices)}}function Na(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-invoices",11),g.\u0275\u0275listener("invoiceState",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditDetails(t)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("InvoiceEditable",e.InvoiceEditable)("invoices",g.\u0275\u0275pipeBind3(2,4,e.invoices,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("isvisibleEditProject",e.isvisibleEditProject)}}function Ra(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",10),g.\u0275\u0275elementStart(1,"app-edit-invoice",12),g.\u0275\u0275listener("isSavedInvoice",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().savedInvoice(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isNewInvoice",!e.listView)("batchId",e.batchId)("isEditInvoice",e.isEditInvoice)("selectedInvoice",e.selectedInvoice)("isvisibleEditProject",e.isvisibleEditProject)}}let Ta=(()=>{class e{constructor(e,t,n,i){this.sortService=e,this._avRoute=t,this.invoicingService=n,this.searchFilterService=i,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.subscription=new c.w0}ngOnInit(){const e=this._avRoute.snapshot.paramMap.get("title");null!=e&&"invoices"===e?(this.listView=!1,this.isEditInvoice=!0):(this.listView=!0,this.isEditInvoice=!1),this.subscription.add(this.invoicingService.sortInvoices.subscribe(e=>{this.onSortData(e)})),this.projectHasBatches(),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.invoicesEditable(),this.getInvoiceByProject(),this.subscription.add(this.invoicingService.reloadInvoices.subscribe(e=>{this.getInvoiceByProject()}))}ngOnDestroy(){this.subscription.unsubscribe()}addInvoiceView(){this.listView=!1,this.isEditInvoice=!1,this.selectedInvoice=void 0}invoicesEditable(){return this.InvoiceEditable=this.user.groupId===h.Fl.ProjectManager||this.user.groupId===h.Fl.SuperAdmin||this.user.groupId===h.Fl.Finance||this.user.groupId===h.Fl.Facturation||this.user.qualification===h._W.DepartmentHead,this.InvoiceEditable}toggleEditDetails(e){this.isEditInvoice=!0,this.listView=!1,this.selectedInvoice=e}savedInvoice(e){this.getInvoiceByProject(),this.listView=e,this.isEditInvoice=!e}getInvoiceByProject(){this.invoicingService.getInvoiceByProject(this.project.projectId).subscribe(e=>{this.invoices=[],0!==e.length&&e.forEach(e=>{const t=Object.assign(new Pi.mw,e);t.invoiceAmount&&(t.invoiceAmount=t.invoiceAmount.toString().replace(",",".")),null!=t.invoiceNetToBePayed&&(t.invoiceNetToBePayed=t.invoiceNetToBePayed.replace(",",".")),this.invoices.push(t)}),this.lengthInvoices=this.invoices.length,null!=this.batchId&&(this.listView=!1,this.isEditInvoice=!1,this.selectedInvoice=void 0)}),this.projectHasBatches()}projectHasBatches(){this.invoicingService.getBatchNotInvoiced(this.project.projectId).subscribe(e=>{this.hasBatches=null!=e&&0!==e.length})}onSortData(e){e.active&&""!==e.direction&&void 0!==this.invoices&&this.invoices.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"batchReference":return this.sortService.compare(t.batchReference,n.batchReference,i,!1);case"invoiceReference":return this.sortService.compare(t.invoiceReference,n.invoiceReference,i,!1);case"contractReference":return this.sortService.compare(t.contractReference,n.contractReference,i,!1);case"invoiceAdressedTo":return this.sortService.compare(t.invoiceAdressedTo,n.invoiceAdressedTo,i,!1);case"invoiceAmount":return this.sortService.compare(t.invoiceAmount,n.invoiceAmount,i,!0);case"invoiceNetToBePayed":return this.sortService.compare(t.invoiceNetToBePayed,n.invoiceNetToBePayed,i,!0);case"invoiceDeliveryDate":return this.sortService.compare(t.invoiceDeliveryDate,n.invoiceDeliveryDate,i,!1);case"validation":return t.invoiceDeposit=this.updateInvoiceDeposit(t),n.invoiceDeposit=this.updateInvoiceDeposit(n),this.sortService.compare(t.invoiceDeposit,n.invoiceDeposit,i,!0);case"invoiceSaariReference":return this.sortService.compare(t.invoiceSaariReference,n.invoiceSaariReference,i,!1);case"invoiceCashedOn":return this.sortService.compare(t.invoiceCashedOn,n.invoiceCashedOn,i,!1);default:return 0}}),this.paginatorPipe.transform(this.invoices,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}updateInvoiceDeposit(e){return 1!==e.invoiceDeposit&&(e.invoiceDeposit=0),e.invoiceDeposit}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(ke.X),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-invoice"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject",batchId:"batchId"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-disable","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"project","InvoiceEditable","invoices","isvisibleEditProject","invoiceState"],[3,"project","isNewInvoice","batchId","isEditInvoice","selectedInvoice","isvisibleEditProject","isSavedInvoice"]],template:function(e,t){1&e&&(g.\u0275\u0275template(0,Va,9,4,"div",0),g.\u0275\u0275template(1,Na,3,8,"div",1),g.\u0275\u0275template(2,Ra,2,6,"div",1)),2&e&&(g.\u0275\u0275property("ngIf",t.listView),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isEditInvoice||!t.listView))},directives:[i.NgIf,ft.M2,qn.J,Aa,_a.b],pipes:[_i.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.date-field[_ngcontent-%COMP%]{font-size:14px}"]}),e})();const Ba=["ngbNav"];function za(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",17),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).deletepif()}),g.\u0275\u0275element(1,"em",18),g.\u0275\u0275elementEnd()}}function qa(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",19),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).addActivity()}),g.\u0275\u0275element(1,"em",20),g.\u0275\u0275text(2," Task "),g.\u0275\u0275elementEnd()}}function La(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",21),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).displayProjectDetails()}),g.\u0275\u0275element(1,"em",22),g.\u0275\u0275elementEnd()}}function Qa(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",23),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).displayWbsGantt()}),g.\u0275\u0275element(1,"em",24),g.\u0275\u0275elementEnd()}}function $a(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",25),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).displayWbs()}),g.\u0275\u0275element(1,"em",24),g.\u0275\u0275elementEnd()}2&e&&g.\u0275\u0275property("hidden",!0)}function Ua(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",26),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).displayInvoicing()}),g.\u0275\u0275element(1,"em",27),g.\u0275\u0275elementEnd()}}const Ha=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}},Ga=function(e,t,n,i,r){return{"label-primary":e,"label-success":t,"label-warning":n,"label-danger":i,"label-default":r}};function Wa(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",4),g.\u0275\u0275elementStart(1,"div",5),g.\u0275\u0275elementStart(2,"div",6),g.\u0275\u0275elementStart(3,"h5"),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"label",7),g.\u0275\u0275text(6),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"label",7),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"div",8),g.\u0275\u0275elementStart(10,"button",9),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().goBack()}),g.\u0275\u0275element(11,"em",10),g.\u0275\u0275text(12," Projects "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(13,za,2,0,"button",11),g.\u0275\u0275template(14,qa,3,0,"button",12),g.\u0275\u0275template(15,La,2,0,"button",13),g.\u0275\u0275template(16,Qa,2,0,"button",14),g.\u0275\u0275template(17,$a,2,1,"button",15),g.\u0275\u0275template(18,Ua,2,0,"button",16),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate2("",e.project.name," [",e.project.abreviation,"]"),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(12,Ha,e.project.SQAVisa===e.PifVisa.Valid,e.project.SQAVisa===e.PifVisa.Invalid,e.project.SQAVisa===e.PifVisa.InProgress)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e.project.SQAVisa," "),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction5(16,Ga,e.project.status===e.ProjectStatusLabel.Planned,e.project.status===e.ProjectStatusLabel.InProgress,e.project.status===e.ProjectStatusLabel.Completed,e.project.status===e.ProjectStatusLabel.Blocked,e.project.status===e.ProjectStatusLabel.Closed)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1("",e.project.status," "),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngIf",void 0!==e.isProject&&!0!==e.isProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isdisplayedWbsGantt&&e.isSuperAdminOrManagerOrDH()&&e.isProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isProject&&e.isInvoicingUser()),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isProject&&e.isInvoicingUser()),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isProject&&e.isInvoicingUser())}}function Ja(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",39),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(3).toggleEditDetails()}),g.\u0275\u0275text(1," edit "),g.\u0275\u0275elementEnd()}}function Ya(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"span"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(3);g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.project.description)}}function Ka(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",4),g.\u0275\u0275elementStart(1,"div"),g.\u0275\u0275template(2,Ja,2,0,"mat-icon",36),g.\u0275\u0275elementStart(3,"div"),g.\u0275\u0275elementStart(4,"h5",37),g.\u0275\u0275text(5,"Project Details"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(6,Ya,2,1,"span",38),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!e.isEditDetails&&e.isvisibleEditProject),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",!e.isEditDetails)}}function Xa(e,t){if(1&e&&g.\u0275\u0275element(0,"app-view-details",40),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("project",e.project)("isProject",e.isProject)}}function Za(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"app-edit-details",41),g.\u0275\u0275listener("projectEvent",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext(2).projectEvent(t)}),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("project",e.project)("projectId",e.project.projectId)("pifId",e.project.pifId)("isProject",e.isProject)("isNewPif",e.isNewPif)}}function eo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",42),g.\u0275\u0275element(1,"app-view-decision",43),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("pifId",e.project.pifId)("isvisibleEditProject",e.isvisibleEditProject)("canEditProject",e.canEditProject)}}function to(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",46),g.\u0275\u0275element(1,"app-team-members",47),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(3);g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)("canEditProject",e.canEditProject)("isProject",e.isProject)}}function no(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",44),g.\u0275\u0275template(1,to,2,4,"div",45),g.\u0275\u0275elementStart(2,"div",46),g.\u0275\u0275element(3,"app-attached-document",47),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!e.isNewPif),g.\u0275\u0275advance(2),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)("canEditProject",e.canEditProject)("isProject",e.isProject)}}const io=function(e,t){return{"col-sm-12":e,"col-sm-8":t}};function ro(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",28),g.\u0275\u0275elementStart(1,"div",29),g.\u0275\u0275elementStart(2,"div",5),g.\u0275\u0275elementStart(3,"div",30),g.\u0275\u0275elementStart(4,"div",0),g.\u0275\u0275template(5,Ka,7,2,"div",1),g.\u0275\u0275elementStart(6,"div",31),g.\u0275\u0275template(7,Xa,1,2,"app-view-details",32),g.\u0275\u0275template(8,Za,1,5,"app-edit-details",33),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(9,eo,2,3,"div",34),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(10,no,4,5,"div",35),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction2(7,io,e.isNewPif,!e.isNewPif)),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!e.isNewPif),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!(e.isNewPif||e.isEditDetails)),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",e.isNewPif||e.isEditDetails),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!e.isNewPif),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!e.isNewPif)}}function ao(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",28),g.\u0275\u0275elementStart(1,"app-wbs-gantt",48),g.\u0275\u0275listener("initializeTopActivityEvent",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().initializeTopActivity(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("updateWbsData",e.updateWbsData)}}function oo(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",28),g.\u0275\u0275elementStart(1,"app-wbs",48),g.\u0275\u0275listener("initializeTopActivityEvent",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().initializeTopActivity(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("updateWbsData",e.updateWbsData)}}function so(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",57),g.\u0275\u0275elementStart(1,"div",58),g.\u0275\u0275elementStart(2,"div",59),g.\u0275\u0275elementStart(3,"div",5),g.\u0275\u0275elementStart(4,"div",60),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function lo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275element(1,"app-price",61),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function co(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275element(1,"app-estimate",61),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function mo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275element(1,"app-order",62),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)("orderId",e.selectedOrderId)}}function po(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275element(1,"app-batch",61),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)}}function ho(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275element(1,"app-invoice",63),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("@fadeInOutTranslate",void 0),g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e.project)("isvisibleEditProject",e.isvisibleEditProject)("batchId",e.selectedBatchId)}}function uo(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",49),g.\u0275\u0275template(1,so,6,0,"div",50),g.\u0275\u0275elementStart(2,"ul",51,52),g.\u0275\u0275listener("activeIdChange",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().activeId=t}),g.\u0275\u0275elementStart(4,"li",53),g.\u0275\u0275elementStart(5,"a",54),g.\u0275\u0275elementStart(6,"mat-icon"),g.\u0275\u0275text(7,"monetization_on"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(8," Prices "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(9,lo,2,3,"ng-template",55),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(10,"li",53),g.\u0275\u0275elementStart(11,"a",54),g.\u0275\u0275elementStart(12,"mat-icon"),g.\u0275\u0275text(13,"assignment"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(14," Quotations "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(15,co,2,3,"ng-template",55),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"li",53),g.\u0275\u0275elementStart(17,"a",54),g.\u0275\u0275elementStart(18,"mat-icon"),g.\u0275\u0275text(19,"assignment_turned_in"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(20," Orders "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(21,mo,2,4,"ng-template",55),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"li",53),g.\u0275\u0275elementStart(23,"a",54),g.\u0275\u0275elementStart(24,"mat-icon"),g.\u0275\u0275text(25,"card_travel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(26," Batches "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(27,po,2,3,"ng-template",55),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"li",53),g.\u0275\u0275elementStart(29,"a",54),g.\u0275\u0275elementStart(30,"mat-icon"),g.\u0275\u0275text(31,"library_books"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(32," Invoices "),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(33,ho,2,4,"ng-template",55),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(34,"div",56),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275reference(3),t=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("activeId",t.activeId),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngbNavItem",1),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngbNavItem",2),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngbNavItem",3),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngbNavItem",4),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngbNavItem",5),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngbNavOutlet",e)}}let go=(()=>{class e{constructor(e,t){this.cdRef=t,this.isProject=void 0,this.isPif=!1,this.isNewPif=!1,this.canEditProject=!0,this.isvisibleEditProject=!1,this.editDetailsIcon="icofont-edit",this.pifCost=new o.FormControl("",[o.Validators.required,o.Validators.min(0)]),this.isdisplayedProjectDetails=!0,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1,this.updateWbsData=new c.xQ,this.isActivityManager=!1,this.subscription=new c.w0,this.activeId=1,this.PifVisa=m.CB,this.ProjectStatusLabel=m.tU,this.previousState={getPrevious:!1,type:null,pageIndex:null,pageSize:null},this._avRoute=e.get(a.gz),this._router=e.get(a.F0),this.activeRoute=e.get(a.gz),this.dtService=e.get(d.Cv),this.location=e.get(i.Location),this.projectService=e.get(p.Y4),this.dialog=e.get(l.uw),this.invoicingService=e.get(ke.X),this.notificationService=e.get(d.gq)}ngOnInit(){null!=this._avRoute.snapshot.paramMap.get("title")&&(this.isdisplayedInvoicing=!0,this.isdisplayedProjectDetails=!1),this.user=JSON.parse(localStorage.getItem("currentUser")),this._avRoute.params.subscribe(e=>{this.project=new m.IK,this.project.pifId=e.pifId,this.project.projectId=e.projectId,e.pifId?this.getProjectDetails(e.pifId,e.projectId):(this.isNewPif=!0,this.isProject=!1,this.isEditDetails=!0,this.project=new m.IK,this.project.status=m.tU.Planned,this.project.managerId=+this.user.userId,this.project.managerName=this.user.userName,this.project.activityId=this.user.activityId)}),this.projectService.toggleEditDetails.subscribe(()=>{this.toggleEditDetails()}),this.projectService.pifIsApproved.subscribe(e=>{0!==e&&(this.isProject=!0),this.project.projectId=e,this.location.go("/project-management/project/edit/"+this.project.pifId+"/"+this.project.projectId),this.projectService.reloadTeam.next(),this.getProjectDetails(this.project.pifId,this.project.projectId)}),this.subscription.add(this.invoicingService.goToOrder.subscribe(e=>{e&&(this.selectedOrderId=e,this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},1e3),this.activeId=3),this.selectedOrderId=e})),this.subscription.add(this.invoicingService.invoiceBatch.subscribe(e=>{e&&(this.selectedBatchId=e,this.isLoading=!0,setTimeout(()=>{this.isLoading=!1},1e3),this.activeId=5),this.selectedBatchId=e})),this.subscription.add(this.projectService.previousState.subscribe(e=>{e&&(this.previousState.pageIndex=e.pageIndex,this.previousState.type=e.type,this.previousState.pageSize=e.pageSize)}))}ngOnDestroy(){this.subscription.unsubscribe()}ngAfterViewInit(){const e=this._avRoute.snapshot.paramMap.get("title");null!=e&&("invoices"===e&&(this.activeId=5),"batches"===e&&(this.activeId=4),"orders"===e&&(this.activeId=3),"estimates"===e&&(this.activeId=2),"costs"===e&&(this.activeId=1))}ngAfterViewChecked(){this.cdRef.detectChanges()}getProjectDetails(e,t){this.projectService.getProjectDetails(e,t).subscribe(e=>{null==e[0]||(this.project=Object.assign(new m.IK,e[0]),this.isEditDetails=!1,this.isPif=0===this.project.projectId,this.isProject=0!==this.project.projectId,this.canEditProject=this.project.status!==m.tU.Closed,this.isNewPif=!1,this.isPif&&(this.project.realStartDate=null,this.project.realEndDate=null),this.isActivityManagersPifProject(this.user.activityId,this.project.pifId))})}canDeactivate(){return!0}addNewProject(){this._router.navigate(["../../../add"],{relativeTo:this.activeRoute})}toggleEditDetails(){this.isEditDetails=!this.isEditDetails}VisibleEditProject(){this.user=JSON.parse(localStorage.getItem("currentUser")),(this.project.managerId===+this.user.userId||this.user.groupId===h.Fl.SuperAdmin||this.isActivityManager)&&(this.isvisibleEditProject=!0)}projectEvent(e){this.getProjectDetails(e.pifId,e.projectId)}initializeTopActivity(e){this.topActivity=e}addActivity(){this.addActivitydialogRef=this.dialog.open(Pe,{disableClose:!1,hasBackdrop:!0,width:"800px",height:"590px",data:{mode:"add",departmentId:this.project.departmentId,activity:this.topActivity,parentStartDate:this.project.plannedStartDate,parentEndDate:this.project.plannedEndDate}}),this.addActivitydialogRef.afterClosed().subscribe(()=>{this.updateWbsData.next()})}displayProjectDetails(){this.isdisplayedProjectDetails=!0,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1}displayWbsGantt(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!0,this.isdisplayedInvoicing=!1}displayWbs(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1}displayInvoicing(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!0}isSuperAdminOrManagerOrDH(){return this.user.groupId===h.Fl.ProjectManager||this.user.groupId===h.Fl.SuperAdmin||this.user.qualification===h._W.DepartmentHead}isInvoicingUser(){return void 0!==this.user.functionsId.find(e=>e===h.FI.Invoice)}isActivityManagersPifProject(e,t){this.projectService.isActivityManagersPifProject(e,t).subscribe(e=>{0!==e[0].count&&this.user.groupId===h.Fl.ProjectManager&&(this.isActivityManager=!0),this.VisibleEditProject()})}deletepif(){X().fire({text:"Are you sure to delete this Pif ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.projectService.deletePif(this.project.pifId).subscribe(()=>{this.notificationService.success("Pif is successfully deleted"),this._router.navigate(["/project-management/project/list"])},()=>{this.notificationService.danger("Delete pif failed")})}})}goBack(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.projectService.previousState.next(this.previousState)),this._router.navigate(["/project-management/project/list"])}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(g.Injector),g.\u0275\u0275directiveInject(g.ChangeDetectorRef))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-project"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ba,5),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.ngbNav=e.first)}},decls:6,vars:5,consts:[[1,"card"],["class","card-header",4,"ngIf"],["class","md-tabs md-card-tabs",4,"ngIf"],["class","md-tabs md-card-tabs m-t-10",4,"ngIf"],[1,"card-header"],[1,"row"],[1,"col-md-7"],[1,"label",3,"ngClass"],[1,"col-md-5",2,"text-align","right"],["type","button","matTooltip","Back to Projects",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-reply"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Delete Pif",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Add task",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Project Details",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Wbs Gantt",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Wbs",3,"hidden","click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary ripple light","style","font-size:inherit;","matTooltip","Invoicing",3,"click",4,"ngIf"],["type","button","matTooltip","Delete Pif",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-bin"],["type","button","matTooltip","Add task",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],["type","button","matTooltip","Project Details",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-listine-dots"],["type","button","matTooltip","Wbs Gantt",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-table"],["type","button","matTooltip","Wbs",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"hidden","click"],["type","button","matTooltip","Invoicing",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-cur-dollar"],[1,"md-tabs","md-card-tabs"],[1,"m-t-10"],[3,"ngClass"],[1,"card-body"],[3,"project","isProject",4,"ngIf"],[3,"project","projectId","pifId","isProject","isNewPif","projectEvent",4,"ngIf"],["class","col-sm-4",4,"ngIf"],["class","row m-t-10",4,"ngIf"],["class","edit-project-ico","matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-header-text"],[4,"ngIf"],["matTooltip","Edit",1,"edit-project-ico",3,"click"],[3,"project","isProject"],[3,"project","projectId","pifId","isProject","isNewPif","projectEvent"],[1,"col-sm-4"],[3,"pifId","isvisibleEditProject","canEditProject"],[1,"row","m-t-10"],["class","col-xl-6 col-md-12",4,"ngIf"],[1,"col-xl-6","col-md-12"],[3,"project","isvisibleEditProject","canEditProject","isProject"],[3,"project","updateWbsData","initializeTopActivityEvent"],[1,"md-tabs","md-card-tabs","m-t-10"],["class","overlay",4,"ngIf"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[3,"project","isvisibleEditProject"],[3,"project","isvisibleEditProject","orderId"],[3,"project","isvisibleEditProject","batchId"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275template(1,Wa,19,22,"div",1),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(2,ro,11,10,"div",2),g.\u0275\u0275template(3,ao,2,2,"div",2),g.\u0275\u0275template(4,oo,2,2,"div",2),g.\u0275\u0275template(5,uo,35,8,"div",3)),2&e&&(g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.isNewPif),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isdisplayedProjectDetails),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isdisplayedWbsGantt),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isdisplayedWbs),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isdisplayedInvoicing))},directives:[i.NgIf,i.NgClass,ne.gM,Ae.Hw,Ve,et,wt,Ut,on,un,Tn,ft.Pz,ft.nv,ft.Vx,ft.uN,ft.tO,Bn.$g,Ti,Ui,Dr,oa,Ta],styles:[".card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.card-header[_ngcontent-%COMP%]   .add-project-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:25px}.card-header[_ngcontent-%COMP%]   .projects-list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:25px}.card-header[_ngcontent-%COMP%]   .edit-project-ico[_ngcontent-%COMP%]{margin-left:15px}.card-body[_ngcontent-%COMP%]{padding:0 20px}.details-card[_ngcontent-%COMP%]{min-height:534px}.btn-circle.btn-xl[_ngcontent-%COMP%]{width:40px;height:40px;padding:8px 10px;border-radius:35px;font-size:18px;line-height:1.33}.btn-circle[_ngcontent-%COMP%]{width:30px;height:30px;padding:6px 0;border-radius:15px;text-align:center;font-size:12px;line-height:1.42857}.material-icons[_ngcontent-%COMP%]{font-size:25px}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"],data:{animation:[(0,s.X$)("fadeInOutTranslate",[(0,s.eR)(":enter",[(0,s.oB)({opacity:0}),(0,s.jt)("400ms ease-in-out",(0,s.oB)({opacity:1}))]),(0,s.eR)(":leave",[(0,s.oB)({transform:"translate(0)"}),(0,s.jt)("400ms ease-in-out",(0,s.oB)({opacity:0}))])])]}}),e})();var fo=n(63753),vo=n(19992),So=n(67827);function bo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Reference"),g.\u0275\u0275elementEnd())}function Co(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",19),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.missionReference),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.missionReference," ")}}function yo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Resource"),g.\u0275\u0275elementEnd())}function Eo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.ressourceName," ")}}function xo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Customer"),g.\u0275\u0275elementEnd())}function Io(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",19),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.clientName),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.clientName," ")}}function wo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Start Date"),g.\u0275\u0275elementEnd())}function Mo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.missionStartDate)," ")}}function Po(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1," End Date"),g.\u0275\u0275elementEnd())}function Do(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.missionEndDate)," ")}}function jo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Invoicing"),g.\u0275\u0275elementEnd())}function Oo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.isInvoiced," ")}}function Fo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",18),g.\u0275\u0275text(1,"Status"),g.\u0275\u0275elementEnd())}const ko=function(e,t){return{"label-default":e,"label-info":t}};function Ao(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"label",20),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction2(2,ko,1===e.missionAnnuler,0===e.missionAnnuler)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.etatMission,"")}}function _o(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function Vo(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",21),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).toggleEditDetails(t.missionId)}),g.\u0275\u0275elementStart(2,"em",22),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(4," \xa0\xa0 "),g.\u0275\u0275elementStart(5,"button",23),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).deleteMission(t)}),g.\u0275\u0275elementStart(6,"em",22),g.\u0275\u0275text(7,"delete"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(8," \xa0\xa0 "),g.\u0275\u0275elementStart(9,"button",24),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).cancelMission(t)}),g.\u0275\u0275elementStart(10,"em",22),g.\u0275\u0275text(11,"cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",n.forbiddenDeleteCancel),g.\u0275\u0275advance(4),g.\u0275\u0275property("disabled",n.forbiddenDeleteCancel||1===e.missionAnnuler)}}function No(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",25)}function Ro(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function To(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275elementStart(1,"mat-table",2,3),g.\u0275\u0275listener("matSortChange",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onSortData(t)}),g.\u0275\u0275elementContainerStart(3,4),g.\u0275\u0275template(4,bo,2,0,"mat-header-cell",5),g.\u0275\u0275template(5,Co,2,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,7),g.\u0275\u0275template(7,yo,2,0,"mat-header-cell",5),g.\u0275\u0275template(8,Eo,2,1,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,9),g.\u0275\u0275template(10,xo,2,0,"mat-header-cell",5),g.\u0275\u0275template(11,Io,2,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,10),g.\u0275\u0275template(13,wo,2,0,"mat-header-cell",5),g.\u0275\u0275template(14,Mo,3,3,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,11),g.\u0275\u0275template(16,Po,2,0,"mat-header-cell",5),g.\u0275\u0275template(17,Do,3,3,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,12),g.\u0275\u0275template(19,jo,2,0,"mat-header-cell",5),g.\u0275\u0275template(20,Oo,2,1,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,13),g.\u0275\u0275template(22,Fo,2,0,"mat-header-cell",5),g.\u0275\u0275template(23,Ao,3,5,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(24,14),g.\u0275\u0275template(25,_o,1,0,"mat-header-cell",15),g.\u0275\u0275template(26,Vo,12,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(27,No,1,0,"mat-header-row",16),g.\u0275\u0275template(28,Ro,1,0,"mat-row",17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",e.dataSource),g.\u0275\u0275advance(26),g.\u0275\u0275property("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",e.displayedColumns)}}let Bo=(()=>{class e{constructor(e,t,n,i,r,a){this.notificationService=e,this.dialog=t,this.searchFilterService=n,this.router=i,this.missionService=r,this.mailService=a,this.displayedColumns=["missionReference","ressourceName","clientName","missionStartDate","missionEndDate","invoice","etatMission","buttons"],this.dataSource=new Qn.by,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenDeleteCancel=!0,this.listView=!1}ngOnInit(){this.forbiddenDeleteCancel=this.currentUser.groupId!==h.Fl.SuperAdmin&&this.currentUser.groupId!==h.Fl.ProjectManager,0!==this.missions.length&&(this.listView=!0),this.selectedMissionId=0,this.dataSource=new Qn.by(this.missions),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}toggleEditDetails(e){this.missionService.previousState.next({pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["/project-management/project/edit-mission/"+e])}deleteMission(e){X().fire({text:`Are you sure to delete this Mission for ${e.ressourceName} ?`,icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.missionService.deleteMission(e.missionId).subscribe(e=>{0!==e?(this.notificationService.success("This Mission is deleted"),this.missionService.savedMission.next("refresh")):this.notificationService.danger("Delete Mission failed")},()=>{this.notificationService.danger("Delete Mission failed")})}})}cancelMission(e){X().fire({text:`Are you sure to cancel this Mission for ${e.ressourceName} ?`,icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:()=>{this.missionService.cancelMission(e.missionId).subscribe(t=>{0!==t?(this.notificationService.success("This Mission is canceled"),this.missionService.savedMission.next("refresh"),this.mailService.missionCanceled(e)):this.notificationService.danger("Cancel Mission failed")},()=>{this.notificationService.danger("Cancel Mission failed")})}})}onSortData(e){this.missionService.sortMissions.next(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.YT))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-missions-table"]],inputs:{missions:"missions"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","missionReference",1,"table-hover","table-striped","table-styling"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","ressourceName"],[4,"matCellDef"],["matColumnDef","clientName"],["matColumnDef","missionStartDate"],["matColumnDef","missionEndDate"],["matColumnDef","invoice"],["matColumnDef","etatMission"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"label",3,"ngClass"],["type","button","matTooltip","Edit Mission",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete Mission",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],["type","button","matTooltip","Cancel Mission",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&g.\u0275\u0275template(0,To,29,4,"div",0),2&e&&g.\u0275\u0275property("ngIf",t.listView)},directives:[i.NgIf,Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,i.NgClass,Qn.XQ,Qn.Gk],pipes:[_e.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}table[_ngcontent-%COMP%]{width:100%}.mat-column-missionReference[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-Ressource[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-clientName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 20%!important;width:20%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-missionStartDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-missionEndDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-invoicing[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-etatMission[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 11%!important;width:11%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-buttons[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 12%!important;width:12%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}  .mat-sort-header-arrow{color:#fff}"]}),e})();function zo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function qo(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",35),g.\u0275\u0275elementStart(1,"div",36),g.\u0275\u0275elementStart(2,"div",37),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",38),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function Lo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",39),g.\u0275\u0275element(1,"app-missions-table",40),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275classProp("blurred",e.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("missions",g.\u0275\u0275pipeBind3(2,3,e.missions,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))}}let Qo=(()=>{class e{constructor(e){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.dropdownSettings={},this.dropdownSettingsStatus={},this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.statusIdentifiers=[{id:m.rs.Active,description:"Active"},{id:m.rs.Canceled,description:"Canceled"}],this.selectedStatusesIdentifiers=[],this.forbiddenAddMission=!0,this.missions=[],this.isLoading=!1,this.destroyed=new c.xQ,this.missionService=e.get(p.Fn),this.projectService=e.get(p.Y4),this.searchFilterService=e.get(d.nJ),this.sortService=e.get(d.Kx),this.excelService=e.get(d.xB),this.dateTimeService=e.get(d.Cv),this.router=e.get(a.F0),this.paginatorPipe=new zn.Ry(this.searchFilterService)}ngOnInit(){this.forbiddenAddMission=this.currentUser.groupId!==h.Fl.SuperAdmin&&this.currentUser.groupId!==h.Fl.ProjectManager,this.listView=!1,this.emptyResult=!1,this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownSettingsStatus={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.selectedStatusesIds=this.statusIdentifiers.map(e=>e.id).join(","),this.getClients(),this.subscription=this.missionService.sortMissions.subscribe(e=>{this.onSortData(e)}),this.getPersistedFilter(),this.refreshSubscription=this.missionService.savedMission.subscribe(e=>{"refresh"===e&&(this.getPersistedFilter(),this.getMissions(),this.missionService.savedMission.next("done"))}),this.subscription.add(this.missionService.previousState.pipe((0,Ne.R)(this.destroyed)).subscribe(e=>{e&&e.getPrevious&&(this.filterMissionButton(),this.searchFilterService.pageSize=e.pageSize,this.searchFilterService.pageIndex=e.pageIndex,this.destroyed.next(),this.missionService.previousState.next())}))}ngOnDestroy(){this.subscription.unsubscribe(),this.refreshSubscription.unsubscribe()}getClients(){this.projectService.getClients().subscribe(e=>{null!=e&&(this.customersIdentifiers=e,null==this.selectedCustomersIds||(this.selectedCustomersIds=this.customersIdentifiers.map(e=>e.id).join(",")))})}filterMissionButton(){this.searchFilterService.pageIndex=0,this.persistFilter(),this.getMissions()}onResetAllFilters(){sessionStorage.removeItem("missionSearch");const e=new Date;this.fromDate=new Date(e.getFullYear(),e.getMonth()-1,1),this.toDate=new Date(e.getFullYear(),e.getMonth()+2,0),this.resourceName="",this.missionReference="",this.selectedStatusesIdentifiers=[],this.selectedCustomersIdentifiers=[]}dateOnly(e){return this.dateTimeService.dateOnly(e)}onSortData(e){e.active&&""!==e.direction&&void 0!==this.missions&&this.missions.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"missionReference":return this.sortService.compare(t.missionReference,n.missionReference,i,!1);case"ressourceName":return this.sortService.compare(t.ressourceName,n.ressourceName,i,!1);case"clientName":return this.sortService.compare(t.clientName,n.clientName,i,!1);case"missionStartDate":return this.sortService.compare(t.missionStartDate,n.missionStartDate,i,!1);case"missionEndDate":return this.sortService.compare(t.missionEndDate,n.missionEndDate,i,!1);case"invoice":return this.sortService.compare(t.isInvoiced,n.isInvoiced,i,!1);case"etatMission":return this.sortService.compare(t.etatMission,n.etatMission,i,!1);default:return 0}}),this.paginatorPipe.transform(this.missions,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}addMission(){this.router.navigate(["/project-management/project/add-mission"])}onClickingEnter(e){"Enter"===e.key&&this.filterMissionButton()}persistFilter(){const e=new m.sf;e.periodFrom=this.fromDate,e.periodTo=this.toDate,e.resourceName=this.resourceName,e.missionReference=this.missionReference,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,sessionStorage.setItem("missionSearch",JSON.stringify(e))}getPersistedFilter(){const e=JSON.parse(sessionStorage.getItem("missionSearch"));if(null!==e)null!=e.periodFrom&&(this.fromDate=e.periodFrom),null!=e.periodTo&&(this.toDate=e.periodTo),this.resourceName=e.resourceName,this.missionReference=e.missionReference,this.selectedStatusesIdentifiers=e.selectedStatusesIdentifiers,this.selectedCustomersIdentifiers=e.selectedCustomersIdentifiers;else{const e=new Date;this.fromDate=new Date(e.getFullYear(),e.getMonth()-1,1),this.toDate=new Date(e.getFullYear(),e.getMonth()+2,0)}}getMissions(){this.isLoading=!0,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(e=>e.id).join(","),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(e=>e.id).join(","),this.missionService.getMissions(21===this.currentUser.groupId?this.currentUser.activityId:0,this.resourceName,this.missionReference,this.selectedCustomersIds,this.fromDate,this.toDate,this.selectedStatusesIds).subscribe(e=>{null!=e&&(this.missions=e,this.lengthMissions=this.missions.length,this.listView=0!==e.length),this.isLoading=!1})}exportToExcel(){void 0!==this.missions&&0!==this.missions.length&&(this.isLoading=!0,this.getPersistedFilter(),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(e=>e.id).join(","),this.missionService.getMissionsDetailsToExport(21===this.currentUser.groupId?this.currentUser.activityId:0,this.resourceName,this.missionReference,this.selectedCustomersIds,this.fromDate,this.toDate,this.selectedStatusesIds).subscribe(e=>{if(void 0!==e&&0!==e.length){const t=[{header:"Matricule",key:"userNumber",width:10},{header:"Resource",key:"userName",width:30},{header:"Customer",key:"clientName",width:25},{header:"Project",key:"projectName",width:30},{header:"Start Date",key:"missionStartDate",width:12},{header:"End Date",key:"missionEndDate",width:12},{header:"Status",key:"status",width:10},{header:"Mission Order Ref.",key:"missionOrderReference",width:25},{header:"Company",key:"companyName",width:25},{header:"Served TND",key:"servedAmountTnd",width:12},{header:"Served \u20ac",key:"servedAmountEuro",width:12},{header:"Ticket TND",key:"ticketCostTnd",width:12},{header:"Ticket \u20ac",key:"ticketCostEuro",width:12},{header:"Stamp Tnd",key:"stampCostTnd",width:12},{header:"Stamp \u20ac",key:"stampCostEuro",width:12},{header:"Assur. TND",key:"assuranceTnd",width:12},{header:"Assur. \u20ac",key:"assuranceEuro",width:12},{header:"Rate \u20ac/TND",key:"currencyRate",width:12}],n=[],i=[],r=[];r.push({cell:"A1",font:{bold:!0}},{cell:"B1",font:{bold:!0}},{cell:"C1",font:{bold:!0}},{cell:"D1",font:{bold:!0}},{cell:"E1",font:{bold:!0}},{cell:"F1",font:{bold:!0}},{cell:"G1",font:{bold:!0}},{cell:"H1",font:{bold:!0}},{cell:"I1",font:{bold:!0}},{cell:"J1",font:{bold:!0}},{cell:"K1",font:{bold:!0}},{cell:"L1",font:{bold:!0}},{cell:"M1",font:{bold:!0}},{cell:"N1",font:{bold:!0}},{cell:"O1",font:{bold:!0}},{cell:"P1",font:{bold:!0}},{cell:"Q1",font:{bold:!0}},{cell:"R1",font:{bold:!0}}),e.forEach(e=>{const t=[];t.push(e.userNumber),t.push(e.userName),t.push(e.clientName),t.push(e.projectName),t.push(this.dateFormat(e.missionStartDate)),t.push(this.dateFormat(e.missionEndDate)),t.push(e.status),t.push(e.missionOrderReference),t.push(e.companyName),t.push(e.servedAmountTnd),t.push(e.servedAmountEuro),t.push(e.ticketCostTnd),t.push(e.ticketCostEuro),t.push(e.stampCostTnd),t.push(e.stampCostEuro),t.push(e.assuranceTnd),t.push(e.assuranceEuro),t.push(e.currencyRate),n.push(t)}),this.excelService.generateExcel(t,n,i,r,"Missions")}this.isLoading=!1},()=>{this.notificationService.danger("Failed to export missions"),this.isLoading=!1}))}dateFormat(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(g.Injector))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-missions"]],decls:66,vars:25,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From",3,"matDatepicker","max","ngModel","keypress","ngModelChange","keydown"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To",3,"matDatepicker","min","ngModel","keypress","ngModelChange","keydown"],["picker22",""],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","ngModelChange","keydown"],[1,"col-sm-10"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],["type","button",1,"export","btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"loaded-content"],[3,"missions"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"div",1),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"mat-list"),g.\u0275\u0275elementStart(8,"mat-list-item"),g.\u0275\u0275elementStart(9,"h3",6),g.\u0275\u0275text(10,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"mat-form-field",7),g.\u0275\u0275elementStart(12,"input",8),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.fromDate=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(13,"mat-datepicker-toggle",9),g.\u0275\u0275element(14,"mat-datepicker",null,10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",7),g.\u0275\u0275elementStart(17,"input",11),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.toDate=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(18,"mat-datepicker-toggle",9),g.\u0275\u0275element(19,"mat-datepicker",null,12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"mat-list-item"),g.\u0275\u0275elementStart(22,"h3",6),g.\u0275\u0275text(23,"Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",13),g.\u0275\u0275elementStart(25,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionReference=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",5),g.\u0275\u0275elementStart(27,"mat-list"),g.\u0275\u0275elementStart(28,"mat-list-item"),g.\u0275\u0275elementStart(29,"h3",6),g.\u0275\u0275text(30,"Customer"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"div",15),g.\u0275\u0275elementStart(32,"ng-multiselect-dropdown",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedCustomersIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"mat-list-item"),g.\u0275\u0275elementStart(34,"h3",6),g.\u0275\u0275text(35,"Resource"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-form-field",13),g.\u0275\u0275elementStart(37,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.resourceName=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"div",17),g.\u0275\u0275elementStart(39,"mat-list"),g.\u0275\u0275elementStart(40,"mat-list-item"),g.\u0275\u0275elementStart(41,"h3",6),g.\u0275\u0275text(42,"Status"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"div",15),g.\u0275\u0275elementStart(44,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"div",19),g.\u0275\u0275elementStart(46,"div",20),g.\u0275\u0275elementStart(47,"button",21),g.\u0275\u0275listener("click",function(){return t.filterMissionButton()}),g.\u0275\u0275text(48,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(49,"div",20),g.\u0275\u0275elementStart(50,"button",22),g.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),g.\u0275\u0275text(51,"Reset"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(52,"nav",23),g.\u0275\u0275elementStart(53,"div",24),g.\u0275\u0275elementStart(54,"button",25),g.\u0275\u0275listener("click",function(){return t.addMission()}),g.\u0275\u0275element(55,"em",26),g.\u0275\u0275text(56," Mission "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"button",27),g.\u0275\u0275listener("click",function(){return t.exportToExcel()}),g.\u0275\u0275element(58,"em",28),g.\u0275\u0275text(59," Export "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(60,"div",29),g.\u0275\u0275element(61,"app-paginator",30),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(62,zo,3,0,"div",31),g.\u0275\u0275elementStart(63,"div",32),g.\u0275\u0275template(64,qo,6,0,"div",33),g.\u0275\u0275template(65,Lo,3,7,"div",34),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(15),n=g.\u0275\u0275reference(20);g.\u0275\u0275advance(12),g.\u0275\u0275property("matDatepicker",e)("max",t.toDate)("ngModel",t.fromDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(4),g.\u0275\u0275property("matDatepicker",n)("min",t.fromDate)("ngModel",t.toDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(7),g.\u0275\u0275property("ngModel",t.missionReference),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",t.customersIdentifiers)("ngModel",t.selectedCustomersIdentifiers)("settings",t.dropdownSettings),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngModel",t.resourceName),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("settings",t.dropdownSettingsStatus)("data",t.statusIdentifiers)("ngModel",t.selectedStatusesIdentifiers),g.\u0275\u0275advance(10),g.\u0275\u0275property("disabled",t.forbiddenAddMission),g.\u0275\u0275advance(7),g.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthMissions),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",0===t.lengthMissions),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView)}},directives:[vo.i$,vo.Tg,b.KE,C.Nt,E.hl,o.DefaultValueAccessor,o.NgControlStatus,o.NgModel,E.nW,b.R9,E.Mq,So.OP,ft.M2,qn.J,i.NgIf,Bn.$g,Bo],pipes:[_i.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e})();var $o=n(60428);const Uo=["missionExpenseForm"];function Ho(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",30),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let Go=(()=>{class e{constructor(e,t,n,i,r,a){this.missionService=e,this.projectService=t,this.notificationService=n,this.numberFormatter=i,this.dialogRef=r,this.data=a,this.missionExpense=new m.gS,this.currentMission=new m.$U,this.missionSpent=new m.Nu,this.missionSpents=[],this.isEdit=!1}ngOnInit(){this.data&&(this.isEdit=this.data.isEdit,this.isEdit?(this.missionExpense=Object.assign(new m.gS,this.data.missionExpense),this.prepareMissionExpenseToEdit()):(this.missionExpense.missionId=this.data.missionId,this.missionService.getMissionExpenses(this.missionExpense.missionId).subscribe(e=>{0!==e.length&&(this.missionExpense.companyId=e[0].companyId)})),this.getCompanies(),this.getCurrentMission(this.missionExpense.missionId))}getCompanies(){this.projectService.getCompanies().subscribe(e=>{null!=e&&(this.companiesIdentifiers=e)})}onChangeCompany(e){this.missionService.campanyChanged.next(e),this.selectedCompanyIdentifier=this.companiesIdentifiers.find(t=>t.id===e)}getCurrentMission(e){this.missionService.getMission(e).subscribe(e=>{this.currentMission=Object.assign(new m.$U,e[0])})}close(){this.dialogRef.close()}cancel(){this.close()}insertOrUpdateMissionExpense(e){this.missionExpenseForm.valid&&!0===this.isMissionExpenseValid(e)?(this.prepareMissionExpenseToEdit(),this.missionService.insertOrUpdateMissionExpense(this.missionExpense).subscribe(t=>{e.missionFraisId=t,this.notificationService.success("Mission expense saved succefully."),this.missionService.refresh.next(),[{expenseType:"servedAmount"},{expenseType:"ticketCost"},{expenseType:"stampCost"},{expenseType:"assurance"}].forEach(e=>{this.missionExpense.companyId&&this.missionExpense.companyId>0&&this.prepareMissionSpent(e.expenseType)}),this.missionService.insertOrUpdateMissionSpent(this.missionSpents).subscribe(e=>{this.notificationService.success("Mission spents saved succefully."),this.missionService.refresh.next()},()=>{this.notificationService.danger("Mission spents not saved.")}),this.close()},()=>{this.notificationService.danger("Mission expense not saved.")})):this.notificationService.danger("Please fill all required fields.")}prepareMissionSpent(e){switch(this.missionSpent=new m.Nu,this.missionSpent.missionFraisId=this.missionExpense.missionFraisId,this.missionSpent.spentCreatorId=JSON.parse(localStorage.getItem("currentUser")).userId,this.missionSpent.spentCompanyId=this.missionExpense.companyId,this.missionSpent.missionStartDate=this.currentMission.missionStartDate,this.missionSpent.missionEndDate=this.currentMission.missionEndDate,e){case"servedAmount":this.missionSpent.expenseType="servedAmount",this.missionSpent.spentReference=this.missionExpense.gdDeclaredServed,this.missionSpent.spentAmount=this.missionExpense.servedAmount,this.missionSpent.spentDescription="FM ";break;case"ticketCost":this.missionSpent.expenseType="ticketCost",this.missionSpent.spentReference=this.missionExpense.gdDeclaredTicket,this.missionSpent.spentAmount=this.missionExpense.ticketCost,this.missionSpent.spentDescription="BA ";break;case"stampCost":this.missionSpent.expenseType="stampCost",this.missionSpent.spentReference=this.missionExpense.gdDeclaredStamp,this.missionSpent.spentAmount=this.missionExpense.stampCost,this.missionSpent.spentDescription="TF ";break;case"assurance":this.missionSpent.expenseType="assurance",this.missionSpent.spentReference=this.missionExpense.gdDeclaredAssurance,this.missionSpent.spentAmount=this.missionExpense.assurance,this.missionSpent.spentDescription="AV "}this.missionSpent.spentDescription+="de "+this.currentMission.ressourceName+" selon OMN\xb0"+this.missionExpense.missionReference,this.missionSpents.push(this.missionSpent)}isMissionExpenseValid(e){let t=!1;if((e.servedAmountEuro>0||e.ticketCost>0||e.stampCost>0||e.assurance>0)&&e.currencyRate>0)return t=!0,t}prepareMissionExpenseToEdit(){this.missionExpense.servedAmountEuro=this.numberFormatter.round(this.missionExpense.servedAmountEuro,2),this.missionExpense.servedAmount=this.numberFormatter.round(this.missionExpense.servedAmountEuro*this.missionExpense.currencyRate,3),this.missionExpense.ticketCost=this.numberFormatter.round(this.missionExpense.ticketCost,3),this.missionExpense.ticketCostEuro=this.numberFormatter.round(this.missionExpense.ticketCost/this.missionExpense.currencyRate,2),this.missionExpense.stampCost=this.numberFormatter.round(this.missionExpense.stampCost,3),this.missionExpense.stampCostEuro=this.numberFormatter.round(this.missionExpense.stampCost/this.missionExpense.currencyRate,2),this.missionExpense.assurance=this.numberFormatter.round(this.missionExpense.assurance,3),this.missionExpense.assuranceEuro=this.numberFormatter.round(this.missionExpense.assurance/this.missionExpense.currencyRate,2)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject($o.e),g.\u0275\u0275directiveInject(l.so),g.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-expenses"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Uo,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.missionExpenseForm=e.first)}},decls:56,vars:32,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["id","missionExpenseForm"],["missionExpenseForm","ngForm"],[1,"row","m-b-6"],[1,"col-sm-4"],["placeholder","Mission order reference","matInput","","name","Mission order reference","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Company","name","company","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Rate","matInput","","name","CurrencyRate","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Served amount \u20ac","matInput","","name","Served amount \u20ac","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Served amount DT","matInput","","name","Served amount DT","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Declared Served","matInput","","name","Declared Served","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Ticket Cost \u20ac","matInput","","name","Ticket Cost \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Ticket Cost DT","matInput","","name","Ticket Cost DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Ticket","matInput","","name","Declared Ticket","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Fiscal stamp \u20ac","matInput","","name","Fiscal stamp \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Fiscal stamp DT","matInput","","name","Fiscal stamp DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Stamp","matInput","","name","Declared Stamp","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Assurance \u20ac","matInput","","name","Assurance \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Assurance DT","matInput","","name","Assurance DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Assurance","matInput","","name","Declared Assurance","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],[1,"row","m-t-20"],[1,"col-lg-12"],[1,"row","f-right"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md",3,"click"],[3,"value"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span"),g.\u0275\u0275text(3," Mission Expense "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"span"),g.\u0275\u0275elementStart(5,"em",2),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(6,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"div",3),g.\u0275\u0275elementStart(8,"div",4),g.\u0275\u0275elementStart(9,"form",5,6),g.\u0275\u0275elementStart(11,"div",7),g.\u0275\u0275elementStart(12,"mat-form-field",8),g.\u0275\u0275elementStart(13,"input",9),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.missionReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"mat-form-field",8),g.\u0275\u0275elementStart(15,"mat-select",10),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.companyId=e})("selectionChange",function(e){return t.onChangeCompany(e.value)}),g.\u0275\u0275template(16,Ho,2,2,"mat-option",11),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"mat-form-field",8),g.\u0275\u0275elementStart(18,"input",12),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.currencyRate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"div",7),g.\u0275\u0275elementStart(20,"mat-form-field",8),g.\u0275\u0275elementStart(21,"input",13),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.servedAmountEuro=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"mat-form-field",8),g.\u0275\u0275elementStart(23,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.servedAmount=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",8),g.\u0275\u0275elementStart(25,"input",15),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredServed=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",7),g.\u0275\u0275elementStart(27,"mat-form-field",8),g.\u0275\u0275elementStart(28,"input",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.ticketCostEuro=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"mat-form-field",8),g.\u0275\u0275elementStart(30,"input",17),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.ticketCost=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"mat-form-field",8),g.\u0275\u0275elementStart(32,"input",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredTicket=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"div",7),g.\u0275\u0275elementStart(34,"mat-form-field",8),g.\u0275\u0275elementStart(35,"input",19),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.stampCostEuro=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-form-field",8),g.\u0275\u0275elementStart(37,"input",20),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.stampCost=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"mat-form-field",8),g.\u0275\u0275elementStart(39,"input",21),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredStamp=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"div",7),g.\u0275\u0275elementStart(41,"mat-form-field",8),g.\u0275\u0275elementStart(42,"input",22),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.assuranceEuro=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"mat-form-field",8),g.\u0275\u0275elementStart(44,"input",23),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.assurance=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"mat-form-field",8),g.\u0275\u0275elementStart(46,"input",24),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredAssurance=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"div",25),g.\u0275\u0275elementStart(48,"div",26),g.\u0275\u0275elementStart(49,"div",27),g.\u0275\u0275elementStart(50,"div",26),g.\u0275\u0275elementStart(51,"button",28),g.\u0275\u0275listener("click",function(){return t.cancel()}),g.\u0275\u0275text(52,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(53," \xa0 \xa0 "),g.\u0275\u0275elementStart(54,"button",29),g.\u0275\u0275listener("click",function(){return t.insertOrUpdateMissionExpense(t.missionExpense)}),g.\u0275\u0275text(55," Save "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(13),g.\u0275\u0275property("ngModel",t.missionExpense.missionReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.companyId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.companiesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.currencyRate),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionExpense.servedAmountEuro),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.servedAmount)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredServed)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionExpense.ticketCostEuro)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.ticketCost),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredTicket)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionExpense.stampCostEuro)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.stampCost),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredStamp)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionExpense.assuranceEuro)("readonly",!0)("disabled",!0),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.assurance),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredAssurance)("readonly",!0)("disabled",!0))},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,C.Nt,o.DefaultValueAccessor,o.MaxLengthValidator,o.RequiredValidator,o.NgControlStatus,o.NgModel,y.gD,i.NgForOf,x.ey],styles:[".col-sm-2[_ngcontent-%COMP%]{width:auto}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-title-style[_ngcontent-%COMP%]{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e})();function Wo(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"tr"),g.\u0275\u0275elementStart(1,"td",11),g.\u0275\u0275text(2),g.\u0275\u0275pipe(3,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"td",11),g.\u0275\u0275text(5),g.\u0275\u0275pipe(6,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",11),g.\u0275\u0275text(8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(3,3,e.visasStartDate)),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(6,5,e.visasEndDate)),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate(e.destination)}}const Jo=function(e){return{active:e}};function Yo(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"li",13),g.\u0275\u0275elementStart(1,"a",16),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).setPage(t)}),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(2,Jo,n.pager.currentPage===e)),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e)}}const Ko=function(e){return{disabled:e}};function Xo(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"ul",12),g.\u0275\u0275elementStart(1,"li",13),g.\u0275\u0275elementStart(2,"em",14),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().setPage(1)}),g.\u0275\u0275text(3,"first_page"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"li",13),g.\u0275\u0275elementStart(5,"em",14),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.currentPage-1)}),g.\u0275\u0275text(6,"chevron_left"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(7,Yo,3,4,"li",15),g.\u0275\u0275elementStart(8,"li",13),g.\u0275\u0275elementStart(9,"em",14),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setNextPage(t.pager.currentPage+1)}),g.\u0275\u0275text(10,"chevron_right"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"li",13),g.\u0275\u0275elementStart(12,"em",14),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext();return t.setPage(t.pager.totalPages)}),g.\u0275\u0275text(13,"last_page"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(5,Ko,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(7,Ko,1===e.pager.currentPage)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",e.pager.pages),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(9,Ko,e.pager.currentPage===e.pager.totalPages)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(11,Ko,e.pager.currentPage===e.pager.totalPages))}}let Zo=(()=>{class e{constructor(e,t,n){this.missionService=e,this.dateTimeService=t,this.pagerService=n,this.subscription=new c.w0,this.pager={}}ngOnDestroy(){this.subscription.unsubscribe()}ngOnInit(){this.visa=[],this.subscription=this.missionService.resourceChanged.subscribe(e=>{this.visa=[],e&&this.missionService.getVisas(e).subscribe(e=>{e&&(e.forEach(e=>{this.dateTimeService.isNullDate(e.visasStartDate)&&this.dateTimeService.isNullDate(e.visasEndDate)&&null==e.destination||this.visa.push(e)}),this.setPage(1))})})}setPageDetails(){return this.visa.length>2}setNextPage(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.visa.length,e,2),this.pagedItems=this.visa.slice(this.pager.startIndex,this.pager.endIndex+1)}setPage(e){e<1||(this.pager=this.pagerService.getPager(this.visa.length,e,2),this.pagedItems=this.visa.slice(this.pager.startIndex,this.pager.endIndex+1))}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(d.e9))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-visa"]],decls:22,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row","m-b-15"],[1,"col-sm-12"],[1,"table-scroll"],[1,"table"],[2,"padding","0px"],["scope","col",1,"col-sm-2","th-table-style"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[1,"td-table-style"],[1,"pagination",2,"float","right"],[3,"ngClass"],[1,"material-icons",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pointer",3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"h5"),g.\u0275\u0275text(3,"Visa"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"div",2),g.\u0275\u0275elementStart(5,"div",3),g.\u0275\u0275elementStart(6,"div",4),g.\u0275\u0275elementStart(7,"div",5),g.\u0275\u0275elementStart(8,"table",6),g.\u0275\u0275element(9,"caption",7),g.\u0275\u0275elementStart(10,"thead"),g.\u0275\u0275elementStart(11,"tr"),g.\u0275\u0275elementStart(12,"th",8),g.\u0275\u0275text(13,"Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"th",8),g.\u0275\u0275text(15,"End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"th",8),g.\u0275\u0275text(17,"Destination"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"tbody"),g.\u0275\u0275template(19,Wo,9,7,"tr",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(20,"div"),g.\u0275\u0275template(21,Xo,14,13,"ul",10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(19),g.\u0275\u0275property("ngForOf",t.pagedItems),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[i.NgForOf,i.NgIf,i.NgClass],pipes:[_e.M],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}tbody[_ngcontent-%COMP%]{display:block;max-height:250px;overflow:auto;overflow-y:auto;border-bottom:1px solid #bbbbbb}.pointer[_ngcontent-%COMP%]{cursor:pointer}.material-icons[_ngcontent-%COMP%]{cursor:pointer;vertical-align:middle;position:relative;top:3px;margin:0 15px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}"]}),e})();function es(e,t){1&e&&g.\u0275\u0275element(0,"th",6)}function ts(e,t){1&e&&g.\u0275\u0275element(0,"th",6)}function ns(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"td",11),g.\u0275\u0275elementStart(1,"em",13),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().editMissionExpense(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}}function is(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"td",11),g.\u0275\u0275elementStart(1,"em",14),g.\u0275\u0275listener("click",function(){g.\u0275\u0275restoreView(e);const t=g.\u0275\u0275nextContext().$implicit;return g.\u0275\u0275nextContext().deleteMissionExpense(t)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}}function rs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"tr"),g.\u0275\u0275elementStart(1,"td",9),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(3,"td",9),g.\u0275\u0275text(4),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"td",10),g.\u0275\u0275text(6),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(7,"td",11),g.\u0275\u0275text(8),g.\u0275\u0275pipe(9,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(10,"td",11),g.\u0275\u0275text(11),g.\u0275\u0275pipe(12,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"td",11),g.\u0275\u0275text(14),g.\u0275\u0275pipe(15,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"td",11),g.\u0275\u0275text(17),g.\u0275\u0275pipe(18,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"td",11),g.\u0275\u0275text(20),g.\u0275\u0275pipe(21,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"td",11),g.\u0275\u0275text(23),g.\u0275\u0275pipe(24,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"td",11),g.\u0275\u0275text(26),g.\u0275\u0275pipe(27,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"td",11),g.\u0275\u0275text(29),g.\u0275\u0275pipe(30,"number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(31,ns,2,0,"td",12),g.\u0275\u0275template(32,is,2,0,"td",12),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.missionReference,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.missionReference,""),g.\u0275\u0275advance(1),g.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.companyName,""),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.companyName,""),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.currencyRate,""),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(9,15,e.servedAmountEuro,"1.0-2"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(12,18,e.servedAmount,"1.0-3"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(15,21,e.ticketCostEuro,"1.0-2"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(18,24,e.ticketCost,"1.0-3"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(21,27,e.stampCostEuro,"1.0-2"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(24,30,e.stampCost,"1.0-3"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(27,33,e.assuranceEuro,"1.0-2"),""),g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind2(30,36,e.assurance,"1.0-3"),""),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!n.forbiddenEditDelete),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!n.forbiddenEditDelete)}}let as=(()=>{class e{constructor(e,t,n){this.missionService=e,this.notificationService=t,this.dialog=n,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenEditDelete=!0}ngOnInit(){this.forbiddenEditDelete=this.currentUser.groupId!==h.Fl.SuperAdmin}editMissionExpense(e){this.openEditMissionExpenseDialog(e)}openEditMissionExpenseDialog(e){this.addEditMissionExpenseDialog=this.dialog.open(Go,{disableClose:!1,hasBackdrop:!0,width:"700px",height:"470px",data:{missionExpense:e,isEdit:!0}})}deleteMissionExpense(e){X().fire({text:"Are you sure to delete this mission expense ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:()=>{this.missionService.deleteMissionExpense(e.missionFraisId).subscribe(()=>{this.notificationService.success("This mission expense is deleted"),this.missionService.refresh.next()},()=>{this.notificationService.danger("Delete mission expense failed")})}})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(l.uw))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-expenses"]],inputs:{missionExpenses:"missionExpenses"},decls:33,vars:3,consts:[[1,"row"],[1,"col-sm-12"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","col"],["scope","col",1,"th-table-style"],["class","th-table-style","scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"td-reference-style",3,"matTooltip"],[1,"td-rate-style"],[1,"td-table-style"],["class","td-table-style",4,"ngIf"],["matTooltip","Edit",1,"icofont","icofont-ui-edit","icon-pointer",3,"click"],["matTooltip","Delete",1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"table",3),g.\u0275\u0275element(4,"caption",4),g.\u0275\u0275elementStart(5,"thead"),g.\u0275\u0275elementStart(6,"tr"),g.\u0275\u0275elementStart(7,"th",5),g.\u0275\u0275text(8,"Mission Order Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"th",5),g.\u0275\u0275text(10,"Company"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"th",6),g.\u0275\u0275text(12,"Rate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"th",6),g.\u0275\u0275text(14,"Served \u20ac"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(15,"th",6),g.\u0275\u0275text(16,"Served TND"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"th",6),g.\u0275\u0275text(18,"Ticket \u20ac"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"th",6),g.\u0275\u0275text(20,"Ticket TND"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"th",6),g.\u0275\u0275text(22,"Stamp \u20ac"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"th",6),g.\u0275\u0275text(24,"Stamp TND"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"th",6),g.\u0275\u0275text(26,"Assurance \u20ac"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"th",6),g.\u0275\u0275text(28,"Assurance TND"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(29,es,1,0,"th",7),g.\u0275\u0275template(30,ts,1,0,"th",7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"tbody"),g.\u0275\u0275template(32,rs,33,39,"tr",8),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(29),g.\u0275\u0275property("ngIf",!t.forbiddenEditDelete),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.forbiddenEditDelete),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngForOf",t.missionExpenses))},directives:[i.NgIf,i.NgForOf,ne.gM],pipes:[i.DecimalPipe],styles:[".table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}.th-table-style[_ngcontent-%COMP%]{text-align:center}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-reference-style[_ngcontent-%COMP%]{max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.td-rate-style[_ngcontent-%COMP%]{width:50px;text-align:center}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();var os=n(7539);const ss=["missionDetailsForm"];function ls(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function cs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ds(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let ms=(()=>{class e{constructor(e,t,n,i,r,a,s){this.router=e,this.coreDataService=t,this.missionService=n,this.notificationService=i,this.mailService=r,this.projectService=a,this.dateTimeService=s,this.initialMission=new m.$U,this.clientsIdentifiers=[],this.resourcesIdentifiers=[],this.countriesIdentifiers=[],this.filteredClients=new c.tq(1),this.clientFilterCtrl=new o.FormControl,this.filteredResources=new c.tq(1),this.resourceFilterCtrl=new o.FormControl,this.filteredCountries=new c.tq(1),this.countryFilterCtrl=new o.FormControl,this.filteredProjects=new c.tq(1),this.projectFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ}ngOnInit(){this.mission?(this.mission=Object.assign(new m.$U,this.mission),this.initialMission=Object.assign(new m.$U,this.mission),this.isInvoiceChecked="False"!==this.mission.isInvoiced):this.mission=new m.$U,this.user=JSON.parse(localStorage.getItem("currentUser")),this.getClients(),this.getCountries(),this.getActiveUsers(),this.clientFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterIdentifiers(this.clientsIdentifiers,this.filteredClients,this.clientFilterCtrl)}),this.countryFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterIdentifiers(this.countriesIdentifiers,this.filteredCountries,this.countryFilterCtrl)}),this.resourceFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterIdentifiers(this.resourcesIdentifiers,this.filteredResources,this.resourceFilterCtrl)})}getClients(){this.projectService.getClients().subscribe(e=>{this.clientsIdentifiers=e,this.filteredClients.next(this.clientsIdentifiers.slice())})}getActiveUsers(){this.coreDataService.getActiveUsers().subscribe(e=>{this.resourcesIdentifiers=e,-1===this.resourcesIdentifiers.findIndex(e=>e.id===this.mission.missionRessource)&&(this.resourcesIdentifiers.push({id:this.mission.missionRessource,description:this.mission.ressourceName+" (Quit)"}),this.resourcesIdentifiers.sort(function(e,t){const n=e.description.toUpperCase(),i=t.description.toUpperCase();return n<i?-1:n>i?1:0})),this.filteredResources.next(this.resourcesIdentifiers.slice())})}getCountries(){this.missionService.getCountries().subscribe(e=>{this.countriesIdentifiers=e,this.filteredCountries.next(this.countriesIdentifiers.slice())})}onChangeCustomer(e){this.selectedClientIdentifier=this.clientsIdentifiers.find(t=>t.id===e)}onChangeResource(e){this.missionService.resourceChanged.next(e),this.selectedResourceIdentifier=this.resourcesIdentifiers.find(t=>t.id===e)}dateChanged(e){if(null!=this.mission.missionEndDate){const e=new Date(this.mission.missionStartDate),t=new Date(this.mission.missionEndDate);this.mission.nightsNumber=(t.getTime()-e.getTime())/864e5}}onChangeCountry(e){this.selectedCountryIdentifier=this.countriesIdentifiers.find(t=>t.id===e)}filterIdentifiers(e,t,n){if(!e)return;let i=n.value;i?(i=i.toLowerCase(),t.next(e.filter(e=>e.description.toLowerCase().indexOf(i)>-1))):t.next(e.slice())}save(){this.missionDetailsForm.valid?(0===this.mission.missionId&&(this.mission.missionCreator=this.user.userId.toString()),this.mission.isInvoiced=!0===this.isInvoiceChecked?"True":"False",this.mission.affectedToPrj="true",this.mission.etatMission=1,this.missionService.insertOrUpdateMission(this.mission).subscribe(e=>{if(this.missionService.refresh.next(),this.router.navigate(["/project-management/project/edit-mission/"+e]),this.notificationService.success("Mission is saved successfully"),this.missionService.toggleMissionDetail.next(),0===this.mission.missionId)this.prepareMissionForNotification(this.mission),this.mailService.missionAdded(this.mission);else{this.initialMission.ressourceName=this.resourcesIdentifiers.find(e=>e.id===this.initialMission.missionRessource).description;const e=this.prepareModification(this.initialMission,this.mission);0!==e.length&&this.mailService.missionModified(this.mission,e,this.initialMission)}})):this.notificationService.danger("Please fill all required fields")}prepareModification(e,t){let n="";return e.missionObject!==t.missionObject&&(n=n.concat(this.modifLongInfoBuilder("Object",e.missionObject,t.missionObject))),e.missionRessource!==t.missionRessource&&(n=n.concat(this.modifInfoBuilder("Ressource",e.ressourceName,this.resourcesIdentifiers.find(e=>e.id===t.missionRessource).description))),e.clientId!==t.clientId&&(n=n.concat(this.modifInfoBuilder("Client",e.clientName,this.clientsIdentifiers.find(e=>e.id===t.clientId).description))),e.isInvoiced!==t.isInvoiced&&(n=n.concat(this.modifInfoBuilder("To be Invoiced",e.isInvoiced,t.isInvoiced))),t.missionStartDate!==e.missionStartDate&&(n=n.concat(this.modifInfoBuilder("Start Date",this.dateTimeService.getShortFormat(e.missionStartDate),this.dateTimeService.getShortFormat(t.missionStartDate)))),t.missionEndDate!==e.missionEndDate&&(n=n.concat(this.modifInfoBuilder("End Date",this.dateTimeService.getShortFormat(e.missionEndDate),this.dateTimeService.getShortFormat(t.missionEndDate)))),e.nightsNumber!==t.nightsNumber&&(n=n.concat(this.modifInfoBuilder("Nights Number",e.nightsNumber,t.nightsNumber))),e.missionCountry!==t.missionCountry&&(n=n.concat(this.modifInfoBuilder("Country",e.missionCountryName,this.countriesIdentifiers.find(e=>e.id===t.missionCountry).description))),e.missionVille!==t.missionVille&&(n=n.concat(this.modifInfoBuilder("Ville",e.missionVille,t.missionVille))),e.invoiceNote!==t.invoiceNote&&(n=n.concat(this.modifLongInfoBuilder("Invoice Note",e.invoiceNote,t.invoiceNote))),e.supportNote!==t.supportNote&&(n=n.concat(this.modifLongInfoBuilder("Support Note",e.supportNote,t.supportNote))),n}modifInfoBuilder(e,t,n){return'<span style="color: #0000ff;">'+e+': <span style="color: #000000;">'+(t=null==t?"":t.toString())+'<span style="color: #FF0000;"> =&gt; </span><strong><span style="color: #000000;">'+(n=null==n?"":n.toString())+"</span></strong><br> "}modifLongInfoBuilder(e,t,n){return'<span style="color: #0000ff;">'+e+': <br><span style="color: #000000;">'+(t=null==t?"":t.toString())+'<br><span style="color: #FF0000;"> =&gt; <br></span><strong><span style="color: #000000;">'+(n=null==n?"":n.toString())+"</span></strong><br> "}cancel(){0!==this.mission.missionId?(this.missionService.refresh.next(),this.missionService.toggleMissionDetail.next()):this.router.navigate(["/project-management/project/missions"])}dateOnly(e){return this.dateTimeService.dateOnly(e)}prepareMissionForNotification(e){this.mission.ressourceName=this.resourcesIdentifiers.find(t=>t.id===e.missionRessource).description,this.mission.clientName=this.clientsIdentifiers.find(t=>t.id===e.clientId).description,this.mission.missionCountryName=this.countriesIdentifiers.find(t=>t.id===e.missionCountry).description}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(d.YY),g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.YT),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-details"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(ss,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.missionDetailsForm=e.first)}},inputs:{mission:"mission"},decls:59,vars:37,consts:[["id","missionDetailsForm"],["missionDetailsForm","ngForm"],[1,"row","m-b-15","m-t-15"],[1,"col-md-12"],["placeholder","Object","matInput","","name","missionObject","appTextValidator","","maxlength","254","required","",3,"ngModel","ngModelChange"],[1,"row","m-b-15"],[1,"col-sm-5"],["placeholder","Resource","name","resource","required","",3,"ngModel","selectionChange","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-5"],["placeholder","Customer","name","customer","required","",3,"ngModel","selectionChange","ngModelChange"],[1,"col-sm-2"],["name","invoice",1,"checkbox-invoice",3,"ngModel","ngModelChange"],["matInput","","placeholder","Start Date","name","missionStartDate","required","",3,"matDatepicker","ngModel","max","dateInput","keypress","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End Date","name","missionEndDate","required","",3,"matDatepicker","ngModel","min","dateInput","keypress","ngModelChange"],["PickerEndDay",""],["type","text","placeholder","Nights Number","matInput","","name","nights","disabled","","required","",3,"ngModel","ngModelChange"],[1,"col-sm-3"],["placeholder","Country","name","country","required","",3,"ngModel","selectionChange","ngModelChange"],["placeholder","City","matInput","","name","city",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["matInput","","placeholder","Invoice Note","name","note",3,"ngModel","ngModelChange"],["matInput","","placeholder","Support Note","name","sendSupport",3,"ngModel","ngModelChange"],[1,"text-center","m-b-15"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"click"],["type","button",1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"form",0,1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"mat-form-field",3),g.\u0275\u0275elementStart(4,"input",4),g.\u0275\u0275listener("ngModelChange",function(e){return t.mission.missionObject=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"div",5),g.\u0275\u0275elementStart(6,"mat-form-field",6),g.\u0275\u0275elementStart(7,"mat-select",7),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangeResource(e.value)})("ngModelChange",function(e){return t.mission.missionRessource=e}),g.\u0275\u0275elementStart(8,"mat-option"),g.\u0275\u0275elementStart(9,"ngx-mat-select-search",8),g.\u0275\u0275elementStart(10,"mat-icon",9),g.\u0275\u0275text(11,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(12,ls,2,2,"mat-option",10),g.\u0275\u0275pipe(13,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"mat-form-field",11),g.\u0275\u0275elementStart(15,"mat-select",12),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCustomer(e.value)})("ngModelChange",function(e){return t.mission.clientId=e}),g.\u0275\u0275elementStart(16,"mat-option"),g.\u0275\u0275elementStart(17,"ngx-mat-select-search",8),g.\u0275\u0275elementStart(18,"mat-icon",9),g.\u0275\u0275text(19,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(20,cs,2,2,"mat-option",10),g.\u0275\u0275pipe(21,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"div",13),g.\u0275\u0275elementStart(23,"mat-checkbox",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.isInvoiceChecked=e}),g.\u0275\u0275text(24,"To be invoiced "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"div",5),g.\u0275\u0275elementStart(26,"mat-form-field",13),g.\u0275\u0275elementStart(27,"input",15),g.\u0275\u0275listener("dateInput",function(e){return t.dateChanged(e)})("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.mission.missionStartDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(28,"mat-datepicker-toggle",16),g.\u0275\u0275element(29,"mat-datepicker",17,18),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"mat-form-field",13),g.\u0275\u0275elementStart(32,"input",19),g.\u0275\u0275listener("dateInput",function(e){return t.dateChanged(e)})("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.mission.missionEndDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(33,"mat-datepicker-toggle",16),g.\u0275\u0275element(34,"mat-datepicker",17,20),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-form-field",13),g.\u0275\u0275elementStart(37,"input",21),g.\u0275\u0275listener("ngModelChange",function(e){return t.mission.nightsNumber=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"mat-form-field",22),g.\u0275\u0275elementStart(39,"mat-select",23),g.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCountry(e.value)})("ngModelChange",function(e){return t.mission.missionCountry=e}),g.\u0275\u0275elementStart(40,"mat-option"),g.\u0275\u0275elementStart(41,"ngx-mat-select-search",8),g.\u0275\u0275elementStart(42,"mat-icon",9),g.\u0275\u0275text(43,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(44,ds,2,2,"mat-option",10),g.\u0275\u0275pipe(45,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"mat-form-field",22),g.\u0275\u0275elementStart(47,"input",24),g.\u0275\u0275listener("ngModelChange",function(e){return t.mission.missionVille=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"div",5),g.\u0275\u0275elementStart(49,"mat-form-field",25),g.\u0275\u0275elementStart(50,"input",26),g.\u0275\u0275listener("ngModelChange",function(e){return t.mission.invoiceNote=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"div",5),g.\u0275\u0275elementStart(52,"mat-form-field",25),g.\u0275\u0275elementStart(53,"textarea",27),g.\u0275\u0275listener("ngModelChange",function(e){return t.mission.supportNote=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(54,"div",28),g.\u0275\u0275elementStart(55,"button",29),g.\u0275\u0275listener("click",function(){return t.save()}),g.\u0275\u0275text(56,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"button",30),g.\u0275\u0275listener("click",function(){return t.cancel()}),g.\u0275\u0275text(58,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(30),n=g.\u0275\u0275reference(35);g.\u0275\u0275advance(4),g.\u0275\u0275property("ngModel",t.mission.missionObject),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.missionRessource),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.resourceFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(13,31,t.filteredResources)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.clientId),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.clientFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(21,33,t.filteredClients)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.isInvoiceChecked),g.\u0275\u0275advance(4),g.\u0275\u0275property("matDatepicker",e)("ngModel",t.mission.missionStartDate)("max",t.mission.missionEndDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("matDatepicker",n)("ngModel",t.mission.missionEndDate)("min",t.mission.missionStartDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.nightsNumber),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.mission.missionCountry),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.countryFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(45,35,t.filteredCountries)),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.missionVille),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.invoiceNote),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.mission.supportNote)}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,C.Nt,o.DefaultValueAccessor,Te.s,o.MaxLengthValidator,o.RequiredValidator,o.NgControlStatus,o.NgModel,y.gD,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,os.oG,E.hl,E.nW,b.R9,E.Mq],pipes:[i.AsyncPipe],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}.checkbox-invoice[_ngcontent-%COMP%]{margin-top:15px!important}"]}),e})(),ps=(()=>{class e{ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-details"]],inputs:{mission:"mission"},decls:47,vars:11,consts:[[1,"row"],[1,"col-sm-6"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"table",3),g.\u0275\u0275element(4,"caption",4),g.\u0275\u0275elementStart(5,"tbody"),g.\u0275\u0275elementStart(6,"tr"),g.\u0275\u0275elementStart(7,"th",5),g.\u0275\u0275text(8,"Resource"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",6),g.\u0275\u0275text(10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"tr"),g.\u0275\u0275elementStart(12,"th",5),g.\u0275\u0275text(13,"Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"td",7),g.\u0275\u0275text(15),g.\u0275\u0275pipe(16,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(17,"th",5),g.\u0275\u0275text(18,"End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"td",7),g.\u0275\u0275text(20),g.\u0275\u0275pipe(21,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"tr"),g.\u0275\u0275elementStart(23,"th",5),g.\u0275\u0275text(24,"Country"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"td",6),g.\u0275\u0275text(26),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"div",1),g.\u0275\u0275elementStart(28,"div",2),g.\u0275\u0275elementStart(29,"table",3),g.\u0275\u0275element(30,"caption",4),g.\u0275\u0275elementStart(31,"tbody"),g.\u0275\u0275elementStart(32,"tr"),g.\u0275\u0275elementStart(33,"th",5),g.\u0275\u0275text(34,"Customer"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"td",6),g.\u0275\u0275text(36),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(37,"tr"),g.\u0275\u0275elementStart(38,"th",5),g.\u0275\u0275text(39,"Nights Number"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"td",7),g.\u0275\u0275text(41),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(42,"tr"),g.\u0275\u0275elementStart(43,"th",5),g.\u0275\u0275text(44,"City"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"td",6),g.\u0275\u0275text(46),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate1("",t.mission.ressourceName," "),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(16,7,t.mission.missionStartDate)," "),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",g.\u0275\u0275pipeBind1(21,9,t.mission.missionEndDate)," "),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate1(" ",t.mission.missionCountryName," "),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate1(" ",t.mission.clientName," "),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1(" ",t.mission.nightsNumber," "),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1(" ",t.mission.missionVille," "))},pipes:[_e.M],styles:[".table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}"]}),e})(),hs=(()=>{class e{ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-project"]],inputs:{missionProject:"missionProject"},decls:63,vars:12,consts:[[1,"row"],[1,"col-sm-3"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"table",3),g.\u0275\u0275element(4,"caption",4),g.\u0275\u0275elementStart(5,"tbody"),g.\u0275\u0275elementStart(6,"tr"),g.\u0275\u0275elementStart(7,"th",5),g.\u0275\u0275text(8,"Project"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"td",6),g.\u0275\u0275text(10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"tr"),g.\u0275\u0275elementStart(12,"th",5),g.\u0275\u0275text(13,"Order Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"td",6),g.\u0275\u0275text(15),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"div",1),g.\u0275\u0275elementStart(17,"div",2),g.\u0275\u0275elementStart(18,"table",3),g.\u0275\u0275element(19,"caption",4),g.\u0275\u0275elementStart(20,"tbody"),g.\u0275\u0275elementStart(21,"tr"),g.\u0275\u0275elementStart(22,"th",5),g.\u0275\u0275text(23," Start"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"td",7),g.\u0275\u0275text(25),g.\u0275\u0275pipe(26,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"tr"),g.\u0275\u0275elementStart(28,"th",5),g.\u0275\u0275text(29,"Invoice Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"td",6),g.\u0275\u0275text(31),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"div",1),g.\u0275\u0275elementStart(33,"div",2),g.\u0275\u0275elementStart(34,"table",3),g.\u0275\u0275element(35,"caption",4),g.\u0275\u0275elementStart(36,"tbody"),g.\u0275\u0275elementStart(37,"tr"),g.\u0275\u0275elementStart(38,"th",5),g.\u0275\u0275text(39," End"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(40,"td",7),g.\u0275\u0275text(41),g.\u0275\u0275pipe(42,"shortDate"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"tr"),g.\u0275\u0275elementStart(44,"th",5),g.\u0275\u0275text(45,"Invoice Amount"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"td",6),g.\u0275\u0275text(47),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"div",1),g.\u0275\u0275elementStart(49,"div",2),g.\u0275\u0275elementStart(50,"table",3),g.\u0275\u0275element(51,"caption",4),g.\u0275\u0275elementStart(52,"tbody"),g.\u0275\u0275elementStart(53,"tr"),g.\u0275\u0275elementStart(54,"th",5),g.\u0275\u0275text(55,"Days Numbers"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(56,"td",6),g.\u0275\u0275text(57),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(58,"tr"),g.\u0275\u0275elementStart(59,"th",5),g.\u0275\u0275text(60,"Ticket Cost"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(61,"td",6),g.\u0275\u0275text(62),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate1("",t.missionProject.projectName," "),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.missionProject.orderReference),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(26,8,t.missionProject.missionStartDate)),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate(t.missionProject.invoiceReference),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate(g.\u0275\u0275pipeBind1(42,10,t.missionProject.missionEndDate)),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate(t.missionProject.invoiceAmount),g.\u0275\u0275advance(10),g.\u0275\u0275textInterpolate(t.missionProject.daysNumbers),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate(t.missionProject.ticketCost))},pipes:[_e.M],styles:[".td-description[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}"]}),e})();const us=["missionDetailsForm"];function gs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",22),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let fs=(()=>{class e{constructor(e,t,n,i){this.missionService=e,this.notificationService=t,this.projectService=n,this.dateTimeService=i,this.displayMissionProject=new g.EventEmitter,this.missionProject=new m.vl,this.filteredProjects=new c.tq(1),this.projectFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ}ngOnInit(){this.missionProject=Object.assign(new m.vl,this.missionProject),this.missionProject.missionId=this.mission.missionId,0===this.missionProject.missionProjectId&&(this.missionProject.missionStartDate=this.mission.missionStartDate,this.missionProject.missionEndDate=this.mission.missionEndDate,this.daysNumbers()),this.getListProject(),this.projectFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterIdentifiers(this.projectsIdentifiers,this.filteredProjects,this.projectFilterCtrl)})}getListProject(){this.projectService.getProjectNames().subscribe(e=>{this.projectsIdentifiers=e,this.filteredProjects.next(this.projectsIdentifiers.slice())})}filterIdentifiers(e,t,n){if(!e)return;let i=n.value;i?(i=i.toLowerCase(),t.next(e.filter(e=>e.description.toLowerCase().indexOf(i)>-1))):t.next(e.slice())}saveMissionProjects(){this.detailsForm.valid?this.missionService.insertOrUpdateMissionProject(this.missionProject).subscribe(e=>{this.displayMissionProject.next(),this.notificationService.success("The mission project was saved successfully.")},()=>{this.notificationService.danger("The mission project was not saved")}):this.notificationService.danger("Please fill all required fields")}cancel(){this.displayMissionProject.next()}daysNumbers(){if(null!=this.missionProject.missionEndDate){const e=new Date(this.missionProject.missionStartDate),t=new Date(this.missionProject.missionEndDate);this.missionProject.daysNumbers=(t.getTime()-e.getTime())/864e5}}dateOnly(e){return this.dateTimeService.dateOnly(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-project"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(us,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.detailsForm=e.first)}},inputs:{missionProject:"missionProject",mission:"mission"},outputs:{displayMissionProject:"displayMissionProject"},decls:37,vars:24,consts:[["id","missionDetailsForm"],["missionDetailsForm","ngForm"],[1,"row","m-b-15"],[1,"col-sm-3"],["placeholder","Project","name","project","required","",3,"ngModel","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Start Date","name","missionStartDate","required","",3,"matDatepicker","ngModel","max","keypress","dateInput","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay1",""],["matInput","","placeholder","End Date","name","missionEndDate","required","",3,"matDatepicker","ngModel","min","keypress","dateInput","ngModelChange"],["PickerEndDay11",""],["placeholder","Days Numbers","matInput","","name","daysNumbers","appNumberValidator","","required","",3,"ngModel","ngModelChange"],["placeholder","Order Reference","matInput","","name","orderReference",3,"ngModel","ngModelChange"],["placeholder","Invoice Reference","matInput","","name","invoiceReference",3,"ngModel","ngModelChange"],["placeholder","Invoice Amount \u20ac","matInput","","name","amount","appNumberValidator","",3,"ngModel","inputValue","ngModelChange"],["placeholder","Ticket Amount DT","matInput","","name","ticketAmount","appNumberValidator","",3,"ngModel","inputValue","ngModelChange"],[1,"text-center","m-b-15"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"form",0,1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"mat-form-field",3),g.\u0275\u0275elementStart(4,"mat-select",4),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.projectId=e}),g.\u0275\u0275elementStart(5,"mat-option"),g.\u0275\u0275elementStart(6,"ngx-mat-select-search",5),g.\u0275\u0275elementStart(7,"mat-icon",6),g.\u0275\u0275text(8,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(9,gs,2,2,"mat-option",7),g.\u0275\u0275pipe(10,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"mat-form-field",3),g.\u0275\u0275elementStart(12,"input",8),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("dateInput",function(){return t.daysNumbers()})("ngModelChange",function(e){return t.missionProject.missionStartDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(13,"mat-datepicker-toggle",9),g.\u0275\u0275element(14,"mat-datepicker",10,11),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",3),g.\u0275\u0275elementStart(17,"input",12),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("dateInput",function(){return t.daysNumbers()})("ngModelChange",function(e){return t.missionProject.missionEndDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(18,"mat-datepicker-toggle",9),g.\u0275\u0275element(19,"mat-datepicker",10,13),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"mat-form-field",3),g.\u0275\u0275elementStart(22,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.daysNumbers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"div",2),g.\u0275\u0275elementStart(24,"mat-form-field",3),g.\u0275\u0275elementStart(25,"input",15),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.orderReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"mat-form-field",3),g.\u0275\u0275elementStart(27,"input",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.invoiceReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"mat-form-field",3),g.\u0275\u0275elementStart(29,"input",17),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.invoiceAmount=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(30,"mat-form-field",3),g.\u0275\u0275elementStart(31,"input",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.ticketCost=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"div",19),g.\u0275\u0275elementStart(33,"button",20),g.\u0275\u0275listener("click",function(){return t.saveMissionProjects()}),g.\u0275\u0275text(34,"Save"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(35,"button",21),g.\u0275\u0275listener("click",function(){return t.cancel()}),g.\u0275\u0275text(36,"Cancel"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(15),n=g.\u0275\u0275reference(20);g.\u0275\u0275advance(4),g.\u0275\u0275property("ngModel",t.missionProject.projectId),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.projectFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(10,22,t.filteredProjects)),g.\u0275\u0275advance(3),g.\u0275\u0275property("matDatepicker",e)("ngModel",t.missionProject.missionStartDate)("max",t.missionProject.missionEndDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("matDatepicker",n)("ngModel",t.missionProject.missionEndDate)("min",t.missionProject.missionStartDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionProject.daysNumbers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.missionProject.orderReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionProject.invoiceReference),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionProject.invoiceAmount)("inputValue",t.missionProject.invoiceAmount),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.missionProject.ticketCost)("inputValue",t.missionProject.ticketCost)}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,y.gD,o.RequiredValidator,o.NgControlStatus,o.NgModel,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,C.Nt,E.hl,o.DefaultValueAccessor,E.nW,b.R9,E.Mq,ze.z],pipes:[i.AsyncPipe],encapsulation:2}),e})();const vs=["missionDetailsForm"];function Ss(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",22),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().toggleEditMissionDetails()}),g.\u0275\u0275text(1," edit "),g.\u0275\u0275elementEnd()}}function bs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"span"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.mission.missionObject)}}function Cs(e,t){if(1&e&&g.\u0275\u0275element(0,"app-edit-mission-details",23),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("mission",e.mission)}}function ys(e,t){if(1&e&&g.\u0275\u0275element(0,"app-view-mission-details",23),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("mission",e.mission)}}function Es(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",24),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().editMissionProject()}),g.\u0275\u0275text(1," edit "),g.\u0275\u0275elementEnd()}}function xs(e,t){if(1&e&&g.\u0275\u0275element(0,"app-view-mission-project",25),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("missionProject",e.missionProject)}}function Is(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"app-edit-mission-project",26),g.\u0275\u0275listener("displayMissionProject",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().displayMissionProject()}),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275property("missionProject",e.missionProject)("mission",e.mission)}}function ws(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-icon",27),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().addMissionExpenses()}),g.\u0275\u0275text(1," add "),g.\u0275\u0275elementEnd()}}let Ms=(()=>{class e{constructor(e,t,n,i){this.missionService=e,this.dialog=t,this.route=n,this.router=i,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenEditMission=!0,this.forbiddenAddMissionExpenses=!0,this.mission=new m.$U,this.missionProject=new m.vl,this.missionExpense=new m.gS,this.missionExpenses=[],this.previousState={getPrevious:!1,type:null,pageIndex:null,pageSize:null}}ngOnInit(){this.forbiddenEditMission=this.currentUser.groupId!==h.Fl.SuperAdmin&&this.currentUser.groupId!==h.Fl.ProjectManager,this.forbiddenAddMissionExpenses=this.currentUser.groupId!==h.Fl.SuperAdmin,this.route.params.subscribe(e=>{null==e.missionId||(this.missionId=+e.missionId,this.getMission(this.missionId),this.getMissionProject(this.missionId),this.getMissionExpenses(this.missionId))}),this.subscription=this.missionService.refresh.subscribe(()=>{this.getMission(this.mission.missionId),this.getMissionProject(this.mission.missionId),this.getMissionExpenses(this.mission.missionId)}),this.missionService.toggleMissionDetail.subscribe(()=>{this.toggleEditMissionDetails()}),this.subscription.add(this.missionService.previousState.subscribe(e=>{e&&(this.previousState.pageIndex=e.pageIndex,this.previousState.pageSize=e.pageSize)}))}getMissionExpenses(e){this.missionService.getMissionExpenses(e).subscribe(e=>{this.missionExpenses=[],0!==e.length&&e.forEach(e=>{this.missionExpenses.push(Object.assign(new m.gS,e))})})}ngOnDestroy(){this.subscription.unsubscribe()}editMissionProject(){this.displayEditMissionProject=!0}toggleEditMissionDetails(){this.EditMissionDetails=!this.EditMissionDetails}displayMissionProject(){this.displayEditMissionProject=!1,this.getMissionProject(this.missionId)}goBack(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.missionService.previousState.next(this.previousState)),this.router.navigate(["/project-management/project/missions"])}getMission(e){this.missionService.getMission(e).subscribe(e=>{this.mission=Object.assign(new m.$U,e[0]),this.missionService.resourceChanged.next(this.mission.missionRessource)})}getMissionProject(e){this.missionService.getMissionProject(e).subscribe(e=>{0!==e.length&&(this.missionProject=Object.assign(new m.vl,e[0]))})}addMissionExpenses(){this.addEditMissionExpensesDialog=this.dialog.open(Go,{disableClose:!1,hasBackdrop:!0,width:"700px",height:"470px",data:{missionId:this.missionId,isEdit:!1}})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(l.uw),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(a.F0))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(vs,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.missionDetailsForm=e.first)}},decls:55,vars:11,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-md-10"],[1,"col-md-2",2,"text-align","right"],["type","button","matTooltip","Back to Projects",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-reply"],[1,"md-tabs","md-card-tabs"],[1,"m-t-10"],[1,"col-sm-8"],["class","edit-project-ico","matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-header-text"],[4,"ngIf"],[1,"card-body"],[3,"mission",4,"ngIf"],[1,"col-sm-4"],[1,"col-sm-12"],["class","edit-mission-ico","matTooltip","Edit",3,"click",4,"ngIf"],[3,"missionProject",4,"ngIf"],[3,"missionProject","mission","displayMissionProject",4,"ngIf"],["class","edit-mission-ico","matTooltip","add",3,"click",4,"ngIf"],[3,"missionExpenses"],["matTooltip","Edit",1,"edit-project-ico",3,"click"],[3,"mission"],["matTooltip","Edit",1,"edit-mission-ico",3,"click"],[3,"missionProject"],[3,"missionProject","mission","displayMissionProject"],["matTooltip","add",1,"edit-mission-ico",3,"click"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"h5"),g.\u0275\u0275text(5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(6,"div",4),g.\u0275\u0275elementStart(7,"button",5),g.\u0275\u0275listener("click",function(){return t.goBack()}),g.\u0275\u0275element(8,"em",6),g.\u0275\u0275text(9," Missions "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(10,"div"),g.\u0275\u0275elementStart(11,"div",7),g.\u0275\u0275elementStart(12,"div",8),g.\u0275\u0275elementStart(13,"div",2),g.\u0275\u0275elementStart(14,"div",9),g.\u0275\u0275elementStart(15,"div",0),g.\u0275\u0275elementStart(16,"div",1),g.\u0275\u0275elementStart(17,"div"),g.\u0275\u0275template(18,Ss,2,0,"mat-icon",10),g.\u0275\u0275elementStart(19,"div"),g.\u0275\u0275elementStart(20,"h5",11),g.\u0275\u0275text(21,"Mission Details"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(22,bs,2,1,"span",12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(23,"div",13),g.\u0275\u0275template(24,Cs,1,1,"app-edit-mission-details",14),g.\u0275\u0275template(25,ys,1,1,"app-view-mission-details",14),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",15),g.\u0275\u0275element(27,"app-visa"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(28,"div",7),g.\u0275\u0275elementStart(29,"div",8),g.\u0275\u0275elementStart(30,"div",2),g.\u0275\u0275elementStart(31,"div",16),g.\u0275\u0275elementStart(32,"div",0),g.\u0275\u0275elementStart(33,"div",1),g.\u0275\u0275elementStart(34,"div"),g.\u0275\u0275template(35,Es,2,0,"mat-icon",17),g.\u0275\u0275elementStart(36,"div"),g.\u0275\u0275elementStart(37,"h5",11),g.\u0275\u0275text(38,"Mission Project"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(39,"div",13),g.\u0275\u0275template(40,xs,1,1,"app-view-mission-project",18),g.\u0275\u0275template(41,Is,1,2,"app-edit-mission-project",19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(42,"div",7),g.\u0275\u0275elementStart(43,"div",8),g.\u0275\u0275elementStart(44,"div",2),g.\u0275\u0275elementStart(45,"div",16),g.\u0275\u0275elementStart(46,"div",0),g.\u0275\u0275elementStart(47,"div",1),g.\u0275\u0275elementStart(48,"div"),g.\u0275\u0275template(49,ws,2,0,"mat-icon",20),g.\u0275\u0275elementStart(50,"div"),g.\u0275\u0275elementStart(51,"h5",11),g.\u0275\u0275text(52,"Mission Expenses"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"div",13),g.\u0275\u0275element(54,"app-view-mission-expenses",21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate2("",t.mission.missionReference," [",t.mission.missionObject,"]"),g.\u0275\u0275advance(13),g.\u0275\u0275property("ngIf",!t.EditMissionDetails&&!t.forbiddenEditMission),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngIf",!t.EditMissionDetails),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.EditMissionDetails),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.EditMissionDetails),g.\u0275\u0275advance(10),g.\u0275\u0275property("ngIf",!t.displayEditMissionProject&&!t.forbiddenEditMission),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngIf",!t.displayEditMissionProject),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.displayEditMissionProject),g.\u0275\u0275advance(8),g.\u0275\u0275property("ngIf",!t.forbiddenAddMissionExpenses),g.\u0275\u0275advance(5),g.\u0275\u0275property("missionExpenses",t.missionExpenses))},directives:[ne.gM,i.NgIf,Zo,as,Ae.Hw,ms,ps,hs,fs],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.card-header[_ngcontent-%COMP%]   .edit-mission-ico[_ngcontent-%COMP%]{margin-left:15px}.card-body[_ngcontent-%COMP%]{width:100%;padding:0 20px}.details-card[_ngcontent-%COMP%]{min-height:534px}.btn-circle.btn-xl[_ngcontent-%COMP%]{width:40px;height:40px;padding:8px 10px;border-radius:35px;font-size:18px;line-height:1.33}.btn-circle[_ngcontent-%COMP%]{width:30px;height:30px;padding:6px 0;border-radius:15px;text-align:center;font-size:12px;line-height:1.42857}.material-icons[_ngcontent-%COMP%]{font-size:25px}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e})();const Ps=function(e,t,n,i,r){return{"label-warning":e,"label-primary":t,"label-success":n,"label-danger":i,"label-default":r}},Ds=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}};let js=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.searchFilterService=t,this.activeRoute=n,this.router=i,this.PifVisa=m.CB,this.ProjectStatusLabel=m.tU}ngOnInit(){this.state=this.project.state}editProject(e,t){this.projectService.previousState.next({type:"card",pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["../edit/"+e.toString()+"/"+t.toString()],{relativeTo:this.activeRoute})}trancateDescription(e){return null==e?"N/A":e.length>100?e.substr(0,100)+" ...":e}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(a.F0))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-project-card"]],inputs:{project:"project"},decls:37,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"thick",2,"display","inline"],[1,"n","f-right"],[1,"label",3,"ngClass"],[1,"card-body"],[1,"row"],[1,"col-sm-12"],[1,"list","list-unstyled","text1"],[1,"thick"],[1,"card-footer"],[1,"task-list-table"],[1,"task-due"],[1,"label","label-pink"],[1,"task-board"],["type","button",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],["matTooltip","Edit",1,"material-icons","pen-icon"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"span",2),g.\u0275\u0275text(3),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(4,"div",3),g.\u0275\u0275elementStart(5,"div"),g.\u0275\u0275elementStart(6,"label",4),g.\u0275\u0275text(7),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(8,"div",5),g.\u0275\u0275elementStart(9,"div",6),g.\u0275\u0275elementStart(10,"div",7),g.\u0275\u0275elementStart(11,"ul",8),g.\u0275\u0275elementStart(12,"li"),g.\u0275\u0275text(13),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"li"),g.\u0275\u0275elementStart(15,"strong",9),g.\u0275\u0275text(16," Customer : "),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(17),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"li"),g.\u0275\u0275elementStart(19,"strong",9),g.\u0275\u0275text(20," Cost : "),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"li"),g.\u0275\u0275elementStart(23,"strong",9),g.\u0275\u0275text(24," Pif : "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(25,"label",4),g.\u0275\u0275text(26),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"div",10),g.\u0275\u0275elementStart(28,"div",11),g.\u0275\u0275elementStart(29,"p",12),g.\u0275\u0275elementStart(30,"strong",13),g.\u0275\u0275text(31),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(32,"div",14),g.\u0275\u0275elementStart(33,"button",15),g.\u0275\u0275listener("click",function(){return t.editProject(t.project.pifId,t.project.projectId)}),g.\u0275\u0275elementStart(34,"em",16),g.\u0275\u0275text(35,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(36,"br")),2&e&&(g.\u0275\u0275advance(3),g.\u0275\u0275textInterpolate1(" ",t.project.name," "),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction5(9,Ps,t.state===t.ProjectStatusLabel.Completed,t.state===t.ProjectStatusLabel.Planned,t.state===t.ProjectStatusLabel.InProgress,t.state===t.ProjectStatusLabel.Blocked,t.state===t.ProjectStatusLabel.Closed)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(t.state),g.\u0275\u0275advance(6),g.\u0275\u0275textInterpolate(t.trancateDescription(t.project.description)),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate1(" ",t.project.customerName," "),g.\u0275\u0275advance(4),g.\u0275\u0275textInterpolate1(" ",t.project.cost," "),g.\u0275\u0275advance(4),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(15,Ds,t.project.SQAVisa===t.PifVisa.Valid,t.project.SQAVisa===t.PifVisa.Invalid,t.project.SQAVisa===t.PifVisa.InProgress)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",t.project.SQAVisa,""),g.\u0275\u0275advance(5),g.\u0275\u0275textInterpolate1("",t.project.activityName," "))},directives:[i.NgClass,ne.gM],styles:[".thick[_ngcontent-%COMP%]{font-weight:900}.text1[_ngcontent-%COMP%]{font-size:14px}.pen-icon-button[_ngcontent-%COMP%]{width:10px;height:10px}.pen-icon[_ngcontent-%COMP%]{font-size:15px}.card-header[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid rgba(0,0,0,.125)}.label-pink[_ngcontent-%COMP%]{background:#e83e8c}.card-body[_ngcontent-%COMP%]{padding-bottom:5px}.card-footer[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0}.task-board[_ngcontent-%COMP%]{margin-top:0}"]}),e})();function Os(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Name"),g.\u0275\u0275elementEnd())}function Fs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",21),g.\u0275\u0275elementStart(1,"span",22),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.name),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.name)}}function ks(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Activity"),g.\u0275\u0275elementEnd())}function As(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",21),g.\u0275\u0275elementStart(1,"span",22),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.activityName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.activityName)}}function _s(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Start Date"),g.\u0275\u0275elementEnd())}function Vs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.plannedStartDate)," ")}}function Ns(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"End Date"),g.\u0275\u0275elementEnd())}function Rs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.plannedEndDate)," ")}}function Ts(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Customer"),g.\u0275\u0275elementEnd())}function Bs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",21),g.\u0275\u0275elementStart(1,"span",22),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.customerName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.customerName," ")}}function zs(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Reference"),g.\u0275\u0275elementEnd())}function qs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",21),g.\u0275\u0275elementStart(1,"span",22),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.reference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.reference," ")}}function Ls(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Cost"),g.\u0275\u0275elementEnd())}function Qs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.cost," ")}}function $s(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Pif"),g.\u0275\u0275elementEnd())}const Us=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}};function Hs(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"label",23),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction3(2,Us,e.SQAVisa===n.PifVisa.Valid,e.SQAVisa===n.PifVisa.Invalid,e.SQAVisa===n.PifVisa.InProgress)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.SQAVisa)}}function Gs(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",20),g.\u0275\u0275text(1,"Status"),g.\u0275\u0275elementEnd())}const Ws=function(e,t,n,i,r){return{"label-warning":e,"label-primary":t,"label-success":n,"label-danger":i,"label-default":r}};function Js(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"label",23),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction5(2,Ws,e.state===n.ProjectStatusLabel.Completed,e.state===n.ProjectStatusLabel.Planned,e.state===n.ProjectStatusLabel.InProgress,e.state===n.ProjectStatusLabel.Blocked,e.state===n.ProjectStatusLabel.Closed)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(e.state)}}function Ys(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function Ks(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",24),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).editProject(t.pifId,t.projectId)}),g.\u0275\u0275elementStart(2,"em",25),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}}function Xs(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",26)}function Zs(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function el(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275elementStart(1,"mat-table",2,3),g.\u0275\u0275listener("matSortChange",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onSortData(t)}),g.\u0275\u0275elementContainerStart(3,4),g.\u0275\u0275template(4,Os,2,0,"mat-header-cell",5),g.\u0275\u0275template(5,Fs,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,7),g.\u0275\u0275template(7,ks,2,0,"mat-header-cell",5),g.\u0275\u0275template(8,As,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,8),g.\u0275\u0275template(10,_s,2,0,"mat-header-cell",5),g.\u0275\u0275template(11,Vs,3,3,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,10),g.\u0275\u0275template(13,Ns,2,0,"mat-header-cell",5),g.\u0275\u0275template(14,Rs,3,3,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,11),g.\u0275\u0275template(16,Ts,2,0,"mat-header-cell",5),g.\u0275\u0275template(17,Bs,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,12),g.\u0275\u0275template(19,zs,2,0,"mat-header-cell",5),g.\u0275\u0275template(20,qs,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,13),g.\u0275\u0275template(22,Ls,2,0,"mat-header-cell",5),g.\u0275\u0275template(23,Qs,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(24,14),g.\u0275\u0275template(25,$s,2,0,"mat-header-cell",5),g.\u0275\u0275template(26,Hs,3,6,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(27,15),g.\u0275\u0275template(28,Gs,2,0,"mat-header-cell",5),g.\u0275\u0275template(29,Js,3,8,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(30,16),g.\u0275\u0275template(31,Ys,1,0,"mat-header-cell",17),g.\u0275\u0275template(32,Ks,4,0,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(33,Xs,1,0,"mat-header-row",18),g.\u0275\u0275template(34,Zs,1,0,"mat-row",19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",e.dataSource),g.\u0275\u0275advance(32),g.\u0275\u0275property("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",e.displayedColumns)}}let tl=(()=>{class e{constructor(e,t,n,i){this.projectService=e,this.searchFilterService=t,this.activeRoute=n,this.router=i,this.displayedColumns=["name","activityName","plannedStartDate","plannedEndDate","customerName","reference","cost","sqa","status","buttons"],this.dataSource=new Qn.by,this.PifVisa=m.CB,this.ProjectStatusLabel=m.tU}ngOnInit(){this.dataSource=new Qn.by(this.projects),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}editProject(e,t){this.projectService.previousState.next({type:"table",pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["../edit/"+e.toString()+"/"+t.toString()],{relativeTo:this.activeRoute})}onSortData(e){this.projectService.sortProjects.next(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(a.F0))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-projects-table"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Ln.YE,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{projects:"projects"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","name"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","activityName"],["matColumnDef","plannedStartDate"],[4,"matCellDef"],["matColumnDef","plannedEndDate"],["matColumnDef","customerName"],["matColumnDef","reference"],["matColumnDef","cost"],["matColumnDef","sqa"],["matColumnDef","status"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],[1,"label",3,"ngClass"],["type","button",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],["matTooltip","edit",1,"material-icons"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&g.\u0275\u0275template(0,el,35,4,"div",0),2&e&&g.\u0275\u0275property("ngIf",void 0!==t.projects&&0!==t.projects.length)},directives:[i.NgIf,Qn.BZ,Ln.YE,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,i.NgClass,Qn.XQ,Qn.Gk],pipes:[_e.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.material-icons[_ngcontent-%COMP%]{font-size:15px}table[_ngcontent-%COMP%]{width:100%}.mat-column-name[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 25%!important;width:25%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-activityName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 10%!important;width:10%!important;overflow-wrap:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-plannedStartDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-plannedEndDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-customerName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-reference[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-cost[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 5%!important;width:5%!important;overflow-wrap:break-word;word-break:break-word;text-align:right;justify-content:flex-end;-webkit-hyphens:auto;hyphens:auto}.mat-column-status[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 7%!important;width:7%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-sqa[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 7%!important;width:7%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-buttons[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 5%!important;width:5%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}  .mat-sort-header-arrow{color:#fff}"]}),e})();function nl(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"button",40),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().addProject()}),g.\u0275\u0275element(1,"em",41),g.\u0275\u0275text(2," Project "),g.\u0275\u0275elementEnd()}}function il(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function rl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",42),g.\u0275\u0275elementStart(1,"div",43),g.\u0275\u0275elementStart(2,"div",44),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",45),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function al(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",48),g.\u0275\u0275element(1,"app-project-card",49),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275property("project",e)}}function ol(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",46),g.\u0275\u0275template(1,al,2,1,"div",47),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275classProp("blurred",e.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind3(2,3,e.projects,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))}}function sl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",50),g.\u0275\u0275element(1,"app-projects-table",51),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275classProp("blurred",e.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("projects",g.\u0275\u0275pipeBind3(2,3,e.projects,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))}}let ll=(()=>{class e{constructor(e,t,n,i,r){this.sortService=e,this.projectService=t,this.searchFilterService=n,this.dateTimeService=i,this.router=r,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.cardView=!0,this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.statusIdentifiers=[],this.selectedStatusesIdentifiers=[],this.projectName="",this.dropdownSettings={},this.dropdownSettingsState={},this.subscription=new c.w0,this.sqaStates=[{id:m.Es.InProgress,description:m.CB.InProgress},{id:m.Es.Valid,description:m.CB.Valid},{id:m.Es.Invalid,description:m.CB.Invalid}],this.selectedSqaStates=[],this.myProjects=!1,this.destroyed=new c.xQ}ngOnInit(){this.searchFilterService.pageSize=24;const e=JSON.parse(sessionStorage.getItem("projectSearch"));null!==e&&(this.projectName=e.projectName,this.selectedActivitiesIdentifiers=e.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),this.selectedCustomersIdentifiers=e.selectedCustomersIdentifiers,this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(e=>e.id).join(","),this.selectedStatusesIdentifiers=e.selectedStatusesIdentifiers,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(e=>e.id).join(","),this.selectedSqaStates=e.selectedSqaStates,this.selectedSqaStatusesIds=this.selectedSqaStates.map(e=>e.description).join(","),null!=e.periodFrom&&(this.searchFilterService.periodFrom=e.periodFrom),null!=e.periodTo&&(this.searchFilterService.periodTo=e.periodTo),this.myProjects=e.myProjects),this.subscription.add(this.projectService.previousState.pipe((0,Ne.R)(this.destroyed)).subscribe(e=>{e&&e.getPrevious&&(this.searchButton(),this.searchFilterService.pageSize=e.pageSize,this.searchFilterService.pageIndex=e.pageIndex,this.cardView="card"===e.type,this.destroyed.next(),this.projectService.previousState.next())})),this.subscription.add(this.projectService.sortProjects.subscribe(e=>{this.onSortData(e)})),this.user=JSON.parse(localStorage.getItem("currentUser")),this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownSettingsState={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.selectedSqaStatusesIds=this.selectedSqaStates.map(e=>e.id).join(","),this.getActivities(),this.getClients(),this.getStatuses()}ngOnDestroy(){this.subscription.unsubscribe(),this.searchFilterService.showingDataLastFilter=[],this.searchFilterService.periodFrom=null,this.searchFilterService.periodTo=null}getActivities(){this.projectService.getActivities().subscribe(e=>{if(null!=e&&(this.activitiesIdentifiers=e,this.selectedActivitiesIds=this.activitiesIdentifiers.map(e=>e.id).join(","),this.onChangeActivity(this.selectedActivitiesIds),null===JSON.parse(sessionStorage.getItem("projectSearch")))){const e=[];this.activitiesIdentifiers.find(e=>e.id===this.user.activityId)&&(e.push(this.activitiesIdentifiers.find(e=>e.id===this.user.activityId)),this.selectedActivitiesIdentifiers=e)}})}getStatuses(){this.projectService.getProjectStates().subscribe(e=>{null!=e&&(this.statusIdentifiers=e,null===JSON.parse(sessionStorage.getItem("projectSearch"))&&(this.selectedStatusesIdentifiers=this.statusIdentifiers.filter(e=>e.id===m.kJ.Planned||e.id===m.kJ.InProgress)))})}getClients(){this.projectService.getClients().subscribe(e=>{null!=e&&(this.customersIdentifiers=e,null===this.selectedCustomersIds||this.selectedCustomersIds||(this.selectedCustomersIds=this.customersIdentifiers.map(e=>e.id).join(","),this.onChangeCustomer(this.selectedCustomersIds)))})}onResetName(){this.projectName=void 0}onResetStatus(){this.selectedStatusesIdentifiers=this.statusIdentifiers.filter(e=>e.id===m.kJ.Planned||e.id===m.kJ.InProgress)}onResetSqaStatus(){this.selectedSqaStates=[]}onResetCustomers(){this.selectedCustomersIdentifiers=[]}onResetStartDateRange(){this.searchFilterService.periodFrom=null}onResetEndDateRange(){this.searchFilterService.periodTo=null}onResetActivity(){const e=[];e.push(this.activitiesIdentifiers.find(e=>e.id===this.user.activityId)),this.selectedActivitiesIdentifiers=e}onResetMyProjects(){this.myProjects=!1}onResetAllFilters(){sessionStorage.removeItem("projectSearch"),this.onResetName(),this.onResetCustomers(),this.onResetStatus(),this.onResetSqaStatus(),this.onResetStartDateRange(),this.onResetEndDateRange(),this.onResetActivity(),this.onResetMyProjects()}onViewModeCard(){this.cardView=!0}onViewModeTable(){this.cardView=!1}onChangeActivity(e){this.selectedActivitiesIds=e}onChangeCustomer(e){this.selectedCustomersIds=e}onChangeStatus(e){this.selectedStatusesIds=e}searchButton(){this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(e=>e.id).join(","),this.selectedSqaStatusesIds=this.selectedSqaStates.map(e=>e.description).join(","),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(e=>e.id).join(","),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),this.user=JSON.parse(localStorage.getItem("currentUser"));const e=new m.bA;e.projectName=this.projectName,e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.selectedSqaStates=this.selectedSqaStates,e.periodFrom=this.searchFilterService.periodFrom,e.periodTo=this.searchFilterService.periodTo,e.myProjects=this.myProjects,sessionStorage.setItem("projectSearch",JSON.stringify(e)),this.getProjects(e)}getProjects(e){const t=this.user.groupId===h.Fl.SuperAdmin||this.user.groupId===h.Fl.Finance||this.user.groupId===h.Fl.Facturation||this.user.activityId===h.RS.Quality||this.user.qualification===h._W.DepartmentHead,n=this.user.qualification===h._W.Director,i=this.user.qualification===h._W.Engineer||this.user.qualification===h._W.ProjectManager||this.user.groupId===h.Fl.ProjectManager||this.user.groupId===h.Fl.TeamLeader||this.user.groupId===h.Fl.Developer||this.user.groupId===h.Fl.Validator;this.searchFilterService.pageIndex=0,this.isLoading=!0,!0===this.myProjects||!t&&i?this.projectService.getMemberProjects(this.user.userId,e).subscribe(e=>{this.refreshProjects(e)}):t?this.projectService.getProjects(e).subscribe(e=>{this.refreshProjects(e)}):n&&this.projectService.getActivityProjects(this.user.userId,this.user.activityId,e).subscribe(e=>{this.refreshProjects(e)})}refreshProjects(e){this.isLoading=!1,this.projects=e,this.lengthProjects=this.projects.length,this.setProjectStatus()}addProject(){this.router.navigate(["project-management/project/add"])}addIsVisible(){return-1!==this.user.functionsId.indexOf(h.FI.AddProject)}onClickingEnter(e){"Enter"===e.key&&this.searchButton()}dateOnly(e){return this.dateTimeService.dateOnly(e)}onSortData(e){e.active&&""!==e.direction&&void 0!==this.projects&&this.projects.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"name":return this.sortService.compare(t.name,n.name,i,!1);case"activityName":return this.sortService.compare(t.activityName,n.activityName,i,!1);case"plannedStartDate":return this.sortService.compare(t.plannedStartDate,n.plannedStartDate,i,!1);case"plannedEndDate":return this.sortService.compare(t.plannedEndDate,n.plannedEndDate,i,!1);case"customerName":return this.sortService.compare(t.customerName,n.customerName,i,!1);case"reference":return this.sortService.compare(t.reference,n.reference,i,!1);case"cost":return this.sortService.compare(t.cost,n.cost,i,!0);case"sqa":return this.sortService.compare(t.SQAVisa,n.SQAVisa,i,!1);case"status":return this.sortService.compare(t.state,n.state,i,!1);default:return 0}}),this.paginatorPipe.transform(this.projects,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}setProjectStatus(){this.projects&&this.projects.forEach(e=>{switch(e.statusId){case m.kJ.InProgress:e.state=m.tU.InProgress;break;case m.kJ.Blocked:e.state=m.tU.Blocked;break;case m.kJ.Closed:e.state=m.tU.Closed;break;case m.kJ.Planned:e.state=m.tU.Planned;break;case m.kJ.Completed:e.state=m.tU.Completed}})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(a.F0))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-projects"]],decls:75,vars:34,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From",3,"matDatepicker","max","ngModel","keypress","ngModelChange"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To",3,"matDatepicker","min","ngModel","keypress","ngModelChange"],["picker22",""],[1,"search-input","col-sm-7"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","keydown","ngModelChange"],[1,"col-sm-3"],[3,"ngModel","ngModelChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button","data-toggle","tooltip","data-placement","top","matTooltip","Card View",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-listine-dots"],["type","button","data-toggle","tooltip","data-placement","top","matTooltip","Table View",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-table"],["type","button","class","btn btn-sm btn-primary waves-light m-r-10 ripple","style","font-size:inherit;",3,"click",4,"ngIf"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","row div-scrollable loaded-content",3,"blurred",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"row","div-scrollable","loaded-content"],["class","col-sm-4 p-r-0",4,"ngFor","ngForOf"],[1,"col-sm-4","p-r-0"],[3,"project"],[1,"loaded-content"],[3,"projects"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"div",1),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"mat-list"),g.\u0275\u0275elementStart(8,"mat-list-item"),g.\u0275\u0275elementStart(9,"h3",6),g.\u0275\u0275text(10,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"mat-form-field",7),g.\u0275\u0275elementStart(12,"input",8),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.searchFilterService.periodFrom=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(13,"mat-datepicker-toggle",9),g.\u0275\u0275element(14,"mat-datepicker",null,10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",7),g.\u0275\u0275elementStart(17,"input",11),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.searchFilterService.periodTo=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(18,"mat-datepicker-toggle",9),g.\u0275\u0275element(19,"mat-datepicker",null,12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"mat-list-item"),g.\u0275\u0275elementStart(22,"h3",6),g.\u0275\u0275text(23,"Project"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",13),g.\u0275\u0275elementStart(25,"input",14),g.\u0275\u0275listener("keydown",function(e){return t.onClickingEnter(e)})("ngModelChange",function(e){return t.projectName=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",15),g.\u0275\u0275elementStart(27,"mat-checkbox",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.myProjects=e}),g.\u0275\u0275text(28," Mines "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"div",5),g.\u0275\u0275elementStart(30,"mat-list"),g.\u0275\u0275elementStart(31,"mat-list-item"),g.\u0275\u0275elementStart(32,"h3",6),g.\u0275\u0275text(33,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"div",17),g.\u0275\u0275elementStart(35,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedActivitiesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-list-item"),g.\u0275\u0275elementStart(37,"h3",6),g.\u0275\u0275text(38,"Customer"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(39,"div",17),g.\u0275\u0275elementStart(40,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedCustomersIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"div",19),g.\u0275\u0275elementStart(42,"mat-list"),g.\u0275\u0275elementStart(43,"mat-list-item"),g.\u0275\u0275elementStart(44,"h3",6),g.\u0275\u0275text(45,"Status"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(46,"div",17),g.\u0275\u0275elementStart(47,"ng-multiselect-dropdown",20),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"mat-list-item"),g.\u0275\u0275elementStart(49,"h3",6),g.\u0275\u0275text(50,"Pif "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(51,"div",17),g.\u0275\u0275elementStart(52,"ng-multiselect-dropdown",21),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedSqaStates=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"div",22),g.\u0275\u0275elementStart(54,"div",23),g.\u0275\u0275elementStart(55,"button",24),g.\u0275\u0275listener("click",function(){return t.searchButton()}),g.\u0275\u0275text(56,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"div",23),g.\u0275\u0275elementStart(58,"button",25),g.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),g.\u0275\u0275text(59,"Reset"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(60,"nav",26),g.\u0275\u0275elementStart(61,"div",27),g.\u0275\u0275elementStart(62,"button",28),g.\u0275\u0275listener("click",function(){return t.onViewModeCard()}),g.\u0275\u0275element(63,"em",29),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(64,"button",30),g.\u0275\u0275listener("click",function(){return t.onViewModeTable()}),g.\u0275\u0275element(65,"em",31),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(66," \xa0 "),g.\u0275\u0275template(67,nl,3,0,"button",32),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(68,"div",33),g.\u0275\u0275element(69,"app-paginator",34),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(70,il,3,0,"div",35),g.\u0275\u0275elementStart(71,"div",36),g.\u0275\u0275template(72,rl,6,0,"div",37),g.\u0275\u0275template(73,ol,3,7,"div",38),g.\u0275\u0275template(74,sl,3,7,"div",39),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(15),n=g.\u0275\u0275reference(20);g.\u0275\u0275advance(12),g.\u0275\u0275property("matDatepicker",e)("max",t.searchFilterService.periodTo)("ngModel",t.searchFilterService.periodFrom),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(4),g.\u0275\u0275property("matDatepicker",n)("min",t.searchFilterService.periodFrom)("ngModel",t.searchFilterService.periodTo),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(7),g.\u0275\u0275property("ngModel",t.projectName),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.myProjects),g.\u0275\u0275advance(8),g.\u0275\u0275property("placeholder","Select...")("data",t.activitiesIdentifiers)("ngModel",t.selectedActivitiesIdentifiers)("settings",t.dropdownSettings),g.\u0275\u0275advance(5),g.\u0275\u0275property("placeholder","Select...")("data",t.customersIdentifiers)("ngModel",t.selectedCustomersIdentifiers)("settings",t.dropdownSettings),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",t.statusIdentifiers)("ngModel",t.selectedStatusesIdentifiers)("settings",t.dropdownSettingsState),g.\u0275\u0275advance(5),g.\u0275\u0275property("placeholder","Select...")("settings",t.dropdownSettingsState)("data",t.sqaStates)("ngModel",t.selectedSqaStates),g.\u0275\u0275advance(15),g.\u0275\u0275property("ngIf",t.addIsVisible()),g.\u0275\u0275advance(2),g.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthProjects),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",0===t.lengthProjects),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.cardView),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.cardView)}},directives:[vo.i$,vo.Tg,b.KE,C.Nt,E.hl,o.DefaultValueAccessor,o.NgControlStatus,o.NgModel,E.nW,b.R9,E.Mq,os.oG,So.OP,ft.M2,ne.gM,i.NgIf,qn.J,Bn.$g,i.NgForOf,js,tl],pipes:[_i.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-divider{margin-top:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.div-scrollable{overflow-y:auto;margin-right:0;max-height:calc(100vh - 392px)}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}.mat-checkbox-layout{margin-bottom:0}.mat-checkbox-layout .mat-checkbox-label{font-size:15px;font-weight:bolder;color:#0000008a}\n"],encapsulation:2}),e})();function cl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1,"Reference"),g.\u0275\u0275elementEnd())}function dl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275elementStart(1,"span",19),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.referenceCode),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(e.referenceCode)}}function ml(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1,"Title"),g.\u0275\u0275elementEnd())}function pl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275elementStart(1,"span",19),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.title),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.title," ")}}function hl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1,"Edition"),g.\u0275\u0275elementEnd())}function ul(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.edition," ")}}function gl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1,"Date"),g.\u0275\u0275elementEnd())}function fl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,e.creationDate)," ")}}function vl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1," Status"),g.\u0275\u0275elementEnd())}function Sl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.state," ")}}function bl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",17),g.\u0275\u0275text(1," Type"),g.\u0275\u0275elementEnd())}function Cl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",18),g.\u0275\u0275elementStart(1,"span",19),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",e.type),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",e.type," ")}}function yl(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-cell")}function El(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"button",20),g.\u0275\u0275listener("click",function(){const t=g.\u0275\u0275restoreView(e).$implicit;return g.\u0275\u0275nextContext(2).navigateToEdit(t)}),g.\u0275\u0275elementStart(2,"em",21),g.\u0275\u0275text(3,"edit"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(1),g.\u0275\u0275property("disabled",!n.isEditable(e))}}function xl(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",22)}function Il(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function wl(e,t){if(1&e){const e=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275listener("matSortChange",function(t){return g.\u0275\u0275restoreView(e),g.\u0275\u0275nextContext().onSortData(t)}),g.\u0275\u0275elementStart(1,"mat-table",2,3),g.\u0275\u0275elementContainerStart(3,4),g.\u0275\u0275template(4,cl,2,0,"mat-header-cell",5),g.\u0275\u0275template(5,dl,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,7),g.\u0275\u0275template(7,ml,2,0,"mat-header-cell",5),g.\u0275\u0275template(8,pl,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,8),g.\u0275\u0275template(10,hl,2,0,"mat-header-cell",5),g.\u0275\u0275template(11,ul,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,10),g.\u0275\u0275template(13,gl,2,0,"mat-header-cell",5),g.\u0275\u0275template(14,fl,3,3,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,11),g.\u0275\u0275template(16,vl,2,0,"mat-header-cell",5),g.\u0275\u0275template(17,Sl,2,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,12),g.\u0275\u0275template(19,bl,2,0,"mat-header-cell",5),g.\u0275\u0275template(20,Cl,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,13),g.\u0275\u0275template(22,yl,1,0,"mat-header-cell",14),g.\u0275\u0275template(23,El,4,1,"mat-cell",9),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(24,xl,1,0,"mat-header-row",15),g.\u0275\u0275template(25,Il,1,0,"mat-row",16),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",e.dataSource),g.\u0275\u0275advance(23),g.\u0275\u0275property("matHeaderRowDef",e.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",e.displayedColumns)}}let Ml=(()=>{class e{constructor(e,t,n,i){this.searchFilterService=e,this.referenceService=t,this.router=n,this.route=i,this.displayedColumns=["referenceCode","title","edition","creationDate","state","type","buttons"],this.dataSource=new Qn.by,this.listView=!1}ngOnInit(){0!==this.references.length&&(this.listView=!0),this.dataSource=new Qn.by(this.references),this.subscription=this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Qn.by(this.searchFilterService.showingDataLastFilter)})}ngOnDestroy(){this.subscription.unsubscribe()}onSortData(e){this.referenceService.sortReferences.next(e)}navigateToEdit(e){this.router.navigate(["/project-management/project/edit-reference/"+e.referenceId.toString()]),this.referenceService.savedReference.next({getPrevious:!1,pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize})}isEditable(e){return e.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.nJ),g.\u0275\u0275directiveInject(p.q8),g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(a.gz))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-references-table"]],inputs:{references:"references"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8","matSort","","matSortDirection","asc","matSortDisableClear","",3,"matSortChange",4,"ngIf"],["matSort","","matSortDirection","asc","matSortDisableClear","",1,"example-container","mat-elevation-z8",3,"matSortChange"],[3,"dataSource"],["table",""],["matColumnDef","referenceCode"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","edition"],[4,"matCellDef"],["matColumnDef","creationDate"],["matColumnDef","state"],["matColumnDef","type"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit reference",1,"btn","btn-mini","btn-primary","ripple","light",3,"disabled","click"],[1,"material-icons"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&g.\u0275\u0275template(0,wl,26,4,"div",0),2&e&&g.\u0275\u0275property("ngIf",t.listView)},directives:[i.NgIf,Ln.YE,Qn.BZ,Qn.w1,Qn.fO,Qn.Dz,Qn.as,Qn.nj,Qn.ge,Ln.nU,Qn.ev,ne.gM,Qn.XQ,Qn.Gk],pipes:[_e.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.table[_ngcontent-%COMP%]{width:100%}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-column-referenceCode[_ngcontent-%COMP%]{flex:0 0 20%!important;width:20%!important}.mat-column-title[_ngcontent-%COMP%]{flex:0 0 26%!important;width:26%!important}.mat-column-edition[_ngcontent-%COMP%]{flex:0 0 5%!important;width:5%!important;justify-content:center}.mat-column-creationDate[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important;justify-content:center}.mat-column-state[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}.mat-column-type[_ngcontent-%COMP%]{flex:0 0 25%!important;width:25%!important}.mat-column-buttons[_ngcontent-%COMP%]{flex:4 0 5%!important;width:5%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e})();function Pl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function Dl(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",33),g.\u0275\u0275elementStart(1,"div",34),g.\u0275\u0275elementStart(2,"div",35),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",36),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function jl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",37),g.\u0275\u0275element(1,"app-references-table",38),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275nextContext();g.\u0275\u0275classProp("blurred",e.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("references",g.\u0275\u0275pipeBind3(2,3,e.references,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))}}let Ol=(()=>{class e{constructor(e,t,n,i,r,a,o){this.notificationService=e,this.dateTimeService=t,this.sortService=n,this.referenceService=i,this.projectService=r,this.router=a,this.searchFilterService=o,this.paginatorPipe=new zn.Ry(this.searchFilterService),this.statusesIdentifiers=[],this.selectedStatusesIdentifiers=[],this.typesIdentifiers=[],this.selectedTypesIdentifiers=[],this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.referenceCode="",this.title="",this.dropdownSettings={},this.dropdownStatusSettings={},this.references=[],this.listView=!1,this.destroyed=new c.xQ}ngOnInit(){this.getStatuses(),this.getTypes(),this.getActivities(),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownStatusSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.subscription=this.referenceService.sortReferences.subscribe(e=>{this.onSortData(e)}),this.periodTo=this.dateTimeService.today(),this.periodFrom=this.dateTimeService.getFirstDayFromPreviousMonth();const e=JSON.parse(sessionStorage.getItem("referenceSearch"));null!==e&&(this.title=e.title,this.referenceCode=e.referenceCode,this.selectedStatusesIdentifiers=e.selectedStatusesIdentifiers,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(e=>e.id).join(","),this.selectedTypesIdentifiers=e.selectedTypesIdentifiers,this.selectedTypesIds=this.selectedTypesIdentifiers.map(e=>e.id).join(","),this.selectedActivitiesIdentifiers=e.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),null!=e.periodFrom&&(this.periodFrom=e.periodFrom),null!=e.periodTo&&(this.periodTo=e.periodTo)),this.refreshSubscription=this.referenceService.savedReference.pipe((0,Ne.R)(this.destroyed)).subscribe(e=>{e&&!0===e.getPrevious&&(this.searchButton(),this.searchFilterService.pageSize=e.pageSize,this.searchFilterService.pageIndex=e.pageIndex,this.destroyed.next(),this.referenceService.savedReference.next())})}ngOnDestroy(){this.subscription.unsubscribe(),this.refreshSubscription.unsubscribe(),this.searchFilterService.showingDataLastFilter=[]}onResetAllFilters(){this.onResetTitle(),this.onResetReference(),this.onResetStatus(),this.onResetType(),this.onResetStartDateRange(),this.onResetEndDateRange(),this.onResetActivity()}getActivities(){this.projectService.getActivities().subscribe(e=>{if(null!=e&&(this.activitiesIdentifiers=e,this.selectedActivitiesIds=this.activitiesIdentifiers.map(e=>e.id).join(","),null===JSON.parse(sessionStorage.getItem("referenceSearch")))){const e=[];this.activitiesIdentifiers.find(e=>e.id===JSON.parse(localStorage.getItem("currentUser")).activityId)&&(e.push(this.activitiesIdentifiers.find(e=>e.id===JSON.parse(localStorage.getItem("currentUser")).activityId)),this.selectedActivitiesIdentifiers=e)}})}getStatuses(){this.referenceService.getDocumentStates().subscribe(e=>{null!=e&&(this.statusesIdentifiers=e,null!=this.selectedStatusesIds&&(this.selectedStatusesIds=this.statusesIdentifiers.map(e=>e.id).join(",")))})}getTypes(){this.referenceService.getTypesDocuments().subscribe(e=>{null!=e&&(this.typesIdentifiers=e,null==this.selectedTypesIds||(this.selectedTypesIds=this.typesIdentifiers.map(e=>e.id).join(",")))})}onResetTitle(){this.title=void 0}onResetActivity(){const e=[];e.push(this.activitiesIdentifiers.find(e=>e.id===JSON.parse(localStorage.getItem("currentUser")).activityId)),this.selectedActivitiesIdentifiers=e,sessionStorage.removeItem("referenceSearch")}onResetReference(){this.referenceCode=void 0}onResetStatus(){this.selectedStatusesIdentifiers=[]}onResetType(){this.selectedTypesIdentifiers=[]}onResetStartDateRange(){this.periodFrom=this.dateTimeService.getFirstDayFromPreviousMonth()}onResetEndDateRange(){this.periodTo=this.dateTimeService.today()}searchButton(){if(null!==this.periodFrom&&null!==this.periodTo){this.searchFilterService.pageIndex=0,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(e=>e.id).join(","),this.selectedTypesIds=this.selectedTypesIdentifiers.map(e=>e.id).join(","),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(",");const e=new m.oU;e.title=this.title,e.referenceCode=this.referenceCode,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.selectedTypesIdentifiers=this.selectedTypesIdentifiers,e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.periodFrom=this.periodFrom,e.periodTo=this.periodTo,sessionStorage.setItem("referenceSearch",JSON.stringify(e)),this.isLoading=!0,this.referenceService.getReferencesProjects(this.title,this.referenceCode,this.selectedStatusesIds,this.selectedTypesIds,this.selectedActivitiesIds,this.periodFrom,this.periodTo).subscribe(e=>{this.isLoading=!1,this.references=e,this.lengthReferences=this.references.length,this.listView=0!==e.length})}else this.notificationService.danger("Please fill dates fields")}onClickingEnter(e){"Enter"===e.key&&this.searchButton()}dateOnly(e){return this.dateTimeService.dateOnly(e)}onSortData(e){e.active&&""!==e.direction&&void 0!==this.references&&this.references.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"referenceCode":return this.sortService.compare(t.referenceCode,n.referenceCode,i,!1);case"title":return this.sortService.compare(t.title,n.title,i,!1);case"edition":return this.sortService.compare(t.edition,n.edition,i,!0);case"creationDate":return this.sortService.compare(t.creationDate,n.creationDate,i,!1);case"state":return this.sortService.compare(t.state,n.state,i,!1);case"type":return this.sortService.compare(t.type,n.type,i,!1);default:return 0}}),this.paginatorPipe.transform(this.references,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}AddReference(){this.router.navigate(["/project-management/project/add-reference"]),void 0!==this.lengthReferences&&0!==this.lengthReferences&&this.referenceService.savedReference.next({getPrevious:!1,pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize})}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(d.Kx),g.\u0275\u0275directiveInject(p.q8),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(d.nJ))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-references"]],decls:68,vars:28,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From","required","",3,"matDatepicker","max","ngModel","keypress","ngModelChange","keydown"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To","required","",3,"matDatepicker","min","ngModel","keypress","ngModelChange","keydown"],["picker22",""],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","ngModelChange","keydown"],[1,"col-sm-10"],[1,"multi-search",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"loaded-content"],[3,"references"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"div",1),g.\u0275\u0275elementStart(6,"div",5),g.\u0275\u0275elementStart(7,"mat-list"),g.\u0275\u0275elementStart(8,"mat-list-item"),g.\u0275\u0275elementStart(9,"h3",6),g.\u0275\u0275text(10,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"mat-form-field",7),g.\u0275\u0275elementStart(12,"input",8),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.periodFrom=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(13,"mat-datepicker-toggle",9),g.\u0275\u0275element(14,"mat-datepicker",null,10),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",7),g.\u0275\u0275elementStart(17,"input",11),g.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.periodTo=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(18,"mat-datepicker-toggle",9),g.\u0275\u0275element(19,"mat-datepicker",null,12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(21,"mat-list-item"),g.\u0275\u0275elementStart(22,"h3",6),g.\u0275\u0275text(23,"Ref."),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"mat-form-field",13),g.\u0275\u0275elementStart(25,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.referenceCode=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(26,"div",5),g.\u0275\u0275elementStart(27,"mat-list"),g.\u0275\u0275elementStart(28,"mat-list-item"),g.\u0275\u0275elementStart(29,"h3",6),g.\u0275\u0275text(30,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"div",15),g.\u0275\u0275elementStart(32,"ng-multiselect-dropdown",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedActivitiesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(33,"mat-list-item"),g.\u0275\u0275elementStart(34,"h3",6),g.\u0275\u0275text(35,"Title"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"mat-form-field",13),g.\u0275\u0275elementStart(37,"input",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.title=e})("keydown",function(e){return t.onClickingEnter(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(38,"div",17),g.\u0275\u0275elementStart(39,"mat-list"),g.\u0275\u0275elementStart(40,"mat-list-item"),g.\u0275\u0275elementStart(41,"h3",6),g.\u0275\u0275text(42,"Status"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"div",15),g.\u0275\u0275elementStart(44,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(45,"mat-list-item"),g.\u0275\u0275elementStart(46,"h3",6),g.\u0275\u0275text(47,"Type"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(48,"div",15),g.\u0275\u0275elementStart(49,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return t.selectedTypesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(50,"div",19),g.\u0275\u0275elementStart(51,"div",20),g.\u0275\u0275elementStart(52,"button",21),g.\u0275\u0275listener("click",function(){return t.searchButton()}),g.\u0275\u0275text(53,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(54,"div",20),g.\u0275\u0275elementStart(55,"button",22),g.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),g.\u0275\u0275text(56,"Reset"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(57,"nav",23),g.\u0275\u0275elementStart(58,"div",24),g.\u0275\u0275elementStart(59,"button",25),g.\u0275\u0275listener("click",function(){return t.AddReference()}),g.\u0275\u0275element(60,"em",26),g.\u0275\u0275text(61," Reference "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(62,"div",27),g.\u0275\u0275element(63,"app-paginator",28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(64,Pl,3,0,"div",29),g.\u0275\u0275elementStart(65,"div",30),g.\u0275\u0275template(66,Dl,6,0,"div",31),g.\u0275\u0275template(67,jl,3,7,"div",32),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(15),n=g.\u0275\u0275reference(20);g.\u0275\u0275advance(12),g.\u0275\u0275property("matDatepicker",e)("max",t.periodTo)("ngModel",t.periodFrom),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(4),g.\u0275\u0275property("matDatepicker",n)("min",t.periodFrom)("ngModel",t.periodTo),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(7),g.\u0275\u0275property("ngModel",t.referenceCode),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",t.activitiesIdentifiers)("ngModel",t.selectedActivitiesIdentifiers)("settings",t.dropdownSettings),g.\u0275\u0275advance(5),g.\u0275\u0275property("ngModel",t.title),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",t.statusesIdentifiers)("ngModel",t.selectedStatusesIdentifiers)("settings",t.dropdownStatusSettings),g.\u0275\u0275advance(5),g.\u0275\u0275property("placeholder","Select...")("data",t.typesIdentifiers)("ngModel",t.selectedTypesIdentifiers)("settings",t.dropdownSettings),g.\u0275\u0275advance(14),g.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthReferences),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",0===t.lengthReferences),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",t.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.listView)}},directives:[vo.i$,vo.Tg,b.KE,C.Nt,E.hl,o.DefaultValueAccessor,o.RequiredValidator,o.NgControlStatus,o.NgModel,E.nW,b.R9,E.Mq,So.OP,ft.M2,qn.J,i.NgIf,Bn.$g,Ml],pipes:[_i.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e})();const Fl=["referenceForm"];function kl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Al(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}function _l(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.code),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.name," ")}}function Vl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.value),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.value," ")}}function Nl(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-option",31),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;g.\u0275\u0275property("value",e.id),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",e.description," ")}}let Rl=(()=>{class e{constructor(e,t,n,i,r,a){this.notificationService=e,this.projectService=t,this.referenceService=n,this._avRoute=i,this.router=r,this.dateTimeService=a,this.reference=new m.s3,this.disableGenerator=!0,this.subscription=new c.w0,this.isSameActivity=!0,this.filteredDocumentTypes=new c.tq(1),this.documentTypeFilterCtrl=new o.FormControl,this.filteredAbbreviations=new c.tq(1),this.abbrivationFilterCtrl=new o.FormControl,this._onDestroy=new c.xQ,this.previousState={getPrevious:!1,pageIndex:null,pageSize:null}}ngOnInit(){0!==this.reference.referenceId?this.isSameActivity=this.reference.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId:this.disableGenerator=!1,this._avRoute.params.subscribe(e=>{null!=e.referenceId&&this.getReferenceProject(+e.referenceId)}),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.reference.creationDate=this.dateTimeService.today(),this.getActivities(),this.getDocumentTypes(),this.getStates(),this.getConfidentialities(),this.abbrivationFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterAbbreviations()}),this.documentTypeFilterCtrl.valueChanges.pipe((0,Ne.R)(this._onDestroy)).subscribe(()=>{this.filterDocumentTypes()}),this.subscription.add(this.referenceService.savedReference.subscribe(e=>{e&&(this.previousState=e)}))}ngOnDestroy(){this.subscription.unsubscribe()}getDocumentTypes(){this.referenceService.getTypesDocuments().subscribe(e=>{null!=e&&(this.documentTypesIdentifiers=e,this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice()))})}getActivities(){this.projectService.getActivities().subscribe(e=>{null!=e&&(this.activitiesIdentifiers=e,0===this.reference.referenceId&&(this.reference.activityId=this.currentUser.activityId,this.getProjectAbbreviationByActivity(this.reference.activityId)))})}getStates(){this.referenceService.getDocumentStates().subscribe(e=>{null!=e&&(this.documentStatesIdentifiers=e)})}getConfidentialities(){this.referenceService.GetDocumentConfidentialities().subscribe(e=>{null!=e&&(this.documentConfidentialitiesIdentifiers=e)})}getProjectAbbreviationByActivity(e){this.referenceService.getActivityAbbriviations(e).subscribe(e=>{null!=e&&(this.projectsAbrreviation=e,this.filteredAbbreviations.next(this.projectsAbrreviation.slice()))})}getReferenceProject(e){this.disableGenerator=!0,this.referenceService.getReferenceProject(e).subscribe(e=>{this.reference=Object.assign(new m.s3,e[0]),this.isSameActivity=this.reference.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId;const t=this.getReferenceParts(this.reference.referenceCode);this.projectAbrreviation=t[2],this.confidentialityCode=t[4].split(" ")[1]})}onActivtyChange(e){this.getProjectAbbreviationByActivity(e)}buildReferenceToSave(e){const t=new m.s3;if(t.referenceId=this.reference.referenceId,t.referenceCode=this.reference.referenceCode,t.title=this.reference.title,t.edition=this.reference.edition,t.creationDate=this.reference.creationDate,t.stateId=this.reference.stateId,t.note=this.reference.note,t.archiving=this.reference.archiving,t.userId=this.reference.userId,t.activityId=this.reference.activityId,t.typeId=this.reference.typeId,0===this.reference.referenceId){const n=this.documentTypesIdentifiers.filter(e=>e.id===this.reference.typeId)[0].description.split("/")[0],i=new Date(this.reference.creationDate).getFullYear().toString().substring(2);t.referenceCode=n+"."+e+"."+this.projectAbrreviation.toUpperCase()+".*****."+i+" "+this.confidentialityCode}return t}getLabelSubmit(){return this.disableGenerator?"Save":"Generate & Save"}saveReference(){this.referenceForm.valid?this.referenceService.getActivityCode(this.reference.activityId).subscribe(e=>{const t=0!==e.length?e[0].activityCode:"TXA";this.reference.userId=+this.currentUser.userId,this.reference.edition=+this.reference.edition.toString().replace(",",".");const n=this.buildReferenceToSave(t);this.referenceService.saveReferenceGenerator(n).subscribe(e=>{this.notificationService.success("Reference saved successfully"),0===this.reference.referenceId?this.getReferenceProject(+e):this.close()})}):this.notificationService.danger("Please fill all required fields")}close(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.referenceService.savedReference.next(this.previousState)),this.router.navigate(["/project-management/project/references"])}filterAbbreviations(){if(!this.projectsAbrreviation)return;let e=this.abbrivationFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredAbbreviations.next(this.projectsAbrreviation.filter(t=>t.value.toLowerCase().indexOf(e)>-1))):this.filteredAbbreviations.next(this.projectsAbrreviation.slice())}filterDocumentTypes(){if(!this.documentTypesIdentifiers)return;let e=this.documentTypeFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredDocumentTypes.next(this.documentTypesIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice())}getReferenceParts(e){const t=e.split("."),n=t.length;let i=[];if(n>5){let e=1,r="";t.forEach(t=>{r+=""===r?t:"."+t,(e<3||e>=n-2)&&(i.push(r),r=""),e++})}else i=t;return i}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(p.Y4),g.\u0275\u0275directiveInject(p.q8),g.\u0275\u0275directiveInject(a.gz),g.\u0275\u0275directiveInject(a.F0),g.\u0275\u0275directiveInject(d.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-reference"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Fl,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.referenceForm=e.first)}},decls:55,vars:39,consts:[[1,"card"],[1,"card-body"],["id","referenceForm"],["referenceForm","ngForm"],[1,"row","m-b-15"],[1,"col-sm-6"],["placeholder","Document Type","name","documentType","required","",3,"disabled","ngModel","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-4"],["placeholder","Activity","name","activity","required","",3,"disabled","ngModel","ngModelChange","selectionChange"],[1,"col-sm-2"],["placeholder","Confidentiality","name","confidentiality","required","",3,"disabled","ngModel","ngModelChange"],["placeholder","Project Abreviation","name","projectAbreviation",3,"disabled","ngModel","ngModelChange"],["matInput","","placeholder","Project Abreviation","name","projectAbreviationInput","required","",3,"disabled","ngModel","ngModelChange"],["matInput","","placeholder","Creation Date","name","creationDate","required","",3,"disabled","matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerCreationDate",""],["matInput","","disabled","","laceholder","Reference Value","name","referenceCode",3,"ngModel","ngModelChange"],[1,"col-sm-8"],["matInput","","placeholder","Title","name","title",3,"ngModel","ngModelChange"],["matInput","","appNumberValidator","","placeholder","Edition","name","edition","required","",3,"inputValue","ngModel","ngModelChange"],["placeholder","Status","name","state","required","",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["matInput","","placeholder","Remarks","name","Remarks",3,"ngModel","ngModelChange"],["matInput","","placeholder","Archiving","name","Archiving",3,"ngModel","ngModelChange"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],["type","reset",1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"form",2,3),g.\u0275\u0275elementStart(4,"div",4),g.\u0275\u0275elementStart(5,"mat-form-field",5),g.\u0275\u0275elementStart(6,"mat-select",6),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.typeId=e}),g.\u0275\u0275elementStart(7,"mat-option"),g.\u0275\u0275elementStart(8,"ngx-mat-select-search",7),g.\u0275\u0275elementStart(9,"mat-icon",8),g.\u0275\u0275text(10,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(11,kl,2,2,"mat-option",9),g.\u0275\u0275pipe(12,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"mat-form-field",10),g.\u0275\u0275elementStart(14,"mat-select",11),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.activityId=e})("selectionChange",function(e){return t.onActivtyChange(e.value)}),g.\u0275\u0275template(15,Al,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(16,"mat-form-field",12),g.\u0275\u0275elementStart(17,"mat-select",13),g.\u0275\u0275listener("ngModelChange",function(e){return t.confidentialityCode=e}),g.\u0275\u0275template(18,_l,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"mat-form-field",12),g.\u0275\u0275elementStart(20,"mat-select",14),g.\u0275\u0275listener("ngModelChange",function(e){return t.projectAbrreviation=e}),g.\u0275\u0275elementStart(21,"mat-option"),g.\u0275\u0275elementStart(22,"ngx-mat-select-search",7),g.\u0275\u0275elementStart(23,"mat-icon",8),g.\u0275\u0275text(24,"close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(25,Vl,2,2,"mat-option",9),g.\u0275\u0275pipe(26,"async"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(27,"mat-form-field",12),g.\u0275\u0275elementStart(28,"input",15),g.\u0275\u0275listener("ngModelChange",function(e){return t.projectAbrreviation=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"mat-form-field",12),g.\u0275\u0275elementStart(30,"input",16),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.creationDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(31,"mat-datepicker-toggle",17),g.\u0275\u0275element(32,"mat-datepicker",18,19),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"mat-form-field",5),g.\u0275\u0275elementStart(35,"input",20),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.referenceCode=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"div",4),g.\u0275\u0275elementStart(37,"mat-form-field",21),g.\u0275\u0275elementStart(38,"input",22),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.title=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(39,"mat-form-field",12),g.\u0275\u0275elementStart(40,"input",23),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.edition=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"mat-form-field",12),g.\u0275\u0275elementStart(42,"mat-select",24),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.stateId=e}),g.\u0275\u0275template(43,Nl,2,2,"mat-option",9),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(44,"div",4),g.\u0275\u0275elementStart(45,"mat-form-field",25),g.\u0275\u0275elementStart(46,"input",26),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.note=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"div",4),g.\u0275\u0275elementStart(48,"mat-form-field",25),g.\u0275\u0275elementStart(49,"input",27),g.\u0275\u0275listener("ngModelChange",function(e){return t.reference.archiving=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(50,"div",28),g.\u0275\u0275elementStart(51,"button",29),g.\u0275\u0275listener("click",function(){return t.saveReference()}),g.\u0275\u0275text(52),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(53,"button",30),g.\u0275\u0275listener("click",function(){return t.close()}),g.\u0275\u0275text(54,"Close"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){const e=g.\u0275\u0275reference(33);g.\u0275\u0275advance(6),g.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.reference.typeId),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.documentTypeFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(12,35,t.filteredDocumentTypes)),g.\u0275\u0275advance(3),g.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.reference.activityId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.activitiesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.confidentialityCode),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.documentConfidentialitiesIdentifiers),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.projectAbrreviation),g.\u0275\u0275advance(2),g.\u0275\u0275property("formControl",t.abbrivationFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",g.\u0275\u0275pipeBind1(26,37,t.filteredAbbreviations)),g.\u0275\u0275advance(3),g.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.projectAbrreviation),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",t.disableGenerator)("matDatepicker",e)("ngModel",t.reference.creationDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",e),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month"),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.reference.referenceCode),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.reference.title),g.\u0275\u0275advance(2),g.\u0275\u0275property("inputValue",t.reference.edition)("ngModel",t.reference.edition),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",t.reference.stateId),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngForOf",t.documentStatesIdentifiers),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.reference.note),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngModel",t.reference.archiving),g.\u0275\u0275advance(2),g.\u0275\u0275property("disabled",!t.isSameActivity),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate(t.getLabelSubmit())}},directives:[o.\u0275NgNoValidate,o.NgControlStatusGroup,o.NgForm,b.KE,y.gD,o.RequiredValidator,o.NgControlStatus,o.NgModel,x.ey,Be.nu,o.FormControlDirective,Ae.Hw,Be.w5,i.NgForOf,C.Nt,o.DefaultValueAccessor,E.hl,E.nW,b.R9,E.Mq,ze.z],pipes:[i.AsyncPipe],styles:[".mat-button[_ngcontent-%COMP%]{min-width:0px}"]}),e})();const Tl=["missionDetailsForm"],Bl=[{path:"",data:{title:"Project",function:h.FI.Project,status:!1},canActivate:[fo.a1],children:[{path:"add",component:go,data:{title:"Add Project",icon:"icon-home",function:h.FI.AddProject,status:!0},canActivate:[fo.a1]},{path:"edit/:pifId/:projectId",component:go,data:{title:"Edit Project",icon:"icon-home",function:h.FI.ProjectDetails,status:!0},canActivate:[fo.a1]},{path:"list",component:ll,data:{title:"Projects",icon:"icon-home",caption:"",function:h.FI.Projects,status:!0},canActivate:[fo.a1]},{path:"missions",component:Qo,data:{title:"Missions",icon:"icon-home",caption:"",function:h.FI.Missions,status:!0},canActivate:[fo.a1]},{path:"add-mission",component:(()=>{class e{constructor(e,t,n,i,r){this.missionService=e,this.dateTimeService=t,this._formBuilder=n,this.notificationService=i,this.router=r,this.mission=new m.$U,this.clientsIdentifiers=[],this.resourcesIdentifiers=[],this.countriesIdentifiers=[],this.filteredClients=new c.tq(1),this.clientFilterCtrl=new o.FormControl,this.filteredResources=new c.tq(1),this.resourceFilterCtrl=new o.FormControl,this.filteredCountries=new c.tq(1),this.countryFilterCtrl=new o.FormControl,this.filteredProjects=new c.tq(1),this.projectFilterCtrl=new o.FormControl}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.projectManagerFormGroup=this._formBuilder.group({name:["",o.Validators.required],date:[this.dateTimeService.today(),o.Validators.required],departmentHead:[null,o.Validators.required]})}insertOrUpdateMission(){this.missionService.insertOrUpdateMission(this.mission).subscribe(e=>{this.notificationService.success("Mission is updated successfully"),0!==this.mission.missionId&&this.missionService.savedMission.next("refresh"),this.router.navigate(["/project-management/project/missions"])},e=>{this.notificationService.danger("Update mission failed")})}cancel(){0!==this.mission.missionId?this.missionService.savedMission.next("refresh"):this.router.navigate(["/project-management/project/missions"])}dateOnly(e){return this.dateTimeService.dateOnly(e)}}return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(p.Fn),g.\u0275\u0275directiveInject(d.Cv),g.\u0275\u0275directiveInject(o.FormBuilder),g.\u0275\u0275directiveInject(d.gq),g.\u0275\u0275directiveInject(a.F0))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-add-mission"]],viewQuery:function(e,t){if(1&e&&g.\u0275\u0275viewQuery(Tl,7),2&e){let e;g.\u0275\u0275queryRefresh(e=g.\u0275\u0275loadQuery())&&(t.missionDetailsForm=e.first)}},decls:7,vars:0,consts:[[1,"row"],[1,"col-md-9"],[1,"card"],[1,"card-body"],[1,"col-md-3"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275elementStart(2,"div",2),g.\u0275\u0275elementStart(3,"div",3),g.\u0275\u0275element(4,"app-edit-mission-details"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"div",4),g.\u0275\u0275element(6,"app-visa"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())},directives:[ms,Zo],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}"]}),e})(),data:{title:"Add Mission",icon:"icon-home",function:h.FI.Missions,status:!0},canActivate:[fo.a1]},{path:"edit-mission/:missionId",component:Ms,data:{title:"Edit Mission",icon:"icon-home",function:h.FI.Missions,status:!0},canActivate:[fo.a1]},{path:"references",component:Ol,data:{title:"References",icon:"icon-home",function:h.FI.References,status:!0},canActivate:[fo.a1]},{path:"edit-reference/:referenceId",component:Rl,data:{title:"Edit Reference",icon:"icon-home",function:h.FI.References,status:!0},canActivate:[fo.a1]},{path:"add-reference",component:Rl,data:{title:"Add Reference",icon:"icon-home",function:h.FI.References,status:!0},canActivate:[fo.a1]}]}];let zl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({imports:[[a.Bz.forChild(Bl)],a.Bz]}),e})();var ql=n(36063);let Ll=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,r.q]]}),e})(),Ql=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Bo],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,Ll]]}),e})();var $l=n(36332);let Ul=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,$l.o,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is]]}),e})(),Hl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is]]}),e})(),Gl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,Hl]]}),e})(),Wl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,Hl]]}),e})(),Jl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is]]}),e})(),Yl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is]]}),e})(),Kl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is]]}),e})(),Xl=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[d.gq,Ai],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,l.Is,$l.o,Ln.JX],Ln.JX]}),e})();var Zl=n(82480),ec=n(88720);let tc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[d.gq,ke.X],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,l.Is,$l.o,Ln.JX],Ln.JX]}),e})();var nc=n(81040);let ic=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Y4,d.gq],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,Yl,Ql,l.Is,Ul,Gl,Wl,Jl,Hl,Kl,Xl,Zl.w,ec.b,tc,nc.U]]}),e})();var rc=n(91841);let ac=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Fn,d.nJ],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,So.ZQ.forRoot(),rc.HttpClientModule,$l.o]]}),e})(),oc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({imports:[[i.CommonModule,So.ZQ,$l.o,r.m,r.q,o.FormsModule,o.ReactiveFormsModule,l.Is]]}),e})(),sc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({imports:[[i.CommonModule,So.ZQ,$l.o,r.m,r.q,o.FormsModule,o.ReactiveFormsModule,l.Is]]}),e})(),lc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({imports:[[i.CommonModule,So.ZQ,$l.o,r.m,r.q,o.FormsModule,o.ReactiveFormsModule,l.Is]]}),e})(),cc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Fn,d.nJ],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,So.ZQ.forRoot(),rc.HttpClientModule,$l.o,oc,sc,lc]]}),e})();var dc=n(38458),mc=n(1464);let pc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[mc.q],imports:[[i.CommonModule,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,So.ZQ.forRoot(),rc.HttpClientModule,$l.o]]}),e})(),hc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Fn],imports:[[oc,sc,i.CommonModule,So.ZQ,rc.HttpClientModule,$l.o,r.m,r.q]]}),e})();const uc={parse:{dateInput:"L"},display:{dateInput:"L",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let gc=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[p.Y4,d.n4,{provide:x.Ad,useValue:"fr-FR"},{provide:x._A,useClass:ql.t7,deps:[x.Ad]},{provide:x.sG,useValue:uc}],imports:[[i.CommonModule,zl,r.m,o.FormsModule,o.ReactiveFormsModule,r.q,l.Is,ic,dc.l,ac,cc,pc,hc]]}),e})()},85718:function(e,t,n){n.d(t,{x:function(){return i}});class i{}}}]);
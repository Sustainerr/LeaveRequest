"use strict";(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[252],{25252:function(e,t,n){n.r(t),n.d(t,{TimesheetModule:function(){return On}});var i=n(74362),r=n(10337),o=n(38583),s=n(32403),a=n(3679),l=n(22238),c=n(37716);let d=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({providers:[i.r4,r.gq],imports:[[o.CommonModule,s.m,a.FormsModule,a.ReactiveFormsModule,s.q,l.Is]]}),e})();var m=n(88452),h=n(70833),p=n(46782),u=n(33873),f=n(85718),g=n(62028),S=n(98295),y=n(49983),v=n(7539),E=n(76627);function I(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275elementStart(1,"h4"),c.\u0275\u0275text(2,"No Result Found"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function C(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-icon",19),c.\u0275\u0275listener("click",function(){c.\u0275\u0275restoreView(e);const t=c.\u0275\u0275nextContext().index;return c.\u0275\u0275nextContext().expand(t)}),c.\u0275\u0275text(1,"chevron_right"),c.\u0275\u0275elementEnd()}}function b(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-icon",19),c.\u0275\u0275listener("click",function(){c.\u0275\u0275restoreView(e);const t=c.\u0275\u0275nextContext().index;return c.\u0275\u0275nextContext().collapse(t)}),c.\u0275\u0275text(1,"keyboard_arrow_up"),c.\u0275\u0275elementEnd()}}function x(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-checkbox",17),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().$implicit.selected=t})("change",function(){c.\u0275\u0275restoreView(e);const t=c.\u0275\u0275nextContext().$implicit,n=c.\u0275\u0275nextContext(2).$implicit;return c.\u0275\u0275nextContext().selectActivity(t,n)}),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext(3);c.\u0275\u0275property("ngModel",e.selected)("indeterminate",t.disabledActivity(e))("disabled",t.disabledActivity(e)),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.activityName," ")}}function w(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"li"),c.\u0275\u0275template(1,x,2,4,"mat-checkbox",22),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext(2).index,t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.visibleActivities[e])}}function M(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"ul",20),c.\u0275\u0275template(1,w,2,1,"li",21),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",e.projectActivities)}}function P(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"li",15),c.\u0275\u0275template(1,C,2,0,"mat-icon",16),c.\u0275\u0275template(2,b,2,0,"mat-icon",16),c.\u0275\u0275elementStart(3,"mat-checkbox",17),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e).$implicit.allActivitiesSelected=t})("change",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().selectAllActivities(t)}),c.\u0275\u0275text(4),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(5,M,2,1,"ul",18),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=t.index,i=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",!i.visibleActivities[n]),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",i.visibleActivities[n]),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngModel",e.allActivitiesSelected)("indeterminate",i.disabledProject(e))("disabled",i.disabledProject(e)),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(e.projectName),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",e.projectActivities.length>0)}}let D=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.timesheetService=t,this.data=n,this.isSubmittedSelection=!1,this.emptyResult=!1}ngOnDestroy(){this.close()}ngOnInit(){this.unfiltredUserProjects=this.data.userProjectList,this.userProjects=this.data.userProjectList,this.userId=this.data.userId,this.visibleActivities=Boolean[this.userProjects.length]=[];for(let e=0;e<this.userProjects.length;e++)this.visibleActivities[e]=!1}close(){(!this.isSubmittedSelection||void 0!==this.userProjects)&&this.userProjects.forEach(e=>{e.allActivitiesSelected=void 0!==e.allActivitiesSaved&&e.allActivitiesSaved,e.projectActivities.forEach(e=>{e.selected=void 0!==e.saved&&!1!==e.saved&&e.saved})}),this.dialogRef.close()}expand(e){this.visibleActivities[e]=!0}collapse(e){this.visibleActivities[e]=!1}getSelectedProjects(){this.isSubmittedSelection=!0,this.selectedUserProjects=[],this.data.selectedUserProjects.forEach(e=>{e.projectStatusId===i.F7&&this.selectedUserProjects.push(e)}),this.userProjects.length<this.data.userProjectList.length&&this.data.selectedUserProjects.forEach(e=>{this.selectedUserProjects.push(e)}),this.buildSelectedProjects(),this.timesheetService.selectedProjects.next(this.selectedUserProjects),this.close()}buildSelectedProjects(){this.userProjects.forEach(e=>{e.allActivitiesSaved=e.allActivitiesSelected;const t=[];if(e.projectActivities.forEach(n=>{n.saved=n.selected,(n.selected||n.hasTimeEntry||n.pinnedActivity)&&(n.hasTimeEntry?this.data.selectedUserProjects.find(t=>t.projectId===e.projectId).projectActivities.filter(e=>e.activityId===n.activityId).forEach(e=>{e.saved=e.selected,t.push(e)}):(n.timeEntryAmountTotal=0,t.push(n)))}),t&&t.length>0){const n=new u.cK(e.projectId,e.projectName);n.projectGeneric=e.projectGeneric,n.projectActivities.push(...t),void 0===this.selectedUserProjects.find(e=>e.projectId===n.projectId)&&this.selectedUserProjects.push(n)}})}selectAllActivities(e){e.projectActivities.forEach(t=>{!t.pinnedActivity&&!t.hasTimeEntry&&(t.selected=e.allActivitiesSelected)})}selectActivity(e,t){const n=t.projectActivities.filter(e=>e.selected).length;n>0?n===t.projectActivities.length?(t.allActivitiesSelected=!0,t.indeterminateStatus=!1):(t.allActivitiesSelected=!0,t.indeterminateStatus=!0):(t.allActivitiesSelected=!1,t.indeterminateStatus=!1)}disabledActivity(e){return e.hasTimeEntry||1===e.pinnedActivity}disabledProject(e){let t=0,n=!1;for(;t<e.projectActivities.length&&!1===n;)(e.projectActivities[t].hasTimeEntry||1===e.projectActivities[t].pinnedActivity)&&(n=!0),t+=1;return n}filterProjects(){this.userProjects=this.unfiltredUserProjects.filter(e=>-1!==e.projectName.toLocaleLowerCase().search(this.targetActivityName.toLocaleLowerCase())||e.projectActivities.some(e=>-1!==e.activityName.toLocaleLowerCase().search(this.targetActivityName.toLocaleLowerCase())));let e=0;if(this.userProjects.forEach(t=>{t.projectActivities.some(e=>-1!==e.activityName.toLocaleLowerCase().search(this.targetActivityName.toLocaleLowerCase()))&&this.expand(e),e++}),0===this.targetActivityName.length){let e=0;for(;e<this.unfiltredUserProjects.length;)this.collapse(e),e++}this.emptyResult=0===this.userProjects.length}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(l.so),c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-select-project"]],decls:22,vars:3,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],[1,"search-bar-container"],[1,"mat-popup-filter"],["placeholder","Search here...","matInput","","name","searchInput",1,"search-bar",3,"ngModel","ngModelChange"],[1,"row"],[1,"col-md-12"],[4,"ngIf"],["class","project-name",4,"ngFor","ngForOf"],[1,"modal_footer"],[1,"pull-right"],["type","button",1,"btn","btn-outline-primary","m-r-5",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"project-name"],[3,"click",4,"ngIf"],[3,"ngModel","indeterminate","disabled","ngModelChange","change"],["class","collapsible activity-name",4,"ngIf"],[3,"click"],[1,"collapsible","activity-name"],[4,"ngFor","ngForOf"],[3,"ngModel","indeterminate","disabled","ngModelChange","change",4,"ngIf"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"span"),c.\u0275\u0275text(3," Select Project "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(4,"span"),c.\u0275\u0275elementStart(5,"em",2),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(6,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(7,"div",3),c.\u0275\u0275elementStart(8,"div",4),c.\u0275\u0275elementStart(9,"mat-form-field",5),c.\u0275\u0275elementStart(10,"input",6),c.\u0275\u0275listener("ngModelChange",function(e){return t.targetActivityName=e})("ngModelChange",function(){return t.filterProjects()}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(11,"div",7),c.\u0275\u0275elementStart(12,"div",8),c.\u0275\u0275template(13,I,3,0,"div",9),c.\u0275\u0275elementStart(14,"ul"),c.\u0275\u0275template(15,P,6,7,"li",10),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(16,"div",11),c.\u0275\u0275elementStart(17,"div",12),c.\u0275\u0275elementStart(18,"button",13),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(19,"Cancel"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(20,"button",14),c.\u0275\u0275listener("click",function(){return t.getSelectedProjects()}),c.\u0275\u0275text(21,"OK"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(10),c.\u0275\u0275property("ngModel",t.targetActivityName),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngIf",t.emptyResult),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngForOf",t.userProjects))},directives:[S.KE,y.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,o.NgIf,o.NgForOf,v.oG,E.Hw],styles:[".mat-checkbox .mat-checkbox-frame{border-color:#3f629d}  .mat-checkbox-checked .mat-checkbox-background{background-color:#3f629d}.project-name[_ngcontent-%COMP%]{margin-left:5px}.project-name[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{cursor:pointer;position:relative;top:4px;font-size:25px}.project-name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:17px;font-weight:500;line-height:30px}.activity-name[_ngcontent-%COMP%]{margin-left:50px;line-height:30px}.expand-collapse-icon[_ngcontent-%COMP%]{cursor:pointer;position:relative;top:7px}.absenceDayOffRowStyle[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}.modal_body[_ngcontent-%COMP%]{height:425px;padding:25px;margin-top:25px;margin-bottom:25px;overflow-y:auto}.modal_footer[_ngcontent-%COMP%]{padding:10px}.table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-top:none}.td-activity-name[_ngcontent-%COMP%]{padding-left:40px;padding-bottom:0;text-align:left}.tr-project-name[_ngcontent-%COMP%]{color:#b8860b}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.popup-filter[_ngcontent-%COMP%]{font-size:large;margin-bottom:-.15em;margin-top:-1em}.mat-popup-filter[_ngcontent-%COMP%]{width:420px}.search-bar-container[_ngcontent-%COMP%]{margin-top:-1.8em}"]}),e})();function k(e){return t=>t.value<e?{minValue:{minValue:e}}:null}var O=n(62758);let T=(()=>{class e{transform(e){const t=document.createElement("div");return t.innerHTML=e,t.innerText}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.\u0275\u0275definePipe({name:"decodeHtmlString",type:e,pure:!0}),e})();function F(e,t){1&e&&(c.\u0275\u0275elementStart(0,"span",21),c.\u0275\u0275elementStart(1,"p"),c.\u0275\u0275text(2,"Invalid Value!"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}const j=function(){return{standalone:!0}};function _(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275elementStart(1,"th",15),c.\u0275\u0275text(2),c.\u0275\u0275pipe(3,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(4,"td"),c.\u0275\u0275elementStart(5,"textarea",16),c.\u0275\u0275listener("input",function(t){const n=c.\u0275\u0275restoreView(e).index;return c.\u0275\u0275nextContext().OnDescriptionChanged(t.target.value,n)}),c.\u0275\u0275pipe(6,"decodeHtmlString"),c.\u0275\u0275text(7,"                                "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(8,"td",17),c.\u0275\u0275elementStart(9,"div",18),c.\u0275\u0275elementStart(10,"input",19),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e).$implicit.progress=t}),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(11,F,3,0,"span",20),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=t.index,i=c.\u0275\u0275nextContext();c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(3,12,e.timeEntryDate)),c.\u0275\u0275advance(3),c.\u0275\u0275propertyInterpolate1("id","description",n,""),c.\u0275\u0275propertyInterpolate1("name","description",n,""),c.\u0275\u0275property("disabled",i.disabledItemEdit(e))("ngModel",c.\u0275\u0275pipeBind1(6,14,e.description))("ngModelOptions",c.\u0275\u0275pureFunction0(16,j)),c.\u0275\u0275advance(5),c.\u0275\u0275propertyInterpolate1("id","progress",n,""),c.\u0275\u0275propertyInterpolate1("name","progress",n,""),c.\u0275\u0275propertyInterpolate("formControlName",n),c.\u0275\u0275property("ngModel",e.progress)("ngClass",i.timeEntryGroup.controls[n].invalid?"form-control is-invalid":"form-control"),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",i.timeEntryGroup.controls[n].invalid)}}let N=(()=>{class e{constructor(e,t,n,i,r,o){this.fb=e,this.dialogRef=t,this.timesheetService=n,this.dtService=i,this.notificationService=r,this.data=o,this.timeEntries=[]}ngOnInit(){this.dialogRef.updateSize("50%","85%"),this.buildForm(),this.userActivity=this.data.activity,this.userIdentifier=this.data.userIdentifier,this.days=this.data.days,this.initTimeEntry(),this.getTimeEntry()}buildForm(){this.timeEntryGroup=this.fb.group({0:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),1:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),2:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),3:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),4:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),5:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")]),6:new a.FormControl("",[k(0),a.Validators.pattern("^(0|[1-9][0-9]*)$")])}),this.disableControls()}disableControls(){Object.entries(this.timeEntryGroup.controls).forEach(([e])=>{this.timeEntryGroup.controls[e].disable()})}disabledItemEdit(e){return this.disabledEdit()||0===e.timeEntryId||0!==e.stateId}disabledEdit(){return this.userActivity.projectStatusId===i.F7||this.userActivity.projectId===i.bf}getTimeEntry(){this.userActivity.timeEntries.forEach(e=>{const t=this.timeEntries.findIndex(t=>this.dtService.areEqual(t.timeEntryDate,e.timeEntryDate));this.timeEntries[t]=e,!this.disabledItemEdit(e)&&null!=this.timeEntryGroup.controls[t]&&this.timeEntryGroup.controls[t].enable()})}initTimeEntry(){this.days.forEach(e=>{this.timeEntries.push({userId:0,timeEntryId:0,projectId:0,activityId:0,timeEntryDate:e.date.toDate(),amount:0,description:"",progress:"0",stateId:u.f3.Filled,categoryId:0})})}close(){this.dialogRef.close()}OnDescriptionChanged(e,t){this.timeEntries[t].description=e}Save(){const e=this.timeEntries.filter(e=>0!==e.timeEntryId&&e.stateId===u.f3.Filled);this.timesheetService.saveUserTimeEntryByActivity(e).subscribe(e=>{0!==e?(this.notificationService.success("Modification Saved with Success!"),this.close()):this.notificationService.warning("You can t update this timeSheet details!")},()=>{this.notificationService.danger("You can t update this time entry details!"),this.getTimeEntry()})}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(a.FormBuilder),c.\u0275\u0275directiveInject(l.so),c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.Cv),c.\u0275\u0275directiveInject(r.gq),c.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-details"]],decls:24,vars:6,consts:[[1,"modal-content"],[1,"modal-header","alert-primary"],[1,"modal-body"],["id","timeEntryForm",3,"formGroup"],[1,"details-form"],[1,"table","table-hover"],[2,"padding","0px"],["scope","col",2,"width","12%"],["scope","col",2,"width","73%"],["scope","col",2,"width","15%"],[4,"ngFor","ngForOf"],[1,"modal-footer"],[1,"pull-right"],["form","timeEntryForm","type","submit",1,"btn","btn-primary",3,"disabled","click"],[1,"btn","btn-default",3,"click"],["scope","col",1,"align-middle"],["rows","3",1,"form-control",3,"disabled","id","name","ngModel","ngModelOptions","input"],[1,"align-middle"],[1,"form-group","position-relative","d-inline-block"],["autocomplete","off",1,"form-control",3,"id","name","ngModel","formControlName","ngClass","ngModelChange"],["class","text-danger",4,"ngIf"],[1,"text-danger"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"h3"),c.\u0275\u0275text(3),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(4,"div",2),c.\u0275\u0275elementStart(5,"form",3),c.\u0275\u0275elementStart(6,"div",4),c.\u0275\u0275elementStart(7,"table",5),c.\u0275\u0275element(8,"caption",6),c.\u0275\u0275elementStart(9,"thead"),c.\u0275\u0275elementStart(10,"tr"),c.\u0275\u0275element(11,"th",7),c.\u0275\u0275elementStart(12,"th",8),c.\u0275\u0275text(13,"Description"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(14,"th",9),c.\u0275\u0275text(15,"Progress (%)"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(16,"tbody"),c.\u0275\u0275template(17,_,12,17,"tr",10),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(18,"div",11),c.\u0275\u0275elementStart(19,"div",12),c.\u0275\u0275elementStart(20,"button",13),c.\u0275\u0275listener("click",function(){return t.Save()}),c.\u0275\u0275text(21," Save "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"button",14),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(23," Cancel"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(3),c.\u0275\u0275textInterpolate3(" ",t.userActivity.projectName," : ",t.userActivity.activityName," - [",t.userIdentifier.description,"] "),c.\u0275\u0275advance(2),c.\u0275\u0275property("formGroup",t.timeEntryGroup),c.\u0275\u0275advance(12),c.\u0275\u0275property("ngForOf",t.timeEntries),c.\u0275\u0275advance(3),c.\u0275\u0275property("disabled",!t.timeEntryGroup.valid||t.disabledEdit()))},directives:[a.\u0275NgNoValidate,a.NgControlStatusGroup,a.FormGroupDirective,o.NgForOf,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,a.FormControlName,o.NgClass,o.NgIf],pipes:[O.M,T],styles:["h3[_ngcontent-%COMP%]{font-size:18px;color:#fff}.modal-header[_ngcontent-%COMP%]{border-bottom:5px solid #eee;background-color:#116aff}.modal-content[_ngcontent-%COMP%]{height:100%;border-radius:0;position:relative}.modal-body[_ngcontent-%COMP%]{height:400px;padding:5px;overflow-y:auto}.modal-footer[_ngcontent-%COMP%]{border-radius:5px;bottom:0px;position:relative;width:100%;border-top:5px solid #F8F8FF;background-color:#eee}textarea[_ngcontent-%COMP%]{resize:none;padding-top:2px;padding-bottom:2px;margin:4px}input[_ngcontent-%COMP%]{margin-left:10px;width:70px}p[_ngcontent-%COMP%]{margin-top:5px;margin-left:10px}.table[_ngcontent-%COMP%]{margin:2px;padding:4px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:2px}.valid-feedback.feedback-icon[_ngcontent-%COMP%], .invalid-feedback.feedback-icon[_ngcontent-%COMP%]{position:absolute;width:10px;bottom:10px;right:15px;margin-top:0}[_ngcontent-%COMP%]:disabled{cursor:not-allowed;opacity:.2}"]}),e})();const R=["form"];let A=(()=>{class e{constructor(e,t,n){this.dialogRef=e,this.timesheetService=t,this.notificationService=n,this.reworkReason=""}ngOnDestroy(){this.close()}rework(){""!==this.reworkReason?(this.timesheetService.timeEntryReworkReason.next(this.reworkReason),this.close()):this.notificationService.warning("Please fill Rework Reason.")}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(l.so),c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.gq))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-rework-reason"]],viewQuery:function(e,t){if(1&e&&c.\u0275\u0275viewQuery(R,7),2&e){let e;c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.form=e.first)}},decls:19,vars:1,consts:[[1,"form-container"],[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],[1,"row"],[1,"col-md-12"],[1,"col-sm-12"],["matInput","","placeholder","Rework Reason","name","reworkReason","required","",3,"ngModel","ngModelChange"],[1,"modal_footer"],[1,"pull-right"],["type","button",1,"btn","btn-outline-primary","m-r-15",3,"click"],["type","submit",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"form",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"div",2),c.\u0275\u0275elementStart(3,"span"),c.\u0275\u0275text(4," Rework reason "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(5,"span"),c.\u0275\u0275elementStart(6,"em",3),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(7,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(8,"div",4),c.\u0275\u0275elementStart(9,"div",5),c.\u0275\u0275elementStart(10,"div",6),c.\u0275\u0275elementStart(11,"mat-form-field",7),c.\u0275\u0275elementStart(12,"textarea",8),c.\u0275\u0275listener("ngModelChange",function(e){return t.reworkReason=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(13,"div",9),c.\u0275\u0275elementStart(14,"div",10),c.\u0275\u0275elementStart(15,"button",11),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(16,"Cancel"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(17,"button",12),c.\u0275\u0275listener("click",function(){return t.rework()}),c.\u0275\u0275text(18,"Rework"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(12),c.\u0275\u0275property("ngModel",t.reworkReason))},directives:[a.\u0275NgNoValidate,a.NgControlStatusGroup,a.NgForm,S.KE,y.Nt,a.DefaultValueAccessor,a.RequiredValidator,a.NgControlStatus,a.NgModel],styles:[".modal_header[_ngcontent-%COMP%]{height:50px;background-color:#448aff;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{height:150px;width:600px;padding:25px;margin-top:25px;margin-bottom:25px;overflow-y:auto}.modal_footer[_ngcontent-%COMP%]{padding:40px;margin-bottom:40px}"]}),e})(),U=(()=>{class e{transform(e){return e.filter(e=>e.projectStatusId!==i.F7)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275pipe=c.\u0275\u0275definePipe({name:"filterProjects",type:e,pure:!0}),e})();var V=n(16738),L=n(88259),z=n.n(L),$=n(43220);let B=(()=>{class e{constructor(e,t){this.timesheetService=e,this.dtService=t,this.selectedDate=new Date,this.daysChange=new c.EventEmitter}ngOnInit(){0!==this.daysForBoard.length&&(this.selectedDate=this.daysForBoard[0].date.toDate()),this.getSelectedWeek(),this.currentWeekSubscription=this.timesheetService.selectCurrentWeek.subscribe(e=>{this.selectedDate=this.dtService.today(),this.getSelectedWeek()})}ngOnDestroy(){this.currentWeekSubscription.unsubscribe()}getSelectedWeek(){this.startOfWeek=V(this.selectedDate).startOf("isoWeek"),this.endOfWeek=V(this.selectedDate).endOf("isoWeek"),this.getWeekDays()}prevWeek(){this.startOfWeek=V(this.startOfWeek).subtract(1,"weeks").startOf("isoWeek"),this.endOfWeek=V(this.endOfWeek).subtract(1,"weeks").endOf("isoWeek"),this.getWeekDays()}nextWeek(){this.startOfWeek=V(this.startOfWeek).add(1,"weeks").startOf("isoWeek"),this.endOfWeek=V(this.endOfWeek).add(1,"weeks").endOf("isoWeek"),this.getWeekDays()}getWeekDays(){this.days=[];let e=this.startOfWeek;for(;e<=this.endOfWeek;)this.days.push({date:e,dayName:this.dtService.getDayName(e)}),e=e.clone().add(1,"d");this.timesheetService.stopTimeEntriesGet.next(),this.selectedDate=this.startOfWeek.toDate(),this.daysChange.emit(this.days)}changeDateEvent(){this.getSelectedWeek()}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.Cv))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-select-week"]],inputs:{daysForBoard:"daysForBoard"},outputs:{daysChange:"daysChange"},decls:25,vars:8,consts:[[2,"padding","0px"],["scope","col"],[1,"td-arrow","pointer",3,"click"],[1,"material-icons"],[1,"td-date"],[1,"td-calendar","pointer",3,"click"],["matInput","",3,"matDatepicker","ngModel","ngModelChange","dateChange"],["picker",""]],template:function(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"table"),c.\u0275\u0275element(1,"caption",0),c.\u0275\u0275elementStart(2,"tr"),c.\u0275\u0275element(3,"th",1),c.\u0275\u0275elementStart(4,"td",2),c.\u0275\u0275listener("click",function(){return t.prevWeek()}),c.\u0275\u0275elementStart(5,"em",3),c.\u0275\u0275text(6,"keyboard_arrow_left"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(7,"td",4),c.\u0275\u0275elementStart(8,"span"),c.\u0275\u0275text(9),c.\u0275\u0275pipe(10,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(11,"td",5),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275reference(17).open()}),c.\u0275\u0275elementStart(12,"em",3),c.\u0275\u0275text(13,"date_range"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(14,"mat-form-field"),c.\u0275\u0275elementStart(15,"input",6),c.\u0275\u0275listener("ngModelChange",function(e){return t.selectedDate=e})("dateChange",function(){return t.changeDateEvent()}),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(16,"mat-datepicker",null,7),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(18,"td",4),c.\u0275\u0275elementStart(19,"span"),c.\u0275\u0275text(20),c.\u0275\u0275pipe(21,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"td",2),c.\u0275\u0275listener("click",function(){return t.nextWeek()}),c.\u0275\u0275elementStart(23,"em",3),c.\u0275\u0275text(24,"keyboard_arrow_right"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275reference(17);c.\u0275\u0275advance(9),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(10,4,t.startOfWeek)),c.\u0275\u0275advance(6),c.\u0275\u0275property("matDatepicker",e)("ngModel",t.selectedDate),c.\u0275\u0275advance(5),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(21,6,t.endOfWeek))}},directives:[S.KE,y.Nt,$.hl,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,$.Mq],pipes:[O.M],styles:["table[_ngcontent-%COMP%]{width:90%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;border:1px solid gainsboro}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;font-size:25px;cursor:pointer}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:4px}table[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:1px;left:3px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:0px;height:0px;visibility:hidden}"]}),e})();var H=n(4885),W=n(15257),G=n(67441),Y=n(72458),X=n(52218);const J=["userSelect"];function q(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-option",15),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275property("value",e),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.description," ")}}function Q(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",16),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().getMyTimeSheet()}),c.\u0275\u0275text(1,"Mine"),c.\u0275\u0275elementEnd()}}let K=(()=>{class e{constructor(e,t,n){this.timesheetService=e,this.coreDataService=t,this.notificationService=n,this.userFilterCtrl=new a.FormControl,this.filteredUsersIdentifiers=new h.tq(1),this._onDestroy=new h.xQ,this.userChange=new c.EventEmitter,this.mine=!0}ngOnInit(){0!==this.userIdentifier.id&&(this.mine=!1),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.currentUserIdentifier=new f.x,this.currentUserIdentifier.id=+this.currentUser.userId,this.currentUserIdentifier.description=this.currentUser.lastName+" "+this.currentUser.firstName+" ("+this.currentUser.userNumber+")",this.selectedUserIdentifier=this.currentUserIdentifier,this.getUsers(),this.userFilterCtrl.valueChanges.pipe((0,p.R)(this._onDestroy)).subscribe(()=>{this.filterUsers()}),this.selectedUserSubscription=this.timesheetService.selectUserRefresh.subscribe(e=>{this.periodFrom=e.startWeekDate,this.periodTo=e.endWeekDate,this.getUsers()})}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete(),this.selectedUserSubscription.unsubscribe()}getUsers(){this.currentUser.groupId===g.Fl.SuperAdmin?this.onlyMySubordinates||0===this.userIdentifier.id?this.getReportersByPeriod():this.getActivitiesUsersByPeriod():this.getReportersByPeriod()}getActivitiesUsersByPeriod(){this.coreDataService.getActivitiesUsersByPeriod(this.activitiesId,this.periodFrom,this.periodTo).subscribe(e=>{if(null!=e){if(this.usersIdentifiers=e,this.usersIdentifiers&&this.usersIdentifiers.length>0)if(this.currentUserExit=void 0!==this.usersIdentifiers.find(e=>e.id===this.currentUser.userId),this.mine)this.selectedUserIdentifier=this.currentUserIdentifier;else{const e=this.usersIdentifiers.find(e=>e.id===this.userIdentifier.id);e?this.selectedUserIdentifier=e:(this.selectedUserIdentifier=this.currentUserIdentifier,this.notificationService.danger(`${this.userIdentifier.description} does not yet working for the compagny in this week!`))}this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice())}})}getReportersByPeriod(){this.coreDataService.getReportersByPeriod(this.currentUserIdentifier.id,this.periodFrom,this.periodTo).subscribe(e=>{if(this.usersIdentifiers=e,this.usersIdentifiers.unshift(this.currentUserIdentifier),this.usersIdentifiers.sort((e,t)=>e.description.localeCompare(t.description)),this.usersIdentifiers&&this.usersIdentifiers.length>0){if(this.currentUserExit=void 0!==this.usersIdentifiers.find(e=>e.id===this.currentUser.userId),!this.mine){const e=this.usersIdentifiers.find(e=>e.id===this.userIdentifier.id);e||this.notificationService.danger(`${this.userIdentifier.description} does not yet working for the compagny in this week!`),this.selectedUserIdentifier=e}this.selectedUserIdentifier||(this.selectedUserIdentifier=this.currentUserIdentifier,this.mine=!0),this.userChange.emit(this.selectedUserIdentifier)}this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice())})}ngAfterViewInit(){this.setInitialValue()}setInitialValue(){this.filteredUsersIdentifiers.pipe((0,W.q)(1),(0,p.R)(this._onDestroy)).subscribe(()=>{this.userSelect.compareWith=(e,t)=>e&&t&&e.id===t.id})}filterUsers(){if(!this.usersIdentifiers)return;let e=this.userFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredUsersIdentifiers.next(this.usersIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice())}onUserSelectEvent(){this.mine=this.selectedUserIdentifier===this.currentUserIdentifier,this.userChange.emit(this.selectedUserIdentifier)}getPreviousUserTimeSheet(){if(void 0!==this.usersIdentifiers){const e=this.usersIdentifiers.indexOf(this.selectedUserIdentifier);this.selectedUserIdentifier=this.usersIdentifiers[0===e?this.usersIdentifiers.length-1:e-1],this.mine=this.selectedUserIdentifier===this.currentUserIdentifier,this.userChange.emit(this.selectedUserIdentifier)}}getMyTimeSheet(){this.mine=!0,this.selectedUserIdentifier=this.currentUserIdentifier,this.userChange.emit(this.selectedUserIdentifier)}getNextUserTimeSheet(){if(void 0!==this.usersIdentifiers){const e=this.usersIdentifiers.indexOf(this.selectedUserIdentifier);this.selectedUserIdentifier=this.usersIdentifiers[e===this.usersIdentifiers.length-1?0:e+1],this.mine=this.selectedUserIdentifier===this.currentUserIdentifier,this.userChange.emit(this.selectedUserIdentifier)}}isMyTimeSheet(){return this.currentUserExit&&this.currentUser.userId!==this.selectedUserIdentifier.id}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.YY),c.\u0275\u0275directiveInject(r.gq))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-select-user"]],viewQuery:function(e,t){if(1&e&&c.\u0275\u0275viewQuery(J,7),2&e){let e;c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.userSelect=e.first)}},inputs:{userIdentifier:"userIdentifier",periodFrom:"periodFrom",periodTo:"periodTo",onlyMySubordinates:"onlyMySubordinates",activitiesId:"activitiesId"},outputs:{userChange:"userChange"},decls:24,vars:8,consts:[[1,"row"],[1,"col-sm-9","content-wrapper"],[2,"padding","0px"],["scope","col"],[1,"td-arrow","pointer",3,"click"],[1,"material-icons"],[1,"td-select-user","pointer"],["floatLabel","never",1,"select-user"],["placeholder","Select user",3,"ngModel","ngModelChange","selectionChange"],["userSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-3"],["class","btn btn-primary",3,"click",4,"ngIf"],[3,"value"],[1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"table"),c.\u0275\u0275element(3,"caption",2),c.\u0275\u0275elementStart(4,"tr"),c.\u0275\u0275element(5,"th",3),c.\u0275\u0275elementStart(6,"td",4),c.\u0275\u0275listener("click",function(){return t.getPreviousUserTimeSheet()}),c.\u0275\u0275elementStart(7,"em",5),c.\u0275\u0275text(8,"keyboard_arrow_left"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(9,"td",6),c.\u0275\u0275elementStart(10,"mat-form-field",7),c.\u0275\u0275elementStart(11,"mat-select",8,9),c.\u0275\u0275listener("ngModelChange",function(e){return t.selectedUserIdentifier=e})("selectionChange",function(){return t.onUserSelectEvent()}),c.\u0275\u0275elementStart(13,"mat-option"),c.\u0275\u0275elementStart(14,"ngx-mat-select-search",10),c.\u0275\u0275elementStart(15,"mat-icon",11),c.\u0275\u0275text(16,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(17,q,2,2,"mat-option",12),c.\u0275\u0275pipe(18,"async"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(19,"td",4),c.\u0275\u0275listener("click",function(){return t.getNextUserTimeSheet()}),c.\u0275\u0275elementStart(20,"em",5),c.\u0275\u0275text(21,"keyboard_arrow_right"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"div",13),c.\u0275\u0275template(23,Q,2,0,"button",14),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(11),c.\u0275\u0275property("ngModel",t.selectedUserIdentifier),c.\u0275\u0275advance(3),c.\u0275\u0275property("formControl",t.userFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngForOf",c.\u0275\u0275pipeBind1(18,6,t.filteredUsersIdentifiers)),c.\u0275\u0275advance(6),c.\u0275\u0275property("ngIf",t.isMyTimeSheet()))},directives:[S.KE,G.gD,a.NgControlStatus,a.NgModel,Y.ey,X.nu,a.FormControlDirective,E.Hw,X.w5,o.NgForOf,o.NgIf],pipes:[o.AsyncPipe],styles:["table[_ngcontent-%COMP%]{width:100%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:1px solid gainsboro}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;font-size:25px;cursor:pointer}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]{text-align:center;width:35px}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:4px}table[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   .td-select-user[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:1px;left:3px}table[_ngcontent-%COMP%]   .td-select-user[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{height:36px}.select-user[_ngcontent-%COMP%]{width:100%;padding-left:5px}.content-wrapper[_ngcontent-%COMP%]     mat-form-field.mat-form-field-appearance-legacy .mat-form-field-underline{display:none}.content-wrapper[_ngcontent-%COMP%]     mat-form-field.mat-form-field-appearance-legacy .mat-form-field-wrapper{padding-bottom:0}.content-wrapper[_ngcontent-%COMP%]     mat-form-field.mat-form-field-appearance-legacy .mat-form-field-infix{border-top:.24375em solid transparent}"]}),e})();var Z=n(38590);let ee=(()=>{class e{constructor(e,t,n){this.timesheetService=e,this.notificationService=t,this.element=n,this.refrechTimeSheet=new c.EventEmitter,this.canEdit=!0}ngOnInit(){if(this.tdId="td-"+this.activity.activityId.toString()+"-"+this.date.getDay().toString(),this.innerHTML="",null==this.timeEntry||(this.innerHTML=this.timeEntry.amount.toString()),(0===this.date.getDay()||6===this.date.getDay())&&(this.background="#ccc"),this.canEdit){switch(this.dayTimeEntriesState){case u.f3.Submitted:this.background="#fffd99",this.canEdit=!1;break;case u.f3.Validated:this.background="#4CAF50",this.canEdit=!1}this.activity.projectStatusId===i.F7&&(this.canEdit=!1)}this.editable=this.canEdit}onClick(){!this.canEdit||this.setSelectedStyle()}onKeyup(e){this.canEdit&&(this.isValidValue(e.target.textContent)?this.setSelectedStyle():this.setErrorStyle())}onblur(){if(!this.canEdit)return void this.setDefaultStyle();const e=this.element.nativeElement.textContent;""!==e||null!=this.timeEntry?this.isValidValue(e)?(this.setDefaultStyle(),this.onTimeEntryBlur(e)):(this.resetValue(),this.setDefaultStyle()):this.setDefaultStyle()}onFocus(){sessionStorage.setItem("td-id",this.tdId)}ngAfterViewInit(){this.tdId===sessionStorage.getItem("td-id")&&(this.element.nativeElement.focus(),this.element.nativeElement.style.border="2px solid #006699")}resetValue(){this.element.nativeElement.innerHTML=null==this.timeEntry?"":this.timeEntry.amount.toString()}setDefaultStyle(){this.element.nativeElement.style.border=""}setSelectedStyle(){this.element.nativeElement.style.border="2px solid #006699"}setErrorStyle(){this.element.nativeElement.style.border="2px solid #dc3545",this.element.nativeElement.focus()}isValidValue(e){let t=0;void 0!==this.timeEntry&&(t=this.timeEntry.amount);const n=this.timeEntryAmountTotal+ +e-t;return null==e||""===e||!isNaN(+e)&&+e>=0&&+e<=24&&n<=24}onTimeEntryBlur(e){""===e?this.deleteTimeEntry():null==this.timeEntry?(this.timeEntry=new u.$2,this.timeEntry.timeEntryId=0,this.timeEntry.projectId=this.projectId,this.timeEntry.activityId=this.activity.activityId,this.timeEntry.timeEntryDate=this.date,this.timeEntry.userId=this.userId,this.timeEntry.stateId=u.f3.Filled,this.timeEntry.amount=+e,this.timeEntry.description="",this.timeEntry.categoryId=null!==this.activity.categoryId||void 0!==this.activity.categoryId?this.activity.categoryId:0,this.insertOrUpdateTimeEntryAmount()):this.timeEntry.amount!==+e&&(this.timeEntry.amount=+e,this.insertOrUpdateTimeEntryAmount()),sessionStorage.removeItem("td-id")}insertOrUpdateTimeEntryAmount(){this.timesheetService.insertOrUpdateTimeEntryAmount(this.timeEntry).subscribe(e=>{0!==e?(this.timeEntry.timeEntryId=e,this.timesheetService.timeEntryChanged.next(this.timeEntry)):(this.notificationService.danger("Save to time entry failed."),this.refrechTimeSheet.emit())},()=>{this.notificationService.danger("Save to time entry failed."),this.refrechTimeSheet.emit()})}deleteTimeEntry(){this.timesheetService.deleteTimeEntry(this.timeEntry.timeEntryId).subscribe(e=>{0!==e?this.timesheetService.timeEntryDeleted.next(this.timeEntry.timeEntryId):(this.notificationService.danger("Delete time Entry failed."),this.refrechTimeSheet.emit())},()=>{this.notificationService.danger("Delete time Entry failed."),this.refrechTimeSheet.emit()})}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.gq),c.\u0275\u0275directiveInject(c.ElementRef))},e.\u0275dir=c.\u0275\u0275defineDirective({type:e,selectors:[["","appTdTimeEntry",""]],hostVars:5,hostBindings:function(e,t){1&e&&c.\u0275\u0275listener("click",function(){return t.onClick()})("keyup",function(e){return t.onKeyup(e)})("blur",function(e){return t.onblur(e)})("focus",function(){return t.onFocus()}),2&e&&(c.\u0275\u0275hostProperty("id",t.tdId)("innerHTML",t.innerHTML,c.\u0275\u0275sanitizeHtml),c.\u0275\u0275attribute("contenteditable",t.editable),c.\u0275\u0275styleProp("background-color",t.background))},inputs:{userId:"userId",activity:"activity",projectId:"projectId",date:"date",timeEntry:"timeEntry",dayTimeEntriesState:"dayTimeEntriesState",timeEntryAmountTotal:"timeEntryAmountTotal"},outputs:{refrechTimeSheet:"refrechTimeSheet"}}),e})();function te(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",32),c.\u0275\u0275elementStart(1,"div",33),c.\u0275\u0275elementStart(2,"div",34),c.\u0275\u0275elementStart(3,"div",2),c.\u0275\u0275elementStart(4,"div",35),c.\u0275\u0275element(5,"mat-spinner"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function ne(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"div",36),c.\u0275\u0275elementStart(1,"h2",37),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(3,"br"),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate(e.selectedUserIdentifier.description)}}function ie(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"div",38),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275elementStart(2,"em",39),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().close()}),c.\u0275\u0275text(3,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}}function re(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"app-select-user",40),c.\u0275\u0275listener("userChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().userChange(t)}),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275property("userIdentifier",e.selectedUserIdentifier)("periodFrom",e.periodFrom)("periodTo",e.periodTo)("onlyMySubordinates",e.onlyMySubordinates)("activitiesId",e.activitiesId)}}function oe(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",41),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().importFromExcel()}),c.\u0275\u0275element(1,"em",42),c.\u0275\u0275text(2," Import "),c.\u0275\u0275elementEnd()}}function se(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",41),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().submitTimeEntry()}),c.\u0275\u0275element(1,"em",43),c.\u0275\u0275text(2," Submit "),c.\u0275\u0275elementEnd()}}function ae(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",41),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().openReworkReasonDialog()}),c.\u0275\u0275element(1,"em",44),c.\u0275\u0275text(2," Rework "),c.\u0275\u0275elementEnd()}}function le(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",41),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().validateTimeEntry()}),c.\u0275\u0275element(1,"em",45),c.\u0275\u0275text(2," Validate "),c.\u0275\u0275elementEnd()}}function ce(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"th",46),c.\u0275\u0275text(1),c.\u0275\u0275pipe(2,"shortDate"),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(2,1,null==e?null:e.date))}}function de(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"th",46),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1("",null==e?null:e.timeEntryAmountTotal," h")}}function me(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"label",50),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(null==e?null:e.projectStatus)}}function he(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"td",58),c.\u0275\u0275listener("refrechTimeSheet",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext(3).refrechTimeSheet()}),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext().$implicit,i=c.\u0275\u0275nextContext(2);c.\u0275\u0275property("userId",i.selectedUserIdentifier.id)("activity",n)("projectId",n.projectId)("date",e.date.toDate())("timeEntry",i.getTimeEntry(n,e))("dayTimeEntriesState",i.getDayTimeEntriesState(e))("timeEntryAmountTotal",null==e?null:e.timeEntryAmountTotal)}}function pe(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275elementStart(1,"td",51),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(3,he,1,7,"td",52),c.\u0275\u0275elementStart(4,"td",53),c.\u0275\u0275text(5),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(6,"td",54),c.\u0275\u0275elementStart(7,"div",55),c.\u0275\u0275elementStart(8,"mat-icon",56),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext(2).openEditDialog(t)}),c.\u0275\u0275text(9,"speaker_notes"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(10,"td",54),c.\u0275\u0275elementStart(11,"div",55),c.\u0275\u0275elementStart(12,"mat-checkbox",57),c.\u0275\u0275listener("change",function(t){const n=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext(2).insertOrUpdatePinActivity(n,t)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext(2);c.\u0275\u0275advance(1),c.\u0275\u0275property("matTooltip",e.activityName.length>45?e.activityName:null),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.activityName," "),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",n.weekDays),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",null==e?null:e.timeEntryAmountTotal," h"),c.\u0275\u0275advance(7),c.\u0275\u0275property("checked",1===e.pinnedActivity)}}const ue=function(e,t){return{"non-generic":e,generic:t}};function fe(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tbody"),c.\u0275\u0275elementStart(1,"tr",47),c.\u0275\u0275elementStart(2,"td",48),c.\u0275\u0275elementStart(3,"span"),c.\u0275\u0275text(4),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(5,me,2,1,"label",49),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(6,pe,13,5,"tr",31),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngClass",c.\u0275\u0275pureFunction2(5,ue,0===e.projectGeneric,0!==e.projectGeneric)),c.\u0275\u0275advance(1),c.\u0275\u0275property("colSpan",n.weekDays.length+5),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate(null==e?null:e.projectName),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",3==e.projectStatusId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",null==e?null:e.projectActivities)}}const ge=function(e,t){return{"main-content":e,"md-dialog-container main-content":t}};let Se=(()=>{class e{constructor(e,t,n){this.dialogRef=t,this.data=n,this.selectedUserProjects=[],this.daysForBoard=[],this.isDisplayedUsers=!0,this.startOfCurrentWeek=V().startOf("isoWeek"),this.endOfCurrentWeek=V().endOf("isoWeek"),this.periodFrom=this.startOfCurrentWeek.toDate(),this.periodTo=this.endOfCurrentWeek.toDate(),this.teamDisplay=!1,this.filteredUsers=new h.tq(1),this.timeEntriesList=[],this.selectedUserIdentifier=new f.x,this.filterProjectPipe=new U,this.activitiesId="",this.onlyMySubordinates=!1,this.dialog=e.get(l.uw),this.timesheetService=e.get(i.r4),this.dtService=e.get(r.Cv),this.notificationService=e.get(r.gq),this.mailService=e.get(r.YT),this.activatedRoute=e.get(m.gz),this.router=e.get(m.F0)}ngOnInit(){let e;if(this.activatedRoute.queryParams.subscribe(t=>{e=null==t.time?0:t.time,this.userId=null==t.id?0:t.id,e=+e,this.userId=+this.userId,0===this.userId&&(this.userId=+this.activatedRoute.snapshot.paramMap.get("id"),e=+this.activatedRoute.snapshot.paramMap.get("time"))}),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.userHasSubordinates=this.currentUser.hasSubordinates,this.userId>0){this.selectedUserIdentifier.id=this.userId;const t=new u.Hu;t.date=V(e),this.daysForBoard.push(t),this.periodFrom=t.date.toDate(),this.periodTo=t.date.endOf("isoWeek").toDate()}else if(0!==this.data.length){this.selectedUserIdentifier.id=+this.data.userId,this.selectedUserIdentifier.description=this.data.userName,this.userId=+this.data.userId,this.activitiesId=this.data.activitiesId,this.onlyMySubordinates=this.data.onlyMySubordinates,this.isDisplayedUsers=!1;const e=new u.Hu;e.date=V(this.data.weekTimeSheet.weekStartDate),this.daysForBoard.push(e),this.periodFrom=e.date.toDate(),this.periodTo=e.date.endOf("isoWeek").toDate()}else this.selectedUserIdentifier.id=+this.currentUser.userId,this.selectedUserIdentifier.description=this.currentUser.userName;this.checkDisplayMode(),this.projectsSubscription=this.timesheetService.selectedProjects.subscribe(e=>{this.selectedUserProjects=e}),sessionStorage.removeItem("td-id"),this.timeEntryChgSubscription=this.timesheetService.timeEntryChanged.subscribe(e=>{this.timeEntryChanged(e)}),this.timeEntryDltSubscription=this.timesheetService.timeEntryDeleted.subscribe(e=>{this.timeEntryDeleted(e)}),this.timeEntryReworkSubscription=this.timesheetService.timeEntryReworkReason.subscribe(e=>{this.reworkTimeEntry(e)})}ngOnDestroy(){this.timesheetService.stopTimeEntriesGet.next(),this.timesheetService.stopTimeEntriesGet.complete(),this.projectsSubscription.unsubscribe(),this.timeEntryChgSubscription.unsubscribe(),this.timeEntryDltSubscription.unsubscribe(),this.timeEntryReworkSubscription.unsubscribe(),this.dialog.closeAll()}userChange(e){this.selectedUserIdentifier=e,sessionStorage.removeItem("td-id"),this.userProjects=[],null!=e&&this.getUserTimeEntries()}daysChange(e){if(sessionStorage.removeItem("td-id"),this.weekDays=e,null!=e){const e=this.weekDays[0].date.toDate(),t=this.weekDays[this.weekDays.length-1].date.toDate();this.timesheetService.selectUserRefresh.next({startWeekDate:e,endWeekDate:t}),this.getUserTimeEntries()}}checkDisplayMode(){this.teamDisplay=null===this.activatedRoute.snapshot.routeConfig||"team"===this.activatedRoute.snapshot.routeConfig.path}getUserTimeEntries(){const e=this.weekDays[0].date.toDate(),t=this.weekDays[this.weekDays.length-1].date.toDate(),n=this.selectedUserIdentifier.id.toString();this.timesheetService.getUserTimeEntries(n,e,t).pipe((0,p.R)(this.timesheetService.stopTimeEntriesGet)).subscribe(e=>{this.timeEntriesList=[],e.forEach(e=>{e.timeEntryDate=new Date(e.timeEntryDate),this.timeEntriesList.push(Object.assign(new u.$2,e))}),this.getUserActivities()})}getUserActivities(){this.isLoading=!0,this.timesheetService.getUserActivities(this.selectedUserIdentifier.id.toString()).subscribe(e=>{this.isLoading=!1;const t=[];e.forEach(e=>{t.push(Object.assign(new u.VB,e))}),this.userProjects=[],t.forEach(e=>{let t=this.userProjects.find(t=>t.projectId===e.projectId);void 0===t?(t=new u.cK(e.projectId,e.projectName),t.projectGeneric=e.projectGeneric,t.projectStatus=e.projectStatus,t.projectStatusId=e.projectStatusId,t.projectActivities.push(e),this.userProjects.push(t)):t.projectActivities.push(e)}),this.getSelectedProjects()})}getSelectedProjects(){this.selectedUserProjects=[],this.userProjects&&this.userProjects.length>0&&this.userProjects.forEach(e=>{if(e.projectActivities&&e.projectActivities.length>0){const t=new u.cK(e.projectId,e.projectName);t.projectGeneric=e.projectGeneric,t.projectStatusId=e.projectStatusId,t.projectStatus=e.projectStatus,e.projectActivities.forEach(e=>{e.timeEntries=this.timeEntriesList.filter(t=>t.activityId===e.activityId),e.hasTimeEntry=e.timeEntries.length>0,this.refreshSelectedProject(e,t),this.refreshSelectedProjectActivities(e,t)}),t.projectActivities.length>0&&this.selectedUserProjects.push(t)}}),this.updateAmountTotals()}refreshSelectedProject(e,t){if(e.hasTimeEntry){let n=-1,i=0;e.timeEntries.forEach(r=>{const o=r.timeEntryDate.getDay(),s=t.projectActivities.filter(t=>t.activityId===e.activityId);if(o===n)if(i+=1,s.length<i){const n=Object.assign(new u.VB,e);n.timeEntries=new Array(r),t.projectActivities.push(n)}else s[i-1].timeEntries.push(r);else if(i=1,0===s.length){const n=Object.assign(new u.VB,e);n.timeEntries=new Array(r),t.projectActivities.push(n)}else s[0].timeEntries.push(r);n=o})}}refreshSelectedProjectActivities(e,t){!e.hasTimeEntry&&(e.pinnedActivity||void 0!==e.selected&&e.selected)&&t.projectActivities.push(e)}updateAmountTotals(){this.resetAmountTotals(),this.selectedUserProjects&&this.selectedUserProjects.length>0&&this.selectedUserProjects.forEach(e=>{e.projectActivities.forEach(e=>{e.timeEntryAmountTotal=0,e.hasTimeEntry=!1,this.timeEntriesList.findIndex(t=>t.activityId===e.activityId)>-1&&this.weekDays.forEach(t=>{const n=this.getTimeEntry(e,t);n&&n.amount>=0&&(e.hasTimeEntry=!0,e.timeEntryAmountTotal=+(n.amount+e.timeEntryAmountTotal).toFixed(2),t.timeEntryAmountTotal=+(n.amount+t.timeEntryAmountTotal).toFixed(2),this.globalTimeEntryAmountTotal=+(n.amount+this.globalTimeEntryAmountTotal).toFixed(2))})})})}resetAmountTotals(){this.weekDays.forEach(e=>{e.timeEntryAmountTotal=0}),this.globalTimeEntryAmountTotal=0}getTimeEntry(e,t){return e.timeEntries.find(e=>this.dtService.areEqual(e.timeEntryDate,t.date))}timeEntryChanged(e){-1===this.timeEntriesList.findIndex(t=>t.timeEntryId===e.timeEntryId)&&(this.timeEntriesList.push(e),this.timeEntriesList=this.sortTimeEntriesList()),this.getSelectedProjects()}sortTimeEntriesList(){return this.timeEntriesList.sort((e,t)=>e.timeEntryDate>t.timeEntryDate?1:e.timeEntryDate<t.timeEntryDate?-1:0)}timeEntryDeleted(e){this.timeEntriesList=this.timeEntriesList.filter(t=>t.timeEntryId!==e),this.getSelectedProjects()}openEditDialog(e){this.displayEditdialogRef=this.dialog.open(N,{disableClose:!1,panelClass:"form_modal",hasBackdrop:!0,data:{userIdentifier:this.selectedUserIdentifier,days:this.weekDays,activity:e}})}openProjectListDialog(){const e={disableClose:!1,panelClass:"form_modal",width:"500px",height:"600px",hasBackdrop:!0,data:{userProjectList:this.filterProjectPipe.transform(this.userProjects),selectedUserProjects:this.selectedUserProjects,userId:this.selectedUserIdentifier.id}};this.displayProjectListdialogRef=this.dialog.open(D,e)}openReworkReasonDialog(){this.timeEntriesList.filter(e=>e.stateId===u.f3.Submitted||e.stateId===u.f3.Validated).length>0?this.displayReworkReasonRef=this.dialog.open(A,{disableClose:!1,panelClass:"form_modal",hasBackdrop:!0,data:{}}):this.notificationService.info("There is no Time Entry to rework.")}selectCurrentWeek(){this.timesheetService.selectCurrentWeek.next()}insertOrUpdatePinActivity(e,t){const n=!0===t.checked?1:0;this.timesheetService.insertOrUpdatePinActivity(+this.selectedUserIdentifier.id,e.activityId,n).subscribe(t=>{0!==t?(e.pinnedActivity=n,0===n&&this.updateDisplayPinActivity(e)):this.notificationService.warning("You can t pin this task")})}updateDisplayPinActivity(e){this.userProjects.forEach(t=>{t.projectId===e.projectId&&(t.allActivitiesSelected=!0,t.allActivitiesSaved=!0,t.projectActivities.forEach(t=>{t.activityId===e.activityId&&(t.selected=!0,t.saved=!0)}))})}importFromExcel(){this.router.navigate(["/project-management/timesheet/import/"])}submitTimeEntry(){z().fire({text:"Do you want to submit your timesheet?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",showLoaderOnConfirm:!0,preConfirm:()=>{const e=this.timeEntriesList.filter(e=>e.stateId===u.f3.Filled);e.length>0?this.isContinuouslyFilledTimeSheet()?this.timesheetService.updateTimeEntriesState(this.weekDays,e,u.f3.Submitted).subscribe(t=>{0!==t?(this.mailService.submitTimesheet(e),this.notificationService.success("This timesheet is submitted.")):this.notificationService.warning("This submit is failed."),this.getUserTimeEntries()},()=>{this.notificationService.danger("This timesheet is not submitted.")}):this.notificationService.danger("Please fill all days continuously."):this.notificationService.info("Please set Time Entry before submitting.")}})}validateTimeEntry(){const e=this.timeEntriesList.filter(e=>e.stateId===u.f3.Submitted);if(0===e.length){const e=this.timeEntriesList.filter(e=>e.stateId===u.f3.Filled);e.length>0?z().fire({text:"Are you sure to validate this timesheet?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes",showLoaderOnConfirm:!0,preConfirm:()=>{this.isContinuouslyFilledTimeSheet()?this.timesheetService.updateTimeEntriesState(this.weekDays,e,u.f3.Validated).subscribe(e=>{this.refrechValidatedTimeEntry(e)},()=>{this.notificationService.danger("This timesheet is not validated.")}):this.notificationService.danger("Please fill all days continuously.")}}):this.notificationService.info("Please set Time Entry before validating.")}else this.timesheetService.updateTimeEntriesState(this.weekDays,e,u.f3.Validated).subscribe(e=>{this.refrechValidatedTimeEntry(e)},()=>{this.notificationService.danger("This timesheet is not validated.")})}refrechValidatedTimeEntry(e){0!==e?this.notificationService.success("This timesheet is validated."):this.notificationService.warning("This timesheet validation failed."),this.getUserTimeEntries()}reworkTimeEntry(e){this.timeEntriesList.filter(e=>e.stateId===u.f3.Submitted||e.stateId===u.f3.Validated).length>0&&this.timesheetService.updateTimeEntriesState(this.weekDays,this.timeEntriesList,u.f3.Filled).subscribe(t=>{0!==t?(this.mailService.reworkTimesheet(e,this.timeEntriesList,this.selectedUserIdentifier.id),this.notificationService.success("Timesheet rework performed.")):this.notificationService.warning("Timesheet rework failed."),this.getUserTimeEntries()},()=>{this.notificationService.danger("Timesheet rework failed.")})}isContinuouslyFilledTimeSheet(){let e=!0,t=new Date(this.timeEntriesList[0].timeEntryDate);return e=1===t.getDay(),e&&(t.setDate(t.getDate()+1),this.timeEntriesList.forEach(n=>{if(new Date(n.timeEntryDate)>t)return e=!1,e;t=new Date(n.timeEntryDate),t.setDate(t.getDate()+1)})),e}getDayTimeEntriesState(e){const t=this.timeEntriesList.find(t=>this.dtService.areEqual(t.timeEntryDate,e.date));return void 0!==t?t.stateId:u.f3.Filled}isUsersNotEmpty(){return this.userHasSubordinates||0!==this.userId&&this.currentUser.groupId===g.Fl.SuperAdmin&&(!this.onlyMySubordinates||this.onlyMySubordinates&&this.userHasSubordinates)}isMyTimeSheet(){return this.currentUser.userId!==this.selectedUserIdentifier.id}close(){this.dialogRef.close()}refrechTimeSheet(){this.getUserTimeEntries()}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(c.Injector),c.\u0275\u0275directiveInject(l.so),c.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-timeentry-component"]],decls:55,vars:25,consts:[[3,"ngClass"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"wrapper"],["class","overlay",4,"ngIf"],[1,"card-body","loaded-content"],["class","col-md-11",4,"ngIf"],["class","col-md-1",4,"ngIf"],[1,"row","m-b-20"],[1,"col-sm-2"],[1,"select-current-week"],[1,"f-w-600",3,"click"],[1,"col-sm-3"],[3,"daysForBoard","daysChange"],[1,"col-sm-4"],[3,"userIdentifier","periodFrom","periodTo","onlyMySubordinates","activitiesId","userChange",4,"ngIf"],[1,"col-sm-3",2,"text-align","right"],["class","btn btn-primary m-r-5","type","submit",3,"click",4,"ngIf"],[1,"btn","btn-primary",3,"click"],[1,"icofont","icofont-plus"],[1,"table","text-center","m-b-10"],[2,"padding","0px"],[1,"th-days","thead"],["scope","col",2,"width","21%"],["style","width:7%","scope","col",4,"ngFor","ngForOf"],["scope","col",2,"width","8%"],[1,"th-totals","thead"],["scope","col",1,"text-right",2,"width","21%"],[1,"tbody"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"col-md-11"],[2,"color","#979695"],[1,"col-md-1"],[1,"material-icons","modal-close",3,"click"],[3,"userIdentifier","periodFrom","periodTo","onlyMySubordinates","activitiesId","userChange"],["type","submit",1,"btn","btn-primary","m-r-5",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"fa","fa-arrow-circle-right"],[1,"icofont","icofont-exchange"],[1,"icofont","icofont-checked"],["scope","col",2,"width","7%"],[1,"tr-project",3,"ngClass"],[3,"colSpan"],["class","label label-danger m-l-5",4,"ngIf"],[1,"label","label-danger","m-l-5"],[1,"text-left",2,"width","21%","text-overflow","ellipsis",3,"matTooltip"],["style","width: 7%;","appTdTimeEntry","",3,"userId","activity","projectId","date","timeEntry","dayTimeEntriesState","timeEntryAmountTotal","refrechTimeSheet",4,"ngFor","ngForOf"],[1,"td-total-activity",2,"width","8%"],[1,"td-notes-pin",2,"width","8%"],[2,"margin-bottom","-0.5em"],[3,"click"],[3,"checked","change"],["appTdTimeEntry","",2,"width","7%",3,"userId","activity","projectId","date","timeEntry","dayTimeEntriesState","timeEntryAmountTotal","refrechTimeSheet"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"div",2),c.\u0275\u0275elementStart(3,"div",3),c.\u0275\u0275elementStart(4,"div",4),c.\u0275\u0275elementStart(5,"div",5),c.\u0275\u0275template(6,te,6,0,"div",6),c.\u0275\u0275elementStart(7,"div",7),c.\u0275\u0275elementStart(8,"div",2),c.\u0275\u0275template(9,ne,4,1,"div",8),c.\u0275\u0275template(10,ie,4,0,"div",9),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(11,"div",10),c.\u0275\u0275elementStart(12,"div",11),c.\u0275\u0275elementStart(13,"div",12),c.\u0275\u0275elementStart(14,"h5"),c.\u0275\u0275text(15," Current Week"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(16,"a",13),c.\u0275\u0275listener("click",function(){return t.selectCurrentWeek()}),c.\u0275\u0275text(17),c.\u0275\u0275pipe(18,"shortDate"),c.\u0275\u0275pipe(19,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(20,"div",14),c.\u0275\u0275elementStart(21,"app-select-week",15),c.\u0275\u0275listener("daysChange",function(e){return t.daysChange(e)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"div",16),c.\u0275\u0275template(23,re,1,5,"app-select-user",17),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(24,"div",18),c.\u0275\u0275template(25,oe,3,0,"button",19),c.\u0275\u0275template(26,se,3,0,"button",19),c.\u0275\u0275template(27,ae,3,0,"button",19),c.\u0275\u0275template(28,le,3,0,"button",19),c.\u0275\u0275elementStart(29,"button",20),c.\u0275\u0275listener("click",function(){return t.openProjectListDialog()}),c.\u0275\u0275element(30,"em",21),c.\u0275\u0275text(31," Task "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(32,"div",2),c.\u0275\u0275elementStart(33,"div",3),c.\u0275\u0275elementStart(34,"table",22),c.\u0275\u0275element(35,"caption",23),c.\u0275\u0275elementStart(36,"thead",24),c.\u0275\u0275element(37,"th",25),c.\u0275\u0275template(38,ce,3,3,"th",26),c.\u0275\u0275elementStart(39,"th",27),c.\u0275\u0275text(40,"Total"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(41,"th",27),c.\u0275\u0275text(42,"Notes"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(43,"th",27),c.\u0275\u0275text(44,"Pin"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(45,"thead",28),c.\u0275\u0275elementStart(46,"th",29),c.\u0275\u0275text(47,"Total"),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(48,de,2,1,"th",26),c.\u0275\u0275elementStart(49,"th",27),c.\u0275\u0275text(50),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(51,"th",27),c.\u0275\u0275element(52,"th",27),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(53,"span",30),c.\u0275\u0275template(54,fe,7,8,"tbody",31),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275property("ngClass",c.\u0275\u0275pureFunction2(22,ge,t.isDisplayedUsers,!t.isDisplayedUsers)),c.\u0275\u0275advance(6),c.\u0275\u0275property("ngIf",t.isLoading),c.\u0275\u0275advance(1),c.\u0275\u0275classProp("blurred",t.isLoading),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",!t.isDisplayedUsers),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",!t.isDisplayedUsers),c.\u0275\u0275advance(7),c.\u0275\u0275textInterpolate2("",c.\u0275\u0275pipeBind1(18,18,t.startOfCurrentWeek),"-",c.\u0275\u0275pipeBind1(19,20,t.endOfCurrentWeek)," "),c.\u0275\u0275advance(4),c.\u0275\u0275property("daysForBoard",t.daysForBoard),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",t.isUsersNotEmpty()),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",t.isDisplayedUsers&&!t.isMyTimeSheet()),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",!t.isMyTimeSheet()),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.isUsersNotEmpty()&&t.isMyTimeSheet()),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.isUsersNotEmpty()&&t.isMyTimeSheet()),c.\u0275\u0275advance(10),c.\u0275\u0275property("ngForOf",t.weekDays),c.\u0275\u0275advance(10),c.\u0275\u0275property("ngForOf",t.weekDays),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",t.globalTimeEntryAmountTotal," h"),c.\u0275\u0275advance(4),c.\u0275\u0275property("ngForOf",t.selectedUserProjects))},directives:[o.NgClass,o.NgIf,B,o.NgForOf,H.$g,K,Z.gM,E.Hw,v.oG,ee],pipes:[O.M],styles:[".card-body[_ngcontent-%COMP%]{padding:25px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border-top:1px solid #bbbbbb;border-left:1px solid #bbbbbb;border-right:1px solid #bbbbbb}table[_ngcontent-%COMP%]{font-size:12px;padding:6px}.tbody[_ngcontent-%COMP%]{display:block;overflow:auto;overflow-y:scroll;max-height:calc(100vh - 380px);border-bottom:1px solid #bbbbbb}.thead[_ngcontent-%COMP%]{width:calc(100% - 1.5em)}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}td[_ngcontent-%COMP%]{overflow:hidden}.tr-project[_ngcontent-%COMP%]{text-align:left;color:#fff;font-weight:600}.generic[_ngcontent-%COMP%]{background-color:#8e0089}.non-generic[_ngcontent-%COMP%]{background-color:#5489a5}.th-days[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}.th-totals[_ngcontent-%COMP%]{background-color:#ccc;color:#000}.td-total-activity[_ngcontent-%COMP%]{font-weight:600;color:#000}.td-notes-pin[_ngcontent-%COMP%]{padding:0;vertical-align:middle}mat-icon[_ngcontent-%COMP%]{cursor:pointer}.select-current-week[_ngcontent-%COMP%]{color:#3f629d}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] + tbody[_ngcontent-%COMP%]{border-top:0px}.select-row[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:40px}.label[_ngcontent-%COMP%]{padding:5px}.f-w-600[_ngcontent-%COMP%]{cursor:pointer}.modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer;margin:0}.modal-close[_ngcontent-%COMP%]:hover{color:red}.md-dialog-container[_ngcontent-%COMP%]{width:1500px;height:700px}.wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"]}),e})();var ye=n(63753),ve=n(71370),Ee=n(60428),Ie=n(44995),Ce=n(36063);const be=V,xe={parse:{dateInput:"MM/YYYY"},display:{dateInput:"MM/YYYY",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}};let we=(()=>{class e{constructor(e,t){this.timesheetService=e,this.dtService=t,this.date=new a.FormControl(be()),this.monthSelected=new Date,this.daysChange=new c.EventEmitter,this.firstDate=new Date(this.date.value)}ngOnInit(){this.date.setValue(this.date.value.startOf("month")),this.getMonthWeeksFirstDay(),this.currentMonthSubscription=this.timesheetService.selectCurrentMonth.subscribe(e=>{this.date.setValue(this.dtService.getCurrentMonth()),this.getMonthWeeksFirstDay()})}chosenYearHandler(e){this.date.setValue(e),this.getMonthWeeksFirstDay()}chosenMonthHandler(e,t){this.date.setValue(e),this.getMonthWeeksFirstDay(),t&&t.close()}previousMonth(){this.date.setValue(be(this.date.value.subtract(1,"months").startOf("month"))),this.getMonthWeeksFirstDay()}nextMonth(){this.date.setValue(be(this.date.value.add(1,"months").startOf("month"))),this.getMonthWeeksFirstDay()}getMonthWeeksFirstDay(){this.weeksFirstDate=[];const e=new Date(this.date.value);for(;e.getMonth()===new Date(this.date.value).getMonth();){for(this.weeksFirstDate.push(new Date(e));e.getUTCDay()<6;)e.setDate(e.getDate()+1);e.setDate(e.getDate()+1)}this.daysChange.emit(this.weeksFirstDate)}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.Cv))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-select-month-board"]],outputs:{daysChange:"daysChange"},features:[c.\u0275\u0275ProvidersFeature([{provide:Y._A,useClass:Ce.t7,deps:[Y.Ad]},{provide:Y.sG,useValue:xe}])],decls:22,vars:7,consts:[[2,"padding","0px"],[1,"td-calendar"],["scope","col"],[1,"td-arrow","pointer",3,"click"],[1,"material-icons"],[1,"td-date"],[1,"td-calendar","pointer",3,"click"],["matInput","",3,"matDatepicker","formControl"],["matSuffix","",3,"for"],["startView","multi-year","panelClass","example-month-picker",3,"yearSelected","monthSelected"],["picker",""]],template:function(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"table"),c.\u0275\u0275element(1,"caption",0),c.\u0275\u0275elementStart(2,"tr",1),c.\u0275\u0275element(3,"th",2),c.\u0275\u0275elementStart(4,"td",3),c.\u0275\u0275listener("click",function(){return t.previousMonth()}),c.\u0275\u0275elementStart(5,"em",4),c.\u0275\u0275text(6,"keyboard_arrow_left"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(7,"td",5),c.\u0275\u0275elementStart(8,"span"),c.\u0275\u0275text(9),c.\u0275\u0275pipe(10,"date"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(11,"td",6),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275reference(18).open()}),c.\u0275\u0275elementStart(12,"em",4),c.\u0275\u0275text(13,"date_range"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(14,"mat-form-field"),c.\u0275\u0275element(15,"input",7),c.\u0275\u0275element(16,"mat-datepicker-toggle",8),c.\u0275\u0275elementStart(17,"mat-datepicker",9,10),c.\u0275\u0275listener("yearSelected",function(e){return t.chosenYearHandler(e)})("monthSelected",function(n){c.\u0275\u0275restoreView(e);const i=c.\u0275\u0275reference(18);return t.chosenMonthHandler(n,i)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(19,"td",3),c.\u0275\u0275listener("click",function(){return t.nextMonth()}),c.\u0275\u0275elementStart(20,"em",4),c.\u0275\u0275text(21,"keyboard_arrow_right"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275reference(18);c.\u0275\u0275advance(9),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind2(10,4,t.date.value,"MM / yyyy")),c.\u0275\u0275advance(6),c.\u0275\u0275property("matDatepicker",e)("formControl",t.date),c.\u0275\u0275advance(1),c.\u0275\u0275property("for",e)}},directives:[S.KE,y.Nt,$.hl,a.DefaultValueAccessor,a.NgControlStatus,a.FormControlDirective,$.nW,S.R9,$.Mq],pipes:[o.DatePipe],styles:["table[_ngcontent-%COMP%]{width:80%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;border:1px solid gainsboro}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;font-size:25px;cursor:pointer}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:4px}table[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:1px;left:3px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:0px;height:0px;visibility:hidden}"]}),e})();var Me=n(67827);let Pe=(()=>{class e{constructor(e,t){this.element=e,this.dialog=t,this.refreshBoard=new c.EventEmitter}ngOnInit(){this.innerHTML=0!==this.weekTimeSheet.amount?this.weekTimeSheet.amount.toString()+" h":"",this.background=2===this.weekTimeSheet.state?"#4CAF50":1===this.weekTimeSheet.state?"#fffd99":"#FFFFFF"}ngOnDestroy(){this.dialog.closeAll()}onClick(e){this.displayEditdialogRef=this.dialog.open(Se,{disableClose:!1,hasBackdrop:!0,data:{userId:this.userId,userName:this.userName,onlyMySubordinates:this.onlyMySubordinates,activitiesId:this.activitiesId,weekTimeSheet:this.weekTimeSheet}}),this.displayEditdialogRef.updatePosition({left:"10%",right:"10%"}),this.displayEditdialogRef.afterClosed().subscribe(e=>{this.refreshBoard.emit(!0)})}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(c.ElementRef),c.\u0275\u0275directiveInject(l.uw))},e.\u0275dir=c.\u0275\u0275defineDirective({type:e,selectors:[["","appTdBoard",""]],hostVars:7,hostBindings:function(e,t){1&e&&c.\u0275\u0275listener("click",function(e){return t.onClick(e)}),2&e&&(c.\u0275\u0275hostProperty("innerHTML",t.innerHTML,c.\u0275\u0275sanitizeHtml),c.\u0275\u0275styleProp("border",t.border)("box-shadow",t.boShadow)("background-color",t.background))},inputs:{weekTimeSheet:"weekTimeSheet",userId:"userId",userName:"userName",activitiesId:"activitiesId",onlyMySubordinates:"onlyMySubordinates"},outputs:{refreshBoard:"refreshBoard"}}),e})();function De(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",32),c.\u0275\u0275elementStart(1,"div",33),c.\u0275\u0275elementStart(2,"div",34),c.\u0275\u0275elementStart(3,"div",2),c.\u0275\u0275elementStart(4,"div",35),c.\u0275\u0275element(5,"mat-spinner"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function ke(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-checkbox",36),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().onlyMySubordinates=t})("change",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().onlyMySubordinatesChanged()}),c.\u0275\u0275text(1," My Subordinates "),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275property("ngModel",e.onlyMySubordinates)}}function Oe(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"ng-multiselect-dropdown",37),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().selectedActivitiesIdentifiers=t})("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().dropDownSelected=!0})("onDropDownClose",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().onDropDownClose()}),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275property("placeholder","Select Activity...")("settings",e.dropDownSettings)("data",e.activitiesIdentifiers)("ngModel",e.selectedActivitiesIdentifiers)}}function Te(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"th",38),c.\u0275\u0275text(1),c.\u0275\u0275pipe(2,"shortDate"),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind1(2,1,e))}}function Fe(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",44),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275property("colSpan",e.weekTimeSheets.length+3),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.activityName," ")}}function je(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",45),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.userNumber," ")}}function _e(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",46),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.userName," ")}}function Ne(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"td",48),c.\u0275\u0275listener("refreshBoard",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext(3).refreshBoard(t)}),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext(2).$implicit,i=c.\u0275\u0275nextContext();c.\u0275\u0275property("weekTimeSheet",e)("userId",n.userId)("userName",n.userName)("onlyMySubordinates",i.onlyMySubordinates)("activitiesId",i.selectedActivitiesIds)}}function Re(e,t){if(1&e&&(c.\u0275\u0275elementContainerStart(0),c.\u0275\u0275template(1,Ne,1,5,"td",47),c.\u0275\u0275elementContainerEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",e.weekTimeSheets)}}function Ae(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",49),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.totalAmount," h ")}}function Ue(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275template(1,Fe,2,2,"td",39),c.\u0275\u0275template(2,je,2,1,"td",40),c.\u0275\u0275template(3,_e,2,1,"td",41),c.\u0275\u0275template(4,Re,2,1,"ng-container",42),c.\u0275\u0275template(5,Ae,2,1,"td",43),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",0===e.userId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",0!==e.userId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",0!==e.userId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",0!==e.userId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",0!==e.userId)}}let Ve=(()=>{class e{constructor(e,t,n,i,r,o){this.timesheetService=e,this.boardService=t,this.numberFormatter=n,this.projectService=i,this.excelService=r,this.router=o,this.currentMonth=V().startOf("month"),this.usersMonthTimeSheets=[],this.usersTimeEntries=[],this.isLoading=!0,this.onlyMySubordinates=!0,this.activitiesIdentifiers=[],this.selectedActivitiesIds="",this.selectedActivitiesIdentifiers=[],this.dropDownSettings={},this.dropDownSelected=!1}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.isSuperAdmin()&&!1===this.currentUser.hasSubordinates&&(this.onlyMySubordinates=!1),this.dropDownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.getActivities()}getActivities(){this.projectService.getActivities().subscribe(e=>{null!=e&&(this.activitiesIdentifiers=e)})}changedMonth(e){this.weeksStartdate=e,this.getSubordinatesTimesheet()}getSubordinatesTimesheet(){let e;this.isLoading=!0,this.isSuperAdmin()&&!1===this.onlyMySubordinates?(e=214,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(",")):(e=this.currentUser.userId,this.selectedActivitiesIds=""),this.timesheetService.GetReportersTimesheet(e,this.selectedActivitiesIds,this.weeksStartdate[0],V(this.weeksStartdate[0]).endOf("month").toDate()).subscribe(e=>{this.isLoading=!1,this.usersTimeEntries=e,this.getUsersMonthTimeSheets(),this.weeksStartdateDisplayed=this.weeksStartdate},()=>{this.isLoading=!1})}getUsersMonthTimeSheets(){this.usersMonthTimeSheets=[];let e="";this.usersTimeEntries.forEach(t=>{let n=this.usersMonthTimeSheets.find(e=>e.userId===t.userId);if(void 0===n){if(n=new u.qH,t.activityName!==e){const n=new u.qH;n.activityName=t.activityName,this.usersMonthTimeSheets.push(n),e=t.activityName}this.boardService.settingWeekTimeSheetWorkingDaysCount(n,this.weeksStartdate),n.activityName=t.activityName,n.userId=t.userId,n.userNumber=t.userNumber,n.userName=t.userName,this.usersMonthTimeSheets.push(n),this.setWeekTimeSheetAttributes(n,t)}else this.setWeekTimeSheetAttributes(n,t)})}setWeekTimeSheetAttributes(e,t){if(null!=t.timeEntryDate){const n=e.weekTimeSheets[this.getIndexOfWeekTimeSheet(new Date(t.timeEntryDate))];if(void 0===n.timeEntryDates.find(e=>e.getTime()===new Date(t.timeEntryDate).getTime()))this.setWeekTimeSheetState(n,e,t);else if(void 0!==t.stateId&&0===t.isLeave){const i=t.amount;n.amount=n.amount+i,e.totalAmount=e.totalAmount+i}}}getIndexOfWeekTimeSheet(e){return e>=this.weeksStartdate[this.weeksStartdate.length-1]?this.weeksStartdate.length-1:this.weeksStartdate.findIndex(t=>e<t)-1}selectCurrentMonth(){this.timesheetService.selectCurrentMonth.next()}refreshBoard(){this.getSubordinatesTimesheet()}setWeekTimeSheetState(e,t,n){if(e.timeEntryDates.push(new Date(n.timeEntryDate)),void 0!==n.stateId){if(0===n.isLeave){const i=n.amount;e.amount=this.numberFormatter.round(e.amount+i,2),t.totalAmount=this.numberFormatter.round(t.totalAmount+i,2)}n.stateId===u.f3.Validated?e.validatedWorkingDaysCount++:(n.stateId===u.f3.Filled||null===n.stateId)&&e.nonSubmittedWorkingDaysCount++}e.workingDaysCount<=e.timeEntryDates.length&&(e.workingDaysCount=e.timeEntryDates.length),e.state=e.validatedWorkingDaysCount===e.workingDaysCount?u.MA.Validated:e.nonSubmittedWorkingDaysCount===e.timeEntryDates.length?u.MA.NotSubmitted:u.MA.InProgress}isSuperAdmin(){return this.currentUser.groupId===g.Fl.SuperAdmin}onlyMySubordinatesChanged(){this.getSubordinatesTimesheet()}onDropDownClose(){this.dropDownSelected&&(this.dropDownSelected=!1,this.getSubordinatesTimesheet())}importFromExcel(){this.router.navigate(["/project-management/timesheet/import/"])}exportToExcel(){if(void 0!==this.usersMonthTimeSheets&&0!==this.usersMonthTimeSheets.length){const e=this.usersMonthTimeSheets[1].weekTimeSheets.length,t=[];t.push({header:"Matricule",key:"userNumber",width:20}),t.push({header:"Ressource",key:"userName",width:30});for(let i=1;i<=e;i++)t.push({header:"Week"+i,key:"week"+i,width:15});t.push({header:"Total",key:"totalAmount",width:15});const n=[];this.usersMonthTimeSheets.forEach(e=>{const t=[];t.push(e.weekTimeSheets.length>=4?e.userNumber:e.activityName),t.push(e.userName),e.weekTimeSheets.forEach(e=>{t.push(e.amount)}),t.push(e.weekTimeSheets.length>=4?e.totalAmount:""),n.push(t)}),this.excelService.generateExcel(t,n,[],[],"board")}}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(ve.$),c.\u0275\u0275directiveInject(Ee.e),c.\u0275\u0275directiveInject(Ie.Y4),c.\u0275\u0275directiveInject(r.xB),c.\u0275\u0275directiveInject(m.F0))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-board"]],decls:45,vars:11,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"wrapper"],["class","overlay",4,"ngIf"],[1,"card-body","loaded-content"],[1,"row","m-b-32"],[1,"col-md-2"],[1,"select-current-month"],[1,"current-month",3,"click"],[1,"col-sm-2"],[3,"daysChange"],[1,"row","col-sm-8","flex-container"],[1,"col-sm-3"],[1,"text-right","m-t-5"],[3,"ngModel","ngModelChange","change",4,"ngIf"],[1,"col-sm-4"],["class","multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose",4,"ngIf"],[1,"col-sm-5"],["type","button",1,"export","btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"table","text-center","m-b-10"],[2,"padding","0px"],[1,"th-header"],["scope","col",1,"th-user-number"],["scope","col",1,"th-user-name"],["scope","col",4,"ngFor","ngForOf"],["scope","col",1,"th-total"],[1,"tbody-scroll"],[4,"ngFor","ngForOf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[3,"ngModel","ngModelChange","change"],[1,"multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose"],["scope","col"],["class","td-activity",3,"colSpan",4,"ngIf"],["class","td-user-number",4,"ngIf"],["class","td-user-name",4,"ngIf"],[4,"ngIf"],["class","td-total",4,"ngIf"],[1,"td-activity",3,"colSpan"],[1,"td-user-number"],[1,"td-user-name"],["appTdBoard","","style","cursor : pointer;",3,"weekTimeSheet","userId","userName","onlyMySubordinates","activitiesId","refreshBoard",4,"ngFor","ngForOf"],["appTdBoard","",2,"cursor","pointer",3,"weekTimeSheet","userId","userName","onlyMySubordinates","activitiesId","refreshBoard"],[1,"td-total"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"div",2),c.\u0275\u0275elementStart(3,"div",3),c.\u0275\u0275elementStart(4,"div",4),c.\u0275\u0275elementStart(5,"div",5),c.\u0275\u0275template(6,De,6,0,"div",6),c.\u0275\u0275elementStart(7,"div",7),c.\u0275\u0275elementStart(8,"div",8),c.\u0275\u0275elementStart(9,"div",9),c.\u0275\u0275elementStart(10,"div",10),c.\u0275\u0275elementStart(11,"h5"),c.\u0275\u0275text(12," Current Month"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(13,"a",11),c.\u0275\u0275listener("click",function(){return t.selectCurrentMonth()}),c.\u0275\u0275text(14),c.\u0275\u0275pipe(15,"date"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(16,"div",12),c.\u0275\u0275elementStart(17,"app-select-month-board",13),c.\u0275\u0275listener("daysChange",function(e){return t.changedMonth(e)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(18,"div",14),c.\u0275\u0275elementStart(19,"div",15),c.\u0275\u0275elementStart(20,"div",16),c.\u0275\u0275template(21,ke,2,1,"mat-checkbox",17),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"div",18),c.\u0275\u0275template(23,Oe,1,4,"ng-multiselect-dropdown",19),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(24,"div",20),c.\u0275\u0275elementStart(25,"button",21),c.\u0275\u0275listener("click",function(){return t.exportToExcel()}),c.\u0275\u0275element(26,"em",22),c.\u0275\u0275text(27," Export "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(28,"button",21),c.\u0275\u0275listener("click",function(){return t.importFromExcel()}),c.\u0275\u0275element(29,"em",22),c.\u0275\u0275text(30," Import "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(31,"div",2),c.\u0275\u0275elementStart(32,"div",3),c.\u0275\u0275elementStart(33,"table",23),c.\u0275\u0275element(34,"caption",24),c.\u0275\u0275elementStart(35,"thead",25),c.\u0275\u0275elementStart(36,"th",26),c.\u0275\u0275text(37,"Matricule"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(38,"th",27),c.\u0275\u0275text(39,"Resource"),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(40,Te,3,3,"th",28),c.\u0275\u0275elementStart(41,"th",29),c.\u0275\u0275text(42,"Total"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(43,"tbody",30),c.\u0275\u0275template(44,Ue,6,5,"tr",31),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(6),c.\u0275\u0275property("ngIf",t.isLoading),c.\u0275\u0275advance(1),c.\u0275\u0275classProp("blurred",t.isLoading),c.\u0275\u0275advance(7),c.\u0275\u0275textInterpolate(c.\u0275\u0275pipeBind2(15,8,t.currentMonth,"MMMM yyyy")),c.\u0275\u0275advance(7),c.\u0275\u0275property("ngIf",t.isSuperAdmin()),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",t.isSuperAdmin()&&!t.onlyMySubordinates),c.\u0275\u0275advance(17),c.\u0275\u0275property("ngForOf",t.weeksStartdateDisplayed),c.\u0275\u0275advance(4),c.\u0275\u0275property("ngForOf",t.usersMonthTimeSheets))},directives:[o.NgIf,we,o.NgForOf,H.$g,v.oG,a.NgControlStatus,a.NgModel,Me.OP,Pe],pipes:[o.DatePipe,O.M],styles:[".card-body[_ngcontent-%COMP%]{padding:25px}.multi-search[_ngcontent-%COMP%]{width:100%}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border-top:1px solid #bbbbbb;border-left:1px solid #bbbbbb;border-right:1px solid #bbbbbb}.td-activity[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#8e0089;width:100%;font-weight:bold}.td-user-number[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:10%;font-weight:bold}.td-user-name[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:20%;font-weight:bold}.td-total[_ngcontent-%COMP%]{background-color:#e0dedd;width:10%}.th-header[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}.th-user-number[_ngcontent-%COMP%]{width:10%}.th-user-name[_ngcontent-%COMP%]{width:20%}.th-total[_ngcontent-%COMP%]{width:10%}.select-current-month[_ngcontent-%COMP%]{color:#3f629d}.select-row[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:40px}.current-month[_ngcontent-%COMP%]{cursor:pointer;margin-left:20px}tbody[_ngcontent-%COMP%]{display:block;overflow:auto;overflow-y:scroll;max-height:calc(100vh - 342px);border-bottom:1px solid #bbbbbb}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}thead[_ngcontent-%COMP%]{width:calc(100% - 1.2em)}.wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}.m-b-32[_ngcontent-%COMP%]{margin-bottom:32px}.export[_ngcontent-%COMP%]{float:right}"]}),e})();var Le=n(55750),ze=n(56185);function $e(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-option",21),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275property("value",e.id),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.description," ")}}let Be=(()=>{class e{constructor(e,t,n,i){this.timesheetService=e,this.datetimeService=t,this.notificationService=n,this.dialogRef=i,this.readyToLoad=!1,this.timeEntriesImport=[]}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.getImportFormats()}getImportFormats(){this.timesheetService.getImportFormats().subscribe(e=>{this.importFormatsIdentifiers=e})}fileLoad(e){switch(this.readyToLoad=!1,this.selectedImportFormatId){case 0:this.fileLoadTelnet(e);break;case 1:this.fileLoadIngenicoJiraTempo(e);break;case 2:this.fileLoadIngenicoHarvest(e);break;case 3:this.fileLoadIngenicoSciformaIndividual(e);break;case 99:this.fileLoadIngenicoSciforma(e)}}fileLoadTelnet(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");this.fileName=t.files[0].name;const n=new FileReader;n.onload=()=>{const e=new ze.Workbook,t=[];e.xlsx.load(n.result).then(e=>{const n=e.worksheets[0],i=n.getRow(1).values.length;n.eachRow(e=>{const n=[];for(let t=1;t<i;t++){let i=e.values[t];void 0===i&&(i=""),n.push(i)}t.push(n),this.processTelnetXlsFile(t)})})},n.readAsArrayBuffer(t.files[0])}processTelnetXlsFile(e){if(this.isTelnetXlsFileHeader(e[0])){this.timeEntriesImportCount=0,this.timeEntriesImport=[];const t=this.buildTelnetXlsFileRows(e);0===t.length?this.notificationService.success("File format valid."):this.notificationService.warning("File contain invalid line(s): "+t.join(", ")+"."),0!==this.timeEntriesImportCount?this.readyToLoad=!0:this.notificationService.warning("There is no lines to load.")}else this.notificationService.danger("File format invalid.")}isTelnetXlsFileHeader(e){this.daysHeaders=[];for(let t=3;t<e.length;t++){const n=+e[t];if(Number.isNaN(n))return!1;this.daysHeaders.push(this.excelDateToJSDate(n))}return void 0!==e&&e.length>=6&&"Matricule"===e[0]&&"Full name"===e[1]&&"Project Abreviation"===e[2]}buildTelnetXlsFileRows(e){const t=[];for(let n=1;n<e.length;n++){const i=e[n];i.length>=3&&void 0!==i[0]&&void 0!==i[1]&&void 0!==i[2]?this.buildTelnetXlsFileRow(i):i.length>0&&t.push((n+1).toString())}return t}buildTelnetXlsFileRow(e){const t=e[0].toString(),n=e[1].toString(),i=e[2].toString();for(let r=3;r<e.length;r++){const o=this.daysHeaders[r-3],s=+e[r];if(!Number.isNaN(s)&&0!==s){const e=new u.XZ;this.timeEntriesImportCount++,e.timeEntryImportId=this.timeEntriesImportCount,e.formatId=this.selectedImportFormatId,e.userImportId=t,e.userImportName=n,e.projectImportId="",e.projectImportName="",e.projectName=i,e.timeEntryImportDate=o,e.timeEntryImportAmount=s,e.timeEntryImportComment="",this.timeEntriesImport.push(e)}}}fileLoadIngenicoJiraTempo(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");this.fileName=t.files[0].name;const n=new FileReader;n.onload=()=>{const e=new ze.Workbook,t=[];e.xlsx.load(n.result).then(e=>{const n=e.worksheets[0],i=n.getRow(1).values.length;n.eachRow(e=>{const n=[];for(let t=1;t<i;t++){let i=e.values[t];void 0===i&&(i=""),n.push(i)}t.push(n),this.processIngenicoJiraTempoXlsFile(t)})})},n.readAsArrayBuffer(t.files[0])}processIngenicoJiraTempoXlsFile(e){if(this.isIngenicoJiraTempoXlsFileHeader(e[0])){this.timeEntriesImportCount=0,this.timeEntriesImport=[];const t=this.buildIngenicoJiraTempoXlsFileRows(e);0===t.length?this.notificationService.success("File format valid."):this.notificationService.warning("File contain invalid line(s): "+t.join(", ")+"."),0!==this.timeEntriesImportCount?this.readyToLoad=!0:this.notificationService.warning("There is no lines to load.")}else this.notificationService.danger("File format invalid.")}isIngenicoJiraTempoXlsFileHeader(e){return void 0!==e&&e.length>=6&&"Issue Key"===e[0]&&"Issue summary"===e[1]&&"Hours"===e[2]&&"Work date"===e[3]&&"Username"===e[4]&&"Full name"===e[5]&&"Work Description"===e[22]}buildIngenicoJiraTempoXlsFileRows(e){const t=[];for(let n=1;n<e.length;n++){const i=e[n];if(i.length>=6&&void 0!==i[0]&&void 0!==i[2]&&void 0!==i[3]&&void 0!==i[4]&&void 0!==i[5]&&void 0!==i[22]){const e=+i[2];Number.isNaN(+i[3])||Number.isNaN(e)?t.push((n+1).toString()):this.buildIngenicoJiraTempoXlsFileRow(i)}else i.length>0&&t.push((n+1).toString())}return t}buildIngenicoJiraTempoXlsFileRow(e){const t=e[0].toString().toUpperCase();if("TNP-1"!==t&&"TNP-2"!==t&&"TNP-3"!==t){const n=e[4].toString(),i=e[5].toString(),r=+e[3],o=+e[2],s=t+": "+e[22].toString(),a=this.excelDateToJSDate(r);let l=this.timeEntriesImport.find(e=>e.userImportId===n&&e.userImportName===i&&this.datetimeService.areEqual(e.timeEntryImportDate,a));void 0===l?(l=new u.XZ,this.timeEntriesImportCount++,l.timeEntryImportId=this.timeEntriesImportCount,l.userImportId=n,l.userImportName=i,l.projectImportId="",l.projectImportName="",l.timeEntryImportDate=a,l.timeEntryImportAmount=o,l.timeEntryImportComment="- "+s,l.formatId=this.selectedImportFormatId,this.timeEntriesImport.push(l)):(l.timeEntryImportAmount=l.timeEntryImportAmount+o,l.timeEntryImportComment=l.timeEntryImportComment+"\n- "+s,l.timeEntryImportComment=l.timeEntryImportComment.substr(0,500))}}fileLoadIngenicoHarvest(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");this.fileName=t.files[0].name;const n=new FileReader;n.onload=()=>{const e=new ze.Workbook,t=[];e.xlsx.load(n.result).then(e=>{const n=e.worksheets[0],i=n.getRow(1).values.length;n.eachRow(e=>{const n=[];for(let t=1;t<i;t++){let i=e.values[t];void 0===i&&(i=""),n.push(i)}t.push(n),this.processIngenicoHarvestXlsFile(t)})})},n.readAsArrayBuffer(t.files[0])}processIngenicoHarvestXlsFile(e){if(this.isIngenicoHarvestXlsFileHeader(e[0])){this.timeEntriesImportCount=0,this.timeEntriesImport=[];const t=this.buildIngenicoHarvestXlsFileRows(e);0===t.length?this.notificationService.success("File format valid."):this.notificationService.warning("File contain invalid line(s): "+t.join(", ")+"."),0!==this.timeEntriesImportCount?this.readyToLoad=!0:this.notificationService.warning("There is no lines to load.")}else this.notificationService.danger("File format invalid.")}isIngenicoHarvestXlsFileHeader(e){return void 0!==e&&e.length>=12&&"Date"===e[0]&&"Task"===e[4]&&"Hours"===e[6]&&"Approved?"===e[9]&&"First Name"===e[10]&&"Last Name"===e[11]}buildIngenicoHarvestXlsFileRows(e){const t=[];for(let n=1;n<e.length;n++){const i=e[n];if(i.length>=12&&void 0!==i[0]&&void 0!==i[4]&&void 0!==i[6]&&void 0!==i[9]&&void 0!==i[10]&&void 0!==i[11]){const e=+i[6];Number.isNaN(+i[0])||Number.isNaN(e)?t.push((n+1).toString()):this.buildIngenicoHarvestXlsFileRow(i)}else i.length>0&&t.push((n+1).toString())}return t}buildIngenicoHarvestXlsFileRow(e){if("YES"===e[9].toString().toUpperCase()){const t=e[10].toString()+"."+e[11].toString(),n=e[10].toString()+" "+e[11].toString(),i=+e[0],r=+e[6],o=e[4].toString(),s=this.excelDateToJSDate(i);let a=this.timeEntriesImport.find(e=>e.userImportId===t&&e.userImportName===n&&this.datetimeService.areEqual(e.timeEntryImportDate,s));void 0===a?(a=new u.XZ,this.timeEntriesImportCount++,a.timeEntryImportId=this.timeEntriesImportCount,a.userImportId=t,a.userImportName=n,a.projectImportId="",a.projectImportName="",a.timeEntryImportDate=s,a.timeEntryImportAmount=r,a.timeEntryImportComment="- "+o,a.formatId=this.selectedImportFormatId,this.timeEntriesImport.push(a)):(a.timeEntryImportAmount=a.timeEntryImportAmount+r,a.timeEntryImportComment=a.timeEntryImportComment+"\n- "+o,a.timeEntryImportComment=a.timeEntryImportComment.substr(0,500))}}fileLoadIngenicoSciformaIndividual(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");this.fileName=t.files[0].name;const n=new FileReader;n.onload=()=>{const e=new ze.Workbook,t=[];e.xlsx.load(n.result).then(e=>{const n=e.worksheets[0],i=n.getRow(1).values.length;n.eachRow(e=>{const n=[];for(let t=1;t<i;t++){let i=e.values[t];void 0===i&&(i=""),n.push(i)}t.push(n),this.processIngenicoSciformaIndividualXlsFile(t)})})},n.readAsArrayBuffer(t.files[0])}processIngenicoSciformaIndividualXlsFile(e){if(this.isIngenicoSciformaIndividualXlsFileHeader(e[3],e[6])){this.timeEntriesImportCount=0,this.timeEntriesImport=[];const t=this.buildIngenicoSciformaIndividualXlsFileRows(e);0===t.length?this.notificationService.success("File format valid."):this.notificationService.warning("File contain invalid line(s): "+t.join(", ")+"."),0!==this.timeEntriesImportCount?this.readyToLoad=!0:this.notificationService.warning("There is no lines to load.")}else this.notificationService.danger("File format invalid.")}isIngenicoSciformaIndividualXlsFileHeader(e,t){return void 0!==e&&void 0!==t&&5===e.length&&5===t.length&&"Source Type"===e[1]&&"Resource"===e[2]&&"DATE"===t[1]&&"SAP ID"===t[2]&&"Project name"===t[3]&&"Time"===t[4]}buildIngenicoSciformaIndividualXlsFileRows(e){const t=[],n=e[4];for(let i=7;i<e.length-6;i++){const r=e[i];5===r.length&&void 0!==r[1]&&void 0!==r[3]&&void 0!==r[4]?Number.isNaN(8*+r[4])?t.push((i+1).toString()):this.buildIngenicoSciformaIndividualXlsFileRow(n,r):r.length>0&&t.push((i+1).toString())}return t}buildIngenicoSciformaIndividualXlsFileRow(e,t){const n=e[2].toString().replace(", ","."),i=e[2].toString().replace(",",""),r=V(t[1].toString(),"DD/MM/YYYY").toDate(),o=8*+t[4],s=t[3].toString();let a=this.timeEntriesImport.find(e=>e.userImportId===n&&e.userImportName===i&&this.datetimeService.areEqual(e.timeEntryImportDate,r));void 0===a?(a=new u.XZ,this.timeEntriesImportCount++,a.timeEntryImportId=this.timeEntriesImportCount,a.userImportId=n,a.userImportName=i,a.projectImportId="",a.projectImportName="",a.timeEntryImportDate=r,a.timeEntryImportAmount=o,a.timeEntryImportComment="- "+s,a.formatId=this.selectedImportFormatId,this.timeEntriesImport.push(a)):(a.timeEntryImportAmount=a.timeEntryImportAmount+o,a.timeEntryImportComment=a.timeEntryImportComment+"\n- "+s,a.timeEntryImportComment=a.timeEntryImportComment.substr(0,500))}fileLoadIngenicoSciforma(e){const t=e.target;if(1!==t.files.length)throw new Error("Cannot use multiple files");this.fileName=t.files[0].name;const n=new FileReader;n.onload=()=>{const e=new ze.Workbook,t=[];e.xlsx.load(n.result).then(e=>{const n=e.worksheets[0],i=n.getRow(1).values.length;n.eachRow(e=>{const n=[];for(let t=1;t<i;t++){let i=e.values[t];void 0===i&&(i=""),n.push(i)}t.push(n),this.processIngenicoSciformaXlsFile(t)})})},n.readAsArrayBuffer(t.files[0])}processIngenicoSciformaXlsFile(e){this.isIngenicoSciformaXlsFileHeader(e[0])?(this.timeEntriesImportCount=0,this.timeEntriesImport=[],this.buildIngenicoSciformaXlsFileValidatedRows(e),this.buildIngenicoSciformaXlsFileCapturedRows(e),this.readyToLoad=!0,this.notificationService.success("File format correct.")):this.notificationService.danger("File format incorrect.")}isIngenicoSciformaXlsFileHeader(e){this.daysHeaders=[];for(let n=11;n<e.length;n++){const t=+e[n];if(Number.isNaN(t))return!1;this.daysHeaders.push(this.excelDateToJSDate(t))}const t=String.fromCharCode(13)+String.fromCharCode(10);return e[0]==="Source"+t+"Type"&&"Resource"===e[1]&&"Actual Effort"===e[2]&&"Actual Cost"===e[3]&&"Res ID"===e[4]&&"Monitored by"===e[5]&&e[6]==="Cost "+t+"Center"&&"Orga"===e[7]&&"Company"===e[8]&&e[9]==="Project's"+t+"SAP ID"&&e[10]==="Project's"+t+"Name"}buildIngenicoSciformaXlsFileValidatedRows(e){for(let t=1;t<e.length;t++){const n=e[t];void 0!==n[8]&&void 0!==n[0].toString()&&"TELNET"===n[8].toString().toUpperCase()&&"VALIDATED ACTUAL"===n[0].toString().toUpperCase()&&this.buildIngenicoSciformaXlsFileRow(n)}}buildIngenicoSciformaXlsFileCapturedRows(e){for(let t=1;t<e.length;t++){const n=e[t];void 0!==n[8]&&void 0!==n[0].toString()&&"TELNET"===n[8].toString().toUpperCase()&&"CAPTURED (TS)"===n[0].toString().toUpperCase()&&0===this.timeEntriesImport.filter(e=>e.userImportId===n[4].toString()&&e.projectImportId===n[10].toString()).length&&this.buildIngenicoSciformaXlsFileRow(n)}}buildIngenicoSciformaXlsFileRow(e){for(let t=11;t<e.length;t++)if(0!=+e[t]){const n=new u.XZ;this.timeEntriesImportCount++,n.timeEntryImportId=this.timeEntriesImportCount,n.formatId=this.selectedImportFormatId,n.userImportId=e[4].toString(),n.userImportName=e[1].toString(),n.projectImportId=e[10].toString(),n.projectImportName=e[10].toString(),n.timeEntryImportDate=this.daysHeaders[t-11],n.timeEntryImportAmount=Math.round(1e4*+e[t])/1e4,n.timeEntryImportComment="",this.timeEntriesImport.push(n)}}excelDateToJSDate(e){const t=86400*Math.floor(e-25569),n=new Date(1e3*t);return new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0)}saveTimeEntriesImport(){void 0!==this.fileName&&void 0!==this.selectedImportFormatId?(this.timesheetService.savingTimeEntriesImport.next(),this.timesheetService.saveTimeEntriesImport(this.timeEntriesImport,this.currentUser.userId).subscribe(()=>{this.timesheetService.reloadTimeEntriesImport.next(),this.notificationService.info("File load completed.<br>Please take note that only your subordinates will be loaded.")},()=>{this.timesheetService.reloadTimeEntriesImport.next(),this.notificationService.danger("File load failed.")}),this.close()):this.notificationService.danger("Please fill all required fields")}close(){this.dialogRef.close()}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.Cv),c.\u0275\u0275directiveInject(r.gq),c.\u0275\u0275directiveInject(l.so))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-load"]],decls:26,vars:4,consts:[[1,"form-container"],[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],[1,"row"],[1,"col-sm-12"],["placeholder","Import Format","name","importFormat","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"row","m-t-20"],[1,"col-sm-10"],["placeholder","File Name *","matInput","","name","fileName","disabled","","required","",3,"ngModel","ngModelChange"],[1,"col-sm-2"],[1,"btn","btn-sm","btn-primary","waves-light","ripple","file-upload-button",2,"font-size","inherit"],["type","file","accept",".xlsx",3,"change"],["fileInput",""],[1,"icofont","icofont-folder-open",2,"font-size","medium"],[1,"modal_footer"],[1,"pull-right"],["type","button",1,"btn","btn-outline-primary","m-r-5",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","click"],[3,"value"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"form",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"div",2),c.\u0275\u0275elementStart(3,"span"),c.\u0275\u0275text(4," Load "),c.\u0275\u0275elementStart(5,"em",3),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(6,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(7,"div",4),c.\u0275\u0275elementStart(8,"div",5),c.\u0275\u0275elementStart(9,"mat-form-field",6),c.\u0275\u0275elementStart(10,"mat-select",7),c.\u0275\u0275listener("ngModelChange",function(e){return t.selectedImportFormatId=e}),c.\u0275\u0275template(11,$e,2,2,"mat-option",8),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(12,"div",9),c.\u0275\u0275elementStart(13,"mat-form-field",10),c.\u0275\u0275elementStart(14,"input",11),c.\u0275\u0275listener("ngModelChange",function(e){return t.fileName=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(15,"div",12),c.\u0275\u0275elementStart(16,"button",13),c.\u0275\u0275elementStart(17,"input",14,15),c.\u0275\u0275listener("change",function(e){return t.fileLoad(e)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(19,"em",16),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(20,"div",17),c.\u0275\u0275elementStart(21,"div",18),c.\u0275\u0275elementStart(22,"button",19),c.\u0275\u0275listener("click",function(){return t.close()}),c.\u0275\u0275text(23,"Cancel"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(24,"button",20),c.\u0275\u0275listener("click",function(){return t.saveTimeEntriesImport()}),c.\u0275\u0275text(25,"Load"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(10),c.\u0275\u0275property("ngModel",t.selectedImportFormatId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",t.importFormatsIdentifiers),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngModel",t.fileName),c.\u0275\u0275advance(10),c.\u0275\u0275property("disabled",!t.readyToLoad))},directives:[a.\u0275NgNoValidate,a.NgControlStatusGroup,a.NgForm,S.KE,G.gD,a.RequiredValidator,a.NgControlStatus,a.NgModel,o.NgForOf,y.Nt,a.DefaultValueAccessor,Y.ey],styles:['.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.modal_body[_ngcontent-%COMP%]{height:190px;padding:25px;overflow-y:auto}.modal_footer[_ngcontent-%COMP%]{padding:25px}.file-upload-button[_ngcontent-%COMP%]{overflow:hidden;position:relative}.file-upload-button[_ngcontent-%COMP%]:after{content:"load";color:#fff;font-size:1.5rem;text-align:center}.file-upload-button[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{font-size:100px;left:0;opacity:0;position:absolute;top:0}']}),e})();var He=n(60657),We=n(19992),Ge=n(69517),Ye=n(39924),Xe=n(11494),Je=n(32789);function qe(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",14),c.\u0275\u0275text(1,"Date"),c.\u0275\u0275elementEnd())}function Qe(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-cell"),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275pipe(3,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",c.\u0275\u0275pipeBind1(3,1,e.timeEntryImportDate)," ")}}function Ke(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",14),c.\u0275\u0275text(1,"Hours"),c.\u0275\u0275elementEnd())}function Ze(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-cell"),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",e.timeEntryImportAmount," ")}}function et(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell"),c.\u0275\u0275text(1,"Comment"),c.\u0275\u0275elementEnd())}function tt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-cell",15),c.\u0275\u0275elementStart(1,"span",16),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275propertyInterpolate("matTooltip",e.timeEntryImportComment),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",e.timeEntryImportComment," ")}}function nt(e,t){1&e&&c.\u0275\u0275element(0,"mat-header-row",17)}function it(e,t){1&e&&c.\u0275\u0275element(0,"mat-row")}function rt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-cell",18),c.\u0275\u0275elementStart(1,"strong",19),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate(e.userImportName)}}function ot(e,t){1&e&&c.\u0275\u0275element(0,"mat-row")}const st=function(){return["groupHeader"]};let at=(()=>{class e{constructor(e,t,n,i,r){this.timesheetService=e,this.sortService=t,this.groupsService=n,this.dialog=i,this.data=r,this.displayedColumns=["timeEntryImportDate","timeEntryImportAmount","timeEntryImportComment"],this.groupByColumns=["userImportName"],this.dataSource=new Je.by}ngOnInit(){this.dataSource=new Je.by(this.groupsService.addGroups(this.data,this.groupByColumns)),this.subscription=this.timesheetService.sortedTimeEntriesImport.subscribe(()=>{this.dataSource=new Je.by(this.groupsService.addGroups(this.data,this.groupByColumns))})}ngOnDestroy(){this.subscription.unsubscribe()}isGroup(e,t){return t.level}onSortData(e){e.active&&""!==e.direction&&void 0!==this.data&&(this.data.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"timeEntryImportDate":return this.sortService.compare(t.timeEntryImportDate,n.timeEntryImportDate,i,!1);case"timeEntryImportAmount":return this.sortService.compare(t.timeEntryImportAmount,n.timeEntryImportAmount,i,!0);default:return 0}}),this.timesheetService.sortedTimeEntriesImport.next())}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.Kx),c.\u0275\u0275directiveInject(r.Jc),c.\u0275\u0275directiveInject(l.uw),c.\u0275\u0275directiveInject(l.WI))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-timeentries-import"]],viewQuery:function(e,t){if(1&e&&c.\u0275\u0275viewQuery(Xe.YE,7),2&e){let e;c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.sort=e.first)}},decls:16,vars:7,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","timeEntryImportDate"],["mat-sort-header","",4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","timeEntryImportAmount"],["matColumnDef","timeEntryImportComment"],[4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999",4,"matCellDef"],[4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],[1,"table-primary","table-*"],["colspan","999"],[1,"strong"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-table",0,1),c.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),c.\u0275\u0275elementContainerStart(2,2),c.\u0275\u0275template(3,qe,2,0,"mat-header-cell",3),c.\u0275\u0275template(4,Qe,4,3,"mat-cell",4),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(5,5),c.\u0275\u0275template(6,Ke,2,0,"mat-header-cell",3),c.\u0275\u0275template(7,Ze,3,1,"mat-cell",4),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(8,6),c.\u0275\u0275template(9,et,2,0,"mat-header-cell",7),c.\u0275\u0275template(10,tt,3,2,"mat-cell",8),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275template(11,nt,1,0,"mat-header-row",9),c.\u0275\u0275template(12,it,1,0,"mat-row",10),c.\u0275\u0275elementContainerStart(13,11),c.\u0275\u0275template(14,rt,3,1,"mat-cell",12),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275template(15,ot,1,0,"mat-row",13),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275property("dataSource",t.dataSource),c.\u0275\u0275advance(11),c.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),c.\u0275\u0275advance(1),c.\u0275\u0275property("matRowDefColumns",t.displayedColumns),c.\u0275\u0275advance(3),c.\u0275\u0275property("matRowDefColumns",c.\u0275\u0275pureFunction0(6,st))("matRowDefWhen",t.isGroup))},directives:[Je.BZ,Xe.YE,Je.w1,Je.fO,Je.Dz,Je.as,Je.nj,Je.ge,Xe.nU,Je.ev,Z.gM,Je.XQ,Je.Gk],pipes:[O.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.header-align[_ngcontent-%COMP%]{display:flex;justify-content:center}  .mat-sort-header-arrow{color:#fff}.strong[_ngcontent-%COMP%]{background:-webkit-linear-gradient(#5a5a5a,black);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-timeEntryImportDate[_ngcontent-%COMP%]{flex:0 0 15%!important;width:15%;text-align:center;justify-content:center}.mat-column-timeEntryImportAmount[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%;text-align:center;justify-content:center}.mat-column-groupHeader[_ngcontent-%COMP%]{color:#030303;background-color:#eceaea;font-weight:bolder;font-size:medium;font-family:Arial,Helvetica,sans-serif}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.input-date[_ngcontent-%COMP%]{width:55%}.disabled-color[_ngcontent-%COMP%]{color:#aaa}"]}),e})();const lt=["userSelect"];function ct(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"User Import"),c.\u0275\u0275elementEnd())}function dt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",24),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span",25),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275propertyInterpolate("matTooltip",e.userImportName),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate(e.userImportName)}}function mt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"User TelnetTeam"),c.\u0275\u0275elementEnd())}function ht(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"span",25),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.userName," ")}}function pt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-option",33),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275property("value",e.id),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.description," ")}}function ut(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-select",28,29),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().$implicit.userId=t})("selectionChange",function(){c.\u0275\u0275restoreView(e);const t=c.\u0275\u0275nextContext().$implicit;return c.\u0275\u0275nextContext().onUserSelect(t)}),c.\u0275\u0275elementStart(2,"mat-option"),c.\u0275\u0275elementStart(3,"ngx-mat-select-search",30),c.\u0275\u0275elementStart(4,"mat-icon",31),c.\u0275\u0275text(5,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(6,pt,2,2,"mat-option",32),c.\u0275\u0275pipe(7,"async"),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275property("ngModel",e.userId),c.\u0275\u0275advance(3),c.\u0275\u0275property("formControl",t.usersFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No users found"),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngForOf",c.\u0275\u0275pipeBind1(7,5,t.filteredUsersIdentifiers))}}function ft(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",24),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275template(1,ht,2,1,"span",26),c.\u0275\u0275template(2,ut,8,7,"mat-select",27),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275propertyInterpolate("matTooltip",e.userName),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",!e.edited),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",e.edited)}}function gt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",34),c.\u0275\u0275text(1,"Project Import"),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275property("hidden",e.hiddenPojectImport)}}function St(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",35),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span",25),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275propertyInterpolate("matTooltip",e.projectImportName),c.\u0275\u0275property("hidden",n.hiddenPojectImport),c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",e.projectImportName," ")}}function yt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"Project TelnetTeam"),c.\u0275\u0275elementEnd())}function vt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"span",25),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.projectName," ")}}function Et(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-option",33),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275property("value",e.id),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.description," ")}}function It(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-select",37,29),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().$implicit.projectId=t})("selectionChange",function(){c.\u0275\u0275restoreView(e);const t=c.\u0275\u0275nextContext().$implicit;return c.\u0275\u0275nextContext().onProjectSelect(t)}),c.\u0275\u0275elementStart(2,"mat-option"),c.\u0275\u0275elementStart(3,"ngx-mat-select-search",30),c.\u0275\u0275elementStart(4,"mat-icon",31),c.\u0275\u0275text(5,"close"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(6,Et,2,2,"mat-option",32),c.\u0275\u0275pipe(7,"async"),c.\u0275\u0275elementEnd()}if(2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275property("ngModel",e.projectId),c.\u0275\u0275advance(3),c.\u0275\u0275property("formControl",t.projectsFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No projects found"),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngForOf",c.\u0275\u0275pipeBind1(7,5,t.filteredProjectsIdentifiers))}}function Ct(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",24),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275template(1,vt,2,1,"span",26),c.\u0275\u0275template(2,It,8,7,"mat-select",36),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275propertyInterpolate("matTooltip",e.projectName),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",!(e.edited&&null!==e.userId)),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",e.edited&&null!==e.userId)}}function bt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"From"),c.\u0275\u0275elementEnd())}function xt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",38),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275pipe(3,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",c.\u0275\u0275pipeBind1(3,1,e.fromDate)," ")}}function wt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"To"),c.\u0275\u0275elementEnd())}function Mt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",38),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275pipe(3,"shortDate"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",c.\u0275\u0275pipeBind1(3,1,e.toDate)," ")}}function Pt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"MDays"),c.\u0275\u0275elementEnd())}function Dt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",38),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",e.manDays," ")}}function kt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",23),c.\u0275\u0275text(1,"Hours"),c.\u0275\u0275elementEnd())}function Ot(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",38),c.\u0275\u0275listener("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodDisplay(t)}),c.\u0275\u0275elementStart(1,"span"),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275advance(2),c.\u0275\u0275textInterpolate1("",e.total," ")}}function Tt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell"),c.\u0275\u0275text(1,"Ok"),c.\u0275\u0275elementEnd())}function Ft(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell"),c.\u0275\u0275elementStart(1,"mat-checkbox",39),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e).$implicit.confirmed=t})("change",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().onConfirmedChange(t)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngModel",e.confirmed)("disabled",!0)}}function jt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"mat-header-cell",40),c.\u0275\u0275text(1,"Edit"),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275property("hidden",e.hideEdit)}}function _t(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"mat-cell",40),c.\u0275\u0275elementStart(1,"mat-checkbox",41),c.\u0275\u0275listener("ngModelChange",function(t){return c.\u0275\u0275restoreView(e).$implicit.edited=t})("click",function(){const t=c.\u0275\u0275restoreView(e).$implicit;return c.\u0275\u0275nextContext().timeEntryImportPeriodEdit(t)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275property("hidden",n.hideEdit),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngModel",e.edited)}}function Nt(e,t){1&e&&c.\u0275\u0275element(0,"mat-header-row",42)}function Rt(e,t){1&e&&c.\u0275\u0275element(0,"mat-row")}let At=(()=>{class e{constructor(e,t,n,i,r){this.timesheetService=e,this.coreDataService=t,this.dialog=n,this.searchFilterService=i,this.dateTimeService=r,this.displayedColumns=["userImportName","userId","projectImportName","projectId","fromDate","toDate","manDays","total","confirmed","edited"],this.dataSource=new Je.by,this.usersIdentifiers=[],this.filteredUsersIdentifiers=new h.tq(1),this.usersFilterCtrl=new a.FormControl,this.projectsIdentifiers=[],this.filteredProjectsIdentifiers=new h.tq(1),this.projectsFilterCtrl=new a.FormControl,this.hiddenPojectImport=!0,this.hideEdit=!0,this._onDestroy=new h.xQ,this.checked=!0}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.timeEntriesImportPeriod.forEach(e=>{this.hiddenPojectImport=this.hiddenPojectImport&&null===e.projectImportId,this.hideEdit=this.hideEdit&&0===e.formatId}),this.dataSource=new Je.by(this.timeEntriesImportPeriod),this.searchFilterService.resultChanged.subscribe(()=>{this.dataSource=new Je.by(this.searchFilterService.showingDataLastFilter)}),this.getSubordinates(),this.usersFilterCtrl.valueChanges.pipe((0,p.R)(this._onDestroy)).subscribe(()=>{this.filterUsers()}),this.getProjects(),this.projectsFilterCtrl.valueChanges.pipe((0,p.R)(this._onDestroy)).subscribe(()=>{this.filterProjects()})}ngOnDestroy(){this._onDestroy.next(),this._onDestroy.complete()}getSubordinates(){this.coreDataService.getSubordinates(this.currentUser.userId).subscribe(e=>{this.currentUser=JSON.parse(localStorage.getItem("currentUser"));const t=new f.x;t.id=+this.currentUser.userId,t.description=this.currentUser.lastName+" "+this.currentUser.firstName+" ("+this.currentUser.userNumber+")",this.usersIdentifiers=e,this.usersIdentifiers.unshift(t),this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice())})}filterUsers(){if(!this.usersIdentifiers)return;let e=this.usersFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredUsersIdentifiers.next(this.usersIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice())}onUserSelect(e){this.timesheetService.updateImportUser(e,this.currentUser.userId).subscribe(()=>{this.filteredUsersIdentifiers.next(this.usersIdentifiers.slice()),this.timesheetService.reloadTimeEntriesImport.next()})}getProjects(){this.timesheetService.getUserActiveProjects(this.currentUser.userId).subscribe(e=>{this.projectsIdentifiers=e,this.filteredProjectsIdentifiers.next(this.projectsIdentifiers.slice())})}filterProjects(){if(!this.projectsIdentifiers)return;let e=this.projectsFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredProjectsIdentifiers.next(this.projectsIdentifiers.filter(t=>t.description.toLowerCase().indexOf(e)>-1))):this.filteredProjectsIdentifiers.next(this.projectsIdentifiers.slice())}onProjectSelect(e){this.timesheetService.updateImportProject(e,this.currentUser.userId).subscribe(()=>{this.filteredProjectsIdentifiers.next(this.projectsIdentifiers.slice()),this.timesheetService.reloadTimeEntriesImport.next()})}onConfirmedChange(e){this.timesheetService.updateImportConfirmed(e,this.currentUser.userId).subscribe(()=>{this.timesheetService.reloadTimeEntriesImport.next()},()=>{this.timesheetService.reloadTimeEntriesImport.next()})}onSortData(){this.timesheetService.sortTimeEntriesImportPeriod.next(this.sort)}dateOnly(e){return this.dateTimeService.dateOnly(e)}timeEntryImportPeriodEdit(e){this.timesheetService.editTimeEntryImportPeriod.next(e)}timeEntryImportPeriodDisplay(e){!1===e.edited&&this.timesheetService.getTimeEntriesImport(e.formatId,e.userImportId,e.userImportName,e.projectId,this.currentUser.userId).subscribe(e=>{this.displayEditdialogRef=this.dialog.open(at,{disableClose:!1,hasBackdrop:!0,width:"800px",data:e})})}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(r.YY),c.\u0275\u0275directiveInject(l.uw),c.\u0275\u0275directiveInject(r.nJ),c.\u0275\u0275directiveInject(r.Cv))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-timeentries-import-period"]],viewQuery:function(e,t){if(1&e&&(c.\u0275\u0275viewQuery(lt,7),c.\u0275\u0275viewQuery(Xe.YE,7)),2&e){let e;c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.userSelect=e.first),c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{timeEntriesImportPeriod:"timeEntriesImportPeriod"},decls:34,vars:4,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","userImportName"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip","click",4,"matCellDef"],["matColumnDef","userId"],["matColumnDef","projectImportName"],["mat-sort-header","",3,"hidden",4,"matHeaderCellDef"],[3,"hidden","matTooltip","click",4,"matCellDef"],["matColumnDef","projectId"],["matColumnDef","fromDate"],[3,"click",4,"matCellDef"],["matColumnDef","toDate"],["matColumnDef","manDays"],["matColumnDef","total"],["matColumnDef","confirmed"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","edited"],[3,"hidden",4,"matHeaderCellDef"],[3,"hidden",4,"matCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip","click"],[1,"span-ellipsis"],["class","span-ellipsis",4,"ngIf"],["placeholder","Select user",3,"ngModel","ngModelChange","selectionChange",4,"ngIf"],["placeholder","Select user",3,"ngModel","ngModelChange","selectionChange"],["userSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["mat-sort-header","",3,"hidden"],[3,"hidden","matTooltip","click"],["placeholder","Select project",3,"ngModel","ngModelChange","selectionChange",4,"ngIf"],["placeholder","Select project",3,"ngModel","ngModelChange","selectionChange"],[3,"click"],[2,"height","20px",3,"ngModel","disabled","ngModelChange","change"],[3,"hidden"],[2,"height","20px",3,"ngModel","ngModelChange","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"mat-table",0,1),c.\u0275\u0275listener("matSortChange",function(){return t.onSortData()}),c.\u0275\u0275elementContainerStart(2,2),c.\u0275\u0275template(3,ct,2,0,"mat-header-cell",3),c.\u0275\u0275template(4,dt,3,2,"mat-cell",4),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(5,5),c.\u0275\u0275template(6,mt,2,0,"mat-header-cell",3),c.\u0275\u0275template(7,ft,3,3,"mat-cell",4),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(8,6),c.\u0275\u0275template(9,gt,2,1,"mat-header-cell",7),c.\u0275\u0275template(10,St,3,3,"mat-cell",8),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(11,9),c.\u0275\u0275template(12,yt,2,0,"mat-header-cell",3),c.\u0275\u0275template(13,Ct,3,3,"mat-cell",4),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(14,10),c.\u0275\u0275template(15,bt,2,0,"mat-header-cell",3),c.\u0275\u0275template(16,xt,4,3,"mat-cell",11),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(17,12),c.\u0275\u0275template(18,wt,2,0,"mat-header-cell",3),c.\u0275\u0275template(19,Mt,4,3,"mat-cell",11),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(20,13),c.\u0275\u0275template(21,Pt,2,0,"mat-header-cell",3),c.\u0275\u0275template(22,Dt,3,1,"mat-cell",11),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(23,14),c.\u0275\u0275template(24,kt,2,0,"mat-header-cell",3),c.\u0275\u0275template(25,Ot,3,1,"mat-cell",11),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(26,15),c.\u0275\u0275template(27,Tt,2,0,"mat-header-cell",16),c.\u0275\u0275template(28,Ft,2,2,"mat-cell",17),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275elementContainerStart(29,18),c.\u0275\u0275template(30,jt,2,1,"mat-header-cell",19),c.\u0275\u0275template(31,_t,2,2,"mat-cell",20),c.\u0275\u0275elementContainerEnd(),c.\u0275\u0275template(32,Nt,1,0,"mat-header-row",21),c.\u0275\u0275template(33,Rt,1,0,"mat-row",22),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275property("dataSource",t.dataSource),c.\u0275\u0275advance(32),c.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),c.\u0275\u0275advance(1),c.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Je.BZ,Xe.YE,Je.w1,Je.fO,Je.Dz,Je.as,Je.nj,Je.ge,Xe.nU,Je.ev,Z.gM,o.NgIf,G.gD,a.NgControlStatus,a.NgModel,Y.ey,X.nu,a.FormControlDirective,E.Hw,X.w5,o.NgForOf,v.oG,Je.XQ,Je.Gk],pipes:[o.AsyncPipe,O.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.header-align[_ngcontent-%COMP%]{display:flex;justify-content:center}  .mat-sort-header-arrow{color:#fff}.strong[_ngcontent-%COMP%]{background:-webkit-linear-gradient(#5a5a5a,black);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-fromDate[_ngcontent-%COMP%]{flex:0 0 5%!important;width:5%;text-align:center;justify-content:center}.mat-column-toDate[_ngcontent-%COMP%]{flex:0 0 5%!important;width:5%;text-align:center;justify-content:center}.mat-column-manDays[_ngcontent-%COMP%]{flex:0 0 4%!important;width:4%;text-align:center;justify-content:center}.mat-column-total[_ngcontent-%COMP%]{flex:0 0 4%!important;width:4%;text-align:center;justify-content:center}.mat-column-confirmed[_ngcontent-%COMP%]{flex:0 0 4%!important;width:4%;text-align:center;justify-content:center}.mat-column-edited[_ngcontent-%COMP%]{flex:0 0 4%!important;width:4%;text-align:center;justify-content:center}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.input-date[_ngcontent-%COMP%]{width:55%}.disabled-color[_ngcontent-%COMP%]{color:#aaa}"]}),e})();var Ut=n(34239);function Vt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",33),c.\u0275\u0275elementStart(1,"div",34),c.\u0275\u0275elementStart(2,"div",35),c.\u0275\u0275elementStart(3,"div",1),c.\u0275\u0275elementStart(4,"div",36),c.\u0275\u0275element(5,"mat-spinner"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function Lt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",37),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().openUploadDialog()}),c.\u0275\u0275element(1,"em",38),c.\u0275\u0275text(2," Load "),c.\u0275\u0275elementEnd()}}function zt(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",39),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().deleteTimeEntriesImport()}),c.\u0275\u0275element(1,"em",40),c.\u0275\u0275text(2," Delete "),c.\u0275\u0275elementEnd()}}function $t(e,t){if(1&e){const e=c.\u0275\u0275getCurrentView();c.\u0275\u0275elementStart(0,"button",39),c.\u0275\u0275listener("click",function(){return c.\u0275\u0275restoreView(e),c.\u0275\u0275nextContext().importTimeEntries()}),c.\u0275\u0275element(1,"em",41),c.\u0275\u0275text(2," Import "),c.\u0275\u0275elementEnd()}}function Bt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275elementStart(1,"h1"),c.\u0275\u0275text(2,"No Result Found"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function Ht(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"div",42),c.\u0275\u0275element(1,"app-timeentries-import-period",43),c.\u0275\u0275pipe(2,"paginator"),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("timeEntriesImportPeriod",c.\u0275\u0275pipeBind3(2,1,e.timeEntriesImportPeriod,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))}}const Wt=n(49457);let Gt=(()=>{class e{constructor(e,t,n,i,r,o){this.dialog=e,this.timesheetService=t,this.sortService=n,this.searchFilterService=i,this.notificationService=r,this.dateTimeService=o,this.isLoading=!0,this.importSearch=new u.o5,this.statuses=[{id:0,description:"Not Ok"},{id:1,description:"Ok"}],this.timeEntriesImportPeriodConfirmed=!1,this.emptyResult=!1,this.dropdownSettingsStatus={},this.paginatorPipe=new Le.Ry(this.searchFilterService)}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.timesheetService.sortTimeEntriesImportPeriod.subscribe(e=>{this.onSortData(e)}),this.timesheetService.editTimeEntryImportPeriod.subscribe(e=>{this.editTimeEntryImportPeriod(e)}),this.dropdownSettingsStatus={singleSelection:!1,idField:"id",textField:"description",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.searchFilterService.resultChanged.subscribe(()=>{setTimeout(()=>{this.emptyResult=0===this.searchFilterService.showingDataLastFilter.length})}),this.listView=!1;const e=JSON.parse(sessionStorage.getItem("importSearch"));null!==e&&(this.importSearch=Object.assign(e,u.o5)),this.getTimeEntriesImportPeriod(),this.timesheetService.savingTimeEntriesImport.subscribe(()=>{this.isLoading=!0}),this.timesheetService.reloadTimeEntriesImport.subscribe(()=>{this.getTimeEntriesImportPeriod()})}ngOnDestroy(){this.searchFilterService.showingDataLastFilter=[],this.searchFilterService.periodFrom=null,this.searchFilterService.periodTo=null,this.dialog.closeAll()}openUploadDialog(){this.uploadDialogRef=this.dialog.open(Be,{disableClose:!1,panelClass:"form_modal",width:"450px",height:"320px",hasBackdrop:!0,data:{}})}downloadImportTimesheetTelnetFormatTemplate(){Wt.saveAs("./assets/docs/ImportTimesheetTelnetFormatTemplate.xlsx","Import Timesheet Telnet Format Template")}searchTimeEntriesImport(){this.updateSessionStorage(),this.getTimeEntriesImportPeriod()}updateSessionStorage(){sessionStorage.setItem("importSearch",JSON.stringify(this.importSearch))}isImportSearchEmpty(){return void 0===this.importSearch.userName&&void 0===this.importSearch.projectName&&void 0===this.importSearch.selectedStatusesIdentifiers&&void 0===this.importSearch.periodFrom&&void 0===this.importSearch.periodTo}getTimeEntriesImportPeriod(){this.searchFilterService.pageIndex=0,this.timesheetService.getTimeEntriesImportPeriod(this.importSearch,this.currentUser.userId).subscribe(e=>{this.timeEntriesImportPeriod=[];let t=0;e.forEach(e=>{this.timeEntriesImportPeriod.push(Object.assign(new u.Jn,e)),1===e.confirmed&&t++}),this.timeEntriesImportPeriodLength=this.timeEntriesImportPeriod.length,this.timeEntriesImportPeriodConfirmed=0!==this.timeEntriesImportPeriod.length&&this.timeEntriesImportPeriodLength===t,this.importSearchEmpty=this.isImportSearchEmpty(),this.emptyResult=!1,this.listView=!0,this.isLoading=!1})}deleteTimeEntriesImport(){this.timesheetService.deleteTimeEntriesImport(this.currentUser.userId).subscribe(()=>{this.importSearch=new u.o5,sessionStorage.removeItem("importSearch"),this.getTimeEntriesImportPeriod(),this.notificationService.success("Delete successful.")},()=>{this.notificationService.danger("Delete failed.")})}importTimeEntries(){const e=this.timeEntriesImportPeriod.filter((e,t,n)=>n.findIndex(t=>t.userId===e.userId)===t);let t=0,n=0;const i=[];e.forEach(r=>{this.timesheetService.importUserTimeEntries(r.userId,this.currentUser.userId).subscribe(o=>{0!==o?t+=1:(n+=1,i.push(r.userName)),t+n===e.length&&(this.getTimeEntriesImportPeriod(),0!==n?this.notificationService.warning("Import failed, may be some users are not imported:<br>- "+i.join(",<br>- ")+"."):this.notificationService.success("Import successful."))},()=>{n+=1,i.push(r.userName),t+n===e.length&&(this.getTimeEntriesImportPeriod(),this.notificationService.warning("Import failed, may be some users are not imported:<br>- "+i.join(",<br>- ")+"."))})})}dateFormat(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}dateOnly(e){return this.dateTimeService.dateOnly(e)}onClickingEnter(e){"Enter"===e.key&&this.searchTimeEntriesImport()}onResetAllFilters(){this.importSearch=new u.o5,sessionStorage.removeItem("importSearch"),this.getTimeEntriesImportPeriod()}onSortData(e){e.active&&""!==e.direction&&void 0!==this.timeEntriesImportPeriod&&this.timeEntriesImportPeriod.sort((t,n)=>{const i="asc"===e.direction;switch(e.active){case"userImportId":return this.sortService.compare(t.userImportId,n.userImportId,i,!1);case"userImportName":return this.sortService.compare(t.userImportName,n.userImportName,i,!1);case"userId":return this.sortService.compare(t.userName,n.userName,i,!1);case"projectImportId":return this.sortService.compare(t.projectImportId,n.projectImportId,i,!1);case"projectImportName":return this.sortService.compare(t.projectImportName,n.projectImportName,i,!1);case"projectId":return this.sortService.compare(t.projectName,n.projectName,i,!1);case"fromDate":return this.sortService.compare(t.fromDate,n.fromDate,i,!1);case"toDate":return this.sortService.compare(t.toDate,n.toDate,i,!1);case"manDays":return this.sortService.compare(t.manDays,n.manDays,i,!0);case"total":return this.sortService.compare(t.total,n.total,i,!0);default:return 0}}),this.paginatorPipe.transform(this.timeEntriesImportPeriod,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}editTimeEntryImportPeriod(e){this.timeEntriesImportPeriod.filter(e=>!0===e.edited).forEach(t=>{(t.userImportId!==e.userImportId||t.projectImportId!==e.projectImportId)&&(t.edited=!1)})}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(l.uw),c.\u0275\u0275directiveInject(i.r4),c.\u0275\u0275directiveInject(He.K),c.\u0275\u0275directiveInject(r.nJ),c.\u0275\u0275directiveInject(r.gq),c.\u0275\u0275directiveInject(r.Cv))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-import"]],decls:61,vars:26,consts:[[1,"page-body"],[1,"row"],["class","overlay",4,"ngIf"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","keydown","ngModelChange"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From",3,"matDatepicker","max","ngModel","keypress","ngModelChange"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To",3,"matDatepicker","min","ngModel","keypress","ngModelChange"],["picker22",""],[1,"col-xl-3","col-lg-12"],[1,"col-sm-10"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button","matTooltip","Telnet Format Template",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-upload-alt",2,"font-size","medium"],["type","button","class","btn btn-sm btn-primary m-r-10","style","font-size:inherit;",3,"click",4,"ngIf"],["type","submit","class","btn btn-sm btn-primary m-r-10","style","font-size:inherit;",3,"click",4,"ngIf"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],["type","button",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],["type","submit",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-trash",2,"font-size","medium"],[1,"fa","fa-arrow-circle-right",2,"font-size","medium"],[1,"example-container","mat-elevation-z8"],[3,"timeEntriesImportPeriod"]],template:function(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275template(2,Vt,6,0,"div",2),c.\u0275\u0275elementStart(3,"div",3),c.\u0275\u0275elementStart(4,"div",4),c.\u0275\u0275elementStart(5,"div",5),c.\u0275\u0275elementStart(6,"div",1),c.\u0275\u0275elementStart(7,"div",6),c.\u0275\u0275elementStart(8,"mat-list"),c.\u0275\u0275elementStart(9,"mat-list-item"),c.\u0275\u0275elementStart(10,"h3",7),c.\u0275\u0275text(11,"User"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(12,"mat-form-field",8),c.\u0275\u0275elementStart(13,"input",9),c.\u0275\u0275listener("keydown",function(e){return t.onClickingEnter(e)})("ngModelChange",function(e){return t.importSearch.userName=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(14,"mat-list-item"),c.\u0275\u0275elementStart(15,"h3",7),c.\u0275\u0275text(16,"Period"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(17,"mat-form-field",10),c.\u0275\u0275elementStart(18,"input",11),c.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.importSearch.periodFrom=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(19,"mat-datepicker-toggle",12),c.\u0275\u0275element(20,"mat-datepicker",null,13),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"mat-form-field",10),c.\u0275\u0275elementStart(23,"input",14),c.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.importSearch.periodTo=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(24,"mat-datepicker-toggle",12),c.\u0275\u0275element(25,"mat-datepicker",null,15),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(27,"div",6),c.\u0275\u0275elementStart(28,"mat-list"),c.\u0275\u0275elementStart(29,"mat-list-item"),c.\u0275\u0275elementStart(30,"h3",7),c.\u0275\u0275text(31,"Project"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(32,"mat-form-field",8),c.\u0275\u0275elementStart(33,"input",9),c.\u0275\u0275listener("keydown",function(e){return t.onClickingEnter(e)})("ngModelChange",function(e){return t.importSearch.projectName=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(34,"div",16),c.\u0275\u0275elementStart(35,"mat-list"),c.\u0275\u0275elementStart(36,"mat-list-item"),c.\u0275\u0275elementStart(37,"h3",7),c.\u0275\u0275text(38,"Status"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(39,"div",17),c.\u0275\u0275elementStart(40,"ng-multiselect-dropdown",18),c.\u0275\u0275listener("ngModelChange",function(e){return t.importSearch.selectedStatusesIdentifiers=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(41,"div",19),c.\u0275\u0275elementStart(42,"div",20),c.\u0275\u0275elementStart(43,"button",21),c.\u0275\u0275listener("click",function(){return t.searchTimeEntriesImport()}),c.\u0275\u0275text(44,"Search"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(45,"div",20),c.\u0275\u0275elementStart(46,"button",22),c.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),c.\u0275\u0275text(47,"Reset"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(48,"nav",23),c.\u0275\u0275elementStart(49,"div",24),c.\u0275\u0275elementStart(50,"button",25),c.\u0275\u0275listener("click",function(){return t.downloadImportTimesheetTelnetFormatTemplate()}),c.\u0275\u0275element(51,"em",26),c.\u0275\u0275text(52," Template "),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(53,Lt,3,0,"button",27),c.\u0275\u0275template(54,zt,3,0,"button",28),c.\u0275\u0275template(55,$t,3,0,"button",28),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(56,"div",29),c.\u0275\u0275element(57,"app-paginator",30),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(58,Bt,3,0,"div",31),c.\u0275\u0275elementStart(59,"div"),c.\u0275\u0275template(60,Ht,3,5,"div",32),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275reference(21),n=c.\u0275\u0275reference(26);c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",t.isLoading),c.\u0275\u0275advance(1),c.\u0275\u0275classProp("blurred",t.isLoading),c.\u0275\u0275advance(10),c.\u0275\u0275property("ngModel",t.importSearch.userName),c.\u0275\u0275advance(5),c.\u0275\u0275property("matDatepicker",e)("max",t.importSearch.periodTo)("ngModel",t.importSearch.periodFrom),c.\u0275\u0275advance(1),c.\u0275\u0275property("for",e),c.\u0275\u0275advance(4),c.\u0275\u0275property("matDatepicker",n)("min",t.importSearch.periodFrom)("ngModel",t.importSearch.periodTo),c.\u0275\u0275advance(1),c.\u0275\u0275property("for",n),c.\u0275\u0275advance(9),c.\u0275\u0275property("ngModel",t.importSearch.projectName),c.\u0275\u0275advance(7),c.\u0275\u0275property("placeholder","Select...")("settings",t.dropdownSettingsStatus)("data",t.statuses)("ngModel",t.importSearch.selectedStatusesIdentifiers)("settings",t.dropdownSettingsStatus),c.\u0275\u0275advance(13),c.\u0275\u0275property("ngIf",t.importSearchEmpty&&void 0!==t.timeEntriesImportPeriodLength&&0===t.timeEntriesImportPeriodLength),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",void 0!==t.timeEntriesImportPeriodLength&&0!==t.timeEntriesImportPeriodLength),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.importSearchEmpty&&t.timeEntriesImportPeriodConfirmed),c.\u0275\u0275advance(2),c.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.timeEntriesImportPeriodLength),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.emptyResult&&t.listView),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngIf",t.listView&&!t.emptyResult)}},directives:[o.NgIf,We.i$,We.Tg,S.KE,y.Nt,a.DefaultValueAccessor,a.NgControlStatus,a.NgModel,$.hl,$.nW,S.R9,$.Mq,Me.OP,Ge.M2,Z.gM,Ye.J,H.$g,At],pipes:[Ut.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.date-field{font-size:14px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.material-icons{font-size:25px}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e})();var Yt=n(60040);function Xt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"th",10),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275nextContext();c.\u0275\u0275attribute("colspan",n.displayedSubColumnsNamesCount),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",n.getColumnHeader(e)," ")}}function Jt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"th",11),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",n.displayedSubColumns[e]," ")}}function qt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",19),c.\u0275\u0275text(1),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275nextContext(2).$implicit,i=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",i.getTotalSubColumnValue(e,n)," ")}}function Qt(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr",15),c.\u0275\u0275elementStart(1,"td",16),c.\u0275\u0275elementStart(2,"span",17),c.\u0275\u0275text(3),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(4,"td",16),c.\u0275\u0275template(5,qt,2,1,"td",18),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(3),c.\u0275\u0275textInterpolate1(" ",e.activityName," "),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngForOf",t.displayedSubColumns)}}function Kt(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275text(1," - "),c.\u0275\u0275elementEnd())}function Zt(e,t){if(1&e&&c.\u0275\u0275text(0),2&e){const e=c.\u0275\u0275nextContext(2).$implicit;c.\u0275\u0275textInterpolate1(" ",e.userIdentifier," ")}}function en(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275text(1," - "),c.\u0275\u0275elementEnd())}function tn(e,t){if(1&e&&c.\u0275\u0275text(0),2&e){const e=c.\u0275\u0275nextContext().index,t=c.\u0275\u0275nextContext(2).$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275textInterpolate1(" ",n.getTotalSubColumnValue(e,t),"")}}function nn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",19),c.\u0275\u0275template(1,en,2,0,"div",22),c.\u0275\u0275template(2,tn,1,1,"ng-template",null,23,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275reference(3),i=c.\u0275\u0275nextContext(2).$implicit,r=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",-1==r.getTotalSubColumnValue(e,i))("ngIfElse",n)}}function rn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr",20),c.\u0275\u0275elementStart(1,"td",21),c.\u0275\u0275template(2,Kt,2,0,"div",22),c.\u0275\u0275template(3,Zt,1,1,"ng-template",null,23,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(5,"td"),c.\u0275\u0275template(6,nn,4,2,"td",18),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275reference(4),t=c.\u0275\u0275nextContext().$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275propertyInterpolate1("matTooltip"," ",t.projectName,""),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",-1==n.getTotalSubColumnValue(n.i,t))("ngIfElse",e),c.\u0275\u0275advance(4),c.\u0275\u0275property("ngForOf",n.displayedSubColumns)}}function on(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275text(1," - "),c.\u0275\u0275elementEnd())}function sn(e,t){if(1&e&&c.\u0275\u0275text(0),2&e){const e=c.\u0275\u0275nextContext().index,t=c.\u0275\u0275nextContext(2).$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275textInterpolate(n.getSubColumnValue(e,t))}}function an(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",19),c.\u0275\u0275template(1,on,2,0,"div",22),c.\u0275\u0275template(2,sn,1,1,"ng-template",null,23,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275reference(3),i=c.\u0275\u0275nextContext(2).$implicit,r=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",-1==r.getSubColumnValue(e,i))("ngIfElse",n)}}function ln(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275elementStart(1,"td",24),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(3,"td"),c.\u0275\u0275template(4,an,4,2,"td",18),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.projectName,""),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.projectName," "),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngForOf",t.displayedSubColumns)}}function cn(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275text(1," - "),c.\u0275\u0275elementEnd())}function dn(e,t){if(1&e&&c.\u0275\u0275text(0),2&e){const e=c.\u0275\u0275nextContext().index,t=c.\u0275\u0275nextContext(2).$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275textInterpolate(n.getSubColumnValue(e,t))}}function mn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",19),c.\u0275\u0275template(1,cn,2,0,"div",22),c.\u0275\u0275template(2,dn,1,1,"ng-template",null,23,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275reference(3),i=c.\u0275\u0275nextContext(2).$implicit,r=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",-1==r.getSubColumnValue(e,i))("ngIfElse",n)}}function hn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275elementStart(1,"td",25),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275element(3,"td"),c.\u0275\u0275template(4,mn,4,2,"td",18),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.projectName,""),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.projectName," "),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngForOf",t.displayedSubColumns)}}function pn(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275text(1," - "),c.\u0275\u0275elementEnd())}function un(e,t){if(1&e&&c.\u0275\u0275text(0),2&e){const e=c.\u0275\u0275nextContext().index,t=c.\u0275\u0275nextContext(2).$implicit,n=c.\u0275\u0275nextContext();c.\u0275\u0275textInterpolate(n.getSubColumnValue(e,t))}}function fn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"td",19),c.\u0275\u0275template(1,pn,2,0,"div",22),c.\u0275\u0275template(2,un,1,1,"ng-template",null,23,c.\u0275\u0275templateRefExtractor),c.\u0275\u0275elementEnd()),2&e){const e=t.index,n=c.\u0275\u0275reference(3),i=c.\u0275\u0275nextContext(2).$implicit,r=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",-1==r.getSubColumnValue(e,i))("ngIfElse",n)}}function gn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tr"),c.\u0275\u0275elementStart(1,"td",26),c.\u0275\u0275text(2),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(3,"td",27),c.\u0275\u0275text(4),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(5,fn,4,2,"td",18),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext().$implicit,t=c.\u0275\u0275nextContext();c.\u0275\u0275advance(1),c.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.projectName,""),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.projectName," "),c.\u0275\u0275advance(1),c.\u0275\u0275propertyInterpolate1("matTooltip"," ",e.customerName,""),c.\u0275\u0275advance(1),c.\u0275\u0275textInterpolate1(" ",e.customerName," "),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",t.displayedSubColumns)}}function Sn(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"tbody"),c.\u0275\u0275template(1,Qt,6,2,"tr",12),c.\u0275\u0275template(2,rn,7,4,"tr",13),c.\u0275\u0275template(3,ln,5,3,"tr",14),c.\u0275\u0275template(4,hn,5,3,"tr",14),c.\u0275\u0275template(5,gn,6,5,"tr",14),c.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",1==e.level),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",2==e.level),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",null==e.level&&0===e.projectActivityId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",null==e.level&&0!==e.projectActivityId&&e.projectActivityId!==e.activityId),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",null==e.level&&0!==e.projectActivityId&&e.projectActivityId===e.activityId)}}let yn=(()=>{class e{constructor(e,t,n,i){this.dialog=e,this.timeEntryResourceGroupService=t,this.dateTimeService=n,this.numberFormatter=i,this.displayedColumns=["userIdentifier"],this.displayedSubColumns=[],this.displayedSubColumnsNames=["Load MD"],this.displayedSubColumnsNamesCount=this.displayedSubColumnsNames.length,this.monthNames=["Jan ","Feb ","Mar ","Apr ","May ","Jun ","Jul ","Aug ","Sep ","Oct ","Nov ","Dec "],this.monthColumnsHeaders=[],this.timeEntryResourcesGrouped=[]}ngOnInit(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.buildColmnsHeader(),this.listView=!0}ngOnChanges(){(null!==this.timeEntryResources||void 0!==this.timeEntryResources)&&(this.timeEntryResourcesGrouped=this.timeEntryResourceGroupService.getTimeEntryResourcesGrouped(this.timeEntryResources,this.timeEntryResourcesFiltred,this.monthsCount))}buildColmnsHeader(){if((null!==this.timeEntryResources||void 0!==this.timeEntryResources)&&this.timeEntryResources.length>0){const e=this.timeEntryResources[0].monthsTimeEntryResource.length;for(let t=0;t<e;t++){this.displayedColumns.push("M"+t);const e=this.timeEntryResources[0].monthsTimeEntryResource[this.getMonthIndex(t)].month-1,n=this.timeEntryResources[0].monthsTimeEntryResource[this.getMonthIndex(t)].year;isNaN(e)?this.monthColumnsHeaders.push("Total"):this.monthColumnsHeaders.push(this.monthNames[e]+n),this.displayedSubColumns=this.displayedSubColumns.concat(this.displayedSubColumnsNames)}}}getMonthIndex(e){return Math.floor(e)}getMonthDetailsIndex(e){return Math.floor(e/this.displayedSubColumnsNamesCount)}getColumnHeader(e){return this.monthColumnsHeaders[e]}getSubColumnValue(e,t){const n=e%this.displayedSubColumnsNamesCount,i=Math.floor(e/this.displayedSubColumnsNamesCount);if(void 0!==t.monthsTimeEntryResource[i])switch(n){case 0:return this.numberFormatter.round(t.monthsTimeEntryResource[i].monthLoad,1)}}getTotalSubColumnValue(e,t){const n=e%this.displayedSubColumnsNamesCount,i=Math.floor(e/this.displayedSubColumnsNamesCount);if(void 0!==t.monthsTimeEntryResource[i])switch(n){case 0:return this.numberFormatter.round(t.monthsTimeEntryResource[i].monthLoad,1)}}dateOnly(e){return this.dateTimeService.dateOnly(e)}datePipe(e){return"0001-01-01T00:00:00"===e?"":e}format(e){return 0===e?"":e}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(l.uw),c.\u0275\u0275directiveInject(i.ml),c.\u0275\u0275directiveInject(r.Cv),c.\u0275\u0275directiveInject(Ee.e))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-resource"]],viewQuery:function(e,t){if(1&e&&c.\u0275\u0275viewQuery(Xe.YE,7),2&e){let e;c.\u0275\u0275queryRefresh(e=c.\u0275\u0275loadQuery())&&(t.sort=e.first)}},inputs:{timeEntryResources:"timeEntryResources",timeEntryResourcesFiltred:"timeEntryResourcesFiltred",monthsCount:"monthsCount"},features:[c.\u0275\u0275NgOnChangesFeature],decls:12,vars:3,consts:[[1,"table","table-bordered"],[2,"padding","0px"],[1,"th"],[1,"th-first"],["rowspan","2","scope","col",1,"th-third"],["rowspan","2","scope","col"],["id","monthHeader",4,"ngFor","ngForOf"],[1,"th-second"],["id","subColumns",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],["id","monthHeader"],["id","subColumns"],["style","background-color: lightgoldenrodyellow;",4,"ngIf"],["style","background-color: rgb(178, 240, 248);",4,"ngIf"],[4,"ngIf"],[2,"background-color","lightgoldenrodyellow"],[1,"td-first"],[1,"span-ellipsis"],["style","text-align: center;",4,"ngFor","ngForOf"],[2,"text-align","center"],[2,"background-color","rgb(178, 240, 248)"],[1,"td-second",3,"matTooltip"],[4,"ngIf","ngIfElse"],["elseBlock",""],[1,"td-third",2,"width","15%","color","rgb(0, 184, 83)",3,"matTooltip"],[1,"td-third",2,"width","15%","color","rgb(255, 81, 0)",3,"matTooltip"],[1,"td-third",2,"width","15%",3,"matTooltip"],[1,"td-third",2,"width","10%",3,"matTooltip"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"table",0),c.\u0275\u0275element(1,"caption",1),c.\u0275\u0275elementStart(2,"thead",2),c.\u0275\u0275elementStart(3,"tr",3),c.\u0275\u0275elementStart(4,"th",4),c.\u0275\u0275text(5,"Activity / Resource / Project"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(6,"th",5),c.\u0275\u0275text(7,"Customer"),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(8,Xt,2,2,"th",6),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(9,"tr",7),c.\u0275\u0275template(10,Jt,2,1,"th",8),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(11,Sn,6,5,"tbody",9),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(8),c.\u0275\u0275property("ngForOf",t.monthColumnsHeaders),c.\u0275\u0275advance(2),c.\u0275\u0275property("ngForOf",t.displayedSubColumns),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngForOf",t.timeEntryResourcesGrouped))},directives:[o.NgForOf,o.NgIf,Z.gM],styles:["thead[_ngcontent-%COMP%]   tr.th-first[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;top:0;background:#3f629d;z-index:2}thead[_ngcontent-%COMP%]   tr.th-second[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;top:43px;background:#3f629d;z-index:2}thead[_ngcontent-%COMP%]   th.th-third[_ngcontent-%COMP%]{width:17%;left:0;background:#3f629d;z-index:3!important}tbody[_ngcontent-%COMP%]   td.td-first[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;left:0;background:lightgoldenrodyellow;z-index:1}tbody[_ngcontent-%COMP%]   td.td-second[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;left:0;background:#b2f0f8;z-index:1}tbody[_ngcontent-%COMP%]   td.td-third[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;left:0;background:white;z-index:1}.th[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6;font-size:.9em}#subColumns[_ngcontent-%COMP%]{margin-bottom:-10px;width:calc(100% - 1.2em);background-color:#3f629d;color:#fff;border-top:1px solid #dee2e6;border-bottom:none;font-weight:normal;font-size:.85em;text-align:center}#monthHeader[_ngcontent-%COMP%]{text-align:center}td[_ngcontent-%COMP%]{font-size:.85em;overflow:hidden;text-overflow:ellipsis;max-width:80px;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6}.tr[_ngcontent-%COMP%]{text-align:center}"]}),e})();function vn(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div"),c.\u0275\u0275elementStart(1,"h1"),c.\u0275\u0275text(2,"No Result Found"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function En(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",29),c.\u0275\u0275elementStart(1,"div",30),c.\u0275\u0275elementStart(2,"div",31),c.\u0275\u0275elementStart(3,"div",1),c.\u0275\u0275elementStart(4,"div",32),c.\u0275\u0275element(5,"mat-spinner"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd())}function In(e,t){if(1&e&&(c.\u0275\u0275elementStart(0,"div",33),c.\u0275\u0275element(1,"app-resource",34),c.\u0275\u0275pipe(2,"paginator"),c.\u0275\u0275elementEnd()),2&e){const e=c.\u0275\u0275nextContext();c.\u0275\u0275classProp("blurred",e.isLoading),c.\u0275\u0275advance(1),c.\u0275\u0275property("timeEntryResources",c.\u0275\u0275pipeBind3(2,5,e.timeEntryResources,e.searchFilterService.pageIndex,e.searchFilterService.pageSize))("timeEntryResourcesFiltred",e.timeEntryResources)("monthsCount",e.monthsCount)}}const Cn=[{path:"",data:{title:"TimeSheet",function:g.FI.Timesheet,status:!1},canActivate:[ye.a1],children:[{path:"timeentry",component:Se,data:{title:"Time Entry",icon:"icon-home",caption:"",function:g.FI.TimeEntry,status:!0},canActivate:[ye.a1]},{path:"board",component:Ve,data:{title:"Board",icon:"icon-home",caption:"",function:g.FI.Board,status:!0},canActivate:[ye.a1]},{path:"import",component:Gt,data:{title:"Import",icon:"icon-home",caption:"",function:g.FI.TimeEntry,status:!0},canActivate:[ye.a1]},{path:"resource-report",component:(()=>{class e{constructor(e){this.emptyResult=!1,this.timeEntryResourcesGrouped=[],this.listView=!1,this.isSuperAdmin=!1,this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.dropdownSettings={},this.dropDownSelected=!1,this.searchFilterService=new r.nJ,this.paginatorPipe=new Le.Ry(this.searchFilterService),this.subscription=new h.w0,this.monthNames=["January ","February ","March ","April ","May ","June ","July ","August ","September ","October ","November ","December "],this.subColumnsNames=["Load MD"],this.dialog=e.get(l.uw),this.sortService=e.get(r.Kx),this.searchFilterService=e.get(r.nJ),this.excelService=e.get(r.xB),this.timesheetService=e.get(i.r4),this.timeEntryResourceGroupService=e.get(i.ml),this.projectService=e.get(Ie.Y4),this.dateTimeService=e.get(r.Cv),this.numberFormatter=e.get(Ee.e),this.notificationService=e.get(r.gq)}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.isSuperAdmin=this.currentUser.groupId===g.Fl.SuperAdmin,this.getActivities(),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!0,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!1,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.subscription.add(this.timesheetService.reloadTimeEntryResource.subscribe(()=>{const e=JSON.parse(sessionStorage.getItem("timeEntryResourceSearch")),t=e.selectedActivitiesIdentifiers.map(e=>e.id).join(",");this.getTimeEntryResource(t,"",e.timeEntryResourceStartDate,e.timeEntryResourceEndDate)})),this.timeEntryResourcesLength=0,this.getActivities(),this.subscription.add(this.searchFilterService.resultChanged.subscribe(()=>{setTimeout(()=>{this.emptyResult=0===this.searchFilterService.showingDataLastFilter.length})}))}onDropDownClose(){this.dropDownSelected&&(this.dropDownSelected=!1,this.selectedActivitiesIds="",this.selectedActivitiesIdentifiers.length!==this.activitiesIdentifiers.length&&(this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(",")),this.getActivityCustomers(Number(this.selectedActivitiesIds)))}onActivityDeSelect(e){this.selectedActivitiesIdentifiers=this.activitiesIdentifiers.filter(t=>t.id===e.id)}getActivityCustomers(e){this.timesheetService.getActivityCustomers(e).subscribe(e=>{this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.selectedCustomersIds="",null!=e&&(this.customersIdentifiers=e)})}onCustomerDeSelect(e){this.selectedCustomersIdentifiers=this.customersIdentifiers.filter(t=>t.id===e.id)}ngOnDestroy(){this.subscription.unsubscribe()}onResetActivity(){this.selectedActivitiesIdentifiers=[]}getActivities(){this.projectService.getActivities().subscribe(e=>{null!=e&&(this.activitiesIdentifiers=e,this.selectedActivitiesIdentifiers=this.activitiesIdentifiers.filter(e=>e.id===this.currentUser.activityId),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),this.setSearchFilter(),this.getActivityCustomers(Number(this.selectedActivitiesIds)))})}setSearchFilter(){const e=JSON.parse(sessionStorage.getItem("timeEntryResourceSearch"));if(e)e.selectedActivitiesIdentifiers&&e.selectedActivitiesIdentifiers.length>0&&(this.selectedActivitiesIdentifiers=e.selectedActivitiesIdentifiers),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),null!=e.timeEntryResourceStartDate&&(this.timeEntryResourceStartDate=new Date(e.timeEntryResourceStartDate),this.minDate=this.timeEntryResourceStartDate),null!=e.timeEntryResourceEndDate&&(this.timeEntryResourceEndDate=new Date(e.timeEntryResourceEndDate),this.maxDate=this.timeEntryResourceEndDate);else{this.selectedActivitiesIdentifiers=this.activitiesIdentifiers.filter(e=>e.id===this.currentUser.activityId);const e=this.dateTimeService.today();this.timeEntryResourceStartDate=V([e.getFullYear(),e.getMonth()]).toDate(),this.timeEntryResourceEndDate=V(e).endOf("month").toDate(),this.minDate=this.timeEntryResourceStartDate,this.maxDate=this.timeEntryResourceEndDate}}searchTimeEntryResource(){if(this.selectedCustomersIdentifiers&&this.selectedCustomersIdentifiers.length>0){this.searchFilterService.pageIndex=0,this.timeEntryResources=[],this.timeEntryResourcesLength=0,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(","),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(e=>e.id).join(","),this.emptyResult=!0,this.listView=!1;const e=new u.AQ;e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,e.timeEntryResourceStartDate=this.timeEntryResourceStartDate,e.timeEntryResourceEndDate=this.timeEntryResourceEndDate,sessionStorage.setItem("timeEntryResourceSearch",JSON.stringify(e)),this.computeStartMonthandYear(),this.getTimeEntryResource(this.selectedActivitiesIds,this.selectedCustomersIds,this.timeEntryResourceStartDate,this.timeEntryResourceEndDate)}else this.notificationService.danger("You should select a customer")}getTimeEntryResource(e,t,n,i){this.isLoading=!0,this.timesheetService.getTimeEntryResource(e,t,n,i).subscribe(e=>{if(null!=e)if(this.isLoading=!1,this.prepareTimeEntryResources(e),this.timeEntryResourcesLength=this.timeEntryResources.length,this.emptyResult=!1,this.listView=!0,0===this.timeEntryResources.length)this.emptyResult=!0;else{const e=this.timeEntryResourceGroupService.getTimeEntryResourcesGrouped(this.timeEntryResources,this.timeEntryResources,this.monthsCount);this.timeEntryResourcesGrouped=JSON.parse(JSON.stringify(e)),this.emptyResult=!1}},()=>{this.isLoading=!1,this.notificationService.danger("TimeEntry resource not loaded.")})}prepareTimeEntryResources(e){e.forEach(e=>{const t=this.timeEntryResources.findIndex(t=>t.activityId===e.activityId&&t.projectId===e.projectId&&t.userId===e.userId);if(-1!==t)this.timeEntryResources[t]=this.prepareTimeEntryResource(this.timeEntryResources[t],e);else{const t=this.createTimeEntryResource(this.startMonth,this.startYear,this.monthsCount);this.timeEntryResources.push(this.prepareTimeEntryResource(t,e))}})}computeStartMonthandYear(){this.startMonth=this.timeEntryResourceStartDate.getMonth(),this.startYear=this.timeEntryResourceStartDate.getFullYear(),this.computeMonthsCount()}computeMonthsCount(){this.monthsCount=12*(this.timeEntryResourceEndDate.getFullYear()-this.timeEntryResourceStartDate.getFullYear()),this.monthsCount-=this.timeEntryResourceStartDate.getMonth(),this.monthsCount+=this.timeEntryResourceEndDate.getMonth()+1}prepareTimeEntryResource(e,t){e.activityId=t.activityId,e.activityName=t.activityName,e.customerId=t.customerId,e.customerName=t.customerName,e.projectId=t.projectId,e.projectName=t.projectName,e.projectActivityId=t.projectActivityId,e.userId=t.userId,e.userIdentifier=t.userIdentifier,e.userNumber=t.userNumber,e.fullName=t.fullName;const n=e.monthsTimeEntryResource.findIndex(e=>e.month===t.month&&e.year===t.year);return-1!==n&&(e.monthsTimeEntryResource[n].monthLoad=this.numberFormatter.round(t.monthLoad,1)),e}createTimeEntryResource(e,t,n){const i=new u.lr(n);for(let r=0;r<n;r++)e+r<12?(i.monthsTimeEntryResource[r].month=e+r+1,i.monthsTimeEntryResource[r].year=t):(i.monthsTimeEntryResource[r].month=e+r+1-12,i.monthsTimeEntryResource[r].year=t+1);return i}exportToExcel(){if(void 0!==this.timeEntryResources&&0!==this.timeEntryResources.length){const e=[],t=[],n=this.subColumnsNames.length,i=[],r=[];e.push({header:"",key:"A",width:25}),e.push({header:"",key:"B",width:8}),e.push({header:"",key:"C",width:25}),e.push({header:"",key:"D",width:30}),e.push({header:"",key:"E",width:25});let o=["Activity","Matricule","Resource","Project","Customer"];r.push({cell:"A2",font:{bold:!0}},{cell:"B2",font:{bold:!0}},{cell:"C2",font:{bold:!0}},{cell:"D2",font:{bold:!0}},{cell:"E2",font:{bold:!0}}),this.timeEntryResourcesGrouped[0].monthsTimeEntryResource.forEach(t=>{this.subColumnsNames.forEach(n=>{e.push({header:void 0!==t.month?this.monthNames[t.month-1].toString()+" "+t.year.toString():"Total",key:n+t.monthIndex,width:20}),o.push(n)}),i.push(this.getExcelColumn(6+n*t.monthIndex)+"1:"+this.getExcelColumn(5+n*(t.monthIndex+1))+"1"),r.push({cell:this.getExcelColumn(6+n*t.monthIndex)+"1",font:{bold:!0},alignment:{vertical:"middle",horizontal:"center"}});let s=0;this.subColumnsNames.forEach(()=>{r.push({cell:this.getExcelColumn(6+n*t.monthIndex+s)+"2",font:{bold:!0},alignment:{vertical:"middle",horizontal:"center"}}),s++})}),t.push(o),this.timeEntryResourcesGrouped.forEach(e=>{o=[],o.push(e.activityName),o.push(e.userNumber),o.push(e.fullName),o.push(e.projectName),o.push(e.customerName),e.monthsTimeEntryResource.forEach(e=>{o.push(this.formatNullOrEmptyValue(e.monthLoad))}),t.push(o)}),this.excelService.generateExcel(e,t,i,r,"TimeEntry_Resource")}}formatNullOrEmptyValue(e){return""===e||null===e?0:e}getExcelColumn(e){const t=26,n=e%t==0?Math.floor(e/t)-1:Math.floor(e/t),i=e%t==0?t:e%t;return e<=t?String.fromCharCode(i+64):String.fromCharCode(n+64)+String.fromCharCode(i+64)}dateFormat(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}dateOnly(e){return this.dateTimeService.dateOnly(e)}daysChangePeriodFrom(e){const t=new Date(e);this.timeEntryResourceStartDate=V([t.getFullYear(),t.getMonth()]).toDate(),this.minDate=this.timeEntryResourceStartDate,this.computeMonthsCount(),this.monthsCount>12&&(this.timeEntryResourceEndDate=V([t.getFullYear(),t.getMonth()]).add(11,"months").endOf("month").toDate(),this.maxDate=this.timeEntryResourceEndDate,this.notificationService.warning("Period can not be more then 12 months!"))}daysChangePeriodTo(e){const t=new Date(e);this.timeEntryResourceEndDate=V(t).endOf("month").toDate(),this.maxDate=this.timeEntryResourceEndDate,this.computeMonthsCount(),this.monthsCount>12&&(this.timeEntryResourceStartDate=V([t.getFullYear(),t.getMonth()]).add(-11,"months").endOf("month").toDate(),this.minDate=this.timeEntryResourceStartDate,this.notificationService.warning("Period can not be more then 12 months!"))}}return e.\u0275fac=function(t){return new(t||e)(c.\u0275\u0275directiveInject(c.Injector))},e.\u0275cmp=c.\u0275\u0275defineComponent({type:e,selectors:[["app-time-entry-resource"]],decls:45,vars:19,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"search-input","col-sm-5"],[3,"selectedDate","maxDate","daysChange"],[3,"selectedDate","minDate","daysChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","disabled","onDeSelect","ngModelChange","click","onDropDownClose"],[1,"col-xl-3","col-lg-12"],[1,"mat-subheader","col-sm-3"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","onDeSelect","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],[1,"div-scrollable"],["class","overlay",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"loaded-content"],[3,"timeEntryResources","timeEntryResourcesFiltred","monthsCount"]],template:function(e,t){1&e&&(c.\u0275\u0275elementStart(0,"div",0),c.\u0275\u0275elementStart(1,"div",1),c.\u0275\u0275elementStart(2,"div",2),c.\u0275\u0275elementStart(3,"div",3),c.\u0275\u0275elementStart(4,"div",4),c.\u0275\u0275elementStart(5,"div",1),c.\u0275\u0275elementStart(6,"div",5),c.\u0275\u0275elementStart(7,"mat-list"),c.\u0275\u0275elementStart(8,"mat-list-item"),c.\u0275\u0275elementStart(9,"h3",6),c.\u0275\u0275text(10,"Period"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(11,"div",7),c.\u0275\u0275elementStart(12,"app-select-month",8),c.\u0275\u0275listener("daysChange",function(e){return t.daysChangePeriodFrom(e)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(13,"div",7),c.\u0275\u0275elementStart(14,"app-select-month",9),c.\u0275\u0275listener("daysChange",function(e){return t.daysChangePeriodTo(e)}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(15,"div",5),c.\u0275\u0275elementStart(16,"mat-list"),c.\u0275\u0275elementStart(17,"mat-list-item"),c.\u0275\u0275elementStart(18,"h3",6),c.\u0275\u0275text(19,"Activity"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(20,"div",10),c.\u0275\u0275elementStart(21,"ng-multiselect-dropdown",11),c.\u0275\u0275listener("onDeSelect",function(e){return t.onActivityDeSelect(e)})("ngModelChange",function(e){return t.selectedActivitiesIdentifiers=e})("click",function(){return t.dropDownSelected=!0})("onDropDownClose",function(){return t.onDropDownClose()}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(22,"div",12),c.\u0275\u0275elementStart(23,"mat-list"),c.\u0275\u0275elementStart(24,"mat-list-item"),c.\u0275\u0275elementStart(25,"h3",13),c.\u0275\u0275text(26,"Customer"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(27,"div",10),c.\u0275\u0275elementStart(28,"ng-multiselect-dropdown",14),c.\u0275\u0275listener("onDeSelect",function(e){return t.onCustomerDeSelect(e)})("ngModelChange",function(e){return t.selectedCustomersIdentifiers=e}),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(29,"div",15),c.\u0275\u0275elementStart(30,"div",16),c.\u0275\u0275elementStart(31,"button",17),c.\u0275\u0275listener("click",function(){return t.searchTimeEntryResource()}),c.\u0275\u0275text(32,"Search"),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(33,"nav",18),c.\u0275\u0275elementStart(34,"div",19),c.\u0275\u0275elementStart(35,"button",20),c.\u0275\u0275listener("click",function(){return t.exportToExcel()}),c.\u0275\u0275element(36,"em",21),c.\u0275\u0275text(37," Export "),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementStart(38,"div",22),c.\u0275\u0275element(39,"app-paginator",23),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275template(40,vn,3,0,"div",24),c.\u0275\u0275elementStart(41,"div",25),c.\u0275\u0275elementStart(42,"div",26),c.\u0275\u0275template(43,En,6,0,"div",27),c.\u0275\u0275template(44,In,3,9,"div",28),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd(),c.\u0275\u0275elementEnd()),2&e&&(c.\u0275\u0275advance(12),c.\u0275\u0275property("selectedDate",t.timeEntryResourceStartDate)("maxDate",t.maxDate),c.\u0275\u0275advance(2),c.\u0275\u0275property("selectedDate",t.timeEntryResourceEndDate)("minDate",t.minDate),c.\u0275\u0275advance(7),c.\u0275\u0275property("placeholder","Select...")("data",t.activitiesIdentifiers)("ngModel",t.selectedActivitiesIdentifiers)("settings",t.dropdownSettings)("disabled",!t.isSuperAdmin),c.\u0275\u0275advance(7),c.\u0275\u0275property("placeholder","Select...")("data",t.customersIdentifiers)("ngModel",t.selectedCustomersIdentifiers)("settings",t.dropdownSettings),c.\u0275\u0275advance(11),c.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.timeEntryResourcesLength),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.emptyResult&&t.listView),c.\u0275\u0275advance(3),c.\u0275\u0275property("ngIf",t.isLoading),c.\u0275\u0275advance(1),c.\u0275\u0275property("ngIf",t.listView&&!t.emptyResult))},directives:[We.i$,We.Tg,Yt.j,Me.OP,a.NgControlStatus,a.NgModel,Ge.M2,Ye.J,o.NgIf,H.$g,yn],pipes:[Ut.R],styles:[".search-input[_ngcontent-%COMP%]{font-size:14px}.multi-search[_ngcontent-%COMP%]{width:100%}.mat-list[_ngcontent-%COMP%]   .mat-subheader[_ngcontent-%COMP%]{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.div-scrollable[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:auto;min-height:217px;max-height:calc(100vh - 342px)}.wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"]}),e})(),data:{title:"Resource Report",icon:"icon-home",caption:"",function:g.FI.TimeEntryReport,status:!0},canActivate:[ye.a1]}]}];let bn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({imports:[[m.Bz.forChild(Cn)],m.Bz]}),e})(),xn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({imports:[[o.CommonModule,s.m,a.FormsModule,a.ReactiveFormsModule,s.q,Me.ZQ.forRoot()]]}),e})();var wn=n(91841),Mn=n(36332);let Pn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({imports:[[o.CommonModule]]}),e})(),Dn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({providers:[r.nJ],imports:[[o.CommonModule,s.m,a.FormsModule,a.ReactiveFormsModule,s.q,l.Is,Me.ZQ.forRoot(),wn.HttpClientModule,Mn.o,Pn]]}),e})(),kn=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({providers:[i.ml],imports:[[o.CommonModule,s.m,a.FormsModule,a.ReactiveFormsModule,s.q,l.Is,Me.ZQ.forRoot(),wn.HttpClientModule]]}),e})(),On=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=c.\u0275\u0275defineInjector({providers:[i.r4,r.gq],imports:[[o.CommonModule,s.m,Me.ZQ.forRoot(),Dn,xn,d,kn,bn]]}),e})()},85718:function(e,t,n){n.d(t,{x:function(){return i}});class i{}},55750:function(e,t,n){n.d(t,{Ry:function(){return i.R}});var i=n(34239);n(62758)},34239:function(e,t,n){n.d(t,{R:function(){return o}});var i=n(37716),r=n(10337);let o=(()=>{class e{constructor(e){this.searchFilterService=e}transform(e,t,n){if(this.startIndex=t*(n*this.searchFilterService.rowSpan)+1,this.endIndex=n*this.searchFilterService.rowSpan*(t+1),null!=e)return this.searchFilterService.showingDataLastFilter=e.slice(this.startIndex-1,this.endIndex),this.searchFilterService.resultChanged.next(),e.slice(this.startIndex-1,this.endIndex)}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(r.nJ,16))},e.\u0275pipe=i.\u0275\u0275definePipe({name:"paginator",type:e,pure:!0}),e})()},39924:function(e,t,n){n.d(t,{J:function(){return p}});var i=n(37716),r=n(99692),o=n(10337),s=n(98295),a=n(67441),l=n(3679),c=n(38583),d=n(72458);function m(e,t){if(1&e&&(i.\u0275\u0275elementStart(0,"mat-option",6),i.\u0275\u0275text(1),i.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;i.\u0275\u0275property("value",e),i.\u0275\u0275advance(1),i.\u0275\u0275textInterpolate(e)}}const h=function(){return[6,12,24,60,120]};let p=(()=>{class e{constructor(e){this.searchFilterService=e,this.disabled=!1,this.hidePageSize=!1,this.showFirstLastButtons=!1,this.page=new i.EventEmitter}set pageIndexChanged(e){this.pageIndex=e,this.updateGoto()}set lengthChanged(e){this.length=e,this.updateGoto()}set pageSizeChanged(e){this.pageSize=e,this.updateGoto()}ngOnInit(){this.updateGoto()}onPaginateChange(e){this.searchFilterService.pageIndex=e.pageIndex,this.searchFilterService.pageSize=e.pageSize,this.length=e.length,this.pageIndex=e.pageIndex,this.pageSize=e.pageSize,this.updateGoto(),this.emitPageEvent(e)}updateGoto(){this.goTo=(this.pageIndex||0)+1,this.pageNumbers=[];const e=Math.ceil(this.length/this.pageSize);for(let t=1;t<=e;t++)this.pageNumbers.push(t)}goToChange(){this.paginator.pageIndex=this.goTo-1,this.searchFilterService.pageIndex=this.paginator.pageIndex,this.searchFilterService.pageSize=this.paginator.pageSize,this.emitPageEvent({length:this.paginator.length,pageIndex:this.paginator.pageIndex,pageSize:this.paginator.pageSize})}emitPageEvent(e){this.page.next(e)}}return e.\u0275fac=function(t){return new(t||e)(i.\u0275\u0275directiveInject(o.nJ))},e.\u0275cmp=i.\u0275\u0275defineComponent({type:e,selectors:[["app-paginator"]],viewQuery:function(e,t){if(1&e&&i.\u0275\u0275viewQuery(r.NW,7),2&e){let e;i.\u0275\u0275queryRefresh(e=i.\u0275\u0275loadQuery())&&(t.paginator=e.first)}},inputs:{length:"length",pageIndex:"pageIndex",pageSize:"pageSize",disabled:"disabled",hidePageSize:"hidePageSize",pageSizeOptions:"pageSizeOptions",showFirstLastButtons:"showFirstLastButtons",pageIndexChanged:["pageIndex","pageIndexChanged"],lengthChanged:["length","lengthChanged"],pageSizeChanged:["pageSize","pageSizeChanged"]},outputs:{page:"page"},decls:8,vars:8,consts:[[1,"d-flex"],[3,"length","pageSize","pageIndex","pageSizeOptions","showFirstLastButtons","page"],[1,"go-to-container"],[1,"go-to-label"],[3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(e,t){1&e&&(i.\u0275\u0275elementStart(0,"div",0),i.\u0275\u0275elementStart(1,"mat-paginator",1),i.\u0275\u0275listener("page",function(e){return t.onPaginateChange(e)}),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(2,"div",2),i.\u0275\u0275elementStart(3,"div",3),i.\u0275\u0275text(4,"Go To: "),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementStart(5,"mat-form-field"),i.\u0275\u0275elementStart(6,"mat-select",4),i.\u0275\u0275listener("ngModelChange",function(e){return t.goTo=e})("selectionChange",function(){return t.goToChange()}),i.\u0275\u0275template(7,m,2,2,"mat-option",5),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd(),i.\u0275\u0275elementEnd()),2&e&&(i.\u0275\u0275advance(1),i.\u0275\u0275property("length",t.length)("pageSize",t.pageSize)("pageIndex",t.pageIndex)("pageSizeOptions",i.\u0275\u0275pureFunction0(7,h))("showFirstLastButtons",!0),i.\u0275\u0275advance(5),i.\u0275\u0275property("ngModel",t.goTo),i.\u0275\u0275advance(1),i.\u0275\u0275property("ngForOf",t.pageNumbers))},directives:[r.NW,s.KE,a.gD,l.NgControlStatus,l.NgModel,c.NgForOf,d.ey],styles:['.mat-paginator[_ngcontent-%COMP%]{width:100%;float:right}.d-flex[_ngcontent-%COMP%]{display:flex}  .mat-select-trigger{font-size:12px}  .mat-option{font-size:12px}.go-to-container[_ngcontent-%COMP%]{display:flex;align-items:baseline;background:white}.go-to-container[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:56px;margin:6px 4px 0;font-size:12px;font-family:Roboto,"Helvetica Neue",sans-serif}.go-to-container[_ngcontent-%COMP%]   .go-to-label[_ngcontent-%COMP%]{width:36px;margin:0 4px;font-size:12px;color:#0000008a;font-family:Roboto,"Helvetica Neue",sans-serif}']}),e})()}}]);
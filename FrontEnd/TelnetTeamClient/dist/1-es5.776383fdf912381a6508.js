!function(){"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function t(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[1],{35001:function(e,r,a){a.r(r),a.d(r,{ReservationModule:function(){return de}});var i=a(38583),s=a(88452),o=a(62028),d=a(63753),c=a(70833),l=function e(){n(this,e),this.deskId=0},u=a(82636),v=function(e,t,n,r){var a,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(a=e[o])&&(s=(i<3?a(s):i>3?a(t,n,s):a(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s};function m(e){return Reflect.metadata("type",e)}function p(e){return Reflect.metadata("dir",e)}function f(e){return Reflect.metadata("persisted",e)}var g,h=((g=h||(h={}))[g.Work=0]="Work",g[g.Holiday=1]="Holiday",g[g.Leave=2]="Leave",h),y=function e(){n(this,e),this.reservationId=0,this.userId=0,this.dayType=h.Work};v([m(u.sP.Decimal),p(u.Nm.InputOutput),f(!0)],y.prototype,"reservationId",void 0),v([m(u.sP.Decimal),p(u.Nm.Input),f(!0)],y.prototype,"userId",void 0),v([m(u.sP.Decimal),p(u.Nm.Input),f(!0)],y.prototype,"deskId",void 0),v([f(!1)],y.prototype,"deskName",void 0),v([m(u.sP.Date),p(u.Nm.Input),f(!0)],y.prototype,"reservationDate",void 0),v([f(!1)],y.prototype,"dayType",void 0);var k=function e(){n(this,e)},S=function e(){n(this,e),this.userId=0,this.reservations=[]},b=a(16738),C=a(88259),P=a.n(C),D=a(37716),w=a(51586),x=a(13409),I=a(10337),R=function(){var e=function(){function e(t,r){n(this,e),this.genericService=t,this.entityParameterService=r,this.refreshReservations=new x.Subject,this.selectCurrentWeek=new x.Subject,this.stopResourceReservationsGet=new x.Subject}return t(e,[{key:"getActivities",value:function(){var e=new w.u;return e.storedProcedureName="FOTT.GetActivities",e.cursorName="activityCurs",this.genericService.createService("/Data/Get",e)}},{key:"getSubordinatesByPeriod",value:function(e,t,n,r){var a=new Array;this.entityParameterService.AddEntityParameter(a,"userId",e,u.sP.Decimal,u.Nm.Input),this.entityParameterService.AddEntityParameter(a,"activitiesId",t,u.sP.Varchar2,u.Nm.Input),this.entityParameterService.AddEntityParameter(a,"periodFrom",n,u.sP.Date,u.Nm.Input),this.entityParameterService.AddEntityParameter(a,"periodTo",r,u.sP.Date,u.Nm.Input);var i=new w.u;return i.storedProcedureName="FOTT.GetSubordinatesByPeriod",i.entitiesParameters=new Array(a),i.cursorName="curs",this.genericService.createService("/Data/Get",i)}},{key:"getHolidaysByPeriod",value:function(e,t){var n=new Array;this.entityParameterService.AddEntityParameter(n,"periodFrom",e,u.sP.Date,u.Nm.Input),this.entityParameterService.AddEntityParameter(n,"periodTo",t,u.sP.Date,u.Nm.Input);var r=new w.u;return r.storedProcedureName="FOTT.GetHolidaysByPeriod",r.entitiesParameters=new Array(n),r.cursorName="curs",this.genericService.createService("/Data/Get",r)}},{key:"getResourcesLeavesByPeriod",value:function(e,t,n){var r=new Array;this.entityParameterService.AddEntityParameter(r,"userId",e,u.sP.Decimal,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodFrom",t,u.sP.Date,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodTo",n,u.sP.Date,u.Nm.Input);var a=new w.u;return a.storedProcedureName="FOTT.GetResourcesLeavesByPeriod",a.entitiesParameters=new Array(r),a.cursorName="curs",this.genericService.createService("/Data/Get",a)}},{key:"getReservedDesksByPeriod",value:function(e,t,n){var r=new Array;this.entityParameterService.AddEntityParameter(r,"userId",e,u.sP.Decimal,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodFrom",t,u.sP.Date,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodTo",n,u.sP.Date,u.Nm.Input);var a=new w.u;return a.storedProcedureName="FOTT.GetReservedDesksByPeriod",a.entitiesParameters=new Array(r),a.cursorName="curs",this.genericService.createService("/Data/Get",a)}},{key:"getResponsibleDesks",value:function(e){var t=new Array;this.entityParameterService.AddEntityParameter(t,"userId",e,u.sP.Decimal,u.Nm.Input);var n=new w.u;return n.storedProcedureName="FOTT.GetResponsibleDesks",n.entitiesParameters=new Array(t),n.cursorName="curs",this.genericService.createService("/Data/Get",n)}},{key:"updateReservationDesk",value:function(e){var t=new Array;this.entityParameterService.AddEntityParameters(t,e);var n=new w.u;return n.storedProcedureName="FOTT.UpdateReservationDesk",n.entitiesParameters=new Array(t),n.outputIdParameterName="reservationId",this.genericService.createService("/Data/Save",n)}},{key:"copyReservedDesksByPeriod",value:function(e,t,n){var r=new Array;this.entityParameterService.AddEntityParameter(r,"resourcesIds",e,u.sP.Varchar2,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodSource",t,u.sP.Varchar2,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodDestination",n,u.sP.Varchar2,u.Nm.Input),this.entityParameterService.AddEntityParameter(r,"reservationsCopied",0,u.sP.Decimal,u.Nm.Output);var a=new w.u;return a.storedProcedureName="FOTT.CopyReservedDesksByPeriod",a.entitiesParameters=new Array(r),a.outputIdParameterName="reservationsCopied",this.genericService.createService("/Data/Save",a)}},{key:"releaseDesks",value:function(e){var t=new Array;this.entityParameterService.AddEntityParameter(t,"reservationsId",e,u.sP.NVarchar2,u.Nm.Input),this.entityParameterService.AddEntityParameter(t,"countDesksReleased",0,u.sP.Decimal,u.Nm.Output);var n=new w.u;return n.storedProcedureName="FOTT.ReleaseDesks",n.entitiesParameters=new Array(t),n.outputIdParameterName="countDesksReleased",this.genericService.createService("/Data/Delete",n)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(D.\u0275\u0275inject(I.MY),D.\u0275\u0275inject(I.RZ))},e.\u0275prov=D.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e}(),O=a(98295),E=a(49983),M=a(43220),N=a(3679),W=a(62758),A=function(){var e=function(){function e(t,r){n(this,e),this.desksService=t,this.dtService=r,this.selectedDate=new Date,this.daysChange=new D.EventEmitter}return t(e,[{key:"ngOnInit",value:function(){var e=this;0!==this.daysReservation.length&&(this.selectedDate=this.daysReservation[0].date.toDate()),this.getSelectedWeek(),this.currentWeekSubscription=this.desksService.selectCurrentWeek.subscribe(function(){e.selectedDate=e.dtService.today(),e.getSelectedWeek()})}},{key:"ngOnDestroy",value:function(){this.currentWeekSubscription.unsubscribe()}},{key:"getSelectedWeek",value:function(){this.startOfWeek=b(this.selectedDate).startOf("isoWeek"),this.endOfWeek=b(this.selectedDate).startOf("isoWeek").add(4,"days"),this.getWeekDays()}},{key:"prevWeek",value:function(){this.startOfWeek=b(this.startOfWeek).subtract(1,"weeks").startOf("isoWeek"),this.endOfWeek=b(this.endOfWeek).subtract(1,"weeks"),this.getWeekDays()}},{key:"nextWeek",value:function(){this.startOfWeek=b(this.startOfWeek).add(1,"weeks").startOf("isoWeek"),this.endOfWeek=b(this.endOfWeek).add(1,"weeks"),this.getWeekDays()}},{key:"getWeekDays",value:function(){this.daysReservation=[];for(var e=this.startOfWeek;e<=this.endOfWeek;)this.daysReservation.push({date:e,dayName:this.dtService.getDayName(e)}),e=e.clone().add(1,"d");this.desksService.stopResourceReservationsGet.next(),this.selectedDate=this.startOfWeek.toDate(),this.daysChange.emit(this.daysReservation)}},{key:"changeDateEvent",value:function(){this.getSelectedWeek()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(D.\u0275\u0275directiveInject(R),D.\u0275\u0275directiveInject(I.Cv))},e.\u0275cmp=D.\u0275\u0275defineComponent({type:e,selectors:[["app-select-week"]],inputs:{daysReservation:"daysReservation"},outputs:{daysChange:"daysChange"},decls:25,vars:8,consts:[[2,"padding","0px"],["scope","col"],[1,"td-arrow","pointer",3,"click"],[1,"material-icons"],[1,"td-date"],[1,"td-calendar","pointer",3,"click"],["matInput","",3,"matDatepicker","ngModel","ngModelChange","dateChange"],["picker",""]],template:function(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"table"),D.\u0275\u0275element(1,"caption",0),D.\u0275\u0275elementStart(2,"tr"),D.\u0275\u0275element(3,"th",1),D.\u0275\u0275elementStart(4,"td",2),D.\u0275\u0275listener("click",function(){return t.prevWeek()}),D.\u0275\u0275elementStart(5,"em",3),D.\u0275\u0275text(6,"keyboard_arrow_left"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(7,"td",4),D.\u0275\u0275elementStart(8,"span"),D.\u0275\u0275text(9),D.\u0275\u0275pipe(10,"shortDate"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(11,"td",5),D.\u0275\u0275listener("click",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275reference(17).open()}),D.\u0275\u0275elementStart(12,"em",3),D.\u0275\u0275text(13,"date_range"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(14,"mat-form-field"),D.\u0275\u0275elementStart(15,"input",6),D.\u0275\u0275listener("ngModelChange",function(e){return t.selectedDate=e})("dateChange",function(){return t.changeDateEvent()}),D.\u0275\u0275elementEnd(),D.\u0275\u0275element(16,"mat-datepicker",null,7),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(18,"td",4),D.\u0275\u0275elementStart(19,"span"),D.\u0275\u0275text(20),D.\u0275\u0275pipe(21,"shortDate"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(22,"td",2),D.\u0275\u0275listener("click",function(){return t.nextWeek()}),D.\u0275\u0275elementStart(23,"em",3),D.\u0275\u0275text(24,"keyboard_arrow_right"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd()}if(2&e){var r=D.\u0275\u0275reference(17);D.\u0275\u0275advance(9),D.\u0275\u0275textInterpolate(D.\u0275\u0275pipeBind1(10,4,t.startOfWeek)),D.\u0275\u0275advance(6),D.\u0275\u0275property("matDatepicker",r)("ngModel",t.selectedDate),D.\u0275\u0275advance(5),D.\u0275\u0275textInterpolate(D.\u0275\u0275pipeBind1(21,6,t.endOfWeek))}},directives:[O.KE,E.Nt,M.hl,N.DefaultValueAccessor,N.NgControlStatus,N.NgModel,M.Mq],pipes:[W.M],styles:["table[_ngcontent-%COMP%]{width:90%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;border:1px solid gainsboro}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;font-size:25px;cursor:pointer}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:4px}table[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:1px;left:3px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:0px;height:0px;visibility:hidden}"]}),e}(),_=a(4885),T=a(7539),F=a(67827);function V(e,t){1&e&&(D.\u0275\u0275elementStart(0,"div",32),D.\u0275\u0275elementStart(1,"div",33),D.\u0275\u0275elementStart(2,"div",34),D.\u0275\u0275elementStart(3,"div",2),D.\u0275\u0275elementStart(4,"div",35),D.\u0275\u0275element(5,"mat-spinner"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd())}function j(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"mat-checkbox",36),D.\u0275\u0275listener("ngModelChange",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().onlyMySubordinates=e})("change",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().onlyMySubordinatesChanged()}),D.\u0275\u0275text(1," Mines "),D.\u0275\u0275elementEnd()}if(2&e){var r=D.\u0275\u0275nextContext();D.\u0275\u0275property("ngModel",r.onlyMySubordinates)}}function B(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"ng-multiselect-dropdown",37),D.\u0275\u0275listener("ngModelChange",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().selectedActivitiesIdentifiers=e})("click",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().dropDownSelected=!0})("onDropDownClose",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().onDropDownClose()}),D.\u0275\u0275elementEnd()}if(2&e){var r=D.\u0275\u0275nextContext();D.\u0275\u0275property("placeholder","Select Activity...")("settings",r.dropDownSettings)("data",r.activitiesIdentifiers)("ngModel",r.selectedActivitiesIdentifiers)}}function L(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"button",38),D.\u0275\u0275listener("click",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().CopyWeekReservation()}),D.\u0275\u0275element(1,"em",39),D.\u0275\u0275text(2," Copy "),D.\u0275\u0275elementEnd()}}function G(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"button",38),D.\u0275\u0275listener("click",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().PasteWeekReservation()}),D.\u0275\u0275element(1,"em",39),D.\u0275\u0275text(2," Paste "),D.\u0275\u0275elementEnd()}}function $(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"button",38),D.\u0275\u0275listener("click",function(){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().ReleaseAllDesks()}),D.\u0275\u0275element(1,"em",40),D.\u0275\u0275text(2," Release "),D.\u0275\u0275elementEnd()}}function H(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"th",41),D.\u0275\u0275text(1),D.\u0275\u0275pipe(2,"date"),D.\u0275\u0275pipe(3,"shortDate"),D.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate2("",D.\u0275\u0275pipeBind2(2,2,null==n?null:n.date,"ccc")," ",D.\u0275\u0275pipeBind1(3,5,null==n?null:n.date),"")}}function U(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",47),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit,r=D.\u0275\u0275nextContext();D.\u0275\u0275property("colSpan",r.daysReservation.length+2),D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.activityName," ")}}function z(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",48),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit,r=D.\u0275\u0275nextContext();D.\u0275\u0275property("colSpan",r.daysReservation.length+2),D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.blockName," ")}}function J(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",49),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.userNumber," ")}}function q(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",50),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.userName," ")}}function Y(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"td",52),D.\u0275\u0275listener("dragstart",function(e){var t=D.\u0275\u0275restoreView(n).$implicit;return D.\u0275\u0275nextContext(3).dragStartDeskLeave(e,t)})("drop",function(e){var t=D.\u0275\u0275restoreView(n).$implicit;return D.\u0275\u0275nextContext(3).onDeskReserve(e,t)})("dragover",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext(3).onDragOver(e)})("dragleave",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext(3).onDragLeave(e)}),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()}if(2&e){var r=t.$implicit,a=D.\u0275\u0275nextContext(3);D.\u0275\u0275property("ngClass",a.getDayDeskClass(r.dayType))("draggable",0!==r.reservationId),D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",r.deskName,"")}}function X(e,t){if(1&e&&(D.\u0275\u0275elementContainerStart(0),D.\u0275\u0275template(1,Y,2,3,"td",51),D.\u0275\u0275elementContainerEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275property("ngForOf",n.reservations)}}function Z(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"tr"),D.\u0275\u0275template(1,U,2,2,"td",42),D.\u0275\u0275template(2,z,2,2,"td",43),D.\u0275\u0275template(3,J,2,1,"td",44),D.\u0275\u0275template(4,q,2,1,"td",45),D.\u0275\u0275template(5,X,2,1,"ng-container",46),D.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0===n.userId&&void 0===n.blockName),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0===n.userId&&void 0!==n.blockName),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0!==n.userId),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0!==n.userId),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0!==n.userId)}}function K(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",57),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.platform," ")}}function Q(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"td",58),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()),2&e){var n=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",n.block," ")}}function ee(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"td",59),D.\u0275\u0275listener("dragstart",function(e){D.\u0275\u0275restoreView(n);var t=D.\u0275\u0275nextContext().$implicit;return D.\u0275\u0275nextContext(2).dragStartDeskReserve(e,t)})("dragover",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext(3).onDragOver(e)})("dragleave",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext(3).onDragLeave(e)})("dragend",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext(3).onDragLeave(e)}),D.\u0275\u0275text(1),D.\u0275\u0275elementEnd()}if(2&e){var r=D.\u0275\u0275nextContext().$implicit;D.\u0275\u0275property("draggable",!0),D.\u0275\u0275advance(1),D.\u0275\u0275textInterpolate1(" ",r.name," ")}}function te(e,t){if(1&e&&(D.\u0275\u0275elementStart(0,"tr"),D.\u0275\u0275template(1,K,2,1,"td",54),D.\u0275\u0275template(2,Q,2,1,"td",55),D.\u0275\u0275template(3,ee,2,2,"td",56),D.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0===n.deskId&&void 0===n.block),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0===n.deskId&&void 0!==n.block),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",0!==n.deskId)}}function ne(e,t){if(1&e){var n=D.\u0275\u0275getCurrentView();D.\u0275\u0275elementStart(0,"div",9),D.\u0275\u0275elementStart(1,"table",53),D.\u0275\u0275listener("drop",function(e){return D.\u0275\u0275restoreView(n),D.\u0275\u0275nextContext().onDeskRelease(e)}),D.\u0275\u0275element(2,"caption",24),D.\u0275\u0275elementStart(3,"thead",25),D.\u0275\u0275elementStart(4,"th",41),D.\u0275\u0275text(5,"Desk"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(6,"tbody",29),D.\u0275\u0275template(7,te,4,3,"tr",30),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd()}if(2&e){var r=D.\u0275\u0275nextContext();D.\u0275\u0275advance(7),D.\u0275\u0275property("ngForOf",r.desks)}}var re=a(49457),ae=[{path:"",data:{title:"Reservation",function:o.FI.DeskReservation,status:!1},canActivate:[d.a1],children:[{path:"desks",component:function(){var e=function(){function e(t,r,a){n(this,e),this.desksService=t,this.dateTimeService=r,this.notificationService=a,this.daysReservation=[],this.daysCopyReservation=[],this.startOfCurrentWeek=b().startOf("isoWeek"),this.endOfCurrentWeek=b().startOf("isoWeek").add(4,"days"),this.periodFrom=this.startOfCurrentWeek.toDate(),this.periodTo=this.endOfCurrentWeek.toDate(),this.isLoading=!1,this.onlyMySubordinates=!0,this.activitiesIdentifiers=[],this.selectedActivitiesIds="",this.selectedActivitiesIdentifiers=[],this.dropDownSettings={},this.dropDownSelected=!1,this.subordonatesResources=[],this.desks=[],this.resourcesWeekReservations=[],this.reservations=[],this.subscription=new c.w0}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.dropDownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.getActivities(),this.getResponsibleDesks(),this.isSuperAdmin()&&!1===this.currentUser.hasSubordinates&&(this.onlyMySubordinates=!1),this.subscription=this.desksService.refreshReservations.subscribe(function(){e.getResourcesWeekReservation()})}},{key:"getActivities",value:function(){var e=this;this.desksService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t)})}},{key:"getResponsibleDesks",value:function(){var e=this;this.desksService.getResponsibleDesks(this.currentUser.userId).subscribe(function(t){t.forEach(function(t){if(-1===e.desks.findIndex(function(e){return e.platform===t.platform})){var n=new l;n.platform=t.platform,e.desks.push(n)}if(-1===e.desks.findIndex(function(e){return e.platform===t.platform&&e.block===t.block})){var r=new l;r.platform=t.platform,r.block=t.block,e.desks.push(r)}e.desks.push(t)})})}},{key:"isSuperAdmin",value:function(){return this.currentUser.groupId===o.Fl.SuperAdmin}},{key:"getResourcesWeekReservation",value:function(){var e,t=this;this.isLoading=!0,this.isSuperAdmin()&&!1===this.onlyMySubordinates?(e=214,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",")):(e=this.currentUser.userId,this.selectedActivitiesIds=""),this.desksService.getSubordinatesByPeriod(e,this.selectedActivitiesIds,this.periodFrom,this.periodTo).subscribe(function(n){n&&n.length>0&&(t.subordonatesResources=n,t.desksService.getReservedDesksByPeriod(e,t.periodFrom,t.periodTo).subscribe(function(n){t.reservations=[],n.forEach(function(e){e.reservationDate=new Date(e.reservationDate),t.reservations.push(Object.assign(new y,e))}),t.desksService.getResourcesLeavesByPeriod(e,t.periodFrom,t.periodTo).subscribe(function(e){t.resourcesLeaves=e,t.getResourcesReservedDesks(),t.isLoading=!1})},function(){t.isLoading=!1}))},function(){t.isLoading=!1})}},{key:"getResourcesReservedDesks",value:function(){var e=this;this.resourcesWeekReservations=[];var t="",n="";this.subordonatesResources.forEach(function(r){var a=e.resourcesWeekReservations.find(function(e){return e.userId===r.userId});if(void 0===a){if(a=new S,r.activityName!==t){var i=new S;i.activityName=r.activityName,e.resourcesWeekReservations.push(i),t=r.activityName}if(void 0!==r.blockName&&r.blockName!==n){var s=new S;s.activityName=r.activityName,s.blockName=r.blockName,e.resourcesWeekReservations.push(s),n=r.blockName}}a.userId=r.userId,a.userNumber=r.userNumber,a.userName=r.userName,a.activityName=r.activityName,e.daysReservation.forEach(function(t){var n=e.reservations.find(function(e){return e.userId===r.userId&&e.reservationDate.toDateString()===t.date.toDate().toDateString()});n||((n=new y).userId=r.userId,n.reservationDate=t.date.toDate()),n.dayType=1===e.daysHolidays[t.date.day()-1].isHoliday?h.Holiday:h.Work,-1!==e.resourcesLeaves.findIndex(function(e){return e.userId===r.userId&&new Date(e.leaveStartDate)<=t.date.toDate()&&t.date.toDate()>=new Date(e.leaveEndDate)})&&(n.dayType=h.Leave),a.reservations.push(n)}),e.resourcesWeekReservations.push(a)})}},{key:"selectCurrentWeek",value:function(){this.desksService.selectCurrentWeek.next()}},{key:"daysChange",value:function(e){var t=this;null!=e&&(this.daysReservation=e,this.periodFrom=this.daysReservation[0].date.toDate(),this.periodTo=this.daysReservation[e.length-1].date.toDate(),this.desksService.getHolidaysByPeriod(this.periodFrom,this.periodTo).subscribe(function(e){t.daysHolidays=e,t.getResourcesWeekReservation()}))}},{key:"onlyMySubordinatesChanged",value:function(){this.getResourcesWeekReservation()}},{key:"getResourceReservationClass",value:function(){return!0===this.onlyMySubordinates?"col-md-10":"col-md-12"}},{key:"getDayDeskClass",value:function(e){return e===h.Holiday||e===h.Leave?"td-holiday":"td-desk"}},{key:"onDropDownClose",value:function(){this.dropDownSelected&&(this.dropDownSelected=!1,this.getResourcesWeekReservation())}},{key:"CopyWeekReservation",value:function(){var e=this;0!==this.reservations.length&&(this.daysCopyReservation=[],this.daysReservation.forEach(function(t){var n=new k;n.date=b(t.date.toDate()),n.dayName=t.dayName,e.daysCopyReservation.push(n)}),this.notificationService.info("Copy week successful.<br/>Move to destination week and Paste copied week."))}},{key:"PasteWeekReservation",value:function(){var e=this;if(0===this.reservations.length){var t=this.subordonatesResources.map(function(e){return e.userId}).join(","),n=this.daysCopyReservation.map(function(t){return e.dateTimeService.getShortFormat(t.date)}).join(","),r=this.daysReservation.map(function(t){return e.dateTimeService.getShortFormat(t.date)}).join(",");this.daysCopyReservation=[],this.desksService.copyReservedDesksByPeriod(t,n,r).subscribe(function(t){e.getResourcesWeekReservation(),0!==t?e.notificationService.success("Reservation week copied successfully."):e.notificationService.danger("Reservation week copy failed.")},function(){e.getResourcesWeekReservation(),e.notificationService.danger("Reservation week copy failed.")})}else this.notificationService.warning("Copy week failed.<br/>You should release all desks before!")}},{key:"ReleaseAllDesks",value:function(){var e=this;0!==this.reservations.length?P().fire({text:"Are you sure to release all reserved desks ?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, release all!",showLoaderOnConfirm:!0,preConfirm:function(){var t=e.reservations.map(function(e){return e.reservationId}).join(",");e.ReleaseDesks(t)}}):this.notificationService.info("There is no desk to release!")}},{key:"ReleaseDesks",value:function(e){var t=this;this.desksService.releaseDesks(e).subscribe(function(e){t.getResourcesWeekReservation(),0!==e?t.notificationService.success("Desk released succefully."):t.notificationService.danger("Release desk failed.")},function(){t.getResourcesWeekReservation(),t.notificationService.danger("Release desk failed.")})}},{key:"viewPlatformPlan",value:function(){re.saveAs("./assets/docs/SFX ETG1 PF1.pdf","SFX ETG1 PF1")}},{key:"dragStartDeskReserve",value:function(e,t){e.dataTransfer.setData("deskData",JSON.stringify(t))}},{key:"dragStartDeskLeave",value:function(e,t){e.dataTransfer.setData("reservationData",JSON.stringify(t))}},{key:"onDeskReserve",value:function(e,t){var n=this;if(e.dataTransfer.getData("deskData")){var r=JSON.parse(e.dataTransfer.getData("deskData"));t.deskId=r.id,this.desksService.updateReservationDesk(t).subscribe(function(e){n.getResourcesWeekReservation(),0!==e?n.notificationService.success("Desk reserved successfully."):n.notificationService.danger("Reservation desk failed.")},function(){n.getResourcesWeekReservation(),n.notificationService.danger("Reservation desk failed.")})}}},{key:"onDeskRelease",value:function(e){if(e.dataTransfer.getData("reservationData")){var t=JSON.parse(e.dataTransfer.getData("reservationData"));this.ReleaseDesks(t.reservationId)}}},{key:"onDragOver",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onDragLeave",value:function(e){e.stopPropagation(),e.preventDefault()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(D.\u0275\u0275directiveInject(R),D.\u0275\u0275directiveInject(I.Cv),D.\u0275\u0275directiveInject(I.gq))},e.\u0275cmp=D.\u0275\u0275defineComponent({type:e,selectors:[["app-desks"]],decls:44,vars:19,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"wrapper"],["class","overlay",4,"ngIf"],[1,"card-body","loaded-content"],[1,"row","m-b-32"],[1,"col-md-2"],[1,"select-current-week"],[1,"f-w-600",3,"click"],[1,"col-sm-2"],[3,"daysReservation","daysChange"],[1,"row","col-sm-8","flex-container"],[1,"col-sm-3"],[1,"text-right","m-t-5"],[3,"ngModel","ngModelChange","change",4,"ngIf"],["class","multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose",4,"ngIf"],[1,"col-sm-6",2,"text-align","right"],["class","btn btn-primary m-r-5","type","submit",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click"],[3,"ngClass"],[1,"table","text-center","m-b-10"],[2,"padding","0px"],[1,"th-header"],["scope","col",1,"th-user-number"],["scope","col",1,"th-user-name"],["scope","col",4,"ngFor","ngForOf"],[1,"tbody-scroll"],[4,"ngFor","ngForOf"],["class","col-md-2",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[3,"ngModel","ngModelChange","change"],[1,"multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose"],["type","submit",1,"btn","btn-primary","m-r-5",3,"click"],[1,"icofont","icofont-copy"],[1,"icofont","icofont-bin"],["scope","col"],["class","td-activity",3,"colSpan",4,"ngIf"],["class","td-block",3,"colSpan",4,"ngIf"],["class","td-user-number",4,"ngIf"],["class","td-user-name",4,"ngIf"],[4,"ngIf"],[1,"td-activity",3,"colSpan"],[1,"td-block",3,"colSpan"],[1,"td-user-number"],[1,"td-user-name"],[3,"ngClass","draggable","dragstart","drop","dragover","dragleave",4,"ngFor","ngForOf"],[3,"ngClass","draggable","dragstart","drop","dragover","dragleave"],[1,"table","text-center","m-b-10",3,"drop"],["class","td-platform",4,"ngIf"],["class","td-block",4,"ngIf"],["class","td-desk",3,"draggable","dragstart","dragover","dragleave","dragend",4,"ngIf"],[1,"td-platform"],[1,"td-block"],[1,"td-desk",3,"draggable","dragstart","dragover","dragleave","dragend"]],template:function(e,t){1&e&&(D.\u0275\u0275elementStart(0,"div",0),D.\u0275\u0275elementStart(1,"div",1),D.\u0275\u0275elementStart(2,"div",2),D.\u0275\u0275elementStart(3,"div",3),D.\u0275\u0275elementStart(4,"div",4),D.\u0275\u0275elementStart(5,"div",5),D.\u0275\u0275template(6,V,6,0,"div",6),D.\u0275\u0275elementStart(7,"div",7),D.\u0275\u0275elementStart(8,"div",8),D.\u0275\u0275elementStart(9,"div",9),D.\u0275\u0275elementStart(10,"div",10),D.\u0275\u0275elementStart(11,"h5"),D.\u0275\u0275text(12,"Current Week"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(13,"a",11),D.\u0275\u0275listener("click",function(){return t.selectCurrentWeek()}),D.\u0275\u0275text(14),D.\u0275\u0275pipe(15,"shortDate"),D.\u0275\u0275pipe(16,"shortDate"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(17,"div",12),D.\u0275\u0275elementStart(18,"app-select-week",13),D.\u0275\u0275listener("daysChange",function(e){return t.daysChange(e)}),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(19,"div",14),D.\u0275\u0275elementStart(20,"div",15),D.\u0275\u0275elementStart(21,"div",16),D.\u0275\u0275template(22,j,2,1,"mat-checkbox",17),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(23,"div",15),D.\u0275\u0275template(24,B,1,4,"ng-multiselect-dropdown",18),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(25,"div",19),D.\u0275\u0275template(26,L,3,0,"button",20),D.\u0275\u0275template(27,G,3,0,"button",20),D.\u0275\u0275template(28,$,3,0,"button",20),D.\u0275\u0275elementStart(29,"button",21),D.\u0275\u0275listener("click",function(){return t.viewPlatformPlan()}),D.\u0275\u0275text(30,"Plan"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(31,"div",2),D.\u0275\u0275elementStart(32,"div",22),D.\u0275\u0275elementStart(33,"table",23),D.\u0275\u0275element(34,"caption",24),D.\u0275\u0275elementStart(35,"thead",25),D.\u0275\u0275elementStart(36,"th",26),D.\u0275\u0275text(37,"Matricule"),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(38,"th",27),D.\u0275\u0275text(39,"Resource"),D.\u0275\u0275elementEnd(),D.\u0275\u0275template(40,H,4,7,"th",28),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementStart(41,"tbody",29),D.\u0275\u0275template(42,Z,6,5,"tr",30),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275template(43,ne,8,1,"div",31),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd(),D.\u0275\u0275elementEnd()),2&e&&(D.\u0275\u0275advance(6),D.\u0275\u0275property("ngIf",t.isLoading),D.\u0275\u0275advance(1),D.\u0275\u0275classProp("blurred",t.isLoading),D.\u0275\u0275advance(7),D.\u0275\u0275textInterpolate2("",D.\u0275\u0275pipeBind1(15,15,t.startOfCurrentWeek),"-",D.\u0275\u0275pipeBind1(16,17,t.endOfCurrentWeek)," "),D.\u0275\u0275advance(4),D.\u0275\u0275property("daysReservation",t.daysReservation),D.\u0275\u0275advance(4),D.\u0275\u0275property("ngIf",t.isSuperAdmin()),D.\u0275\u0275advance(2),D.\u0275\u0275property("ngIf",t.isSuperAdmin()&&!t.onlyMySubordinates),D.\u0275\u0275advance(2),D.\u0275\u0275property("ngIf",t.onlyMySubordinates&&0===t.daysCopyReservation.length),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",t.onlyMySubordinates&&0!==t.daysCopyReservation.length),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",t.onlyMySubordinates),D.\u0275\u0275advance(4),D.\u0275\u0275property("ngClass",t.getResourceReservationClass()),D.\u0275\u0275advance(8),D.\u0275\u0275property("ngForOf",t.daysReservation),D.\u0275\u0275advance(2),D.\u0275\u0275property("ngForOf",t.resourcesWeekReservations),D.\u0275\u0275advance(1),D.\u0275\u0275property("ngIf",t.onlyMySubordinates))},directives:[i.NgIf,A,i.NgClass,i.NgForOf,_.$g,T.oG,N.NgControlStatus,N.NgModel,F.OP],pipes:[W.M,i.DatePipe],styles:[".card-body[_ngcontent-%COMP%]{padding:25px}.multi-search[_ngcontent-%COMP%]{width:100%}.select-current-week[_ngcontent-%COMP%]{color:#3f629d}.f-w-600[_ngcontent-%COMP%]{cursor:pointer}.m-b-32[_ngcontent-%COMP%]{margin-bottom:32px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border-top:1px solid #bbbbbb;border-left:1px solid #bbbbbb;border-right:1px solid #bbbbbb}.td-activity[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#8e0089;width:100%;font-weight:bold}.td-user-number[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:10%;font-weight:bold}.td-user-name[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:20%;font-weight:bold}.th-header[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}.th-user-number[_ngcontent-%COMP%]{width:10%}.th-user-name[_ngcontent-%COMP%]{width:20%}.td-platform[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#8e0089;width:100%;font-weight:bold}.td-block[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#5489a5;width:100%;font-weight:bold}.td-desk[_ngcontent-%COMP%]{color:#448aff;font-weight:bold;cursor:pointer}.td-holiday[_ngcontent-%COMP%]{color:#448aff;font-weight:bold;background:repeating-linear-gradient(120deg,white,white 4px,pink 4px,pink 6px);cursor:pointer}tbody[_ngcontent-%COMP%]{display:block;overflow:auto;overflow-y:scroll;max-height:calc(100vh - 342px);border-bottom:1px solid #bbbbbb}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}thead[_ngcontent-%COMP%]{width:calc(100% - 1.2em)}.wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"]}),e}(),data:{title:"Desks",icon:"icon-desk",caption:"",function:o.FI.Desks,status:!0},canActivate:[d.a1]}]}],ie=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=D.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=D.\u0275\u0275defineInjector({imports:[[s.Bz.forChild(ae)],s.Bz]}),e}(),se=a(32403),oe=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=D.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=D.\u0275\u0275defineInjector({imports:[[i.CommonModule,se.m,N.FormsModule,N.ReactiveFormsModule,se.q,F.ZQ.forRoot()]]}),e}(),de=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=D.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=D.\u0275\u0275defineInjector({providers:[R],imports:[[i.CommonModule,ie,oe]]}),e}()}}])}();
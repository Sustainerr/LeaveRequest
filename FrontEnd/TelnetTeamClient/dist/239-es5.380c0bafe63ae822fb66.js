!function(){"use strict";function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function t(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[239],{83239:function(e,n,a){a.r(n),a.d(n,{CUSTOM_DT_FORMATS:function(){return yt},InvoicingModule:function(){return xt}});var r,c=a(38583),o=a(32403),l=a(3679),s=a(72458),d=a(22238),m=a(36063),v=a(82480),u=a(67827),h=a(91841),p=a(36332),f=a(38458),g=a(37716),S=((r=function e(){i(this,e)}).\u0275fac=function(e){return new(e||r)},r.\u0275mod=g.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=g.\u0275\u0275defineInjector({providers:[],imports:[[c.CommonModule,o.m,l.FormsModule,l.ReactiveFormsModule,o.q,d.Is,u.ZQ.forRoot(),h.HttpClientModule,v.w,p.o,f.l]]}),r),y=a(88452),x=a(63753),b=a(62028),C=a(70833),I=a(90046),E=a(55750),D=a(10337),w=a(44995),k=a(96523),R=a(19992),A=a(98295),M=a(49983),T=a(43220),j=a(69517),F=a(39924),P=a(4885),N=a(42352),B=a(88136),O=a(34239);function V(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function z(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",32),g.\u0275\u0275elementStart(1,"div",33),g.\u0275\u0275elementStart(2,"div",34),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",35),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function _(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",36),g.\u0275\u0275elementStart(1,"app-estimates",37),g.\u0275\u0275listener("estimateState",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext(2).toggleEditDetails(e)}),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext(2);g.\u0275\u0275classProp("blurred",n.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("contractDetails",!0)("estimates",g.\u0275\u0275pipeBind3(2,6,n.estimates,n.searchFilterService.pageIndex,n.searchFilterService.pageSize))("estimateEditable",n.estimateEditable)("project",n.projects)}}function $(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",4),g.\u0275\u0275elementStart(1,"div",5),g.\u0275\u0275elementStart(2,"div",6),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",7),g.\u0275\u0275elementStart(5,"mat-list"),g.\u0275\u0275elementStart(6,"mat-list-item"),g.\u0275\u0275elementStart(7,"h3",8),g.\u0275\u0275text(8,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"mat-form-field",9),g.\u0275\u0275elementStart(10,"input",10),g.\u0275\u0275listener("keypress",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().dateOnly(e)})("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().estimateStartDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(11,"mat-datepicker-toggle",11),g.\u0275\u0275element(12,"mat-datepicker",null,12),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(14,"mat-form-field",9),g.\u0275\u0275elementStart(15,"input",13),g.\u0275\u0275listener("keypress",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().dateOnly(e)})("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().estimateEndDate=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(16,"mat-datepicker-toggle",11),g.\u0275\u0275element(17,"mat-datepicker",null,14),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(19,"mat-list-item"),g.\u0275\u0275elementStart(20,"h3",8),g.\u0275\u0275text(21,"Reference"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(22,"mat-form-field",15),g.\u0275\u0275elementStart(23,"input",16),g.\u0275\u0275listener("keydown",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().onClickingEnter(e)})("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().estimateReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(24,"div",7),g.\u0275\u0275elementStart(25,"mat-list"),g.\u0275\u0275elementStart(26,"mat-list-item"),g.\u0275\u0275elementStart(27,"h3",8),g.\u0275\u0275text(28,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(29,"div",17),g.\u0275\u0275elementStart(30,"ng-multiselect-dropdown",18),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().selectedActivitiesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(31,"mat-list-item"),g.\u0275\u0275elementStart(32,"h3",8),g.\u0275\u0275text(33,"Customer"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(34,"div",17),g.\u0275\u0275elementStart(35,"ng-multiselect-dropdown",19),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().selectedCustomersIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(36,"div",20),g.\u0275\u0275elementStart(37,"mat-list"),g.\u0275\u0275elementStart(38,"mat-list-item"),g.\u0275\u0275elementStart(39,"h3",8),g.\u0275\u0275text(40,"Status"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(41,"div",17),g.\u0275\u0275elementStart(42,"ng-multiselect-dropdown",19),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().selectedStatusesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(43,"div",21),g.\u0275\u0275elementStart(44,"div",22),g.\u0275\u0275elementStart(45,"button",23),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().filterEstimateButton()}),g.\u0275\u0275text(46,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(47,"div",22),g.\u0275\u0275elementStart(48,"button",24),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().onResetAllFilters()}),g.\u0275\u0275text(49,"Reset"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(50,"nav",25),g.\u0275\u0275elementStart(51,"div",26),g.\u0275\u0275element(52,"app-paginator",27),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(53,V,3,0,"div",28),g.\u0275\u0275elementStart(54,"div",29),g.\u0275\u0275template(55,z,6,0,"div",30),g.\u0275\u0275template(56,_,3,10,"div",31),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275reference(13),a=g.\u0275\u0275reference(18),r=g.\u0275\u0275nextContext();g.\u0275\u0275advance(10),g.\u0275\u0275property("matDatepicker",n)("max",r.estimateEndDate)("ngModel",r.estimateStartDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",n),g.\u0275\u0275advance(4),g.\u0275\u0275property("matDatepicker",a)("min",r.estimateStartDate)("ngModel",r.estimateEndDate),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",a),g.\u0275\u0275advance(7),g.\u0275\u0275property("ngModel",r.estimateReference),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("settings",r.dropdownSettings)("data",r.activitiesIdentifiers)("ngModel",r.selectedActivitiesIdentifiers)("disabled",r.isProjectManager),g.\u0275\u0275advance(5),g.\u0275\u0275property("placeholder","Select...")("settings",r.dropdownSettings)("data",r.customersIdentifiers)("ngModel",r.selectedCustomersIdentifiers),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("settings",r.dropdownSettingsStatus)("data",r.statuses)("ngModel",r.selectedStatusesIdentifiers),g.\u0275\u0275advance(10),g.\u0275\u0275property("pageSize",r.searchFilterService.pageSize)("pageIndex",r.searchFilterService.pageIndex)("length",r.lengthEstimates),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",r.emptyResult&&r.listView),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",r.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",r.listView&&!r.emptyResult)}}function L(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",38),g.\u0275\u0275elementStart(1,"app-edit-estimate",39),g.\u0275\u0275listener("isSavedEstimate",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().savedEstimate(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("isEditEstimate",!0)("selectedEstimate",n.selectedEstimate)}}var H=function(){var e=function(){function e(t,n,a,r,c,o){i(this,e),this.sortService=t,this.projectService=n,this.notificationService=a,this.searchFilterService=r,this.dateTimeService=c,this.invoicingService=o,this.estimateReference="",this.emptyResult=!1,this.listView=!1,this.selectedCustomersIdentifiers=[],this.customersIdentifiers=[],this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.isEditableEstimate=!1,this.orderEditable=!1,this.dropdownSettings={},this.dropdownSettingsStatus={},this.selectedStatusesIdentifiers=[],this.subscription=new C.w0,this.statuses=[{id:"Emis",description:"Emis"},{id:"Lanc\xe9",description:"Lanc\xe9"},{id:"Factur\xe9",description:"Factur\xe9"},{id:"Clos",description:"Clos"},{id:"Suspendu",description:"Suspendu"},{id:"Arr\xeat\xe9",description:"Arr\xeat\xe9"}],this.paginatorPipe=new E.Ry(this.searchFilterService),this.isProjectManager=!1}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.subscription.add(this.invoicingService.sortEstimates.subscribe(function(t){e.onSortData(t)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownSettingsStatus={singleSelection:!1,idField:"id",textField:"description",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.getCustomers(),this.getActivities(),this.subscription.add(this.invoicingService.reloadEstimates.subscribe(function(t){e.getEstimates(e.estimateReference,e.selectedCustomersIds,e.selectedActivitiesIds,e.selectedState,e.estimateStartDate,e.estimateEndDate)})),this.lengthEstimates=0,this.subscription.add(this.searchFilterService.resultChanged.subscribe(function(){setTimeout(function(){e.emptyResult=0===e.searchFilterService.showingDataLastFilter.length})})),this.estimateStartDate=this.dateTimeService.getFirstDayFromPreviousMonth(),this.estimateEndDate=this.dateTimeService.today();var t=JSON.parse(sessionStorage.getItem("estimateSearch"));null!==t&&(this.estimateReference=t.estimateReference,this.selectedCustomersIdentifiers=t.selectedCustomersIdentifiers,this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.selectedActivitiesIdentifiers=t.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),this.selectedStatusesIdentifiers=t.selectedStatusesIdentifiers,this.selectedState=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),null!=t.estimateStartDate&&(this.estimateStartDate=t.estimateStartDate),null!=t.estimateEndDate&&(this.estimateEndDate=t.estimateEndDate)),this.user=JSON.parse(localStorage.getItem("currentUser"))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onResetCustomers",value:function(){this.selectedCustomersIdentifiers=[]}},{key:"onResetActivity",value:function(){this.user.groupId!==b.Fl.ProjectManager&&(this.selectedActivitiesIdentifiers=[])}},{key:"onResetStates",value:function(){this.selectedStatusesIdentifiers=[]}},{key:"onResetAllFilters",value:function(){sessionStorage.removeItem("estimateSearch"),this.estimateReference="",this.onResetCustomers(),this.onResetActivity(),this.onResetStates(),this.estimateStartDate=this.dateTimeService.getFirstDayFromPreviousMonth(),this.estimateEndDate=this.dateTimeService.today()}},{key:"onChangeCustomer",value:function(e){this.selectedCustomersIds=e}},{key:"onChangeActivity",value:function(e){this.selectedActivitiesIds=e}},{key:"onChangeServices",value:function(e){this.selectedServicesIds=e}},{key:"getCustomers",value:function(){var e=this;this.projectService.getClients().subscribe(function(t){null!=t&&(e.customersIdentifiers=t,null==e.selectedCustomersIds||(e.selectedCustomersIds=e.customersIdentifiers.map(function(e){return e.id}).join(","),e.onChangeCustomer(e.selectedCustomersIds)))})}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t,e.user.groupId===b.Fl.ProjectManager?(e.selectedActivitiesIdentifiers=e.activitiesIdentifiers.filter(function(t){return t.id===e.user.activityId}),e.isProjectManager=!0,e.selectedActivitiesIds=e.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",")):e.selectedActivitiesIds=e.activitiesIdentifiers.map(function(e){return e.id}).join(","),e.onChangeActivity(e.selectedActivitiesIds))})}},{key:"filterEstimateButton",value:function(){if(null!==this.estimateEndDate&&null!==this.estimateStartDate){this.searchFilterService.pageIndex=0,void 0!==this.selectedStatusesIdentifiers&&(this.selectedState=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(",")),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",");var e=new I.ag;e.estimateReference=this.estimateReference,e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.estimateStartDate=this.estimateStartDate,e.estimateEndDate=this.estimateEndDate,sessionStorage.setItem("estimateSearch",JSON.stringify(e)),this.getEstimates(this.estimateReference,this.selectedCustomersIds,this.selectedActivitiesIds,this.selectedState,this.estimateStartDate,this.estimateEndDate)}else this.notificationService.danger("Please fill dates fields")}},{key:"getEstimates",value:function(e,t,i,n,a,r){var c=this;this.isLoading=!0,this.invoicingService.getEstimates(e,t,i,n,a,r).subscribe(function(e){c.isLoading=!1,null!=e&&(c.emptyResult=!1,c.estimates=e,c.listView=!0,c.lengthEstimates=c.estimates.length,c.emptyResult=0===e.length)})}},{key:"toggleEditDetails",value:function(e){this.listView=!1,this.selectedEstimate=Object.assign(new I.B0,e),this.isEditableEstimate=!0}},{key:"savedEstimate",value:function(e){this.listView=e,this.isEditableEstimate=!e,this.emptyResult=!1,this.getEstimates(this.estimateReference,this.selectedCustomersIds,this.selectedActivitiesIds,this.selectedState,this.estimateStartDate,this.estimateEndDate)}},{key:"onClickingEnter",value:function(e){"Enter"===e.key&&this.filterEstimateButton()}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&this.estimates.sort(function(i,n){var a="asc"===e.direction;switch(e.active){case"estimateReference":return t.sortService.compare(i.estimateReference,n.estimateReference,a,!1);case"estimateEdit":return t.sortService.compare(i.estimateEdit,n.estimateEdit,a,!1);case"estimateDate":return t.sortService.compare(i.estimateDate,n.estimateDate,a,!1);case"clientName":return t.sortService.compare(i.clientName,n.clientName,a,!1);case"estimateState":return t.sortService.compare(i.estimateState,n.estimateState,a,!1);case"contractReference":return t.sortService.compare(i.contractReference,n.contractReference,a,!1);case"orderDate":return t.sortService.compare(i.orderDate,n.orderDate,a,!1);case"batchRefference":return t.sortService.compare(i.batchRefference,n.batchRefference,a,!1);default:return 0}}),this.paginatorPipe.transform(this.estimates,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(D.Kx),g.\u0275\u0275directiveInject(w.Y4),g.\u0275\u0275directiveInject(D.gq),g.\u0275\u0275directiveInject(D.nJ),g.\u0275\u0275directiveInject(D.Cv),g.\u0275\u0275directiveInject(k.X))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-all-estimates"]],decls:4,vars:2,consts:[[1,"page-body"],[1,"row"],["class","col-xl-12 col-lg-12 filter-bar",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From","required","",3,"matDatepicker","max","ngModel","keypress","ngModelChange"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To","required","",3,"matDatepicker","min","ngModel","keypress","ngModelChange"],["picker22",""],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","keydown","ngModelChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","disabled","ngModelChange"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10"],[1,"nav-item","nav-grid","col-sm-12"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","example-container mat-elevation-z8  loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"example-container","mat-elevation-z8","loaded-content"],[3,"contractDetails","estimates","estimateEditable","project","estimateState"],[1,"example-container","mat-elevation-z8"],[3,"isEditEstimate","selectedEstimate","isSavedEstimate"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275template(2,$,57,28,"div",2),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(3,L,2,2,"div",3),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!t.isEditableEstimate),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",t.isEditableEstimate&&!t.emptyResult))},directives:[c.NgIf,R.i$,R.Tg,A.KE,M.Nt,T.hl,l.DefaultValueAccessor,l.RequiredValidator,l.NgControlStatus,l.NgModel,T.nW,A.R9,T.Mq,u.OP,j.M2,F.J,P.$g,N.N,B.c],pipes:[O.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-divider{margin-top:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.material-icons{font-size:25px}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e}(),J=a(16738),Y=a(60040),q=a(11494),G=a(32789),Q=a(38590),W=a(72172),U=a(7539),X=a(62758);function K(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Batch Ref."),g.\u0275\u0275elementEnd())}function Z(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",25),g.\u0275\u0275listener("click",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().goToBatchesDetail(e)}),g.\u0275\u0275elementStart(1,"span",26),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",n.batchReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",n.batchReference," ")}}function ee(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Order Ref."),g.\u0275\u0275elementEnd())}function te(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",25),g.\u0275\u0275listener("click",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().goToOrdersDetail(e)}),g.\u0275\u0275elementStart(1,"span",26),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",n.contractReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",n.contractReference," ")}}function ie(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Estimate Ref."),g.\u0275\u0275elementEnd())}function ne(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",25),g.\u0275\u0275listener("click",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().goToEstimatesDetail(e)}),g.\u0275\u0275elementStart(1,"span",26),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",n.estimateReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",n.estimateReference," ")}}function ae(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Project"),g.\u0275\u0275elementEnd())}function re(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",27),g.\u0275\u0275elementStart(1,"span",26),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.projectName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1("",i.projectName," ")}}function ce(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Delivery Date"),g.\u0275\u0275elementEnd())}function oe(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,i.batchDeliveryDate)," ")}}function le(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Addressed To"),g.\u0275\u0275elementEnd())}function se(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",27),g.\u0275\u0275elementStart(1,"span",26),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.batchAdressedTo),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",i.batchAdressedTo," ")}}function de(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Amount"),g.\u0275\u0275elementEnd())}function me(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",i.batchAmount," ",i.currency," ")}}function ve(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Invoice Date"),g.\u0275\u0275elementEnd())}function ue(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",28),g.\u0275\u0275elementStart(1,"mat-form-field",29),g.\u0275\u0275elementStart(2,"input",30),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.invoiceDeliveryDate=e})("keypress",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().dateOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(3,"mat-datepicker-toggle",31),g.\u0275\u0275element(4,"mat-datepicker",32,33),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit,a=g.\u0275\u0275reference(5),r=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",a)("ngModel",r.datePipe(n.invoiceDeliveryDate))("disabled",r.invoicedBatch(n)||n.BatchChecked),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",a),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month")}}function he(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",34),g.\u0275\u0275text(1,"Net to pay"),g.\u0275\u0275elementEnd())}var pe=function(e){return{"disabled-color":e}};function fe(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",28),g.\u0275\u0275elementStart(1,"mat-form-field",35),g.\u0275\u0275elementStart(2,"input",36),g.\u0275\u0275listener("keypress",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().numberOnly(e)})("blur",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().checkNumber(e)})("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.invoiceNetToBePayed=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275text(3,"\xa0\xa0\xa0 "),g.\u0275\u0275elementStart(4,"span",37),g.\u0275\u0275text(5),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit,a=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",n.invoiceNetToBePayed)("disabled",a.invoicedBatch(n)||n.BatchChecked),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngClass",g.\u0275\u0275pureFunction1(4,pe,!0===n.BatchChecked)),g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",n.currency,"")}}function ge(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Saari Ref."),g.\u0275\u0275elementEnd())}function Se(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",28),g.\u0275\u0275elementStart(1,"mat-form-field",38),g.\u0275\u0275elementStart(2,"input",39),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.invoiceSaariReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit,a=g.\u0275\u0275nextContext();g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",n.invoiceSaariReference)("disabled",a.invoicedBatch(n))}}function ye(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",24),g.\u0275\u0275text(1,"Invoiced"),g.\u0275\u0275elementEnd())}function xe(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"mat-checkbox",40),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.BatchChecked=e})("change",function(e){var t=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().batchesInvoiced(t,e)})("click",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext().DisabledWhenChecked(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit,a=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("ngModel",n.BatchChecked)("disabled",a.invoicedBatch(n))}}function be(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",41)}function Ce(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function Ie(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",42),g.\u0275\u0275elementStart(1,"strong",43),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(i.activityName)}}function Ee(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}var De=function(){return["groupHeader"]},we=function(){var e=function(){function e(t){i(this,e),this.displayedColumns=["batchReference","orderReference","estimateReference","projectName","batchDelevryDate","batchAdressedTo","batchAmount","invoiceDeliveryDate","invoiceNetToBePayed","invoiceSaariReference","invoiced"],this.dataSource=new G.by,this.checked=!0,this.invoicingBatches=[],this.groupByColumns=[],this.invoicingService=t.get(k.X),this.searchFilterService=t.get(D.nJ),this.groupsService=t.get(D.Jc),this.mailService=t.get(D.YT),this.notificationService=t.get(D.gq),this.dateTimeService=t.get(D.Cv),this.router=t.get(y.F0),this.activeRoute=t.get(y.gz)}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.groupByColumns=["activityName"],this.selectedBatchId=0,this.dataSource=new G.by(this.groupsService.addGroups(this.batches,this.groupByColumns)),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new G.by(e.groupsService.addGroups(e.searchFilterService.showingDataLastFilter,e.groupByColumns))}),this.invoicingService.insertInvoicingBatch.subscribe(function(t){e.insertInvoicesLaunch()})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"invoicedBatch",value:function(e){return!(0===e.invoiceId||null==e.invoiceId)}},{key:"onSortData",value:function(e){this.invoicingService.sortInvoices.next(e)}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"datePipe",value:function(e){return"0001-01-01T00:00:00"===e?"":e}},{key:"insertInvoicesLaunch",value:function(){var e=this;this.invoicingBatches.length>0?this.invoicingService.saveInvoicesLaunch(this.invoicingBatches).subscribe(function(){e.notificationService.success("Invoice is saved successfully"),e.invoicingService.getinvoicingBatches.next(),e.invoicingBatches.forEach(function(t){e.mailService.invoiceAdded(t)}),e.invoicingBatches=[]},function(t){e.notificationService.danger("Add invoice failed")}):this.notificationService.warning("None of the batches are checked Please verify")}},{key:"batchesInvoiced",value:function(e,t){if(!0===t.checked){var i=new I.mw;i.invoiceReference="N/A",i.currencyId=e.currencyId,i.invoiceAdressedTo=e.batchAdressedTo,i.invoiceAmount=e.batchAmount,i.invoiceDeliveryDate=e.invoiceDeliveryDate,i.invoiceSaariReference=e.invoiceSaariReference,i.invoiceNetToBePayed=e.invoiceNetToBePayed,i.batchId=e.batchId,i.batchReference=e.batchReference,i.projectName=e.projectName,this.invoicingBatches.push(i)}else{var n=this.invoicingBatches.findIndex(function(t){return t.batchId=e.batchId});this.invoicingBatches.splice(n,1)}}},{key:"DisabledWhenChecked",value:function(e){""===e.invoiceNetToBePayed&&(e.invoiceNetToBePayed=null),null===e.invoiceDeliveryDate||null===e.invoiceNetToBePayed?e.BatchChecked=!0:(!0===e.locked||void 0===e.locked)&&(e.locked=!0),!0===e.BatchChecked&&(e.locked=!1)}},{key:"isGroup",value:function(e,t){return t.level}},{key:"numberOnly",value:function(e){var t=e.which?e.which:e.keyCode;return!(t>31&&(t<44||t>57)||45===t||47===t)}},{key:"goToBatchesDetail",value:function(e){this.router.navigate(["/project-management/project/edit/"+e.pifId.toString()+"/"+e.projectId.toString(),{title:"batches",batchId:e.batchId}],{relativeTo:this.activeRoute})}},{key:"goToOrdersDetail",value:function(e){this.router.navigate(["/project-management/project/edit/"+e.pifId.toString()+"/"+e.projectId.toString(),{title:"orders",contractId:e.contractId}],{relativeTo:this.activeRoute})}},{key:"goToEstimatesDetail",value:function(e){this.router.navigate(["/project-management/project/edit/"+e.pifId.toString()+"/"+e.projectId.toString(),{title:"estimates",estimateId:e.estimateId}],{relativeTo:this.activeRoute})}},{key:"checkNumber",value:function(e){e.invoiceNetToBePayed&&(e.invoiceNetToBePayed=e.invoiceNetToBePayed.toString().replace(",",".")),isNaN(e.invoiceNetToBePayed)&&(e.invoiceNetToBePayed=null)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(g.Injector))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-invoices-launch"]],viewQuery:function(e,t){var i;(1&e&&g.\u0275\u0275viewQuery(q.YE,7),2&e)&&(g.\u0275\u0275queryRefresh(i=g.\u0275\u0275loadQuery())&&(t.sort=i.first))},inputs:{batches:"batches"},decls:40,vars:7,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","batchReference"],["mat-sort-header","",4,"matHeaderCellDef"],["class","reference",3,"matTooltip","click",4,"matCellDef"],["matColumnDef","orderReference"],["matColumnDef","estimateReference"],["matColumnDef","projectName"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","batchDelevryDate"],[4,"matCellDef"],["matColumnDef","batchAdressedTo"],["matColumnDef","batchAmount"],["matColumnDef","invoiceDeliveryDate"],["floatLabel","never",4,"matCellDef"],["matColumnDef","invoiceNetToBePayed"],["mat-sort-header","","class","header-align",4,"matHeaderCellDef"],["matColumnDef","invoiceSaariReference"],["matColumnDef","invoiced"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999",4,"matCellDef"],[4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-sort-header",""],[1,"reference",3,"matTooltip","click"],[1,"span-ellipsis"],[3,"matTooltip"],["floatLabel","never"],[2,"width","90%","text-align","center"],["matInput","","name","invoiceDeliveryDate",3,"matDatepicker","ngModel","disabled","ngModelChange","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["mat-sort-header","",1,"header-align"],[2,"width","90%","text-align","right"],["appNumberValidator","","matInput","",2,"width","100px","border","white",3,"ngModel","disabled","keypress","blur","ngModelChange"],[3,"ngClass"],[2,"width","90%"],["matInput","",2,"border","white",3,"ngModel","disabled","ngModelChange"],[2,"height","20px",3,"ngModel","disabled","ngModelChange","change","click"],[1,"table-primary","table-*"],["colspan","999"],[1,"strong"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-table",0,1),g.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),g.\u0275\u0275elementContainerStart(2,2),g.\u0275\u0275template(3,K,2,0,"mat-header-cell",3),g.\u0275\u0275template(4,Z,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(5,5),g.\u0275\u0275template(6,ee,2,0,"mat-header-cell",3),g.\u0275\u0275template(7,te,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(8,6),g.\u0275\u0275template(9,ie,2,0,"mat-header-cell",3),g.\u0275\u0275template(10,ne,3,2,"mat-cell",4),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(11,7),g.\u0275\u0275template(12,ae,2,0,"mat-header-cell",3),g.\u0275\u0275template(13,re,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(14,9),g.\u0275\u0275template(15,ce,2,0,"mat-header-cell",3),g.\u0275\u0275template(16,oe,3,3,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(17,11),g.\u0275\u0275template(18,le,2,0,"mat-header-cell",3),g.\u0275\u0275template(19,se,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(20,12),g.\u0275\u0275template(21,de,2,0,"mat-header-cell",3),g.\u0275\u0275template(22,me,2,2,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(23,13),g.\u0275\u0275template(24,ve,2,0,"mat-header-cell",3),g.\u0275\u0275template(25,ue,6,5,"mat-cell",14),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(26,15),g.\u0275\u0275template(27,he,2,0,"mat-header-cell",16),g.\u0275\u0275template(28,fe,6,6,"mat-cell",14),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(29,17),g.\u0275\u0275template(30,ge,2,0,"mat-header-cell",3),g.\u0275\u0275template(31,Se,3,2,"mat-cell",14),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(32,18),g.\u0275\u0275template(33,ye,2,0,"mat-header-cell",3),g.\u0275\u0275template(34,xe,2,2,"mat-cell",10),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(35,be,1,0,"mat-header-row",19),g.\u0275\u0275template(36,Ce,1,0,"mat-row",20),g.\u0275\u0275elementContainerStart(37,21),g.\u0275\u0275template(38,Ie,3,1,"mat-cell",22),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(39,Ee,1,0,"mat-row",23),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275property("dataSource",t.dataSource),g.\u0275\u0275advance(35),g.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",t.displayedColumns),g.\u0275\u0275advance(3),g.\u0275\u0275property("matRowDefColumns",g.\u0275\u0275pureFunction0(6,De))("matRowDefWhen",t.isGroup))},directives:[G.BZ,q.YE,G.w1,G.fO,G.Dz,G.as,G.nj,G.ge,q.nU,G.ev,Q.gM,A.KE,M.Nt,T.hl,l.DefaultValueAccessor,l.NgControlStatus,l.NgModel,T.nW,A.R9,T.Mq,W.z,c.NgClass,U.oG,G.XQ,G.Gk],pipes:[X.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 342px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-orderReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-estimateReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-batchDelevryDate[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}.mat-column-batchAdressedTo[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-batchAmount[_ngcontent-%COMP%]{flex:0 0 6%!important;width:6%;text-align:right;justify-content:flex-end}.mat-column-projectName[_ngcontent-%COMP%]{flex:0 0 11%!important;width:12%!important}.mat-column-invoiceDeliveryDate[_ngcontent-%COMP%]{flex:0 0 7%!important;width:8%!important;justify-content:center;-webkit-margin-start:1%;margin-inline-start:1%}.mat-column-invoiceNetToBePayed[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important;-webkit-margin-start:1%;margin-inline-start:1%}.mat-column-invoiceSaariReference[_ngcontent-%COMP%]{flex:0 0 8%!important;width:9%!important;-webkit-margin-start:1%;margin-inline-start:1%}.mat-column-invoiced[_ngcontent-%COMP%]{flex:0 0 7%!important;width:4%!important;justify-content:center}.header-align[_ngcontent-%COMP%]{display:flex;justify-content:center}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}  .mat-sort-header-arrow{color:#fff}.strong[_ngcontent-%COMP%]{background:-webkit-linear-gradient(#5a5a5a,black);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold}.mat-column-groupHeader[_ngcontent-%COMP%]{color:#030303;background-color:#eceaea;font-weight:bolder;font-size:medium;font-family:Arial,Helvetica,sans-serif}.input-date[_ngcontent-%COMP%]{width:55%}.reference[_ngcontent-%COMP%]{color:#00f;cursor:pointer}.disabled-color[_ngcontent-%COMP%]{color:#aaa}"]}),e}();function ke(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"nav",22),g.\u0275\u0275elementStart(1,"div",23),g.\u0275\u0275elementStart(2,"button",24),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext(2).exportToExcel()}),g.\u0275\u0275element(3,"em",25),g.\u0275\u0275text(4," Export "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"button",26),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext(2).insertInvoicingBatch()}),g.\u0275\u0275element(6,"em",27),g.\u0275\u0275text(7," Submit "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(8,"div",28),g.\u0275\u0275element(9,"app-paginator",29),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(5),g.\u0275\u0275property("disabled",n.mutliClickDisable),g.\u0275\u0275advance(4),g.\u0275\u0275property("pageSize",n.searchFilterService.pageSize)("pageIndex",n.searchFilterService.pageIndex)("length",n.lengthBatches)}}function Re(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function Ae(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",30),g.\u0275\u0275elementStart(1,"div",31),g.\u0275\u0275elementStart(2,"div",32),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",33),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function Me(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",34),g.\u0275\u0275element(1,"app-invoices-launch",35),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){var i=g.\u0275\u0275nextContext(2);g.\u0275\u0275classProp("blurred",i.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("batches",g.\u0275\u0275pipeBind3(2,3,i.batches,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))}}function Te(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",3),g.\u0275\u0275elementStart(1,"div",4),g.\u0275\u0275elementStart(2,"div",5),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",6),g.\u0275\u0275elementStart(5,"mat-list"),g.\u0275\u0275elementStart(6,"mat-list-item"),g.\u0275\u0275elementStart(7,"h3",7),g.\u0275\u0275text(8,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"div",8),g.\u0275\u0275elementStart(10,"app-select-month",9),g.\u0275\u0275listener("daysChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().daysChangePeriodFrom(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"div",8),g.\u0275\u0275elementStart(12,"app-select-month",10),g.\u0275\u0275listener("daysChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().daysChangePeriodTo(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"div",6),g.\u0275\u0275elementStart(14,"mat-list"),g.\u0275\u0275elementStart(15,"mat-list-item"),g.\u0275\u0275elementStart(16,"h3",7),g.\u0275\u0275text(17,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"div",11),g.\u0275\u0275elementStart(19,"ng-multiselect-dropdown",12),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().selectedActivitiesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(20,"div",13),g.\u0275\u0275elementStart(21,"div",14),g.\u0275\u0275elementStart(22,"div",15),g.\u0275\u0275elementStart(23,"button",16),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().filterBatchButton()}),g.\u0275\u0275text(24,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(25,ke,10,4,"nav",17),g.\u0275\u0275template(26,Re,3,0,"div",18),g.\u0275\u0275elementStart(27,"div",19),g.\u0275\u0275template(28,Ae,6,0,"div",20),g.\u0275\u0275template(29,Me,3,7,"div",21),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(10),g.\u0275\u0275property("selectedDate",n.deliveryStartDate)("maxDate",n.maxDate),g.\u0275\u0275advance(2),g.\u0275\u0275property("selectedDate",n.deliveryEndDate)("minDate",n.minDate),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",n.activitiesIdentifiers)("ngModel",n.selectedActivitiesIdentifiers)("settings",n.dropdownSettings)("disabled",n.isProjectManager),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngIf",!n.isEditBatch&&!n.addBatch),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",n.emptyResult&&n.listView),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",n.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",n.listView&&!n.isEditBatch&&!n.emptyResult)}}var je=function(){var e=function(){function e(t,n,a,r,c,o){i(this,e),this.invoicingService=t,this.sortService=n,this.excelService=a,this.searchFilterService=r,this.projectService=c,this.dateTimeService=o,this.deliveryStartDate=void 0,this.deliveryEndDate=void 0,this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.dropdownSettings={},this.subscription=new C.w0,this.paginatorPipe=new E.Ry(this.searchFilterService),this.groupByColumns=[],this.mutliClickDisable=!1,this.isProjectManager=!1}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.groupByColumns=["activityName"];var t=this.dateTimeService.today();this.deliveryStartDate=J([t.getFullYear(),t.getMonth()]).toDate(),this.deliveryEndDate=J(t).endOf("month").toDate(),this.minDate=this.deliveryStartDate,this.maxDate=this.deliveryEndDate,this.subscription.add(this.invoicingService.sortInvoices.subscribe(function(t){e.onSortData(t)})),this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.listView=!1,this.isEditBatch=!1,this.addBatch=!1,this.getActivities(),this.subscription.add(this.searchFilterService.resultChanged.subscribe(function(){setTimeout(function(){e.emptyResult=0===e.searchFilterService.showingDataLastFilter.length})}));var i=JSON.parse(sessionStorage.getItem("launchinvoicingSearch"));null!==i&&(this.selectedActivitiesIdentifiers=i.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),null!=i.deliveryStartDate&&(this.deliveryStartDate=i.deliveryStartDate,this.minDate=new Date(this.deliveryStartDate)),null!=i.deliveryEndDate&&(this.deliveryEndDate=i.deliveryEndDate,this.maxDate=new Date(this.deliveryEndDate))),this.invoicingService.getinvoicingBatches.subscribe(function(){var t=JSON.parse(sessionStorage.getItem("launchinvoicingSearch")),i=t.deliveryStartDate,n=t.deliveryEndDate,a=t.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",");e.getLaunchInvoices(a,i,n)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"toggleEditDetails",value:function(e){this.isEditBatch=!0,this.selectedBatch=e,this.addBatch=!1,this.listView=!1}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t,e.user.groupId===b.Fl.ProjectManager?(e.selectedActivitiesIdentifiers=e.activitiesIdentifiers.filter(function(t){return t.id===e.user.activityId}),e.isProjectManager=!0,e.selectedActivitiesIds=e.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",")):e.selectedActivitiesIds=e.activitiesIdentifiers.map(function(e){return e.id}).join(","),e.onChangeActivity(e.selectedActivitiesIds))})}},{key:"onChangeActivity",value:function(e){this.selectedActivitiesIds=e}},{key:"onResetActivity",value:function(){this.selectedActivitiesIdentifiers=[]}},{key:"savedBatch",value:function(e){var t=this;this.listView=e,this.isEditBatch=!e,this.addBatch=!e,this.emptyResult=!1,this.invoicingService.getLaunchInvoices(this.selectedActivitiesIds,this.deliveryStartDate,this.deliveryEndDate).subscribe(function(e){null!=e&&(t.batches=e,t.lengthBatches=t.batches.length)})}},{key:"exportToExcel",value:function(){var e=this;if(void 0!==this.batches&&0!==this.batches.length){var t=[];this.batches.forEach(function(i){var n=[];n.push(i.activityName),n.push(i.batchReference),n.push(i.contractReference),n.push(i.estimateReference),n.push(i.projectName),n.push(i.customer),n.push(e.dateFormat(i.batchDeliveryDate)),n.push(i.batchAdressedTo),n.push(i.batchAmount),n.push(e.dateFormat(i.invoiceDeliveryDate)),n.push(i.invoiceNetToBePayed),n.push(i.currency),n.push(i.invoiceSaariReference),t.push(n)}),this.excelService.generateExcel([{header:"Activity",key:"activityName"},{header:"Batch Reference",key:"batchReference"},{header:"Order Reference",key:"contractReference"},{header:"Estimate Reference",key:"estimateReference"},{header:"Project",key:"projectName"},{header:"Customer",key:"customer"},{header:"Delivery Date",key:"batchDeliveryDate"},{header:"Adressed To",key:"batchAdressedTo"},{header:"Amount",key:"batchAmount"},{header:"Invoice Date",key:"invoiceDeliveryDate"},{header:"Net To Pay",key:"invoiceNetToBePayed"},{header:"Currency",key:"currency"},{header:"Saari Ref",key:"invoiceSaariReference"}],t,[],[],"Invoices_Launch")}}},{key:"dateFormat",value:function(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}},{key:"filterBatchButton",value:function(){this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),this.updateSessionStorage(),this.getLaunchInvoices(this.selectedActivitiesIds,this.deliveryStartDate,this.deliveryEndDate)}},{key:"updateSessionStorage",value:function(){var e=new I.$l;e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.deliveryStartDate=this.deliveryStartDate,e.deliveryEndDate=this.deliveryEndDate,sessionStorage.setItem("launchinvoicingSearch",JSON.stringify(e))}},{key:"getLaunchInvoices",value:function(e,t,i){var n=this;this.searchFilterService.pageIndex=0,this.isLoading=!0,this.invoicingService.getLaunchInvoices(e,t,i).subscribe(function(e){n.isLoading=!1,null!=e&&(n.batches=e,n.batches.forEach(function(e){e.invoiceNetToBePayed&&(e.invoiceNetToBePayed=+e.invoiceNetToBePayed.toString().replace(",",".")),e.BatchChecked=n.invoicedBatch(e),n.emptyResult=!1}),n.lengthBatches=n.batches.length,n.listView=!0)})}},{key:"invoicedBatch",value:function(e){return!(0===e.invoiceId||null==e.invoiceId)}},{key:"insertInvoicingBatch",value:function(){var e=this;this.mutliClickDisable=!0,setTimeout(function(){e.mutliClickDisable=!1},1e3),this.invoicingService.insertInvoicingBatch.next()}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.batches&&(this.batches.sort(function(i,n){var a="asc"===e.direction;switch(e.active){case"batchReference":return t.sortService.compare(i.batchReference,n.batchReference,a,!1);case"orderReference":return t.sortService.compare(i.contractReference,n.contractReference,a,!1);case"estimateReference":return t.sortService.compare(i.estimateReference,n.estimateReference,a,!1);case"projectName":return t.sortService.compare(i.projectName,n.projectName,a,!1);case"batchDelevryDate":return t.sortService.compare(i.batchDeliveryDate,n.batchDeliveryDate,a,!1);case"batchAdressedTo":return t.sortService.compare(i.batchAdressedTo,n.batchAdressedTo,a,!1);case"batchAmount":return t.sortService.compare(i.batchAmount,n.batchAmount,a,!0);case"invoiceDeliveryDate":return t.sortService.compare(i.invoiceDeliveryDate,n.invoiceDeliveryDate,a,!1);case"invoiceNetToBePayed":return t.sortService.compare(i.invoiceNetToBePayed,n.invoiceNetToBePayed,a,!0);case"invoiceSaariReference":return t.sortService.compare(i.invoiceSaariReference,n.invoiceSaariReference,a,!1);case"invoiced":return t.sortService.compare(i.BatchChecked,n.BatchChecked,a,!1);default:return 0}}),this.batches.sort(function(e,i){return t.sortService.compare(e.activityId,i.activityId,!0,!0)})),this.paginatorPipe.transform(this.batches,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"daysChangePeriodFrom",value:function(e){var t=new Date(e);this.deliveryStartDate=J([t.getFullYear(),t.getMonth()]).toDate(),this.minDate=this.deliveryStartDate}},{key:"daysChangePeriodTo",value:function(e){var t=new Date(e);this.deliveryEndDate=J(t).endOf("month").toDate(),this.maxDate=this.deliveryEndDate}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(k.X),g.\u0275\u0275directiveInject(D.Kx),g.\u0275\u0275directiveInject(D.xB),g.\u0275\u0275directiveInject(D.nJ),g.\u0275\u0275directiveInject(w.Y4),g.\u0275\u0275directiveInject(D.Cv))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-all-invoices-launch"]],inputs:{project:"project"},decls:3,vars:1,consts:[[1,"page-body"],[1,"row"],["class","col-xl-12 col-lg-12 filter-bar",4,"ngIf"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"search-input","col-sm-5"],[3,"selectedDate","maxDate","daysChange"],[3,"selectedDate","minDate","daysChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","disabled","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],["class","navbar navbar-light bg-faded m-b-10 p-10",4,"ngIf"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","example-container mat-elevation-z8 loaded-content",3,"blurred",4,"ngIf"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],["type","submit",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"disabled","click"],[1,"fa","fa-arrow-circle-right",2,"font-size","medium"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"example-container","mat-elevation-z8","loaded-content"],[3,"batches"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275template(2,Te,30,13,"div",2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!t.isEditBatch&&!t.addBatch))},directives:[c.NgIf,R.i$,R.Tg,Y.j,u.OP,l.NgControlStatus,l.NgModel,j.M2,F.J,P.$g,we],pipes:[O.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.date-field{font-size:14px}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.material-icons{font-size:25px}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e}(),Fe=a(17224);function Pe(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Project"),g.\u0275\u0275elementEnd())}function Ne(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",24),g.\u0275\u0275listener("click",function(e){var t=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext(2).goToInvoicesDetail(t,e)}),g.\u0275\u0275elementStart(1,"span",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",n.projectName),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",n.projectName," ")}}function Be(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Batch Ref."),g.\u0275\u0275elementEnd())}function Oe(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.batchReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",i.batchReference,"")}}function Ve(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Order Ref."),g.\u0275\u0275elementEnd())}function ze(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.contractReference),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate1(" ",i.contractReference," ")}}function _e(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Addressed To"),g.\u0275\u0275elementEnd())}function $e(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.invoiceAdressedTo),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(i.invoiceAdressedTo)}}function Le(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Customer"),g.\u0275\u0275elementEnd())}function He(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",26),g.\u0275\u0275elementStart(1,"span",25),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275propertyInterpolate("matTooltip",i.customer),g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(i.customer)}}function Je(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Net to pay"),g.\u0275\u0275elementEnd())}function Ye(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"numberForm"),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" ",g.\u0275\u0275pipeBind1(2,2,i.invoiceNetToBePayed)," ",i.currency," ")}}function qe(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Delivery"),g.\u0275\u0275elementEnd())}function Ge(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275text(1),g.\u0275\u0275pipe(2,"shortDate"),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate1(" ",g.\u0275\u0275pipeBind1(2,1,i.invoiceDeliveryDate)," ")}}function Qe(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Saari Ref."),g.\u0275\u0275elementEnd())}function We(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell",27),g.\u0275\u0275elementStart(1,"mat-form-field",28),g.\u0275\u0275elementStart(2,"input",29),g.\u0275\u0275listener("blur",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext(2).updatedSaariRef(e)})("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.invoiceSaariReference=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit;g.\u0275\u0275advance(2),g.\u0275\u0275property("ngModel",n.invoiceSaariReference)}}function Ue(e,t){1&e&&(g.\u0275\u0275elementStart(0,"mat-header-cell",23),g.\u0275\u0275text(1,"Cashed On"),g.\u0275\u0275elementEnd())}function Xe(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"mat-cell"),g.\u0275\u0275elementStart(1,"mat-form-field",30),g.\u0275\u0275elementStart(2,"input",31),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i).$implicit.invoiceCashedOn=e})("dateChange",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext(2).updatedCashedOn(e)})("blur",function(){var e=g.\u0275\u0275restoreView(i).$implicit;return g.\u0275\u0275nextContext(2).updatedCashedOn(e)})("keypress",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext(2).dateOnly(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(3,"mat-datepicker-toggle",32),g.\u0275\u0275element(4,"mat-datepicker",33,34),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=t.$implicit,a=g.\u0275\u0275reference(5),r=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(2),g.\u0275\u0275property("matDatepicker",a)("ngModel",r.datePipe(n.invoiceCashedOn)),g.\u0275\u0275advance(1),g.\u0275\u0275property("for",a),g.\u0275\u0275advance(1),g.\u0275\u0275property("startView","month")}}function Ke(e,t){1&e&&g.\u0275\u0275element(0,"mat-header-row",35)}function Ze(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}function et(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",39),g.\u0275\u0275text(1),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(1),g.\u0275\u0275textInterpolate2(" \xa0",i.activityTotal,"\xa0",i.currency,"\xa0\xa0 ")}}function tt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"mat-cell",36),g.\u0275\u0275elementStart(1,"strong",37),g.\u0275\u0275text(2),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(3,"strong",37),g.\u0275\u0275text(4,"\xa0\xa0\xa0\xa0-- Net To Pay Total:"),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(5,et,2,2,"div",38),g.\u0275\u0275elementEnd()),2&e){var i=t.$implicit;g.\u0275\u0275advance(2),g.\u0275\u0275textInterpolate(i.activityName),g.\u0275\u0275advance(3),g.\u0275\u0275property("ngForOf",i.activitiesTotal)}}function it(e,t){1&e&&g.\u0275\u0275element(0,"mat-row")}var nt=function(){return["groupHeader"]};function at(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",1),g.\u0275\u0275elementStart(1,"mat-table",2,3),g.\u0275\u0275listener("matSortChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().onSortData(e)}),g.\u0275\u0275elementContainerStart(3,4),g.\u0275\u0275template(4,Pe,2,0,"mat-header-cell",5),g.\u0275\u0275template(5,Ne,3,2,"mat-cell",6),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(6,7),g.\u0275\u0275template(7,Be,2,0,"mat-header-cell",5),g.\u0275\u0275template(8,Oe,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(9,9),g.\u0275\u0275template(10,Ve,2,0,"mat-header-cell",5),g.\u0275\u0275template(11,ze,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(12,10),g.\u0275\u0275template(13,_e,2,0,"mat-header-cell",5),g.\u0275\u0275template(14,$e,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(15,11),g.\u0275\u0275template(16,Le,2,0,"mat-header-cell",5),g.\u0275\u0275template(17,He,3,2,"mat-cell",8),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(18,12),g.\u0275\u0275template(19,Je,2,0,"mat-header-cell",5),g.\u0275\u0275template(20,Ye,3,4,"mat-cell",13),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(21,14),g.\u0275\u0275template(22,qe,2,0,"mat-header-cell",5),g.\u0275\u0275template(23,Ge,3,3,"mat-cell",13),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(24,15),g.\u0275\u0275template(25,Qe,2,0,"mat-header-cell",5),g.\u0275\u0275template(26,We,3,1,"mat-cell",16),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275elementContainerStart(27,17),g.\u0275\u0275template(28,Ue,2,0,"mat-header-cell",5),g.\u0275\u0275template(29,Xe,6,4,"mat-cell",13),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(30,Ke,1,0,"mat-header-row",18),g.\u0275\u0275template(31,Ze,1,0,"mat-row",19),g.\u0275\u0275elementContainerStart(32,20),g.\u0275\u0275template(33,tt,6,2,"mat-cell",21),g.\u0275\u0275elementContainerEnd(),g.\u0275\u0275template(34,it,1,0,"mat-row",22),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("dataSource",n.dataSource),g.\u0275\u0275advance(29),g.\u0275\u0275property("matHeaderRowDef",n.displayedColumns)("matHeaderRowDefSticky",!0),g.\u0275\u0275advance(1),g.\u0275\u0275property("matRowDefColumns",n.displayedColumns),g.\u0275\u0275advance(3),g.\u0275\u0275property("matRowDefColumns",g.\u0275\u0275pureFunction0(6,nt))("matRowDefWhen",n.isGroup)}}var rt=function(){var e=function(){function e(t,n,a,r,c,o,l){i(this,e),this.invoicingService=t,this.dialog=n,this.searchFilterService=a,this.dateTimeService=r,this.router=c,this.activeRoute=o,this.invoicesValidateGroupService=l,this.displayedColumns=["projectName","customer","contractReference","batchReference","invoiceAdressedTo","invoiceDeliveryDate","invoiceNetToBePayed","invoiceSaariReference","invoiceCashedOn"],this.dataSource=new G.by,this.groupByColumns=[],this.expandedSubInvoice=[]}return t(e,[{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditInvoice=!1,this.listView=!0,this.selectedInvoiceId=0,this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.setInvoiceDeposit(),e.dataSource=new G.by(e.invoicesValidateGroupService.addGroupWithTotal(e.searchFilterService.showingDataLastFilter,e.groupByColumns,e.invoicesFiltred))})}},{key:"ngOnChanges",value:function(){this.groupByColumns=["activityName"],(null!==this.invoices||void 0!==this.invoices)&&(this.dataSource=new G.by(this.invoicesValidateGroupService.addGroupWithTotal(this.searchFilterService.showingDataLastFilter,this.groupByColumns,this.invoicesFiltred)))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"setInvoiceDeposit",value:function(){this.searchFilterService.showingDataLastFilter.forEach(function(e){(1===e.invoiceDeposit||3===e.invoiceDeposit)&&(e.invoiceChecked=!0)})}},{key:"isGroup",value:function(e,t){return t.level}},{key:"getValidationState",value:function(e){return 1===e?"validated":"pending"}},{key:"updatedSaariRef",value:function(e){var t=this;this.invoicingService.saveInvoiceSaariRef(e.invoiceId,e.invoiceSaariReference).subscribe(function(){""===e.invoiceSaariReference&&t.invoicingService.reloadInvoices.next()})}},{key:"updatedCashedOn",value:function(e){this.invoicingService.saveInvoiceCashedOn(e.invoiceId,e.invoiceCashedOn)}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"datePipe",value:function(e){return"0001-01-01T00:00:00"===e?"":e}},{key:"onSortData",value:function(e){this.invoicingService.sortAllInvoices.next(e)}},{key:"goToInvoicesDetail",value:function(e,t){this.router.navigate(["/project-management/project/edit/"+e.pifId.toString()+"/"+e.projectId.toString(),{title:"invoices",invoiceId:e.invoiceId}],{relativeTo:this.activeRoute})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(k.X),g.\u0275\u0275directiveInject(d.uw),g.\u0275\u0275directiveInject(D.nJ),g.\u0275\u0275directiveInject(D.Cv),g.\u0275\u0275directiveInject(y.F0),g.\u0275\u0275directiveInject(y.gz),g.\u0275\u0275directiveInject(k.a))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-invoices-validate"]],viewQuery:function(e,t){var i;(1&e&&g.\u0275\u0275viewQuery(q.YE,7),2&e)&&(g.\u0275\u0275queryRefresh(i=g.\u0275\u0275loadQuery())&&(t.sort=i.first))},inputs:{InvoiceEditable:"InvoiceEditable",invoices:"invoices",invoicesFiltred:"invoicesFiltred"},features:[g.\u0275\u0275NgOnChangesFeature],decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSortDirection","asc","matSortDisableClear","","matSort","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","projectName",1,"table-hover","table-striped","table-styling"],["mat-sort-header","",4,"matHeaderCellDef"],["class","link",3,"matTooltip","click",4,"matCellDef"],["matColumnDef","batchReference"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","contractReference"],["matColumnDef","invoiceAdressedTo"],["matColumnDef","customer"],["matColumnDef","invoiceNetToBePayed"],[4,"matCellDef"],["matColumnDef","invoiceDeliveryDate"],["matColumnDef","invoiceSaariReference"],["floatLabel","never","style","text-align: left;",4,"matCellDef"],["matColumnDef","invoiceCashedOn"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["matColumnDef","groupHeader"],["colspan","999",4,"matCellDef"],[4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-sort-header",""],[1,"link",3,"matTooltip","click"],[1,"span-ellipsis"],[3,"matTooltip"],["floatLabel","never",2,"text-align","left"],[2,"width","70%"],["matInput","",2,"border","white",3,"ngModel","blur","ngModelChange"],[2,"width","90%"],["matInput","","name","invoiceCashedOn",3,"matDatepicker","ngModel","ngModelChange","dateChange","blur","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],[1,"table-primary","table-*"],["colspan","999"],[1,"strong"],["class","strong-amount",4,"ngFor","ngForOf"],[1,"strong-amount"]],template:function(e,t){1&e&&g.\u0275\u0275template(0,at,35,7,"div",0),2&e&&g.\u0275\u0275property("ngIf",t.listView)},directives:[c.NgIf,G.BZ,q.YE,G.w1,G.fO,G.Dz,G.as,G.nj,G.ge,q.nU,G.ev,Q.gM,A.KE,M.Nt,l.DefaultValueAccessor,l.NgControlStatus,l.NgModel,T.hl,T.nW,A.R9,T.Mq,G.XQ,G.Gk,c.NgForOf],pipes:[Fe.$,X.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 342px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-groupHeader[_ngcontent-%COMP%]{color:#030303;background-color:#eceaea;font-weight:bolder;font-size:medium;font-family:Arial,Helvetica,sans-serif}.mat-column-projectName[_ngcontent-%COMP%]{flex:0 0 17%!important;width:17%!important}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-contractReference[_ngcontent-%COMP%]{flex:0 0 11%!important;width:11%!important}.mat-column-invoiceAdressedTo[_ngcontent-%COMP%]{flex:0 0 11%!important;width:11%!important}.mat-column-invoiceNetToBePayed[_ngcontent-%COMP%]{flex:0 0 9%!important;width:9%!important;text-align:right;justify-content:flex-end}.mat-column-invoiceDeliveryDate[_ngcontent-%COMP%]{flex:0 0 6%!important;width:6%!important;justify-content:center}.mat-column-invoiceSaariReference[_ngcontent-%COMP%]{flex:0 0 11%!important;width:11%!important;justify-content:center}.mat-column-invoiceCashedOn[_ngcontent-%COMP%]{flex:0 0 11%!important;width:11%!important;justify-content:center}.mat-column-customer[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}  .mat-sort-header-arrow{color:#fff}.strong[_ngcontent-%COMP%]{background:-webkit-linear-gradient(#5a5a5a,black);-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:bold}.strong-amount[_ngcontent-%COMP%]{background:-webkit-linear-gradient(#546cf3,#05274d);-webkit-background-clip:text;-webkit-text-fill-color:transparent}.link[_ngcontent-%COMP%]{color:#00f;cursor:pointer}"]}),e}(),ct=a(27205);function ot(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"nav",23),g.\u0275\u0275elementStart(1,"div",24),g.\u0275\u0275elementStart(2,"button",25),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext(2).exportToExcel()}),g.\u0275\u0275element(3,"em",26),g.\u0275\u0275text(4," Export "),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(5,"div",27),g.\u0275\u0275element(6,"app-paginator",28),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext(2);g.\u0275\u0275advance(6),g.\u0275\u0275property("pageSize",n.searchFilterService.pageSize)("pageIndex",n.searchFilterService.pageIndex)("length",n.countInvoices)}}function lt(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div"),g.\u0275\u0275elementStart(1,"h1"),g.\u0275\u0275text(2,"No Result Found"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function st(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",29),g.\u0275\u0275elementStart(1,"div",30),g.\u0275\u0275elementStart(2,"div",31),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",32),g.\u0275\u0275element(5,"mat-spinner"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd())}function dt(e,t){if(1&e&&(g.\u0275\u0275elementStart(0,"div",33),g.\u0275\u0275element(1,"app-invoices-validate",34),g.\u0275\u0275pipe(2,"paginator"),g.\u0275\u0275elementEnd()),2&e){var i=g.\u0275\u0275nextContext(2);g.\u0275\u0275classProp("blurred",i.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("invoices",g.\u0275\u0275pipeBind3(2,5,i.invoices,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("invoicesFiltred",i.invoices)("InvoiceEditable",i.InvoiceEditable)}}function mt(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",4),g.\u0275\u0275elementStart(1,"div",5),g.\u0275\u0275elementStart(2,"div",6),g.\u0275\u0275elementStart(3,"div",1),g.\u0275\u0275elementStart(4,"div",7),g.\u0275\u0275elementStart(5,"mat-list"),g.\u0275\u0275elementStart(6,"mat-list-item"),g.\u0275\u0275elementStart(7,"h3",8),g.\u0275\u0275text(8,"Period"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(9,"div",9),g.\u0275\u0275elementStart(10,"app-select-month",10),g.\u0275\u0275listener("daysChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().daysChangePeriodFrom(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(11,"div",9),g.\u0275\u0275elementStart(12,"app-select-month",11),g.\u0275\u0275listener("daysChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().daysChangePeriodTo(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(13,"div",7),g.\u0275\u0275elementStart(14,"mat-list"),g.\u0275\u0275elementStart(15,"mat-list-item"),g.\u0275\u0275elementStart(16,"h3",8),g.\u0275\u0275text(17,"Activity"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementStart(18,"div",12),g.\u0275\u0275elementStart(19,"ng-multiselect-dropdown",13),g.\u0275\u0275listener("ngModelChange",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().selectedActivitiesIdentifiers=e}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275element(20,"div",14),g.\u0275\u0275elementStart(21,"div",15),g.\u0275\u0275elementStart(22,"div",16),g.\u0275\u0275elementStart(23,"button",17),g.\u0275\u0275listener("click",function(){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().filterInvoiceButton()}),g.\u0275\u0275text(24,"Search"),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(25,ot,7,3,"nav",18),g.\u0275\u0275template(26,lt,3,0,"div",19),g.\u0275\u0275elementStart(27,"div",20),g.\u0275\u0275template(28,st,6,0,"div",21),g.\u0275\u0275template(29,dt,3,9,"div",22),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(10),g.\u0275\u0275property("selectedDate",n.deliveryStartDate)("maxDate",n.maxDate),g.\u0275\u0275advance(2),g.\u0275\u0275property("selectedDate",n.deliveryEndDate)("minDate",n.minDate),g.\u0275\u0275advance(7),g.\u0275\u0275property("placeholder","Select...")("data",n.activitiesIdentifiers)("ngModel",n.selectedActivitiesIdentifiers)("settings",n.dropdownSettings),g.\u0275\u0275advance(6),g.\u0275\u0275property("ngIf",!n.addInvoice&&!n.isEditInvoice),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",n.emptyResult&&n.listView),g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",n.isLoading),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",n.listView&&!n.isEditInvoice&&!n.emptyResult)}}function vt(e,t){if(1&e){var i=g.\u0275\u0275getCurrentView();g.\u0275\u0275elementStart(0,"div",35),g.\u0275\u0275elementStart(1,"app-edit-invoice",36),g.\u0275\u0275listener("isSavedInvoice",function(e){return g.\u0275\u0275restoreView(i),g.\u0275\u0275nextContext().savedInvoice(e)}),g.\u0275\u0275elementEnd(),g.\u0275\u0275elementEnd()}if(2&e){var n=g.\u0275\u0275nextContext();g.\u0275\u0275advance(1),g.\u0275\u0275property("project",n.project)("isNewInvoice",!n.listView)("isEditInvoice",n.isEditInvoice)("selectedInvoice",n.selectedInvoice)}}var ut=[{path:"",data:{title:"Invoice",function:b.FI.Invoicing,status:!1},canActivate:[x.a1],children:[{path:"invoices-launch",component:je,data:{title:"Invoices Launch",icon:"icon-home",caption:"",function:b.FI.Batches,status:!0},canActivate:[x.a1]},{path:"invoices",component:function(){var e=function(){function e(t,n,a,r,c,o){i(this,e),this.sortService=t,this.searchFilterService=n,this.excelService=a,this.invoicingService=r,this.dateTimeService=c,this.projectService=o,this.emptyResult=!1,this.listView=!1,this.isEditInvoice=!1,this.addInvoice=!1,this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.dropdownSettings={},this.paginatorPipe=new E.Ry(this.searchFilterService),this.subscription=new C.w0}return t(e,[{key:"ngOnInit",value:function(){var e=this,t=this.dateTimeService.today();this.deliveryStartDate=J([t.getFullYear(),t.getMonth()]).toDate(),this.deliveryEndDate=J(t).endOf("month").toDate(),this.minDate=this.deliveryStartDate,this.maxDate=this.deliveryEndDate,this.subscription.add(this.invoicingService.sortAllInvoices.subscribe(function(t){e.onSortData(t)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditInvoice=!1,this.subscription.add(this.invoicingService.reloadInvoices.subscribe(function(t){var i=JSON.parse(sessionStorage.getItem("invoicesSearch")),n=i.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",");e.getInvoices(n,i.deliveryStartDate,i.deliveryEndDate)})),this.countInvoices=0,this.getActivities(),this.subscription.add(this.searchFilterService.resultChanged.subscribe(function(){setTimeout(function(){e.emptyResult=0===e.searchFilterService.showingDataLastFilter.length})}));var i=JSON.parse(sessionStorage.getItem("invoicesSearch"));null!==i&&(this.selectedActivitiesIdentifiers=i.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),null!=i.deliveryStartDate&&(this.deliveryStartDate=i.deliveryStartDate,this.minDate=new Date(this.deliveryStartDate)),null!=i.deliveryEndDate&&(this.deliveryEndDate=i.deliveryEndDate,this.maxDate=new Date(this.deliveryEndDate)))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onResetActivity",value:function(){this.selectedActivitiesIdentifiers=[]}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t,e.selectedActivitiesIds=e.activitiesIdentifiers.map(function(e){return e.id}).join(","),e.onChangeActivity(e.selectedActivitiesIds))})}},{key:"onChangeActivity",value:function(e){this.selectedActivitiesIds=e}},{key:"toggleEditDetails",value:function(e){this.isEditInvoice=!0,this.selectedInvoice=e,this.listView=!1}},{key:"savedInvoice",value:function(e){this.listView=!0,this.isEditInvoice=!1,this.addInvoice=!1,this.getInvoices(this.selectedActivitiesIds,this.deliveryStartDate,this.deliveryEndDate)}},{key:"invoiceCanceled",value:function(e){this.listView=e,this.isEditInvoice=!e,this.getInvoices(this.selectedActivitiesIds,this.deliveryStartDate,this.deliveryEndDate)}},{key:"filterInvoiceButton",value:function(){this.searchFilterService.pageIndex=0,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",");var e=new I.z0;e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.deliveryStartDate=this.deliveryStartDate,e.deliveryEndDate=this.deliveryEndDate,sessionStorage.setItem("invoicesSearch",JSON.stringify(e)),this.getInvoices(this.selectedActivitiesIds,this.deliveryStartDate,this.deliveryEndDate)}},{key:"getInvoices",value:function(e,t,i){var n=this;this.isLoading=!0,this.invoicingService.getInvoices(e,t,i).subscribe(function(e){n.isLoading=!1,null!=e&&(n.invoices=e,n.countInvoices=n.invoices.length,n.emptyResult=!1,n.listView=!0,n.emptyResult=0===e.length)})}},{key:"exportToExcel",value:function(){var e=this;if(void 0!==this.invoices&&0!==this.invoices.length){var t=[];this.invoices.forEach(function(i){var n=[];n.push(i.activityName),n.push(i.projectName),n.push(i.customer),n.push(i.batchReference),n.push(i.contractReference),n.push(i.invoiceAdressedTo),n.push(i.invoiceNetToBePayed),n.push(i.currency),n.push(e.dateFormat(i.invoiceDeliveryDate)),n.push(i.invoiceSaariReference),n.push(e.dateFormat(i.invoiceCashedOn)),t.push(n)}),this.excelService.generateExcel([{header:"Activity",key:"activityName"},{header:"Project",key:"projectName"},{header:"Customer",key:"customer"},{header:"Batch Reference",key:"batchReference"},{header:"Order Reference",key:"contractReference"},{header:"Adressed To",key:"invoiceAdressedTo"},{header:"Net To Pay",key:"invoiceNetToBePayed"},{header:"Currency",key:"currency"},{header:"Invoice Date",key:"invoiceDeliveryDate"},{header:"Saari Ref",key:"invoiceSaariReference"},{header:"Cashed On",key:"invoiceCashedOn"}],t,[],[],"Invoices_Validate")}}},{key:"onClickingEnter",value:function(e){"Enter"===e.key&&this.filterInvoiceButton()}},{key:"dateFormat",value:function(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.invoices&&(this.invoices.sort(function(i,n){var a="asc"===e.direction;switch(e.active){case"projectName":return t.sortService.compare(i.projectName,n.projectName,a,!1);case"batchReference":return t.sortService.compare(i.batchReference,n.batchReference,a,!1);case"invoiceReference":return t.sortService.compare(i.invoiceReference,n.invoiceReference,a,!1);case"contractReference":return t.sortService.compare(i.contractReference,n.contractReference,a,!1);case"invoiceAdressedTo":return t.sortService.compare(i.invoiceAdressedTo,n.invoiceAdressedTo,a,!1);case"invoiceAmount":return t.sortService.compare(i.invoiceAmount,n.invoiceAmount,a,!0);case"invoiceNetToBePayed":return t.sortService.compare(i.invoiceNetToBePayed,n.invoiceNetToBePayed,a,!0);case"invoiceDeliveryDate":return t.sortService.compare(i.invoiceDeliveryDate,n.invoiceDeliveryDate,a,!1);case"invoiceSaariReference":return t.sortService.compare(i.invoiceSaariReference,n.invoiceSaariReference,a,!1);case"invoiceCashedOn":return t.sortService.compare(i.invoiceCashedOn,n.invoiceCashedOn,a,!1);case"customer":return t.sortService.compare(i.customer,n.customer,a,!1);default:return 0}}),this.invoices.sort(function(e,i){return t.sortService.compare(e.activityId,i.activityId,!0,!0)})),this.paginatorPipe.transform(this.invoices,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"daysChangePeriodFrom",value:function(e){var t=new Date(e);this.deliveryStartDate=J([t.getFullYear(),t.getMonth()]).toDate(),this.minDate=this.deliveryStartDate}},{key:"daysChangePeriodTo",value:function(e){var t=new Date(e);this.deliveryEndDate=J(t).endOf("month").toDate(),this.maxDate=this.deliveryEndDate}}]),e}();return e.\u0275fac=function(t){return new(t||e)(g.\u0275\u0275directiveInject(D.Kx),g.\u0275\u0275directiveInject(D.nJ),g.\u0275\u0275directiveInject(D.xB),g.\u0275\u0275directiveInject(k.X),g.\u0275\u0275directiveInject(D.Cv),g.\u0275\u0275directiveInject(w.Y4))},e.\u0275cmp=g.\u0275\u0275defineComponent({type:e,selectors:[["app-all-invoices-validate"]],decls:4,vars:2,consts:[[1,"page-body"],[1,"row"],["class","col-xl-12 col-lg-12 filter-bar",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"search-input","col-sm-5"],[3,"selectedDate","maxDate","daysChange"],[3,"selectedDate","minDate","daysChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],["class","navbar navbar-light bg-faded m-b-10 p-10",4,"ngIf"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","example-container mat-elevation-z8 loaded-content",3,"blurred",4,"ngIf"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"example-container","mat-elevation-z8","loaded-content"],[3,"invoices","invoicesFiltred","InvoiceEditable"],[1,"example-container","mat-elevation-z8"],[3,"project","isNewInvoice","isEditInvoice","selectedInvoice","isSavedInvoice"]],template:function(e,t){1&e&&(g.\u0275\u0275elementStart(0,"div",0),g.\u0275\u0275elementStart(1,"div",1),g.\u0275\u0275template(2,mt,30,12,"div",2),g.\u0275\u0275elementEnd(),g.\u0275\u0275template(3,vt,2,4,"div",3),g.\u0275\u0275elementEnd()),2&e&&(g.\u0275\u0275advance(2),g.\u0275\u0275property("ngIf",!t.isEditInvoice),g.\u0275\u0275advance(1),g.\u0275\u0275property("ngIf",!t.listView&&t.isEditInvoice&&!t.emptyResult))},directives:[c.NgIf,R.i$,R.Tg,Y.j,u.OP,l.NgControlStatus,l.NgModel,j.M2,F.J,P.$g,rt,ct.b],pipes:[O.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.material-icons{font-size:25px}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e}(),data:{title:"Invoices Validate",icon:"icon-home",caption:"",function:b.FI.Invoices,status:!0},canActivate:[x.a1]},{path:"quotations",component:H,data:{title:"Quotations",icon:"icon-home",caption:"",function:b.FI.Estimations,status:!0},canActivate:[x.a1]}]}],ht=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({imports:[[y.Bz.forChild(ut)],y.Bz]}),e}(),pt=a(81040),ft=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[D.nJ],imports:[[c.CommonModule,o.m,l.FormsModule,l.ReactiveFormsModule,o.q,d.Is,u.ZQ.forRoot(),h.HttpClientModule,pt.U,p.o]]}),e}(),gt=a(88720),St=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[D.nJ],imports:[[c.CommonModule,o.m,l.FormsModule,l.ReactiveFormsModule,o.q,d.Is,u.ZQ.forRoot(),h.HttpClientModule,gt.b]]}),e}(),yt={parse:{dateInput:"L"},display:{dateInput:"L",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},xt=function(){var e=function e(){i(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=g.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=g.\u0275\u0275defineInjector({providers:[w.Y4,k.X,k.a,D.n4,D.Kx,{provide:s.Ad,useValue:"fr-FR"},{provide:s._A,useClass:m.t7,deps:[s.Ad]},{provide:s.sG,useValue:yt}],imports:[[c.CommonModule,ht,o.m,l.FormsModule,l.ReactiveFormsModule,o.q,d.Is,v.w,St,S,ft]]}),e}()}}])}();
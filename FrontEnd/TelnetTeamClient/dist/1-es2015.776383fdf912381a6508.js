"use strict";(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[1],{35001:function(e,t,n){n.r(t),n.d(t,{ReservationModule:function(){return ie}});var r=n(38583),s=n(88452),i=n(62028),a=n(63753),o=n(70833);class d{constructor(){this.deskId=0}}var c=n(82636),l=function(e,t,n,r){var s,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var o=e.length-1;o>=0;o--)(s=e[o])&&(a=(i<3?s(a):i>3?s(t,n,a):s(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};function u(e){return Reflect.metadata("type",e)}function m(e){return Reflect.metadata("dir",e)}function p(e){return Reflect.metadata("persisted",e)}var h=(()=>{return(e=h||(h={}))[e.Work=0]="Work",e[e.Holiday=1]="Holiday",e[e.Leave=2]="Leave",h;var e})();class v{constructor(){this.reservationId=0,this.userId=0,this.dayType=h.Work}}l([u(c.sP.Decimal),m(c.Nm.InputOutput),p(!0)],v.prototype,"reservationId",void 0),l([u(c.sP.Decimal),m(c.Nm.Input),p(!0)],v.prototype,"userId",void 0),l([u(c.sP.Decimal),m(c.Nm.Input),p(!0)],v.prototype,"deskId",void 0),l([p(!1)],v.prototype,"deskName",void 0),l([u(c.sP.Date),m(c.Nm.Input),p(!0)],v.prototype,"reservationDate",void 0),l([p(!1)],v.prototype,"dayType",void 0);class g{}class f{constructor(){this.userId=0,this.reservations=[]}}var y=n(16738),k=n(88259),S=n.n(k),b=n(37716),C=n(51586),P=n(13409),D=n(10337);let w=(()=>{class e{constructor(e,t){this.genericService=e,this.entityParameterService=t,this.refreshReservations=new P.Subject,this.selectCurrentWeek=new P.Subject,this.stopResourceReservationsGet=new P.Subject}getActivities(){const e=new C.u;return e.storedProcedureName="FOTT.GetActivities",e.cursorName="activityCurs",this.genericService.createService("/Data/Get",e)}getSubordinatesByPeriod(e,t,n,r){const s=new Array;this.entityParameterService.AddEntityParameter(s,"userId",e,c.sP.Decimal,c.Nm.Input),this.entityParameterService.AddEntityParameter(s,"activitiesId",t,c.sP.Varchar2,c.Nm.Input),this.entityParameterService.AddEntityParameter(s,"periodFrom",n,c.sP.Date,c.Nm.Input),this.entityParameterService.AddEntityParameter(s,"periodTo",r,c.sP.Date,c.Nm.Input);const i=new C.u;return i.storedProcedureName="FOTT.GetSubordinatesByPeriod",i.entitiesParameters=new Array(s),i.cursorName="curs",this.genericService.createService("/Data/Get",i)}getHolidaysByPeriod(e,t){const n=new Array;this.entityParameterService.AddEntityParameter(n,"periodFrom",e,c.sP.Date,c.Nm.Input),this.entityParameterService.AddEntityParameter(n,"periodTo",t,c.sP.Date,c.Nm.Input);const r=new C.u;return r.storedProcedureName="FOTT.GetHolidaysByPeriod",r.entitiesParameters=new Array(n),r.cursorName="curs",this.genericService.createService("/Data/Get",r)}getResourcesLeavesByPeriod(e,t,n){const r=new Array;this.entityParameterService.AddEntityParameter(r,"userId",e,c.sP.Decimal,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodFrom",t,c.sP.Date,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodTo",n,c.sP.Date,c.Nm.Input);const s=new C.u;return s.storedProcedureName="FOTT.GetResourcesLeavesByPeriod",s.entitiesParameters=new Array(r),s.cursorName="curs",this.genericService.createService("/Data/Get",s)}getReservedDesksByPeriod(e,t,n){const r=new Array;this.entityParameterService.AddEntityParameter(r,"userId",e,c.sP.Decimal,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodFrom",t,c.sP.Date,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodTo",n,c.sP.Date,c.Nm.Input);const s=new C.u;return s.storedProcedureName="FOTT.GetReservedDesksByPeriod",s.entitiesParameters=new Array(r),s.cursorName="curs",this.genericService.createService("/Data/Get",s)}getResponsibleDesks(e){const t=new Array;this.entityParameterService.AddEntityParameter(t,"userId",e,c.sP.Decimal,c.Nm.Input);const n=new C.u;return n.storedProcedureName="FOTT.GetResponsibleDesks",n.entitiesParameters=new Array(t),n.cursorName="curs",this.genericService.createService("/Data/Get",n)}updateReservationDesk(e){const t=new Array;this.entityParameterService.AddEntityParameters(t,e);const n=new C.u;return n.storedProcedureName="FOTT.UpdateReservationDesk",n.entitiesParameters=new Array(t),n.outputIdParameterName="reservationId",this.genericService.createService("/Data/Save",n)}copyReservedDesksByPeriod(e,t,n){const r=new Array;this.entityParameterService.AddEntityParameter(r,"resourcesIds",e,c.sP.Varchar2,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodSource",t,c.sP.Varchar2,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"periodDestination",n,c.sP.Varchar2,c.Nm.Input),this.entityParameterService.AddEntityParameter(r,"reservationsCopied",0,c.sP.Decimal,c.Nm.Output);const s=new C.u;return s.storedProcedureName="FOTT.CopyReservedDesksByPeriod",s.entitiesParameters=new Array(r),s.outputIdParameterName="reservationsCopied",this.genericService.createService("/Data/Save",s)}releaseDesks(e){const t=new Array;this.entityParameterService.AddEntityParameter(t,"reservationsId",e,c.sP.NVarchar2,c.Nm.Input),this.entityParameterService.AddEntityParameter(t,"countDesksReleased",0,c.sP.Decimal,c.Nm.Output);const n=new C.u;return n.storedProcedureName="FOTT.ReleaseDesks",n.entitiesParameters=new Array(t),n.outputIdParameterName="countDesksReleased",this.genericService.createService("/Data/Delete",n)}}return e.\u0275fac=function(t){return new(t||e)(b.\u0275\u0275inject(D.MY),b.\u0275\u0275inject(D.RZ))},e.\u0275prov=b.\u0275\u0275defineInjectable({token:e,factory:e.\u0275fac}),e})();var x=n(98295),I=n(49983),R=n(43220),O=n(3679),E=n(62758);let M=(()=>{class e{constructor(e,t){this.desksService=e,this.dtService=t,this.selectedDate=new Date,this.daysChange=new b.EventEmitter}ngOnInit(){0!==this.daysReservation.length&&(this.selectedDate=this.daysReservation[0].date.toDate()),this.getSelectedWeek(),this.currentWeekSubscription=this.desksService.selectCurrentWeek.subscribe(()=>{this.selectedDate=this.dtService.today(),this.getSelectedWeek()})}ngOnDestroy(){this.currentWeekSubscription.unsubscribe()}getSelectedWeek(){this.startOfWeek=y(this.selectedDate).startOf("isoWeek"),this.endOfWeek=y(this.selectedDate).startOf("isoWeek").add(4,"days"),this.getWeekDays()}prevWeek(){this.startOfWeek=y(this.startOfWeek).subtract(1,"weeks").startOf("isoWeek"),this.endOfWeek=y(this.endOfWeek).subtract(1,"weeks"),this.getWeekDays()}nextWeek(){this.startOfWeek=y(this.startOfWeek).add(1,"weeks").startOf("isoWeek"),this.endOfWeek=y(this.endOfWeek).add(1,"weeks"),this.getWeekDays()}getWeekDays(){this.daysReservation=[];let e=this.startOfWeek;for(;e<=this.endOfWeek;)this.daysReservation.push({date:e,dayName:this.dtService.getDayName(e)}),e=e.clone().add(1,"d");this.desksService.stopResourceReservationsGet.next(),this.selectedDate=this.startOfWeek.toDate(),this.daysChange.emit(this.daysReservation)}changeDateEvent(){this.getSelectedWeek()}}return e.\u0275fac=function(t){return new(t||e)(b.\u0275\u0275directiveInject(w),b.\u0275\u0275directiveInject(D.Cv))},e.\u0275cmp=b.\u0275\u0275defineComponent({type:e,selectors:[["app-select-week"]],inputs:{daysReservation:"daysReservation"},outputs:{daysChange:"daysChange"},decls:25,vars:8,consts:[[2,"padding","0px"],["scope","col"],[1,"td-arrow","pointer",3,"click"],[1,"material-icons"],[1,"td-date"],[1,"td-calendar","pointer",3,"click"],["matInput","",3,"matDatepicker","ngModel","ngModelChange","dateChange"],["picker",""]],template:function(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"table"),b.\u0275\u0275element(1,"caption",0),b.\u0275\u0275elementStart(2,"tr"),b.\u0275\u0275element(3,"th",1),b.\u0275\u0275elementStart(4,"td",2),b.\u0275\u0275listener("click",function(){return t.prevWeek()}),b.\u0275\u0275elementStart(5,"em",3),b.\u0275\u0275text(6,"keyboard_arrow_left"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(7,"td",4),b.\u0275\u0275elementStart(8,"span"),b.\u0275\u0275text(9),b.\u0275\u0275pipe(10,"shortDate"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(11,"td",5),b.\u0275\u0275listener("click",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275reference(17).open()}),b.\u0275\u0275elementStart(12,"em",3),b.\u0275\u0275text(13,"date_range"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(14,"mat-form-field"),b.\u0275\u0275elementStart(15,"input",6),b.\u0275\u0275listener("ngModelChange",function(e){return t.selectedDate=e})("dateChange",function(){return t.changeDateEvent()}),b.\u0275\u0275elementEnd(),b.\u0275\u0275element(16,"mat-datepicker",null,7),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(18,"td",4),b.\u0275\u0275elementStart(19,"span"),b.\u0275\u0275text(20),b.\u0275\u0275pipe(21,"shortDate"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(22,"td",2),b.\u0275\u0275listener("click",function(){return t.nextWeek()}),b.\u0275\u0275elementStart(23,"em",3),b.\u0275\u0275text(24,"keyboard_arrow_right"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd()}if(2&e){const e=b.\u0275\u0275reference(17);b.\u0275\u0275advance(9),b.\u0275\u0275textInterpolate(b.\u0275\u0275pipeBind1(10,4,t.startOfWeek)),b.\u0275\u0275advance(6),b.\u0275\u0275property("matDatepicker",e)("ngModel",t.selectedDate),b.\u0275\u0275advance(5),b.\u0275\u0275textInterpolate(b.\u0275\u0275pipeBind1(21,6,t.endOfWeek))}},directives:[x.KE,I.Nt,R.hl,O.DefaultValueAccessor,O.NgControlStatus,O.NgModel,R.Mq],pipes:[E.M],styles:["table[_ngcontent-%COMP%]{width:90%}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:center;border:1px solid gainsboro}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:relative;font-size:25px;cursor:pointer}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-arrow[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:4px}table[_ngcontent-%COMP%]   .pointer[_ngcontent-%COMP%]{cursor:pointer}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]{width:35px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:1px;left:3px}table[_ngcontent-%COMP%]   .td-calendar[_ngcontent-%COMP%]   .mat-form-field[_ngcontent-%COMP%]{width:0px;height:0px;visibility:hidden}"]}),e})();var N=n(4885),W=n(7539),A=n(67827);function _(e,t){1&e&&(b.\u0275\u0275elementStart(0,"div",32),b.\u0275\u0275elementStart(1,"div",33),b.\u0275\u0275elementStart(2,"div",34),b.\u0275\u0275elementStart(3,"div",2),b.\u0275\u0275elementStart(4,"div",35),b.\u0275\u0275element(5,"mat-spinner"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd())}function T(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"mat-checkbox",36),b.\u0275\u0275listener("ngModelChange",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().onlyMySubordinates=t})("change",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().onlyMySubordinatesChanged()}),b.\u0275\u0275text(1," Mines "),b.\u0275\u0275elementEnd()}if(2&e){const e=b.\u0275\u0275nextContext();b.\u0275\u0275property("ngModel",e.onlyMySubordinates)}}function F(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"ng-multiselect-dropdown",37),b.\u0275\u0275listener("ngModelChange",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().selectedActivitiesIdentifiers=t})("click",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().dropDownSelected=!0})("onDropDownClose",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().onDropDownClose()}),b.\u0275\u0275elementEnd()}if(2&e){const e=b.\u0275\u0275nextContext();b.\u0275\u0275property("placeholder","Select Activity...")("settings",e.dropDownSettings)("data",e.activitiesIdentifiers)("ngModel",e.selectedActivitiesIdentifiers)}}function V(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"button",38),b.\u0275\u0275listener("click",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().CopyWeekReservation()}),b.\u0275\u0275element(1,"em",39),b.\u0275\u0275text(2," Copy "),b.\u0275\u0275elementEnd()}}function j(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"button",38),b.\u0275\u0275listener("click",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().PasteWeekReservation()}),b.\u0275\u0275element(1,"em",39),b.\u0275\u0275text(2," Paste "),b.\u0275\u0275elementEnd()}}function B(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"button",38),b.\u0275\u0275listener("click",function(){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().ReleaseAllDesks()}),b.\u0275\u0275element(1,"em",40),b.\u0275\u0275text(2," Release "),b.\u0275\u0275elementEnd()}}function L(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"th",41),b.\u0275\u0275text(1),b.\u0275\u0275pipe(2,"date"),b.\u0275\u0275pipe(3,"shortDate"),b.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate2("",b.\u0275\u0275pipeBind2(2,2,null==e?null:e.date,"ccc")," ",b.\u0275\u0275pipeBind1(3,5,null==e?null:e.date),"")}}function G(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",47),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit,t=b.\u0275\u0275nextContext();b.\u0275\u0275property("colSpan",t.daysReservation.length+2),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.activityName," ")}}function $(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",48),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit,t=b.\u0275\u0275nextContext();b.\u0275\u0275property("colSpan",t.daysReservation.length+2),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.blockName," ")}}function H(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",49),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.userNumber," ")}}function U(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",50),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.userName," ")}}function z(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"td",52),b.\u0275\u0275listener("dragstart",function(t){const n=b.\u0275\u0275restoreView(e).$implicit;return b.\u0275\u0275nextContext(3).dragStartDeskLeave(t,n)})("drop",function(t){const n=b.\u0275\u0275restoreView(e).$implicit;return b.\u0275\u0275nextContext(3).onDeskReserve(t,n)})("dragover",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext(3).onDragOver(t)})("dragleave",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext(3).onDragLeave(t)}),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()}if(2&e){const e=t.$implicit,n=b.\u0275\u0275nextContext(3);b.\u0275\u0275property("ngClass",n.getDayDeskClass(e.dayType))("draggable",0!==e.reservationId),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.deskName,"")}}function J(e,t){if(1&e&&(b.\u0275\u0275elementContainerStart(0),b.\u0275\u0275template(1,z,2,3,"td",51),b.\u0275\u0275elementContainerEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275property("ngForOf",e.reservations)}}function q(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"tr"),b.\u0275\u0275template(1,G,2,2,"td",42),b.\u0275\u0275template(2,$,2,2,"td",43),b.\u0275\u0275template(3,H,2,1,"td",44),b.\u0275\u0275template(4,U,2,1,"td",45),b.\u0275\u0275template(5,J,2,1,"ng-container",46),b.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0===e.userId&&void 0===e.blockName),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0===e.userId&&void 0!==e.blockName),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0!==e.userId),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0!==e.userId),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0!==e.userId)}}function Y(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",57),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.platform," ")}}function X(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"td",58),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()),2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.block," ")}}function Z(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"td",59),b.\u0275\u0275listener("dragstart",function(t){b.\u0275\u0275restoreView(e);const n=b.\u0275\u0275nextContext().$implicit;return b.\u0275\u0275nextContext(2).dragStartDeskReserve(t,n)})("dragover",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext(3).onDragOver(t)})("dragleave",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext(3).onDragLeave(t)})("dragend",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext(3).onDragLeave(t)}),b.\u0275\u0275text(1),b.\u0275\u0275elementEnd()}if(2&e){const e=b.\u0275\u0275nextContext().$implicit;b.\u0275\u0275property("draggable",!0),b.\u0275\u0275advance(1),b.\u0275\u0275textInterpolate1(" ",e.name," ")}}function K(e,t){if(1&e&&(b.\u0275\u0275elementStart(0,"tr"),b.\u0275\u0275template(1,Y,2,1,"td",54),b.\u0275\u0275template(2,X,2,1,"td",55),b.\u0275\u0275template(3,Z,2,2,"td",56),b.\u0275\u0275elementEnd()),2&e){const e=t.$implicit;b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0===e.deskId&&void 0===e.block),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0===e.deskId&&void 0!==e.block),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",0!==e.deskId)}}function Q(e,t){if(1&e){const e=b.\u0275\u0275getCurrentView();b.\u0275\u0275elementStart(0,"div",9),b.\u0275\u0275elementStart(1,"table",53),b.\u0275\u0275listener("drop",function(t){return b.\u0275\u0275restoreView(e),b.\u0275\u0275nextContext().onDeskRelease(t)}),b.\u0275\u0275element(2,"caption",24),b.\u0275\u0275elementStart(3,"thead",25),b.\u0275\u0275elementStart(4,"th",41),b.\u0275\u0275text(5,"Desk"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(6,"tbody",29),b.\u0275\u0275template(7,K,4,3,"tr",30),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd()}if(2&e){const e=b.\u0275\u0275nextContext();b.\u0275\u0275advance(7),b.\u0275\u0275property("ngForOf",e.desks)}}const ee=n(49457),te=[{path:"",data:{title:"Reservation",function:i.FI.DeskReservation,status:!1},canActivate:[a.a1],children:[{path:"desks",component:(()=>{class e{constructor(e,t,n){this.desksService=e,this.dateTimeService=t,this.notificationService=n,this.daysReservation=[],this.daysCopyReservation=[],this.startOfCurrentWeek=y().startOf("isoWeek"),this.endOfCurrentWeek=y().startOf("isoWeek").add(4,"days"),this.periodFrom=this.startOfCurrentWeek.toDate(),this.periodTo=this.endOfCurrentWeek.toDate(),this.isLoading=!1,this.onlyMySubordinates=!0,this.activitiesIdentifiers=[],this.selectedActivitiesIds="",this.selectedActivitiesIdentifiers=[],this.dropDownSettings={},this.dropDownSelected=!1,this.subordonatesResources=[],this.desks=[],this.resourcesWeekReservations=[],this.reservations=[],this.subscription=new o.w0}ngOnInit(){this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.dropDownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.getActivities(),this.getResponsibleDesks(),this.isSuperAdmin()&&!1===this.currentUser.hasSubordinates&&(this.onlyMySubordinates=!1),this.subscription=this.desksService.refreshReservations.subscribe(()=>{this.getResourcesWeekReservation()})}getActivities(){this.desksService.getActivities().subscribe(e=>{null!=e&&(this.activitiesIdentifiers=e)})}getResponsibleDesks(){this.desksService.getResponsibleDesks(this.currentUser.userId).subscribe(e=>{e.forEach(e=>{if(-1===this.desks.findIndex(t=>t.platform===e.platform)){const t=new d;t.platform=e.platform,this.desks.push(t)}if(-1===this.desks.findIndex(t=>t.platform===e.platform&&t.block===e.block)){const t=new d;t.platform=e.platform,t.block=e.block,this.desks.push(t)}this.desks.push(e)})})}isSuperAdmin(){return this.currentUser.groupId===i.Fl.SuperAdmin}getResourcesWeekReservation(){let e;this.isLoading=!0,this.isSuperAdmin()&&!1===this.onlyMySubordinates?(e=214,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(e=>e.id).join(",")):(e=this.currentUser.userId,this.selectedActivitiesIds=""),this.desksService.getSubordinatesByPeriod(e,this.selectedActivitiesIds,this.periodFrom,this.periodTo).subscribe(t=>{t&&t.length>0&&(this.subordonatesResources=t,this.desksService.getReservedDesksByPeriod(e,this.periodFrom,this.periodTo).subscribe(t=>{this.reservations=[],t.forEach(e=>{e.reservationDate=new Date(e.reservationDate),this.reservations.push(Object.assign(new v,e))}),this.desksService.getResourcesLeavesByPeriod(e,this.periodFrom,this.periodTo).subscribe(e=>{this.resourcesLeaves=e,this.getResourcesReservedDesks(),this.isLoading=!1})},()=>{this.isLoading=!1}))},()=>{this.isLoading=!1})}getResourcesReservedDesks(){this.resourcesWeekReservations=[];let e="",t="";this.subordonatesResources.forEach(n=>{let r=this.resourcesWeekReservations.find(e=>e.userId===n.userId);if(void 0===r){if(r=new f,n.activityName!==e){const t=new f;t.activityName=n.activityName,this.resourcesWeekReservations.push(t),e=n.activityName}if(void 0!==n.blockName&&n.blockName!==t){const e=new f;e.activityName=n.activityName,e.blockName=n.blockName,this.resourcesWeekReservations.push(e),t=n.blockName}}r.userId=n.userId,r.userNumber=n.userNumber,r.userName=n.userName,r.activityName=n.activityName,this.daysReservation.forEach(e=>{let t=this.reservations.find(t=>t.userId===n.userId&&t.reservationDate.toDateString()===e.date.toDate().toDateString());t||(t=new v,t.userId=n.userId,t.reservationDate=e.date.toDate()),t.dayType=1===this.daysHolidays[e.date.day()-1].isHoliday?h.Holiday:h.Work,-1!==this.resourcesLeaves.findIndex(t=>t.userId===n.userId&&new Date(t.leaveStartDate)<=e.date.toDate()&&e.date.toDate()>=new Date(t.leaveEndDate))&&(t.dayType=h.Leave),r.reservations.push(t)}),this.resourcesWeekReservations.push(r)})}selectCurrentWeek(){this.desksService.selectCurrentWeek.next()}daysChange(e){null!=e&&(this.daysReservation=e,this.periodFrom=this.daysReservation[0].date.toDate(),this.periodTo=this.daysReservation[e.length-1].date.toDate(),this.desksService.getHolidaysByPeriod(this.periodFrom,this.periodTo).subscribe(e=>{this.daysHolidays=e,this.getResourcesWeekReservation()}))}onlyMySubordinatesChanged(){this.getResourcesWeekReservation()}getResourceReservationClass(){return!0===this.onlyMySubordinates?"col-md-10":"col-md-12"}getDayDeskClass(e){return e===h.Holiday||e===h.Leave?"td-holiday":"td-desk"}onDropDownClose(){this.dropDownSelected&&(this.dropDownSelected=!1,this.getResourcesWeekReservation())}CopyWeekReservation(){0!==this.reservations.length&&(this.daysCopyReservation=[],this.daysReservation.forEach(e=>{const t=new g;t.date=y(e.date.toDate()),t.dayName=e.dayName,this.daysCopyReservation.push(t)}),this.notificationService.info("Copy week successful.<br/>Move to destination week and Paste copied week."))}PasteWeekReservation(){if(0===this.reservations.length){const e=this.subordonatesResources.map(e=>e.userId).join(","),t=this.daysCopyReservation.map(e=>this.dateTimeService.getShortFormat(e.date)).join(","),n=this.daysReservation.map(e=>this.dateTimeService.getShortFormat(e.date)).join(",");this.daysCopyReservation=[],this.desksService.copyReservedDesksByPeriod(e,t,n).subscribe(e=>{this.getResourcesWeekReservation(),0!==e?this.notificationService.success("Reservation week copied successfully."):this.notificationService.danger("Reservation week copy failed.")},()=>{this.getResourcesWeekReservation(),this.notificationService.danger("Reservation week copy failed.")})}else this.notificationService.warning("Copy week failed.<br/>You should release all desks before!")}ReleaseAllDesks(){0!==this.reservations.length?S().fire({text:"Are you sure to release all reserved desks ?",icon:"question",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, release all!",showLoaderOnConfirm:!0,preConfirm:()=>{const e=this.reservations.map(e=>e.reservationId).join(",");this.ReleaseDesks(e)}}):this.notificationService.info("There is no desk to release!")}ReleaseDesks(e){this.desksService.releaseDesks(e).subscribe(e=>{this.getResourcesWeekReservation(),0!==e?this.notificationService.success("Desk released succefully."):this.notificationService.danger("Release desk failed.")},()=>{this.getResourcesWeekReservation(),this.notificationService.danger("Release desk failed.")})}viewPlatformPlan(){ee.saveAs("./assets/docs/SFX ETG1 PF1.pdf","SFX ETG1 PF1")}dragStartDeskReserve(e,t){e.dataTransfer.setData("deskData",JSON.stringify(t))}dragStartDeskLeave(e,t){e.dataTransfer.setData("reservationData",JSON.stringify(t))}onDeskReserve(e,t){if(e.dataTransfer.getData("deskData")){const n=JSON.parse(e.dataTransfer.getData("deskData"));t.deskId=n.id,this.desksService.updateReservationDesk(t).subscribe(e=>{this.getResourcesWeekReservation(),0!==e?this.notificationService.success("Desk reserved successfully."):this.notificationService.danger("Reservation desk failed.")},()=>{this.getResourcesWeekReservation(),this.notificationService.danger("Reservation desk failed.")})}}onDeskRelease(e){if(e.dataTransfer.getData("reservationData")){const t=JSON.parse(e.dataTransfer.getData("reservationData"));this.ReleaseDesks(t.reservationId)}}onDragOver(e){e.stopPropagation(),e.preventDefault()}onDragLeave(e){e.stopPropagation(),e.preventDefault()}}return e.\u0275fac=function(t){return new(t||e)(b.\u0275\u0275directiveInject(w),b.\u0275\u0275directiveInject(D.Cv),b.\u0275\u0275directiveInject(D.gq))},e.\u0275cmp=b.\u0275\u0275defineComponent({type:e,selectors:[["app-desks"]],decls:44,vars:19,consts:[[1,"main-content"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"wrapper"],["class","overlay",4,"ngIf"],[1,"card-body","loaded-content"],[1,"row","m-b-32"],[1,"col-md-2"],[1,"select-current-week"],[1,"f-w-600",3,"click"],[1,"col-sm-2"],[3,"daysReservation","daysChange"],[1,"row","col-sm-8","flex-container"],[1,"col-sm-3"],[1,"text-right","m-t-5"],[3,"ngModel","ngModelChange","change",4,"ngIf"],["class","multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose",4,"ngIf"],[1,"col-sm-6",2,"text-align","right"],["class","btn btn-primary m-r-5","type","submit",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-primary",3,"click"],[3,"ngClass"],[1,"table","text-center","m-b-10"],[2,"padding","0px"],[1,"th-header"],["scope","col",1,"th-user-number"],["scope","col",1,"th-user-name"],["scope","col",4,"ngFor","ngForOf"],[1,"tbody-scroll"],[4,"ngFor","ngForOf"],["class","col-md-2",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[3,"ngModel","ngModelChange","change"],[1,"multi-search",3,"placeholder","settings","data","ngModel","ngModelChange","click","onDropDownClose"],["type","submit",1,"btn","btn-primary","m-r-5",3,"click"],[1,"icofont","icofont-copy"],[1,"icofont","icofont-bin"],["scope","col"],["class","td-activity",3,"colSpan",4,"ngIf"],["class","td-block",3,"colSpan",4,"ngIf"],["class","td-user-number",4,"ngIf"],["class","td-user-name",4,"ngIf"],[4,"ngIf"],[1,"td-activity",3,"colSpan"],[1,"td-block",3,"colSpan"],[1,"td-user-number"],[1,"td-user-name"],[3,"ngClass","draggable","dragstart","drop","dragover","dragleave",4,"ngFor","ngForOf"],[3,"ngClass","draggable","dragstart","drop","dragover","dragleave"],[1,"table","text-center","m-b-10",3,"drop"],["class","td-platform",4,"ngIf"],["class","td-block",4,"ngIf"],["class","td-desk",3,"draggable","dragstart","dragover","dragleave","dragend",4,"ngIf"],[1,"td-platform"],[1,"td-block"],[1,"td-desk",3,"draggable","dragstart","dragover","dragleave","dragend"]],template:function(e,t){1&e&&(b.\u0275\u0275elementStart(0,"div",0),b.\u0275\u0275elementStart(1,"div",1),b.\u0275\u0275elementStart(2,"div",2),b.\u0275\u0275elementStart(3,"div",3),b.\u0275\u0275elementStart(4,"div",4),b.\u0275\u0275elementStart(5,"div",5),b.\u0275\u0275template(6,_,6,0,"div",6),b.\u0275\u0275elementStart(7,"div",7),b.\u0275\u0275elementStart(8,"div",8),b.\u0275\u0275elementStart(9,"div",9),b.\u0275\u0275elementStart(10,"div",10),b.\u0275\u0275elementStart(11,"h5"),b.\u0275\u0275text(12,"Current Week"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(13,"a",11),b.\u0275\u0275listener("click",function(){return t.selectCurrentWeek()}),b.\u0275\u0275text(14),b.\u0275\u0275pipe(15,"shortDate"),b.\u0275\u0275pipe(16,"shortDate"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(17,"div",12),b.\u0275\u0275elementStart(18,"app-select-week",13),b.\u0275\u0275listener("daysChange",function(e){return t.daysChange(e)}),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(19,"div",14),b.\u0275\u0275elementStart(20,"div",15),b.\u0275\u0275elementStart(21,"div",16),b.\u0275\u0275template(22,T,2,1,"mat-checkbox",17),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(23,"div",15),b.\u0275\u0275template(24,F,1,4,"ng-multiselect-dropdown",18),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(25,"div",19),b.\u0275\u0275template(26,V,3,0,"button",20),b.\u0275\u0275template(27,j,3,0,"button",20),b.\u0275\u0275template(28,B,3,0,"button",20),b.\u0275\u0275elementStart(29,"button",21),b.\u0275\u0275listener("click",function(){return t.viewPlatformPlan()}),b.\u0275\u0275text(30,"Plan"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(31,"div",2),b.\u0275\u0275elementStart(32,"div",22),b.\u0275\u0275elementStart(33,"table",23),b.\u0275\u0275element(34,"caption",24),b.\u0275\u0275elementStart(35,"thead",25),b.\u0275\u0275elementStart(36,"th",26),b.\u0275\u0275text(37,"Matricule"),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(38,"th",27),b.\u0275\u0275text(39,"Resource"),b.\u0275\u0275elementEnd(),b.\u0275\u0275template(40,L,4,7,"th",28),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementStart(41,"tbody",29),b.\u0275\u0275template(42,q,6,5,"tr",30),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275template(43,Q,8,1,"div",31),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd(),b.\u0275\u0275elementEnd()),2&e&&(b.\u0275\u0275advance(6),b.\u0275\u0275property("ngIf",t.isLoading),b.\u0275\u0275advance(1),b.\u0275\u0275classProp("blurred",t.isLoading),b.\u0275\u0275advance(7),b.\u0275\u0275textInterpolate2("",b.\u0275\u0275pipeBind1(15,15,t.startOfCurrentWeek),"-",b.\u0275\u0275pipeBind1(16,17,t.endOfCurrentWeek)," "),b.\u0275\u0275advance(4),b.\u0275\u0275property("daysReservation",t.daysReservation),b.\u0275\u0275advance(4),b.\u0275\u0275property("ngIf",t.isSuperAdmin()),b.\u0275\u0275advance(2),b.\u0275\u0275property("ngIf",t.isSuperAdmin()&&!t.onlyMySubordinates),b.\u0275\u0275advance(2),b.\u0275\u0275property("ngIf",t.onlyMySubordinates&&0===t.daysCopyReservation.length),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",t.onlyMySubordinates&&0!==t.daysCopyReservation.length),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",t.onlyMySubordinates),b.\u0275\u0275advance(4),b.\u0275\u0275property("ngClass",t.getResourceReservationClass()),b.\u0275\u0275advance(8),b.\u0275\u0275property("ngForOf",t.daysReservation),b.\u0275\u0275advance(2),b.\u0275\u0275property("ngForOf",t.resourcesWeekReservations),b.\u0275\u0275advance(1),b.\u0275\u0275property("ngIf",t.onlyMySubordinates))},directives:[r.NgIf,M,r.NgClass,r.NgForOf,N.$g,W.oG,O.NgControlStatus,O.NgModel,A.OP],pipes:[E.M,r.DatePipe],styles:[".card-body[_ngcontent-%COMP%]{padding:25px}.multi-search[_ngcontent-%COMP%]{width:100%}.select-current-week[_ngcontent-%COMP%]{color:#3f629d}.f-w-600[_ngcontent-%COMP%]{cursor:pointer}.m-b-32[_ngcontent-%COMP%]{margin-bottom:32px}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border-top:1px solid #bbbbbb;border-left:1px solid #bbbbbb;border-right:1px solid #bbbbbb}.td-activity[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#8e0089;width:100%;font-weight:bold}.td-user-number[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:10%;font-weight:bold}.td-user-name[_ngcontent-%COMP%]{text-align:left;background-color:#e0dedd;width:20%;font-weight:bold}.th-header[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}.th-user-number[_ngcontent-%COMP%]{width:10%}.th-user-name[_ngcontent-%COMP%]{width:20%}.td-platform[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#8e0089;width:100%;font-weight:bold}.td-block[_ngcontent-%COMP%]{text-align:left;color:#fff;background-color:#5489a5;width:100%;font-weight:bold}.td-desk[_ngcontent-%COMP%]{color:#448aff;font-weight:bold;cursor:pointer}.td-holiday[_ngcontent-%COMP%]{color:#448aff;font-weight:bold;background:repeating-linear-gradient(120deg,white,white 4px,pink 4px,pink 6px);cursor:pointer}tbody[_ngcontent-%COMP%]{display:block;overflow:auto;overflow-y:scroll;max-height:calc(100vh - 342px);border-bottom:1px solid #bbbbbb}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}thead[_ngcontent-%COMP%]{width:calc(100% - 1.2em)}.wrapper[_ngcontent-%COMP%]{width:100%;height:100%}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"]}),e})(),data:{title:"Desks",icon:"icon-desk",caption:"",function:i.FI.Desks,status:!0},canActivate:[a.a1]}]}];let ne=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=b.\u0275\u0275defineInjector({imports:[[s.Bz.forChild(te)],s.Bz]}),e})();var re=n(32403);let se=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=b.\u0275\u0275defineInjector({imports:[[r.CommonModule,re.m,O.FormsModule,O.ReactiveFormsModule,re.q,A.ZQ.forRoot()]]}),e})(),ie=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=b.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=b.\u0275\u0275defineInjector({providers:[w],imports:[[r.CommonModule,ne,se]]}),e})()}}]);
!function(){"use strict";function e(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null==n)return;var i,r,a=[],o=!0,l=!1;try{for(n=n.call(e);!(o=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);o=!0);}catch(s){l=!0,r=s}finally{try{o||null==n.return||n.return()}finally{if(l)throw r}}return a}(e,n)||function(e,n){if(!e)return;if("string"==typeof e)return t(e,n);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(e,n)}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function r(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(self.webpackChunktelnetteam_app=self.webpackChunktelnetteam_app||[]).push([[538],{59538:function(t,i,a){a.r(i),a.d(i,{CUSTOM_DT_FORMATS:function(){return Sc},ProjectModule:function(){return yc}});var o=a(38583),l=a(32403),s=a(88452),c=a(3679),d=a(17238),m=a(22238),p=a(70833),u=a(10337),f=a(24438),h=a(44995),v=a(62028),g=a(35929),S=a(37716),y=a(5566),b=a(65939),C=a(85718),E=a(98295),x=a(49983),I=a(67441),w=a(43220),M=a(72458);function P(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n," ")}}function D(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,P,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("name")))}}function j(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function k(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,j,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("description")))}}function O(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",33),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function F(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n," ")}}function A(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,F,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("selectedPhaseId")))}}function _(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",33),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function V(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n," ")}}function N(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,V,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("selectedCategoryId")))}}function R(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function T(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,R,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("plannedStartDate")))}}function B(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function z(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,B,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("plannedEndDate")))}}function q(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function L(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,q,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("plannedDuration")))}}function Q(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function $(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,Q,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("elapsedDuration")))}}function U(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function H(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,U,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("estimatedCharge")))}}function G(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function W(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,G,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.detailsForm.get("advancement")))}}var J=function(e){return{"btn-disabled":e}};function Y(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",34),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().revert()}),S.\u0275\u0275text(1," Cancel "),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275property("disabled",i.isCancelBtnDisabled())("ngClass",S.\u0275\u0275pureFunction1(2,J,i.isCancelBtnDisabled()))}}function K(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",35),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().saveActivityDetails()}),S.\u0275\u0275text(1," Save "),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275property("disabled",i.isSaveBtnDisabled()||i.mutliClickDisable)("ngClass",S.\u0275\u0275pureFunction1(2,J,i.isSaveBtnDisabled()))}}var X,Z=((X=function(){function t(e,i,r,a,o){n(this,t),this.notificationService=e,this.projectService=i,this.dtService=r,this.fb=a,this.showErrorService=o,this.refresh=new S.EventEmitter,this.close=new S.EventEmitter,this.phasesIdentifiers=[],this.phasesCategories=[],this.mutliClickDisable=!1}return r(t,[{key:"ngOnInit",value:function(){var e=this;this.rebuildForm(),this.updateDateRangeValue(),this.isReadOnlyMode=1===this.activity.level,this.disableFormControls(),this.departmentId!==f.vH.Mecanic&&this.departmentId!==f.vH.DATABOX&&(this.departmentId=f.vH.ProjectTelnet),this.getPhases(this.departmentId),this.isEditMode&&this.projectService.getPhaseCategories().subscribe(function(t){e.phasesCategories=t,e.phasesCategories=e.phasesCategories.filter(function(t){return t.phaseId===e.activity.phaseId})})}},{key:"disableFormControls",value:function(){var t=this;this.isReadOnlyMode&&Object.entries(this.detailsForm.controls).forEach(function(n){var i=e(n,1)[0];t.detailsForm.controls[i].disable()}),this.detailsForm.controls.elapsedDuration.disable(),this.detailsForm.controls.estimatedCharge.disable(),this.detailsForm.controls.actualCost.disable(),this.detailsForm.controls.advancement.disable(),this.detailsForm.controls.plannedDuration.disable()}},{key:"updateDateRangeValue",value:function(){this.minStartDate=this.parentStartDate,this.maxStartDate=this.dtService.getMinDate(this.parentEndDate,this.detailsForm.controls.plannedEndDate.value),this.minEndDate=this.dtService.getMaxDate(this.parentStartDate,this.detailsForm.controls.plannedStartDate.value),this.maxEndDate=this.parentEndDate}},{key:"insertNewActivityDetails",value:function(){var e=this.activity;this.activity.activityNumber=e.hasChilds?e.activityNumber+"."+(e.subActivities.length+1):e.activityNumber+".1",this.activity.projectId=e.projectId,this.activity.level=e.level+1,this.activity.parentId=e.activityId,this.activity.subActivities=[],this.activity.assignments=[],this.activity.hasChilds=!1}},{key:"rebuildForm",value:function(){this.detailsForm.reset({name:this.activity.name,description:this.activity.description,selectedPhaseId:this.activity.phaseId,selectedCategoryId:this.activity.categoryId,plannedStartDate:this.activity.plannedStartDate,plannedEndDate:this.activity.plannedEndDate,estimatedCharge:this.activity.estimatedCharge,plannedDuration:this.activity.plannedDuration,elapsedDuration:this.activity.elapsedDuration,advancement:this.activity.advancement,actualCost:this.activity.actualCost})}},{key:"prepareSaveActivity",value:function(){var e=this.detailsForm.value,t=new f.cS;return t.activityId=this.activity.activityId,t.projectId=this.activity.projectId,t.phaseId=this.detailsForm.controls.selectedPhaseId.value,t.categoryId=this.detailsForm.controls.selectedCategoryId.value,t.name=e.name,t.description=e.description,t.plannedStartDate=e.plannedStartDate,t.plannedEndDate=e.plannedEndDate,t.estimatedCharge=e.estimatedCharge,t.advancement=e.advancement,t.actualCost=e.actualCost,t.elapsedDuration=e.elapsedDuration,t}},{key:"revert",value:function(){this.rebuildForm(),this.close.emit()}},{key:"updateOriginalActivity",value:function(e){this.activity.activityId=e.activityId,this.activity.name=e.name,this.activity.description=e.description,this.activity.phaseId=e.phaseId,this.activity.categoryId=e.categoryId,this.activity.plannedStartDate=e.plannedStartDate,this.activity.plannedEndDate=e.plannedEndDate,this.activity.estimatedCharge=e.estimatedCharge,this.activity.advancement=e.advancement,this.activity.actualCost=e.actualCost,this.activity.realEndDate=e.realEndDate,this.activity.status=e.status,this.activity.earnedValue=e.earnedValue,this.activity.spi=e.spi,this.activity.cpi=e.cpi,this.activity.elapsedDuration=e.elapsedDuration}},{key:"saveActivityDetails",value:function(){var e=this;this.mutliClickDisable=!0,setTimeout(function(){e.mutliClickDisable=!1},1e3);var t=this.prepareSaveActivity();this.activity.advancement!==t.advancement?100===t.advancement?(t.realEndDate=this.dtService.today(),t.status=f.fU.Completed):(t.status=f.fU.Started,t.realEndDate=null):(t.status=this.activity.status,t.realEndDate=this.activity.realEndDate),this.projectService.saveActivity(t).subscribe(function(n){0===e.activity.activityId&&(t.activityId=n,e.isEditMode=!0),e.updateOriginalActivity(t),e.updateAllKpis(),e.rebuildForm(),e.notificationService.success("Task saved successfully."),e.refresh.emit()},function(t){e.notificationService.danger("Save task failed")})}},{key:"updateEstimatedCharge",value:function(){var e=0;this.activity.assignments.forEach(function(t){e+=+t.estimatedCharge}),this.detailsForm.patchValue({estimatedCharge:e}),this.detailsForm.controls.estimatedCharge.markAsDirty()}},{key:"activityDateChange",value:function(){this.detailsForm.controls.plannedStartDate.valid&&this.detailsForm.controls.plannedEndDate.valid&&(this.updatePlannedDuration(),this.updateDateRangeValue(),this.updateElapsedDuration())}},{key:"updatePlannedDuration",value:function(){this.detailsForm.patchValue({plannedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.detailsForm.controls.plannedEndDate.value)}),this.detailsForm.controls.plannedDuration.markAsDirty()}},{key:"updateElapsedDuration",value:function(){var e=this;switch(this.activity.status){case f.fU.NotStarted:this.detailsForm.patchValue({elapsedDuration:0});break;case f.fU.Started:this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.dtService.today(),!1)});break;case f.fU.Completed:if(this.activity.hasChilds){var t=null;this.activity.subActivities.forEach(function(n){t=e.dtService.getMaxDate(t,n.realEndDate)}),this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,t)})}else this.detailsForm.patchValue({elapsedDuration:this.dtService.getBusinessDays(this.detailsForm.controls.plannedStartDate.value,this.activity.realEndDate)})}}},{key:"updateAllKpis",value:function(){this.updateEarnedValue(),this.updateSpi(),this.updateCpi()}},{key:"updateEarnedValue",value:function(){var e=+(this.activity.advancement/100*this.activity.estimatedCharge).toFixed(2);this.activity.earnedValue=isNaN(e)?0:e}},{key:"updateSpi",value:function(){if(0!==this.activity.elapsedDuration){var e=+(this.activity.advancement/100*this.activity.plannedDuration/this.activity.elapsedDuration).toFixed(2);this.activity.spi=isNaN(e)?0:e}else this.activity.spi=0}},{key:"updateCpi",value:function(){if(0!==this.activity.actualCost){var e=+(this.activity.earnedValue/this.activity.actualCost).toFixed(2);this.activity.cpi=isNaN(e)?0:e}else this.activity.cpi=0}},{key:"isSaveBtnDisabled",value:function(){return this.isReadOnlyMode||this.detailsForm.invalid}},{key:"isCancelBtnDisabled",value:function(){return this.isReadOnlyMode}},{key:"isCloseBtnDisabled",value:function(){return this.detailsForm.dirty||this.detailsForm.touched}},{key:"getPhases",value:function(e){var t=this;this.projectService.getProjectPhases(e).subscribe(function(e){e.forEach(function(e){t.phasesIdentifiers.push(Object.assign(new C.x,e))})})}},{key:"onChangePhase",value:function(e){var t=this;this.projectService.getPhaseCategories().subscribe(function(n){t.phasesCategories=n,t.phasesCategories=t.phasesCategories.filter(function(t){return t.phaseId===e})}),this.activity.phaseId=e,this.detailsForm.controls.selectedCategoryId.setValue(0)}},{key:"onChangeCategory",value:function(e){this.activity.categoryId=e}}]),t}()).\u0275fac=function(e){return new(e||X)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(c.FormBuilder),S.\u0275\u0275directiveInject(u.n4))},X.\u0275cmp=S.\u0275\u0275defineComponent({type:X,selectors:[["app-activity-details"]],inputs:{departmentId:"departmentId",activity:"activity",isEditMode:"isEditMode",isReadOnlyMode:"isReadOnlyMode",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",detailsForm:"detailsForm"},outputs:{refresh:"refresh",close:"close"},decls:46,vars:26,consts:[[1,"activity-details"],["id","detailsForm",3,"formGroup"],[1,"details-form"],[1,"name"],["placeholder","Task Name","matInput","","name","name","formControlName","name","required","","maxlength","50","appTextValidator",""],[4,"ngIf"],[1,"description"],["placeholder","Description","matInput","","name","activityDesc","formControlName","description","required",""],[1,"phases"],["placeholder","Phases","formControlName","selectedPhaseId","required","",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"categories"],["placeholder","Categories","formControlName","selectedCategoryId","required","",3,"selectionChange"],[1,"start-end-date"],["matInput","","placeholder","Start Date","formControlName","plannedStartDate","required","",3,"min","max","matDatepicker","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End Date","formControlName","plannedEndDate","required","",3,"min","max","matDatepicker","dateChange"],["PickerEndDay",""],[1,"duration"],["placeholder","Planned duration (Days):","matInput","","name","plannedDuration","formControlName","plannedDuration"],["placeholder","Elapsed duration (Days):","matInput","","name","elapsedDuration","formControlName","elapsedDuration"],[1,"charge"],["placeholder","Charge (MD):","matInput","","name","estimatedCharge","formControlName","estimatedCharge"],[1,"advancement"],["placeholder","Progress (%):","matInput","","name","advancement",3,"formControlName"],[1,"actual-cost"],["placeholder","Actual Cost (MD)","matInput","","name","actualCost","formControlName","actualCost"],[1,"activity-btn"],["type","button","class","btn btn-outline-primary m-r-10",3,"disabled","ngClass","click",4,"ngIf"],["class","btn btn-primary",3,"disabled","ngClass","click",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"value"],["type","button",1,"btn","btn-outline-primary","m-r-10",3,"disabled","ngClass","click"],[1,"btn","btn-primary",3,"disabled","ngClass","click"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"form",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"mat-form-field",3),S.\u0275\u0275element(4,"input",4),S.\u0275\u0275template(5,D,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"mat-form-field",6),S.\u0275\u0275element(7,"input",7),S.\u0275\u0275template(8,k,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"mat-form-field",8),S.\u0275\u0275elementStart(10,"mat-select",9),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangePhase(e.value)}),S.\u0275\u0275template(11,O,2,2,"mat-option",10),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(12,A,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"mat-form-field",11),S.\u0275\u0275elementStart(14,"mat-select",12),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCategory(e.value)}),S.\u0275\u0275template(15,_,2,2,"mat-option",10),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(16,N,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"mat-form-field",13),S.\u0275\u0275elementStart(18,"input",14),S.\u0275\u0275listener("dateChange",function(){return t.activityDateChange()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(19,"mat-datepicker-toggle",15),S.\u0275\u0275element(20,"mat-datepicker",16,17),S.\u0275\u0275template(22,T,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"mat-form-field",13),S.\u0275\u0275elementStart(24,"input",18),S.\u0275\u0275listener("dateChange",function(){return t.activityDateChange()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(25,"mat-datepicker-toggle",15),S.\u0275\u0275element(26,"mat-datepicker",16,19),S.\u0275\u0275template(28,z,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"mat-form-field",20),S.\u0275\u0275element(30,"input",21),S.\u0275\u0275template(31,L,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"mat-form-field",20),S.\u0275\u0275element(33,"input",22),S.\u0275\u0275template(34,$,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"mat-form-field",23),S.\u0275\u0275element(36,"input",24),S.\u0275\u0275template(37,H,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"mat-form-field",25),S.\u0275\u0275element(39,"input",26),S.\u0275\u0275template(40,W,2,1,"mat-error",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(41,"mat-form-field",27),S.\u0275\u0275element(42,"input",28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"div",29),S.\u0275\u0275template(44,Y,2,4,"button",30),S.\u0275\u0275template(45,K,2,4,"button",31),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(21),i=S.\u0275\u0275reference(27);S.\u0275\u0275advance(1),S.\u0275\u0275property("formGroup",t.detailsForm),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("name"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("description"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",t.phasesIdentifiers),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("selectedPhaseId"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",t.phasesCategories),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("selectedCategoryId"))),S.\u0275\u0275advance(2),S.\u0275\u0275property("min",t.minStartDate)("max",t.maxStartDate)("matDatepicker",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedStartDate"))),S.\u0275\u0275advance(2),S.\u0275\u0275property("min",t.minEndDate)("max",t.maxEndDate)("matDatepicker",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedEndDate"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("plannedDuration"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("elapsedDuration"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("estimatedCharge"))),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControlName","advancement"),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.detailsForm.get("advancement"))),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",!t.isReadOnlyMode),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.isReadOnlyMode)}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.FormGroupDirective,E.KE,x.Nt,c.DefaultValueAccessor,c.NgControlStatus,c.FormControlName,c.RequiredValidator,c.MaxLengthValidator,o.NgIf,I.gD,o.NgForOf,w.hl,w.nW,E.R9,w.Mq,E.TO,M.ey,o.NgClass],styles:["activity-details[_ngcontent-%COMP%]{overflow:hidden}.activity-btn[_ngcontent-%COMP%]{float:right;padding-right:20px;margin-top:60px}.details-form[_ngcontent-%COMP%]{display:inline-block;padding:10px}.details-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:0 5px}.details-form[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{width:97%}.details-form[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{width:97%}.details-form[_ngcontent-%COMP%]   .phases[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .categories[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .start-end-date[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .duration[_ngcontent-%COMP%]{width:47%}.details-form[_ngcontent-%COMP%]   .charge[_ngcontent-%COMP%]{width:30%}.details-form[_ngcontent-%COMP%]   .advancement[_ngcontent-%COMP%]{width:30%}.details-form[_ngcontent-%COMP%]   .actual-cost[_ngcontent-%COMP%]{width:31%}"]}),X),ee=function(){var e=function(){function e(){n(this,e)}return r(e,[{key:"getLabelCssClass",value:function(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-activity-kpi"]],inputs:{activity:"activity"},decls:53,vars:5,consts:[[1,"table-responsive"],[1,"table","table-border","table-xs"],[2,"padding","0px"],["scope","col"],["colspan","2",1,"text-right"],[1,"text-right",2,"padding-right","0"],[3,"className"],[2,"width","10px","padding-right","0"],[1,"kpi-tooltip"],[1,"material-icons"],[1,"kpi-tooltip-content"],[1,"kpi-tooltip-text"],[1,"kpi-tooltip-inner"],[2,"display","block"],[1,"li-danger"],[1,"li-default"],[1,"li-success"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"table",1),S.\u0275\u0275element(2,"caption",2),S.\u0275\u0275elementStart(3,"tbody"),S.\u0275\u0275elementStart(4,"tr"),S.\u0275\u0275elementStart(5,"th",3),S.\u0275\u0275text(6,"Earned Value:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",4),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"tr"),S.\u0275\u0275elementStart(10,"th",3),S.\u0275\u0275text(11,"SPI:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"td",5),S.\u0275\u0275elementStart(13,"label",6),S.\u0275\u0275text(14),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"td",7),S.\u0275\u0275elementStart(16,"a",8),S.\u0275\u0275elementStart(17,"em",9),S.\u0275\u0275text(18,"info_outline"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"span",10),S.\u0275\u0275elementStart(20,"span",11),S.\u0275\u0275elementStart(21,"span",12),S.\u0275\u0275elementStart(22,"span",13),S.\u0275\u0275text(23,"Schedule Performance Index (SPI) :"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"ul"),S.\u0275\u0275elementStart(25,"li",14),S.\u0275\u0275text(26,"\xa0- SPI < 1 : ahead of schedule"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"li",15),S.\u0275\u0275text(28,"\xa0- SPI = 1 : on time"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"li",16),S.\u0275\u0275text(30,"\xa0- SPI > 1 : behind schedule"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"tr"),S.\u0275\u0275elementStart(32,"th",3),S.\u0275\u0275text(33,"CPI:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(34,"td",5),S.\u0275\u0275elementStart(35,"label",6),S.\u0275\u0275text(36),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(37,"td",7),S.\u0275\u0275elementStart(38,"a",8),S.\u0275\u0275elementStart(39,"em",9),S.\u0275\u0275text(40,"info_outline"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(41,"span",10),S.\u0275\u0275elementStart(42,"span",11),S.\u0275\u0275elementStart(43,"span",12),S.\u0275\u0275elementStart(44,"span",13),S.\u0275\u0275text(45,"Cost Performance Index (CPI) :"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"ul"),S.\u0275\u0275elementStart(47,"li",14),S.\u0275\u0275text(48,"\xa0- CPI < 1 : over budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(49,"li",15),S.\u0275\u0275text(50,"\xa0- CPI = 1 : on budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"li",16),S.\u0275\u0275text(52,"\xa0- CPI > 1 : under budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(8),S.\u0275\u0275textInterpolate1("",t.activity.earnedValue," MD"),S.\u0275\u0275advance(5),S.\u0275\u0275property("className",t.getLabelCssClass(t.activity.spi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.activity.spi," "),S.\u0275\u0275advance(21),S.\u0275\u0275property("className",t.getLabelCssClass(t.activity.cpi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.activity.cpi," "))},styles:['.table[_ngcontent-%COMP%]{margin:0}.table.table-xs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table.table-xs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px}.td-kpi-value[_ngcontent-%COMP%]{padding-right:0}.td-kpi-info[_ngcontent-%COMP%]{width:10px;padding-right:0}.mat-tab-header[_ngcontent-%COMP%]{overflow:visible}.table-responsive[_ngcontent-%COMP%]{overflow:visible;padding:35px 15px}.kpi-tooltip[_ngcontent-%COMP%]{display:inline;position:relative;z-index:999}.kpi-tooltip[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-text[_ngcontent-%COMP%]{transition-delay:0s;transform:scale(1)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-inner[_ngcontent-%COMP%]{transition-delay:.3s;transform:translate(0)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-content[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;transition-delay:0s}.kpi-tooltip-content[_ngcontent-%COMP%]{position:absolute;z-index:9999;width:220px;left:50%;bottom:100%;font-size:12px;line-height:1.4;font-weight:400;color:#fff;background:0 0;opacity:0;margin:0 0 20px -205px;cursor:default;pointer-events:none;-webkit-font-smoothing:antialiased;transition:opacity .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.kpi-tooltip-content[_ngcontent-%COMP%]:after{content:"";bottom:-20px;left:50%;border:solid transparent;height:0;width:0;position:absolute;pointer-events:none;border-color:#007bff transparent transparent;border-width:10px;margin-left:85px}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-text[_ngcontent-%COMP%]{border-bottom:10px solid #007bff;overflow:hidden;transform:scaleX(0);transition:transform .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]{background:#2b2b2b;padding:10px;transform:translateY(100%);transition:transform .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-danger[_ngcontent-%COMP%]{color:#ff5252}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-success[_ngcontent-%COMP%]{color:#11c15b}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-default[_ngcontent-%COMP%]{color:#d6d6d6}a.kpi-tooltip[_ngcontent-%COMP%]{font-weight:700;color:#007bff;z-index:9}']}),e}(),te=a(88259),ne=a.n(te),ie=a(5963),re=a(52110),ae=a(51095),oe=a(38590);function le(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",34),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.Id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.Description," ")}}function se(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n," ")}}function ce(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,se,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("selectedUsersId")))}}function de(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",34),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.roleId),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.roleName," ")}}function me(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n," ")}}function pe(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,me,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("selectedRoleId")))}}function ue(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function fe(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,ue,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("userPlannedStartDate")))}}function he(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n,"")}}function ve(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,he,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("userPlannedEndDate")))}}function ge(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n," ")}}function Se(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,ge,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("estimatedCharge")))}}function ye(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",35),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().updateUserEstimatedCharge()}),S.\u0275\u0275element(1,"em",36),S.\u0275\u0275elementEnd()}}function be(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n," ")}}function Ce(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-error"),S.\u0275\u0275template(1,be,2,1,"mat-error",32),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.showErrorService.getErrors(n.assignmentForm.get("budgetedCharge")))}}function Ee(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",35),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().updateUserBudgetedCharge()}),S.\u0275\u0275element(1,"em",36),S.\u0275\u0275elementEnd()}}function xe(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"tr"),S.\u0275\u0275elementStart(1,"td",37),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(3,"td",37),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"td",38),S.\u0275\u0275text(6),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",38),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",39),S.\u0275\u0275text(10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"td",39),S.\u0275\u0275text(12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"td",40),S.\u0275\u0275elementStart(14,"em",41),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().editAssignment(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"td",40),S.\u0275\u0275elementStart(16,"em",42),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().deleteAssignment(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",i.memberName,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.memberName),S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",i.roleName,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.roleName),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(r.dtService.getShortFormat(i.userPlannedStartDate)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(r.dtService.getShortFormat(i.userPlannedEndDate)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i.estimatedCharge),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i.budgetedCharge)}}var Ie=function(e){return{active:e}};function we(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"li",44),S.\u0275\u0275elementStart(1,"a",45),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).setPage(e)}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(2,Ie,r.pager.currentPage===i)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i)}}var Me=function(e){return{disabled:e}};function Pe(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"ul",43),S.\u0275\u0275elementStart(1,"li",44),S.\u0275\u0275elementStart(2,"a",45),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().setPage(1)}),S.\u0275\u0275text(3,"First"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"li",44),S.\u0275\u0275elementStart(5,"a",45),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.currentPage-1)}),S.\u0275\u0275text(6,"Previous"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,we,3,4,"li",46),S.\u0275\u0275elementStart(8,"li",44),S.\u0275\u0275elementStart(9,"a",45),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setNextPage(e.pager.currentPage+1)}),S.\u0275\u0275text(10,"Next"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"li",44),S.\u0275\u0275elementStart(12,"a",45),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.totalPages)}),S.\u0275\u0275text(13,"Last"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(5,Me,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(7,Me,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",i.pager.pages),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(9,Me,i.pager.currentPage===i.pager.totalPages)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(11,Me,i.pager.currentPage===i.pager.totalPages))}}var De=function(e){return{"btn-disabled":e}},je=function(){var e=function(){function e(t,i,r,a,o,l){n(this,e),this.mailService=t,this.projectService=i,this.notificationService=r,this.pagerService=a,this.dtService=o,this.showErrorService=l,this.users=[],this.pager={},this.rolesList=[],this.isEditAssignmentMode=!1}return r(e,[{key:"ngOnInit",value:function(){this.getProjectMembers(),this.getAllRoles(),0!==this.activity.activityId&&(this.getActivityDetails(this.activity.activityId),this.rebuildForm())}},{key:"updateDateRangeValue",value:function(){this.minStartDate=this.activity.plannedStartDate,this.maxStartDate=this.dtService.getMinDate(this.activity.plannedEndDate,this.assignmentForm.controls.userPlannedEndDate.value),this.minEndDate=this.dtService.getMaxDate(this.activity.plannedStartDate,this.assignmentForm.controls.userPlannedStartDate.value),this.maxEndDate=this.activity.plannedEndDate}},{key:"rebuildForm",value:function(){this.isEditAssignmentMode=!1,this.assignmentForm.reset({selectedUsersId:null,selectedRoleId:null,userPlannedStartDate:this.activity.plannedStartDate,userPlannedEndDate:this.activity.plannedEndDate}),this.updateUserEstimatedCharge(),this.updateUserBudgetedCharge(),this.assignmentForm.controls.selectedUsersId.markAsPristine(),this.assignmentForm.controls.selectedUsersId.markAsUntouched(),this.assignmentForm.controls.selectedUsersId.enable(),this.assignmentForm.controls.selectedRoleId.markAsPristine(),this.assignmentForm.controls.selectedRoleId.markAsUntouched()}},{key:"getActivityDetails",value:function(e){var t=this;this.projectService.getProjectActivityAssignments(e).subscribe(function(e){t.activity.assignments=[],null!=e&&(e.forEach(function(e){t.activity.assignments.push(Object.assign(new f.ot,e))}),t.setPage(1))})}},{key:"clear",value:function(){this.rebuildForm()}},{key:"getSaveBtnLabel",value:function(){return this.isEditAssignmentMode?"Save":"Add"}},{key:"saveAssignment",value:function(){var e=this,t=new f.ot,n="";t.activityId=this.activity.activityId,t.projectId=this.activity.projectId,t.usersIds=this.assignmentForm.controls.selectedUsersId.value,t.roleId=this.assignmentForm.controls.selectedRoleId.value,t.userPlannedStartDate=this.assignmentForm.controls.userPlannedStartDate.value,t.userPlannedEndDate=this.assignmentForm.controls.userPlannedEndDate.value,t.estimatedCharge=this.assignmentForm.controls.estimatedCharge.value,t.budgetedCharge=this.assignmentForm.controls.budgetedCharge.value,this.projectService.saveAssignments(t).subscribe(function(i){0!==i?e.projectService.getProjectActivityAssignments(e.activity.activityId).subscribe(function(i){e.activity.assignments=[],null!=i&&i.forEach(function(t){e.activity.assignments.push(Object.assign(new f.ot,t)),n="",n=t.projectName}),!1===e.isEditAssignmentMode&&e.mailService.taskAssigned(e.activity.name,t.usersIds,n),e.activity.hasAssignment=!0,e.setPage(1),e.rebuildForm()},function(){e.notificationService.danger("Save assignment failed")}):e.notificationService.danger("Failed to save assignments")},function(){e.notificationService.danger("Failed to save assignments")})}},{key:"editAssignment",value:function(e){this.isEditAssignmentMode=!0;var t=[];t.push(e.userId),this.assignmentForm.reset({selectedUsersId:t,selectedRoleId:e.roleId,userPlannedStartDate:e.userPlannedStartDate,userPlannedEndDate:e.userPlannedEndDate,estimatedCharge:e.estimatedCharge,budgetedCharge:e.budgetedCharge}),this.assignmentForm.controls.selectedUsersId.markAsPristine(),this.assignmentForm.controls.selectedUsersId.markAsUntouched(),this.assignmentForm.controls.selectedUsersId.disable(),this.assignmentForm.controls.selectedRoleId.markAsPristine(),this.assignmentForm.controls.selectedRoleId.markAsUntouched()}},{key:"deleteAssignment",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this assignment ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){e.activityId=t.activity.activityId,e.projectId=t.activity.projectId,t.projectService.deleteAssignment(e).subscribe(function(n){0!==n?(t.notificationService.success("Delete assignment succeeded."),t.activity.assignments=t.activity.assignments.filter(function(t){return t.userId!==e.userId}),0===t.activity.assignments.length&&(t.activity.hasAssignment=!1),t.setPage(1),t.rebuildForm()):t.notificationService.danger("Delete assignment failed.")},function(){t.notificationService.danger("Delete assignment failed.")})}})}},{key:"getProjectMembers",value:function(){var e=this;this.projectService.getProjectMembers(this.activity.projectId).subscribe(function(t){e.users=t})}},{key:"setPage",value:function(e){e<1||(this.pager=this.pagerService.getPager(this.activity.assignments.length,e),this.pagedItems=this.activity.assignments.slice(this.pager.startIndex,this.pager.endIndex+1))}},{key:"setNextPage",value:function(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.activity.assignments.length,e),this.pagedItems=this.activity.assignments.slice(this.pager.startIndex,this.pager.endIndex+1)}},{key:"assignmentDateChange",value:function(){this.assignmentForm.controls.userPlannedStartDate.valid&&this.assignmentForm.controls.userPlannedEndDate.valid&&(this.updateUserEstimatedCharge(),this.updateUserBudgetedCharge())}},{key:"updateUserEstimatedCharge",value:function(){this.assignmentForm.patchValue({estimatedCharge:8*this.dtService.getBusinessDays(this.assignmentForm.controls.userPlannedStartDate.value,this.assignmentForm.controls.userPlannedEndDate.value)}),this.assignmentForm.controls.estimatedCharge.markAsDirty()}},{key:"updateUserBudgetedCharge",value:function(){this.assignmentForm.patchValue({budgetedCharge:8*this.dtService.getBusinessDays(this.assignmentForm.controls.userPlannedStartDate.value,this.assignmentForm.controls.userPlannedEndDate.value)}),this.assignmentForm.controls.budgetedCharge.markAsDirty()}},{key:"getAllRoles",value:function(){var e=this;this.projectService.getAllRoles().subscribe(function(t){e.rolesList=[],t.forEach(function(t){e.rolesList.push(Object.assign(new f.jg,t))}),e.rolesList=e.rolesList.filter(function(e){return e.roleId!==v.G7.SQA})})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.YT),S.\u0275\u0275directiveInject(ie.Y),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(re.e),S.\u0275\u0275directiveInject(y.C),S.\u0275\u0275directiveInject(u.n4))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-activity-assignment"]],inputs:{activity:"activity",isEditMode:"isEditMode",isReadOnlyMode:"isReadOnlyMode",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",assignmentForm:"assignmentForm"},decls:59,vars:28,consts:[[1,"activity-assignment"],[3,"submit"],[1,"assignment-form",3,"formGroup"],["assign","ngForm"],[1,"users-list"],["multiple","","placeholder","Resources","formControlName","selectedUsersId","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"roles-list"],["placeholder","Role","formControlName","selectedRoleId","required",""],[1,"start-date"],["matInput","","placeholder","Start Date","formControlName","userPlannedStartDate","required","",3,"matDatepicker","min","max","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerAssgPlannedStartDay",""],[1,"end-date"],["matInput","","placeholder","End Date","formControlName","userPlannedEndDate","required","",3,"min","max","matDatepicker","dateChange"],["PickerAssgPlannedEndDay",""],[1,"user-charge"],["placeholder","Estimate (h)","matInput","","name","estimatedCharge","formControlName","estimatedCharge","required",""],["mat-button","","type","button","matSuffix","","mat-icon-button","",3,"click",4,"ngIf"],["placeholder","Budget (h)","matInput","","name","budgetedCharge","formControlName","budgetedCharge","required",""],[1,"assignment-btn"],["type","button",1,"btn","btn-outline-primary","m-r-10",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled","ngClass"],[1,"assignment-table","table-responsive"],["id","resourceTable",1,"table","table-striped","table-no-bordered"],[2,"padding","0px"],["scope","row",1,"table-name"],["scope","row",1,"table-date"],["scope","row",1,"table-charge"],["scope","row",1,"table-btn"],[4,"ngFor","ngForOf"],["class","pagination pointer","style","float:right",4,"ngIf"],[3,"value"],["mat-button","","type","button","matSuffix","","mat-icon-button","",3,"click"],[1,"icofont","icofont-refresh"],[1,"table-name","span-ellipsis",3,"matTooltip"],[1,"table-date"],[1,"table-charge"],[1,"table-btn"],[1,"icofont","icofont-ui-edit","pointer",3,"click"],[1,"icofont","icofont-ui-delete","pointer",3,"click"],[1,"pagination","pointer",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"form",1),S.\u0275\u0275listener("submit",function(){return t.saveAssignment()}),S.\u0275\u0275elementStart(2,"div",2,3),S.\u0275\u0275elementStart(4,"mat-form-field",4),S.\u0275\u0275elementStart(5,"mat-select",5),S.\u0275\u0275template(6,le,2,2,"mat-option",6),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,ce,2,1,"mat-error",7),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(8,"mat-form-field",8),S.\u0275\u0275elementStart(9,"mat-select",9),S.\u0275\u0275template(10,de,2,2,"mat-option",6),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(11,pe,2,1,"mat-error",7),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"mat-form-field",10),S.\u0275\u0275elementStart(13,"input",11),S.\u0275\u0275listener("dateChange",function(){return t.assignmentDateChange()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(14,fe,2,1,"mat-error",7),S.\u0275\u0275element(15,"mat-datepicker-toggle",12),S.\u0275\u0275element(16,"mat-datepicker",13,14),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(18,"mat-form-field",15),S.\u0275\u0275elementStart(19,"input",16),S.\u0275\u0275listener("dateChange",function(){return t.assignmentDateChange()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(20,ve,2,1,"mat-error",7),S.\u0275\u0275element(21,"mat-datepicker-toggle",12),S.\u0275\u0275element(22,"mat-datepicker",13,17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",18),S.\u0275\u0275element(25,"input",19),S.\u0275\u0275template(26,Se,2,1,"mat-error",7),S.\u0275\u0275template(27,ye,2,0,"button",20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"mat-form-field",18),S.\u0275\u0275element(29,"input",21),S.\u0275\u0275template(30,Ce,2,1,"mat-error",7),S.\u0275\u0275template(31,Ee,2,0,"button",20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"div",22),S.\u0275\u0275elementStart(33,"button",23),S.\u0275\u0275listener("click",function(){return t.clear()}),S.\u0275\u0275text(34,"Clear "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"button",24),S.\u0275\u0275text(36),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(37,"div",25),S.\u0275\u0275elementStart(38,"table",26),S.\u0275\u0275element(39,"caption",27),S.\u0275\u0275elementStart(40,"thead"),S.\u0275\u0275elementStart(41,"tr"),S.\u0275\u0275elementStart(42,"th",28),S.\u0275\u0275text(43,"Member"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"th",28),S.\u0275\u0275text(45,"Role"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"th",29),S.\u0275\u0275text(47,"Start Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"th",29),S.\u0275\u0275text(49,"End Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(50,"th",30),S.\u0275\u0275text(51,"Estimate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(52,"th",30),S.\u0275\u0275text(53,"Budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(54,"th",31),S.\u0275\u0275element(55,"th",31),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(56,"tbody"),S.\u0275\u0275template(57,xe,17,8,"tr",32),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(58,Pe,14,13,"ul",33),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(17),i=S.\u0275\u0275reference(23);S.\u0275\u0275advance(2),S.\u0275\u0275property("formGroup",t.assignmentForm),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngForOf",t.users),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("selectedUsersId"))),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",t.rolesList),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("selectedRoleId"))),S.\u0275\u0275advance(2),S.\u0275\u0275property("matDatepicker",n)("min",t.activity.plannedStartDate)("max",t.dtService.getMinDate(t.activity.plannedEndDate,t.assignmentForm.controls.userPlannedEndDate.value)),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("userPlannedStartDate"))),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("min",t.dtService.getMaxDate(t.activity.plannedStartDate,t.assignmentForm.controls.userPlannedStartDate.value))("max",t.activity.plannedEndDate)("matDatepicker",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("userPlannedEndDate"))),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("estimatedCharge"))),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.assignmentForm.controls.userPlannedStartDate.valid&&t.assignmentForm.controls.userPlannedEndDate.valid),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.showErrorService.hasError(t.assignmentForm.get("budgetedCharge"))),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.assignmentForm.controls.userPlannedStartDate.valid&&t.assignmentForm.controls.userPlannedEndDate.valid),S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!t.assignmentForm.valid)("ngClass",S.\u0275\u0275pureFunction1(26,De,!t.assignmentForm.valid)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.getSaveBtnLabel()," "),S.\u0275\u0275advance(21),S.\u0275\u0275property("ngForOf",t.pagedItems),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.pager.pages&&t.pager.pages.length)}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,c.FormGroupDirective,E.KE,I.gD,c.NgControlStatus,c.FormControlName,c.RequiredValidator,o.NgForOf,o.NgIf,x.Nt,c.DefaultValueAccessor,w.hl,w.nW,E.R9,w.Mq,o.NgClass,M.ey,E.TO,ae.lW,oe.gM],styles:[".activity-assignment[_ngcontent-%COMP%]{overflow:hidden}.assignment-form[_ngcontent-%COMP%]{display:inline-block;padding:10px}.assignment-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{margin:0 5px}.assignment-form[_ngcontent-%COMP%]   .users-list[_ngcontent-%COMP%]{width:65%}.assignment-form[_ngcontent-%COMP%]   .roles-list[_ngcontent-%COMP%]{width:30%;margin-left:2%}.assignment-form[_ngcontent-%COMP%]   .start-date[_ngcontent-%COMP%]{width:25%}.assignment-form[_ngcontent-%COMP%]   .end-date[_ngcontent-%COMP%]{width:25%;margin-left:2%}.assignment-form[_ngcontent-%COMP%]   .user-charge[_ngcontent-%COMP%]{width:20%;margin-left:2%}.assignment-btn[_ngcontent-%COMP%]{float:right}.assignment-table[_ngcontent-%COMP%]{text-align:center;padding-left:15px;padding-right:15px}.assignment-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}.pointer[_ngcontent-%COMP%]{cursor:pointer}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.table-name[_ngcontent-%COMP%]{width:20%!important}.table-date[_ngcontent-%COMP%]{width:15%!important}.table-charge[_ngcontent-%COMP%]{width:10%!important}.table-btn[_ngcontent-%COMP%]{width:5%!important}"]}),e}();function ke(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-tab",10),S.\u0275\u0275element(1,"app-activity-assignment",11),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275propertyInterpolate("label",n.assignmentTabLabel),S.\u0275\u0275property("disabled",!n.activity.activityId),S.\u0275\u0275advance(1),S.\u0275\u0275property("activity",n.activity)("assignmentForm",n.assignmentForm)("isEditMode",n.isEditMode)("isReadOnlyMode",n.isReadOnlyMode)}}var Oe=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.dialogRef=t,this.dialogData=i,this.fb=r,this.dtService=a,this.showErrorService=o,this.activity=new f.cS,this.assignmentTabLabel="Assignment",this.isEditMode="edit"===this.dialogData.mode,this.parentStartDate=this.dialogData.parentStartDate,this.parentEndDate=this.dialogData.parentEndDate,this.createDetailsForm(),this.createAssignmentForm(),this.departmentId=this.dialogData.departmentId,this.isEditMode?this.activity=this.dialogData.activity:this.insertNewActivityDetails()}return r(e,[{key:"ngOnInit",value:function(){this.isReadOnlyMode=1===this.activity.level}},{key:"ngOnDestroy",value:function(){this.close()}},{key:"insertNewActivityDetails",value:function(){var e=this.dialogData.activity;this.activity.activityNumber=e.hasChilds?e.activityNumber+"."+(e.subActivities.length+1):e.activityNumber+".1",this.activity.projectId=e.projectId,this.activity.level=e.level+1,this.activity.parentId=e.activityId,this.activity.subActivities=[],this.activity.assignments=[],this.activity.hasChilds=!1}},{key:"createDetailsForm",value:function(){this.detailsForm=this.fb.group({name:new c.FormControl("",c.Validators.required),description:new c.FormControl("",c.Validators.required),selectedPhaseId:new c.FormControl("",c.Validators.required),selectedCategoryId:new c.FormControl("",c.Validators.required),plannedStartDate:new c.FormControl("",[c.Validators.required,Fe(this)]),plannedEndDate:new c.FormControl("",[c.Validators.required,Ae(this)]),estimatedCharge:new c.FormControl("",[g.d.numeric,c.Validators.min(0)]),plannedDuration:new c.FormControl("",[g.d.numeric,c.Validators.min(0)]),elapsedDuration:new c.FormControl("",[g.d.numeric,c.Validators.min(0)]),advancement:new c.FormControl("",[g.d.numeric,c.Validators.min(0),c.Validators.max(100)]),actualCost:new c.FormControl("",[g.d.numeric,c.Validators.min(0)])})}},{key:"createAssignmentForm",value:function(){this.assignmentForm=this.fb.group({selectedUsersId:new c.FormControl("",c.Validators.required),selectedRoleId:new c.FormControl("",c.Validators.required),userPlannedStartDate:new c.FormControl("",[c.Validators.required,_e(this)]),userPlannedEndDate:new c.FormControl("",[c.Validators.required,Ve(this)]),estimatedCharge:new c.FormControl("",[g.d.numeric,c.Validators.min(0)]),budgetedCharge:new c.FormControl("",[g.d.numeric,c.Validators.min(0)])})}},{key:"refresh",value:function(){var e=8*this.dtService.getBusinessDays(this.activity.plannedStartDate,this.activity.plannedEndDate);this.assignmentForm.reset({selectedUsersId:null,selectedRoleId:null,userPlannedStartDate:this.activity.plannedStartDate,userPlannedEndDate:this.activity.plannedEndDate,estimatedCharge:e,budgetedCharge:e})}},{key:"close",value:function(){this.dialogRef.close()}},{key:"isCloseBtnDisabled",value:function(){return void 0!==this.detailsForm&&(this.detailsForm.dirty||this.detailsForm.touched)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(m.WI),S.\u0275\u0275directiveInject(c.FormBuilder),S.\u0275\u0275directiveInject(y.C),S.\u0275\u0275directiveInject(u.n4))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-editactivity"]],decls:15,vars:12,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["label","Details"],[3,"isEditMode","departmentId","activity","detailsForm","isReadOnlyMode","parentStartDate","parentEndDate","close","refresh"],[3,"label","disabled",4,"ngIf"],["label","KPI",3,"disabled"],[2,"padding","15px 0"],[3,"activity"],[3,"label","disabled"],[3,"activity","assignmentForm","isEditMode","isReadOnlyMode"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"span"),S.\u0275\u0275elementStart(5,"em",2),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(6,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",3),S.\u0275\u0275elementStart(8,"mat-tab-group"),S.\u0275\u0275elementStart(9,"mat-tab",4),S.\u0275\u0275elementStart(10,"app-activity-details",5),S.\u0275\u0275listener("close",function(){return t.close()})("refresh",function(){return t.refresh()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(11,ke,2,6,"mat-tab",6),S.\u0275\u0275elementStart(12,"mat-tab",7),S.\u0275\u0275elementStart(13,"div",8),S.\u0275\u0275element(14,"app-activity-kpi",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate2(" ",t.activity.name," [",t.activity.activityNumber,"] "),S.\u0275\u0275advance(7),S.\u0275\u0275property("isEditMode",t.isEditMode)("departmentId",t.departmentId)("activity",t.activity)("detailsForm",t.detailsForm)("isReadOnlyMode",t.isReadOnlyMode)("parentStartDate",t.parentStartDate)("parentEndDate",t.parentEndDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.activity.hasChilds&&1!=t.activity.level),S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",!t.activity.activityId),S.\u0275\u0275advance(2),S.\u0275\u0275property("activity",t.activity))},directives:[b.SP,b.uX,Z,o.NgIf,ee,je],styles:[".mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{white-space:nowrap}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   .btn-icon.edit[_ngcontent-%COMP%]{padding:0;margin:0}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:14px;font-weight:bold}"]}),e}();function Fe(e){return function(t){var n=t.value,i=e.activity;return i.hasChilds&&i.subActivities.some(function(t){return e.dtService.isBefore(t.plannedStartDate,n)})?{childStartDate:!0}:i.assignments&&i.assignments.some(function(t){return e.dtService.isBefore(t.userPlannedStartDate,n)})?{assingnmentStartDate:!0}:null}}function Ae(e){return function(t){var n=t.value,i=e.activity;return e.dtService.isBefore(e.parentEndDate,n)?{parentEndDate:!0}:i.hasChilds&&i.subActivities.some(function(t){return e.dtService.isAfter(t.plannedEndDate,n)&&!e.dtService.areEqual(t.plannedEndDate,n)})?{childEndDate:!0}:i.assignments&&i.assignments.some(function(t){return e.dtService.isAfter(t.userPlannedEndDate,n)&&!e.dtService.areEqual(t.userPlannedEndDate,n)})?{assingnmentEndDate:!0}:null}}function _e(e){return function(t){return e.dtService.isBefore(t.value,e.activity.plannedStartDate)?{activityStartDate:!0}:null}}function Ve(e){return function(t){return e.dtService.isAfter(t.value,e.activity.plannedEndDate)?{activityEndDate:!0}:null}}var Ne=a(96523),Re=a(76627),Te=a(62758),Be=function(){var e=function e(t,i){n(this,e),this.dtService=t,this.projectService=i};return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(h.Y4))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-details"]],inputs:{isProject:"isProject",project:"project"},decls:67,vars:15,consts:[[1,"row"],[1,"col-sm-6"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"],[1,"technologies"],[1,"label","label-pink"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"table",3),S.\u0275\u0275element(4,"caption",4),S.\u0275\u0275elementStart(5,"tbody"),S.\u0275\u0275elementStart(6,"tr"),S.\u0275\u0275elementStart(7,"th",5),S.\u0275\u0275text(8,"Activity"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",6),S.\u0275\u0275text(10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"tr"),S.\u0275\u0275elementStart(12,"th",5),S.\u0275\u0275text(13,"Customer"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"td",6),S.\u0275\u0275text(15),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"tr"),S.\u0275\u0275elementStart(17,"th",5),S.\u0275\u0275text(18,"Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"td",7),S.\u0275\u0275text(20),S.\u0275\u0275pipe(21,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"th",5),S.\u0275\u0275text(23,"End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"td",7),S.\u0275\u0275text(25),S.\u0275\u0275pipe(26,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"tr"),S.\u0275\u0275elementStart(28,"th",5),S.\u0275\u0275text(29,"Technology"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"td",6),S.\u0275\u0275elementStart(31,"div",8),S.\u0275\u0275elementStart(32,"label",9),S.\u0275\u0275text(33),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(34,"div",1),S.\u0275\u0275elementStart(35,"div",2),S.\u0275\u0275elementStart(36,"table",3),S.\u0275\u0275element(37,"caption",4),S.\u0275\u0275elementStart(38,"tbody"),S.\u0275\u0275elementStart(39,"tr"),S.\u0275\u0275elementStart(40,"th",5),S.\u0275\u0275text(41,"Company"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(42,"td",6),S.\u0275\u0275text(43),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"tr"),S.\u0275\u0275elementStart(45,"th",5),S.\u0275\u0275text(46,"Contact"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(47,"td",7),S.\u0275\u0275text(48),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(49,"th",5),S.\u0275\u0275text(50,"Place"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"td",7),S.\u0275\u0275text(52),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"tr"),S.\u0275\u0275elementStart(54,"th",5),S.\u0275\u0275text(55,"Category"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(56,"td",7),S.\u0275\u0275text(57),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(58,"th",5),S.\u0275\u0275text(59,"Cost (MD)"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(60,"td",7),S.\u0275\u0275text(61),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(62,"tr"),S.\u0275\u0275elementStart(63,"th",5),S.\u0275\u0275text(64,"Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(65,"td",6),S.\u0275\u0275text(66),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate(t.project.activityName),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.project.customerName),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(21,11,t.project.plannedStartDate)),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(26,13,t.project.plannedEndDate)),S.\u0275\u0275advance(8),S.\u0275\u0275textInterpolate(t.project.technologieName),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate(t.project.companyName),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.project.customerContact),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate(t.project.customerPlace),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.project.categoryName),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate(t.project.cost),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.project.reference))},pipes:[Te.M],styles:[".td-description[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}.technologies[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle}.technologies[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{border-radius:9px;font-size:85%;padding:4px 8px;margin-right:4px}.technologies[_ngcontent-%COMP%]   .label-pink[_ngcontent-%COMP%]{background:#e83e8c}"]}),e}(),ze=a(46782),qe=a(15257),Le=a(36144),Qe=a(52218),$e=a(72172),Ue=["techSelect"],He=["pifDetailsForm"],Ge=["clientSelect"];function We(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Je(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Ye(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Ke(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Xe(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Ze(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",36),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function et(e,t){1&e&&(S.\u0275\u0275elementStart(0,"button",37),S.\u0275\u0275text(1,"Save"),S.\u0275\u0275elementEnd())}function tt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"button",38),S.\u0275\u0275text(1,"Create"),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("disabled",n.mutliClickDisable)}}function nt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",39),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onCancel()}),S.\u0275\u0275text(1,"Cancel"),S.\u0275\u0275elementEnd()}}function it(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",39),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().loadProjects()}),S.\u0275\u0275text(1,"Cancel"),S.\u0275\u0275elementEnd()}}var rt=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.notificationService=i,this._router=r,this.dateTimeService=a,this.projectEvent=new S.EventEmitter,this.statusIdentifiers=[],this.mutliClickDisable=!1,this.clientFilterCtrl=new c.FormControl,this.technologyFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ,this.filteredClients=new p.tq(1),this.filteredTechnologies=new p.tq(1)}return r(e,[{key:"toggleEditDetails",value:function(){this.projectService.toggleEditDetails.emit()}},{key:"ngOnInit",value:function(){var e=this;this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.isQA=this.currentUser.activityId===v.RS.Quality,0!==this.pifId?this.projectService.getProjectDetails(this.pifId,this.projectId).subscribe(function(t){null!=t&&(e.project=Object.assign(new f.IK,t[0]),e.getActivities(),e.getCompanies(),e.getCategories(),e.getClients(),e.getTechnologies(),e.getStatus())}):(this.getActivities(),this.getCompanies(),this.getCategories(),this.getClients(),this.getTechnologies(),this.getStatus()),this.clientFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterClients()}),this.technologyFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterTechnologies()})}},{key:"ngOnDestroy",value:function(){this.activitiesIdentifiers=[],this.companiesIdentifiers=[],this.clientsIdentifiers=[],this.categoriesIdentifiers=[],this.technologiesIdentifiers=[]}},{key:"ngAfterViewInit",value:function(){this.setInitialValue()}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t,e.onChangeActivity(e.project.activityId))})}},{key:"getCompanies",value:function(){var e=this;this.projectService.getCompanies().subscribe(function(t){null!=t&&(e.companiesIdentifiers=t,e.onChangeCompany(e.project.companyId))})}},{key:"getCategories",value:function(){var e=this;this.projectService.getCategories().subscribe(function(t){null!=t&&(e.categoriesIdentifiers=t,e.onChangeCategory(e.project.categoryId))})}},{key:"getClients",value:function(){var e=this;this.projectService.getClients().subscribe(function(t){null!=t&&(e.clientsIdentifiers=t,e.onChangeCustomer(e.project.customerId),e.filteredClients.next(e.clientsIdentifiers.slice()))})}},{key:"getTechnologies",value:function(){var e=this;this.projectService.getTechnologies().subscribe(function(t){null!=t&&(e.technologiesIdentifiers=t,e.onChangeTechnologie(e.project.technologieId),e.filteredTechnologies.next(e.technologiesIdentifiers.slice()))}),this.groupsSelect.value=this.project.technologieId}},{key:"getStatus",value:function(){var e=this;this.projectService.getProjectStates().subscribe(function(t){null!=t&&(e.statusIdentifiers=t,null==e.project.statusId||e.onChangeStatus(e.project.statusId),e.isProject?e.statusIdentifiers=e.statusIdentifiers.filter(function(e){return e.id!==f.kJ.Planned}):e.project.statusId=f.kJ.Planned)})}},{key:"save",value:function(e,t){var n=this;this.mutliClickDisable=!0,setTimeout(function(){n.mutliClickDisable=!1},1e3),this.validDetails()&&(this.project.cost=+this.project.cost.toString().replace(",","."),this.projectService.saveProjectDetails(this.project).subscribe(function(e){null!=e&&(0!==e?0===n.project.projectId?(n.project.pifId=e,n.project.categoryName=n.selectedCategoryIdentifier.description,n.project.activityName=n.selectedActivityIdentifier.description,n.project.companyName=n.selectedCompanyIdentifier.description,n.project.customerName=n.selectedCustomerIdentifier.description,n.notificationService.success("The project [ "+n.project.name+" ] was saved successfully."),n.projectEvent.emit(n.project),n._router.navigate(["/project-management/project/edit/"+e+"/0"])):(n.project.categoryName=n.selectedCategoryIdentifier.description,n.project.activityName=n.selectedActivityIdentifier.description,n.project.companyName=n.selectedCompanyIdentifier.description,n.project.customerName=n.selectedCustomerIdentifier.description,n.notificationService.success("The project [ "+n.project.name+" ] was saved successfully."),n.projectEvent.emit(n.project),n.projectService.toggleEditDetails.emit()):n.notificationService.danger("Save project failed"))}))}},{key:"validDetails",value:function(){if(this.detailsForm.valid){if(this.addEvent())return!0;this.notificationService.danger("Please check dates")}else this.notificationService.danger("Please fill all required fields");return!1}},{key:"onCancel",value:function(){this.projectService.toggleEditDetails.emit()}},{key:"onChangeCategory",value:function(e){this.selectedCategoryIdentifier=this.categoriesIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeActivity",value:function(e){this.selectedActivityIdentifier=this.activitiesIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeCompany",value:function(e){this.selectedCompanyIdentifier=this.companiesIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeCustomer",value:function(e){this.selectedCustomerIdentifier=this.clientsIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeTechnologie",value:function(e){this.selectedTechnologyIdentifier=this.technologiesIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeStatus",value:function(e){this.selectedStatusIdentifier=this.statusIdentifiers.find(function(t){return t.id===e}),this.isProject&&(this.project.status=this.selectedStatusIdentifier.description)}},{key:"addEvent",value:function(){return this.project.plannedEndDate&&(this.project.plannedEndDate=new Date(this.project.plannedEndDate)),this.project.plannedStartDate&&(this.project.plannedStartDate=new Date(this.project.plannedStartDate)),this.project.realEndDate&&(this.project.realEndDate=new Date(this.project.realEndDate)),this.project.realStartDate&&(this.project.realStartDate=new Date(this.project.realStartDate)),!(this.project.plannedStartDate&&this.project.plannedEndDate||this.project.realStartDate&&this.project.realEndDate)||!(this.isNewPif&&this.project.plannedStartDate>this.project.plannedEndDate||!this.isNewPif&&(this.project.realStartDate>this.project.realEndDate||this.project.plannedStartDate>this.project.plannedEndDate))||(this.notificationService.danger("End Date must be greater than Start Date"),!1)}},{key:"numberOnly",value:function(e){var t=e.which?e.which:e.keyCode;return!(t>31&&(t<44||t>57)||45===t||47===t)}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"loadProjects",value:function(){this._router.navigate(["/project-management/project/list"])}},{key:"setInitialValue",value:function(){this.filteredClients.pipe((0,qe.q)(1),(0,ze.R)(this._onDestroy)),this.filteredTechnologies.pipe((0,qe.q)(1),(0,ze.R)(this._onDestroy))}},{key:"filterClients",value:function(){if(this.clientsIdentifiers){var e=this.clientFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredClients.next(this.clientsIdentifiers.filter(function(t){return t.description.toLowerCase().indexOf(e)>-1}))):this.filteredClients.next(this.clientsIdentifiers.slice())}}},{key:"filterTechnologies",value:function(){if(this.technologiesIdentifiers){var e=this.technologyFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredTechnologies.next(this.technologiesIdentifiers.filter(function(t){return t.description.toLowerCase().indexOf(e)>-1}))):this.filteredTechnologies.next(this.technologiesIdentifiers.slice())}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(u.Cv))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-details"]],viewQuery:function(e,t){var n;(1&e&&(S.\u0275\u0275viewQuery(Ue,7),S.\u0275\u0275viewQuery(He,7),S.\u0275\u0275viewQuery(Ge,7)),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.groupsSelect=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.detailsForm=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.clientSelect=n.first))},inputs:{projectId:"projectId",pifId:"pifId",project:"project",isNewPif:"isNewPif",isProject:"isProject"},outputs:{projectEvent:"projectEvent"},decls:68,vars:44,consts:[["id","pifDetailsForm",3,"submit"],["pifDetailsForm","ngForm"],[1,"row"],[1,"col-sm-6"],["placeholder","Name","matInput","","name","name","required","","maxlength","100","appTextValidator","",3,"ngModel","ngModelChange"],[1,"col-sm-3"],["placeholder","Abreviation","matInput","","name","abreviation","required","","maxlength","20","appTextValidator","",3,"ngModel","ngModelChange"],["placeholder","Status","name","status","required","",3,"ngModel","disabled","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-12"],["matInput","","placeholder","Description","name","description","required","",3,"ngModel","ngModelChange"],["placeholder","Activity","name","activity","required","",3,"ngModel","ngModelChange","selectionChange"],["placeholder","Company","name","company","required","",3,"ngModel","ngModelChange","selectionChange"],["placeholder","Customer","name","customer","required","",3,"ngModel","ngModelChange","selectionChange"],["clientSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],["placeholder","Contact","matInput","","name","customerContact","maxlength","100","appTextValidator","","required","",3,"ngModel","ngModelChange"],["placeholder","Place","matInput","","name","customerPlace","maxlength","100","appTextValidator","","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Start","name","plannedStartDate","required","",3,"matDatepicker","ngModel","keypress","ngModelChange","dateChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End","name","plannedEndDate","required","",3,"matDatepicker","ngModel","keypress","ngModelChange","dateChange"],["PickerEndDay",""],["placeholder","Category","name","category","required","",3,"ngModel","ngModelChange","selectionChange"],["selectcategory",""],["color","red",1,"col-sm-3"],["placeholder","Cost (MD)","matInput","","name","cost","required","","appNumberValidator","",3,"ngModel","inputValue","ngModelChange","keypress"],["placeholder","Technology","name","technologies","required","",3,"ngModel","ngModelChange","selectionChange"],["techSelect",""],["placeholder","Reference","matInput","","name","reference",3,"ngModel","disabled","ngModelChange"],[1,"text-center"],["type","submit","class","btn btn-md btn-primary ripple light m-r-20",4,"ngIf"],["type","submit","class","btn btn-md btn-primary ripple light m-r-20",3,"disabled",4,"ngIf"],["type","reset","class","btn btn-md btn-default ripple",3,"click",4,"ngIf"],[3,"value"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled"],["type","reset",1,"btn","btn-md","btn-default","ripple",3,"click"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"form",0,1),S.\u0275\u0275listener("submit",function(){return t.save()}),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"mat-form-field",3),S.\u0275\u0275elementStart(4,"input",4),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.name=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"mat-form-field",5),S.\u0275\u0275elementStart(6,"input",6),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.abreviation=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"mat-form-field",5),S.\u0275\u0275elementStart(8,"mat-select",7),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.statusId=e})("selectionChange",function(e){return t.onChangeStatus(e.value)}),S.\u0275\u0275template(9,We,2,2,"mat-option",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(10,"div",2),S.\u0275\u0275elementStart(11,"mat-form-field",9),S.\u0275\u0275elementStart(12,"textarea",10),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.description=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"div",2),S.\u0275\u0275elementStart(14,"mat-form-field",3),S.\u0275\u0275elementStart(15,"mat-select",11),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.activityId=e})("selectionChange",function(e){return t.onChangeActivity(e.value)}),S.\u0275\u0275template(16,Je,2,2,"mat-option",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"mat-form-field",3),S.\u0275\u0275elementStart(18,"mat-select",12),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.companyId=e})("selectionChange",function(e){return t.onChangeCompany(e.value)}),S.\u0275\u0275template(19,Ye,2,2,"mat-option",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(20,"div",2),S.\u0275\u0275elementStart(21,"mat-form-field",3),S.\u0275\u0275elementStart(22,"mat-select",13,14),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerId=e})("selectionChange",function(e){return t.onChangeCustomer(e.value)}),S.\u0275\u0275elementStart(24,"mat-option"),S.\u0275\u0275elementStart(25,"ngx-mat-select-search",15),S.\u0275\u0275elementStart(26,"mat-icon",16),S.\u0275\u0275text(27,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(28,Ke,2,2,"mat-option",8),S.\u0275\u0275pipe(29,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"mat-form-field",5),S.\u0275\u0275elementStart(31,"input",17),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerContact=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"mat-form-field",5),S.\u0275\u0275elementStart(33,"input",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.customerPlace=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(34,"div",2),S.\u0275\u0275elementStart(35,"mat-form-field",5),S.\u0275\u0275elementStart(36,"input",19),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.project.plannedStartDate=e})("dateChange",function(){return t.addEvent()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(37,"mat-datepicker-toggle",20),S.\u0275\u0275element(38,"mat-datepicker",21,22),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"mat-form-field",5),S.\u0275\u0275elementStart(41,"input",23),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.project.plannedEndDate=e})("dateChange",function(){return t.addEvent()}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(42,"mat-datepicker-toggle",20),S.\u0275\u0275element(43,"mat-datepicker",21,24),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"mat-form-field",5),S.\u0275\u0275elementStart(46,"mat-select",25,26),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.categoryId=e})("selectionChange",function(e){return t.onChangeCategory(e.value)}),S.\u0275\u0275template(48,Xe,2,2,"mat-option",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(49,"mat-form-field",27),S.\u0275\u0275elementStart(50,"input",28),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.cost=e})("keypress",function(e){return t.numberOnly(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"div",2),S.\u0275\u0275elementStart(52,"mat-form-field",3),S.\u0275\u0275elementStart(53,"mat-select",29,30),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.technologieId=e})("selectionChange",function(e){return t.onChangeTechnologie(e.value)}),S.\u0275\u0275elementStart(55,"mat-option"),S.\u0275\u0275elementStart(56,"ngx-mat-select-search",15),S.\u0275\u0275elementStart(57,"mat-icon",16),S.\u0275\u0275text(58,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(59,Ze,2,2,"mat-option",8),S.\u0275\u0275pipe(60,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(61,"mat-form-field",3),S.\u0275\u0275elementStart(62,"input",31),S.\u0275\u0275listener("ngModelChange",function(e){return t.project.reference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(63,"div",32),S.\u0275\u0275template(64,et,2,0,"button",33),S.\u0275\u0275template(65,tt,2,1,"button",34),S.\u0275\u0275template(66,nt,2,0,"button",35),S.\u0275\u0275template(67,it,2,0,"button",35),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(39),i=S.\u0275\u0275reference(44);S.\u0275\u0275advance(4),S.\u0275\u0275property("ngModel",t.project.name),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.project.abreviation),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.project.statusId)("disabled",!t.isProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.statusIdentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.description),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.activityId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.activitiesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.project.companyId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.companiesIdentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.customerId),S.\u0275\u0275advance(3),S.\u0275\u0275property("formControl",t.clientFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(29,40,t.filteredClients)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.customerContact),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.project.customerPlace),S.\u0275\u0275advance(3),S.\u0275\u0275property("matDatepicker",n)("ngModel",t.project.plannedStartDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("matDatepicker",i)("ngModel",t.project.plannedEndDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.categoryId),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngForOf",t.categoriesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.project.cost)("inputValue",t.project.cost),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.technologieId),S.\u0275\u0275advance(3),S.\u0275\u0275property("formControl",t.technologyFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(60,42,t.filteredTechnologies)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.project.reference)("disabled",!t.isQA),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",!t.isNewPif),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isNewPif),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.isNewPif),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isNewPif)}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,x.Nt,c.DefaultValueAccessor,c.RequiredValidator,c.MaxLengthValidator,Le.s,c.NgControlStatus,c.NgModel,I.gD,o.NgForOf,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,w.hl,w.nW,E.R9,w.Mq,$e.z,o.NgIf],pipes:[o.AsyncPipe],styles:["form[_ngcontent-%COMP%]{padding:10px 20px}"]}),e}(),at=a(97832),ot=["stepper"];function lt(e,t){1&e&&S.\u0275\u0275text(0,"Project Manager")}function st(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-icon"),S.\u0275\u0275text(1,"check"),S.\u0275\u0275elementEnd())}function ct(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",29),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.Id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.Name," ")}}var dt=function(e){return{"btn-disabled":e}};function mt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"button",30),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().sendForValidation()}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",i.isSendForValidationBtnDisabled())("ngClass",S.\u0275\u0275pureFunction1(3,dt,i.isSendForValidationBtnDisabled())),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.pmActionName)}}function pt(e,t){1&e&&S.\u0275\u0275text(0,"Department Head")}function ut(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",29),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.description),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function ft(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"button",30),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().sendToSQA()}),S.\u0275\u0275text(2,"Send to SQA"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",i.isSendToSQABtnDisabled())("ngClass",S.\u0275\u0275pureFunction1(2,dt,i.isSendToSQABtnDisabled()))}}function ht(e,t){1&e&&S.\u0275\u0275text(0,"SQA")}function vt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",31),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().generateSQAReference()}),S.\u0275\u0275element(1,"em",32),S.\u0275\u0275text(2,"Generate "),S.\u0275\u0275elementEnd()}}function gt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",29),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.description),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function St(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"button",30),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().validate()}),S.\u0275\u0275text(2,"Validate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",i.isValidateBtnDisabled()||i.mutliClickDisable)("ngClass",S.\u0275\u0275pureFunction1(2,dt,i.isValidateBtnDisabled()))}}var yt=function(){var e=function(){function e(t,i,r){n(this,e),this.dialogRef=i,this.dialogData=r,this.canEditProject=!0,this.observationStatusesIdentifiers=[],this.pifValidationDetails=new f.C2,this.isLinear=!1,this.conditionDepartHead=!1,this.conditionSQA=!1,this.conditionPM=!1,this.mutliClickDisable=!1,this.pmActionName="Send for validation",this.coreDataService=t.get(u.YY),this.mailerService=t.get(u.YT),this.notificationService=t.get(u.gq),this.projectService=t.get(h.Y4),this.dtService=t.get(u.Cv),this._formBuilder=t.get(c.FormBuilder),this.pifId=this.dialogData.pifId}return r(e,[{key:"ngAfterViewInit",value:function(){this.getPifValidationDetails()}},{key:"ngOnInit",value:function(){this.getPifDetails(),this.getDepartmentHeads(),this.getObservationStatuses(),this.user=JSON.parse(localStorage.getItem("currentUser")),this.projectManagerFormGroup=this._formBuilder.group({name:["",c.Validators.required],date:[this.dtService.today(),c.Validators.required],departmentHead:[null,c.Validators.required]}),this.departmentHeadFormGroup=this._formBuilder.group({comment:[""],date:[this.dtService.today(),c.Validators.required],visa:["",c.Validators.required]}),this.SQAFormGroup=this._formBuilder.group({comment:[""],date:[this.dtService.today(),c.Validators.required],reference:["",c.Validators.required],visa:["",c.Validators.required]}),this.projectManagerFormGroup.controls.name.disable()}},{key:"rebuildStepperForms",value:function(){this.projectManagerFormGroup.reset({name:this.pifValidationDetails.projectMngName,date:this.pifValidationDetails.projectMngCommentDate,departmentHead:this.pifValidationDetails.departHeadId}),this.departmentHeadFormGroup.reset({comment:this.pifValidationDetails.departHeadComment,date:this.pifValidationDetails.departHeadCommentDate,visa:this.pifValidationDetails.departHeadVisa}),this.SQAFormGroup.reset({comment:this.pifValidationDetails.SQAComment,date:this.pifValidationDetails.SQACommentDate,reference:this.pifValidationDetails.projectReference,visa:this.pifValidationDetails.SQAVisa})}},{key:"getObservationStatuses",value:function(){var e=this;this.projectService.getObservationStatuses().subscribe(function(t){null!=t&&(e.observationStatusesIdentifiers=t)})}},{key:"disableStepperForms",value:function(){this.disableProjectManagerForm(),this.disabledDepartmentHeadForm(),this.disabledSQAForm()}},{key:"getDepartmentHeads",value:function(){var e=this;this.departmentHeadList=[],this.projectService.getDepartmentHeads().subscribe(function(t){t.forEach(function(t){e.departmentHeadList.push({Id:t.USER_ID,Name:t.USER_FIRSTNAME+" "+t.USER_LASTNAME})})})}},{key:"getPifDetails",value:function(){var e=this;this.projectService.getProjectDetails(this.pifId,0).subscribe(function(t){e.pif=Object.assign(new f.IK,t[0])})}},{key:"getPifValidationDetails",value:function(){var e=this;this.projectService.getPifValidationDetails(this.pifId).subscribe(function(t){e.pifValidationDetails=Object.assign(new f.C2,t[0]),e.rebuildStepperForms(),e.disableStepperForms(),setTimeout(function(){e.selectStep(e.pifValidationDetails)},400),e.pifValidationDetails.projectMngVisa===f.CB.Valid&&(e.pmActionName="Resend For Validation")})}},{key:"generateSQAReference",value:function(){var e=this;this.projectService.generateSQAReference(this.pifId.toString()).subscribe(function(t){e.pifValidationDetails.projectReference=t.value,e.projectService.pifIsApproved.emit(0),e.notificationService.success("Generate reference succeeded.")},function(t){e.notificationService.danger("Generate reference failed.")})}},{key:"sendForValidation",value:function(){var e=this;this.pifValidationDetails.projectMngVisa===f.CB.Valid?this.coreDataService.getUser(this.user.hierarchicalHead1).subscribe(function(t){e.mailerService.projectValidation(e.pif,t[0].email),e.disableProjectManagerForm(),e.close()}):(this.pifValidationDetails.projectMngVisa=f.ZW.Valide,this.pifValidationDetails.projectMngCommentDate=this.projectManagerFormGroup.controls.date.value,this.pifValidationDetails.departHeadId=this.projectManagerFormGroup.controls.departmentHead.value,this.pifValidationDetails.statusIdP=f.Es.Valid,this.projectService.updatePifValidDetailsPM(this.pifValidationDetails).subscribe(function(t){e.notificationService.success("Sent for validation performed"),e.disableProjectManagerForm(),e.close(),e.coreDataService.getUser(e.user.hierarchicalHead1).subscribe(function(t){e.mailerService.projectValidation(e.pif,t[0].email)})}))}},{key:"sendToSQA",value:function(){var e=this;this.disableValidationDepartmentHead()?(this.pifValidationDetails.departHeadComment=this.departmentHeadFormGroup.controls.comment.value,this.pifValidationDetails.departHeadCommentDate=this.departmentHeadFormGroup.controls.date.value,this.pifValidationDetails.departHeadVisa=this.departmentHeadFormGroup.controls.visa.value,this.pifValidationDetails.statusIdD=this.getPifStatusId(this.pifValidationDetails.departHeadVisa),this.pifValidationDetails.departHeadVisa=this.convertPifVisaFromEnglishToFrench(this.pifValidationDetails.departHeadVisa),this.projectService.updatePifValidDetailsDH(this.pifValidationDetails).subscribe(function(t){(-1!==e.pifValidationDetails.departHeadVisa.indexOf(f.CB.Valid)||-1!==e.pifValidationDetails.departHeadVisa.indexOf(f.CB.Invalid))&&e.notificationService.success("Sent for Validation performed"),e.disabledDepartmentHeadForm(),e.close()},function(t){e.notificationService.danger("Sent for Validation failed")})):this.notificationService.danger("You can not change visa to In progress")}},{key:"validate",value:function(){var e=this;this.mutliClickDisable=!0,setTimeout(function(){e.mutliClickDisable=!1},1e3),this.disableValidationSQA()?(this.pifValidationDetails.SQAComment=this.SQAFormGroup.controls.comment.value,this.pifValidationDetails.SQACommentDate=this.SQAFormGroup.controls.date.value,this.pifValidationDetails.projectReference=this.SQAFormGroup.controls.reference.value,this.pifValidationDetails.SQAVisa=this.SQAFormGroup.controls.visa.value,this.pifValidationDetails.SQAVisa=this.convertPifVisaFromEnglishToFrench(this.pifValidationDetails.SQAVisa),this.pifValidationDetails.SQAId=+this.user.userId,this.projectService.updatePifSQACreateProject(this.pifValidationDetails).subscribe(function(t){e.disabledSQAForm(),(-1!==e.pifValidationDetails.SQAVisa.indexOf(f.CB.Valid)||-1!==e.pifValidationDetails.SQAVisa.indexOf(f.CB.Invalid))&&e.notificationService.success("Validation performed"),e.projectService.pifIsApproved.emit(t),e.close(),e.mailerService.projectValidated(e.pif,e.pifValidationDetails.SQAVisa)},function(t){e.notificationService.danger("Validation failed")})):this.notificationService.danger("You can not change visa to In progress")}},{key:"convertPifVisaFromEnglishToFrench",value:function(e){switch(e){case f.CB.InProgress:e=f.ZW.EnCours;break;case f.CB.Valid:e=f.ZW.Valide;break;case f.CB.Invalid:e=f.ZW.Invalide}return e}},{key:"disableValidationSQA",value:function(){return-1!==this.pifValidationDetails.SQAVisa.indexOf(f.CB.InProgress)||(-1===this.pifValidationDetails.SQAVisa.indexOf(f.CB.Valid)||-1===this.pifValidationDetails.SQAVisa.indexOf(f.CB.Invalid)||-1!==this.pifValidationDetails.SQAVisa.indexOf(f.CB.InProgress))&&-1===this.SQAFormGroup.controls.visa.value.indexOf(f.CB.InProgress)}},{key:"disableValidationDepartmentHead",value:function(){return-1!==this.pifValidationDetails.departHeadVisa.indexOf(f.CB.InProgress)||(-1===this.pifValidationDetails.departHeadVisa.indexOf(f.CB.Valid)||-1===this.pifValidationDetails.departHeadVisa.indexOf(f.CB.Invalid))&&-1===this.departmentHeadFormGroup.controls.visa.value.indexOf(f.CB.InProgress)}},{key:"disableProjectManagerForm",value:function(){(this.isManageProjectStepCompleted()||this.isNotProjectManager())&&(this.projectManagerFormGroup.controls.name.disable(),this.projectManagerFormGroup.controls.date.disable(),this.projectManagerFormGroup.controls.departmentHead.disable())}},{key:"disabledDepartmentHeadForm",value:function(){(this.isNotQualityManagerOrDH()||!this.isManageProjectStepCompleted()||-1!==this.pifValidationDetails.SQAVisa.indexOf(f.CB.Valid))&&(this.departmentHeadFormGroup.controls.comment.disable(),this.departmentHeadFormGroup.controls.date.disable(),this.departmentHeadFormGroup.controls.visa.disable())}},{key:"disabledSQAForm",value:function(){(!this.isManageProjectStepCompleted()||this.isNotQualityManager()||-1!==this.pifValidationDetails.SQAVisa.indexOf(f.CB.Valid))&&(this.SQAFormGroup.controls.comment.disable(),this.SQAFormGroup.controls.date.disable(),this.SQAFormGroup.controls.reference.disable(),this.SQAFormGroup.controls.visa.disable())}},{key:"isSendForValidationBtnDisabled",value:function(){return!this.projectManagerFormGroup.valid&&this.isNotProjectManager()||this.pifValidationDetails.SQAVisa===f.CB.Valid}},{key:"isSendToSQABtnDisabled",value:function(){return!this.departmentHeadFormGroup.valid}},{key:"isGenerateBtnVisible",value:function(){return this.isManageProjectStepCompleted()&&this.isQualityManager()&&-1===this.pifValidationDetails.SQAVisa.indexOf(f.CB.Valid)}},{key:"isValidateBtnDisabled",value:function(){return!this.SQAFormGroup.valid}},{key:"isManageProjectStepCompleted",value:function(){return this.pifValidationDetails&&this.pifValidationDetails.projectMngVisa===f.CB.Valid}},{key:"isDepartmentHeadStepCompleted",value:function(){return this.pifValidationDetails&&(this.pifValidationDetails.departHeadVisa===f.CB.Valid||this.pifValidationDetails.departHeadVisa===f.CB.Invalid)}},{key:"isSQAStepCompleted",value:function(){return this.pifValidationDetails&&(this.pifValidationDetails.SQAVisa===f.CB.Valid||this.pifValidationDetails.SQAVisa===f.CB.Invalid)}},{key:"isNotProjectManager",value:function(){return this.pifValidationDetails.projectMngId!==+this.user.userId}},{key:"isNotQualityManagerOrDH",value:function(){return this.user.activityId!==v.RS.Quality&&this.user.qualification!==v._W.DepartmentHead}},{key:"isNotQualityManager",value:function(){return this.user.activityId!==v.RS.Quality}},{key:"isQualityManager",value:function(){return this.user.activityId===v.RS.Quality}},{key:"close",value:function(){this.dialogRef.close(),this.projectService.reloadDecisions.next()}},{key:"getPifStatusId",value:function(e){return this.observationStatusesIdentifiers.find(function(t){return t.description===e}).id}},{key:"selectStep",value:function(e){e.projectMngVisa===f.CB.Valid&&(this.stepper.selectedIndex=1),e.departHeadVisa===f.CB.Valid&&(this.stepper.selectedIndex=2)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(S.Injector),S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(m.WI))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-decision"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(ot,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.stepper=n.first))},inputs:{pifId:"pifId"},decls:57,vars:25,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],[3,"linear"],["stepper",""],[3,"stepControl","editable"],[3,"formGroup"],["matStepLabel",""],["matStepperIcon","edit"],[1,"col-sm-12"],["matInput","","placeholder","Project Manager","formControlName","name"],[1,"col-sm-6"],["matInput","","placeholder","Date","formControlName","date","required","",3,"matDatepicker"],["matSuffix","",3,"for"],[3,"startView"],["PickerProjectManagerDate",""],["placeholder","Department Head","formControlName","departmentHead","required",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],[3,"stepControl"],["matInput","","placeholder","Comment","formControlName","comment","maxlength","255"],[1,"col-md-12"],["PickerDepartmentHeadDate",""],["placeholder","Visa","formControlName","visa","required",""],["matInput","","placeholder","Reference","formControlName","reference","required","",3,"ngModel","ngModelChange"],["class","btn btn-md btn-primary ripple light text-center","type","button","mat-button","","matSuffix","",3,"click",4,"ngIf"],["PickerSQADate",""],[3,"value"],["type","submit",1,"btn","btn-primary","m-l-15","f-right",3,"disabled","ngClass","click"],["type","button","mat-button","","matSuffix","",1,"btn","btn-md","btn-primary","ripple","light","text-center",3,"click"],[1,"fa","fa-cog",2,"font-size","medium"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3," Edit Manager Decision "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"span"),S.\u0275\u0275elementStart(5,"em",2),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(6,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",3),S.\u0275\u0275elementStart(8,"div",4),S.\u0275\u0275elementStart(9,"mat-horizontal-stepper",5,6),S.\u0275\u0275elementStart(11,"mat-step",7),S.\u0275\u0275elementStart(12,"form",8),S.\u0275\u0275template(13,lt,1,0,"ng-template",9),S.\u0275\u0275template(14,st,2,0,"ng-template",10),S.\u0275\u0275elementStart(15,"mat-form-field",11),S.\u0275\u0275element(16,"input",12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"mat-form-field",13),S.\u0275\u0275element(18,"input",14),S.\u0275\u0275element(19,"mat-datepicker-toggle",15),S.\u0275\u0275element(20,"mat-datepicker",16,17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"mat-form-field",11),S.\u0275\u0275elementStart(23,"mat-select",18),S.\u0275\u0275template(24,ct,2,2,"mat-option",19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(25,mt,3,5,"div",20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"mat-step",21),S.\u0275\u0275elementStart(27,"form",8),S.\u0275\u0275template(28,pt,1,0,"ng-template",9),S.\u0275\u0275elementStart(29,"mat-form-field",11),S.\u0275\u0275element(30,"input",22),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"mat-form-field",23),S.\u0275\u0275element(32,"input",14),S.\u0275\u0275element(33,"mat-datepicker-toggle",15),S.\u0275\u0275element(34,"mat-datepicker",16,24),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-form-field",11),S.\u0275\u0275elementStart(37,"mat-select",25),S.\u0275\u0275template(38,ut,2,2,"mat-option",19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(39,ft,3,4,"div",20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"mat-step",21),S.\u0275\u0275elementStart(41,"form",8),S.\u0275\u0275template(42,ht,1,0,"ng-template",9),S.\u0275\u0275elementStart(43,"mat-form-field",11),S.\u0275\u0275element(44,"input",22),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"mat-form-field",11),S.\u0275\u0275elementStart(46,"input",26),S.\u0275\u0275listener("ngModelChange",function(e){return t.pifValidationDetails.projectReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(47,vt,3,0,"button",27),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"mat-form-field",11),S.\u0275\u0275element(49,"input",14),S.\u0275\u0275element(50,"mat-datepicker-toggle",15),S.\u0275\u0275element(51,"mat-datepicker",16,28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"mat-form-field",11),S.\u0275\u0275elementStart(54,"mat-select",25),S.\u0275\u0275template(55,gt,2,2,"mat-option",19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(56,St,3,4,"div",20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(21),i=S.\u0275\u0275reference(35),r=S.\u0275\u0275reference(52);S.\u0275\u0275advance(9),S.\u0275\u0275property("linear",t.isLinear),S.\u0275\u0275advance(2),S.\u0275\u0275property("stepControl",t.projectManagerFormGroup)("editable",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("formGroup",t.projectManagerFormGroup),S.\u0275\u0275advance(6),S.\u0275\u0275property("matDatepicker",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngForOf",t.departmentHeadList),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.canEditProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("stepControl",t.departmentHeadFormGroup),S.\u0275\u0275advance(1),S.\u0275\u0275property("formGroup",t.departmentHeadFormGroup),S.\u0275\u0275advance(5),S.\u0275\u0275property("matDatepicker",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngForOf",t.observationStatusesIdentifiers),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.canEditProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("stepControl",t.SQAFormGroup),S.\u0275\u0275advance(1),S.\u0275\u0275property("formGroup",t.SQAFormGroup),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngModel",t.pifValidationDetails.projectReference),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isGenerateBtnVisible()),S.\u0275\u0275advance(2),S.\u0275\u0275property("matDatepicker",r),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",r),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngForOf",t.observationStatusesIdentifiers),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.canEditProject)}},directives:[at.Vq,at.C0,c.\u0275NgNoValidate,c.NgControlStatusGroup,c.FormGroupDirective,at.VY,at.z9,E.KE,x.Nt,c.DefaultValueAccessor,c.NgControlStatus,c.FormControlName,w.hl,c.RequiredValidator,w.nW,E.R9,w.Mq,I.gD,o.NgForOf,o.NgIf,c.MaxLengthValidator,Re.Hw,M.ey,o.NgClass,ae.lW],styles:[".mat-step-icon[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}mat-option.mat-selected[_ngcontent-%COMP%]{background-color:#3f629d}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.btn-disabled[_ngcontent-%COMP%]{background-color:#3f629d;border-color:#3f629d}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray;background-color:#3f629d}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e}(),bt=a(69517);function Ct(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",11),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().editDecision()}),S.\u0275\u0275text(1," edit"),S.\u0275\u0275elementEnd()}}var Et=function(e,t,n){return{"label-info":e,"label-danger":t,"label-success":n}};function xt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"h6"),S.\u0275\u0275text(1,"Project Manager"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(2," \xa0 "),S.\u0275\u0275elementStart(3,"label",12),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(2,Et,n.pifValidationDetails.projectMngVisa===n.PifVisa.InProgress,n.pifValidationDetails.projectMngVisa===n.PifVisa.Invalid,n.pifValidationDetails.projectMngVisa===n.PifVisa.Valid)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n.pifValidationDetails.projectMngVisa," ")}}function It(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",13),S.\u0275\u0275elementStart(1,"table",14),S.\u0275\u0275element(2,"caption",15),S.\u0275\u0275elementStart(3,"tbody"),S.\u0275\u0275elementStart(4,"tr"),S.\u0275\u0275elementStart(5,"th",16),S.\u0275\u0275text(6,"Name"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",17),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"th",16),S.\u0275\u0275text(10,"Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"td",18),S.\u0275\u0275text(12),S.\u0275\u0275pipe(13,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(8),S.\u0275\u0275textInterpolate(n.pifValidationDetails.projectMngName),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(13,2,n.pifValidationDetails.projectMngCommentDate))}}function wt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"h6"),S.\u0275\u0275text(1,"Department Manager"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(2," \xa0 "),S.\u0275\u0275elementStart(3,"label",12),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(2,Et,n.pifValidationDetails.departHeadVisa===n.PifVisa.InProgress,n.pifValidationDetails.departHeadVisa===n.PifVisa.Invalid,n.pifValidationDetails.departHeadVisa===n.PifVisa.Valid)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n.pifValidationDetails.departHeadVisa," ")}}function Mt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",13),S.\u0275\u0275elementStart(1,"table",14),S.\u0275\u0275element(2,"caption",15),S.\u0275\u0275elementStart(3,"tbody"),S.\u0275\u0275elementStart(4,"tr"),S.\u0275\u0275elementStart(5,"th",16),S.\u0275\u0275text(6,"Name"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",17),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"th",16),S.\u0275\u0275text(10,"Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"td",18),S.\u0275\u0275text(12),S.\u0275\u0275pipe(13,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"tr"),S.\u0275\u0275elementStart(15,"th",16),S.\u0275\u0275text(16,"Comment"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"td",19),S.\u0275\u0275text(18),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(8),S.\u0275\u0275textInterpolate(n.pifValidationDetails.departHeadName),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(13,3,n.pifValidationDetails.departHeadCommentDate)),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate(n.pifValidationDetails.departHeadComment)}}function Pt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"h6"),S.\u0275\u0275text(1,"SQA"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(2," \xa0 "),S.\u0275\u0275elementStart(3,"label",12),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(2,Et,n.pifValidationDetails.SQAVisa===n.PifVisa.InProgress,n.pifValidationDetails.SQAVisa===n.PifVisa.Invalid,n.pifValidationDetails.SQAVisa===n.PifVisa.Valid)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",n.pifValidationDetails.SQAVisa," ")}}function Dt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",13),S.\u0275\u0275elementStart(1,"table",14),S.\u0275\u0275element(2,"caption",15),S.\u0275\u0275elementStart(3,"tbody"),S.\u0275\u0275elementStart(4,"tr"),S.\u0275\u0275elementStart(5,"th",16),S.\u0275\u0275text(6,"Name"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",17),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"th",16),S.\u0275\u0275text(10,"Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"td",18),S.\u0275\u0275text(12),S.\u0275\u0275pipe(13,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"tr"),S.\u0275\u0275elementStart(15,"th",16),S.\u0275\u0275text(16,"Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"td",19),S.\u0275\u0275text(18),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"tr"),S.\u0275\u0275elementStart(20,"th",16),S.\u0275\u0275text(21,"Comment"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"td",19),S.\u0275\u0275text(23),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(8),S.\u0275\u0275textInterpolate(n.pifValidationDetails.SQAName),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(13,4,n.pifValidationDetails.SQACommentDate)),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate(n.pifValidationDetails.projectReference),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(n.pifValidationDetails.SQAComment)}}var jt=function(){var e=function(){function e(t,i,r,a){n(this,e),this.notificationService=t,this.projectService=i,this.dtService=r,this.dialog=a,this.PifVisa=f.CB,this.pifValidationDetails=new f.C2,this.isLinear=!0,this.isValidated=!1}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.reloadDecisionsSubscription=this.projectService.reloadDecisions.subscribe(function(){e.getPifValidationDetails()}),this.getPifValidationDetails()}},{key:"ngOnDestroy",value:function(){this.reloadDecisionsSubscription.unsubscribe(),this.dialog.closeAll()}},{key:"getPifValidationDetails",value:function(){var e=this;this.projectService.getPifValidationDetails(this.pifId).subscribe(function(t){e.pifValidationDetails=Object.assign(new f.C2,t[0]),e.pifValidationDetails.SQAVisa===f.CB.Valid&&(e.isValidated=!0)})}},{key:"isManageProjectStepCompleted",value:function(){return this.pifValidationDetails&&this.pifValidationDetails.projectMngVisa===f.CB.Valid}},{key:"isDepartmentHeadStepCompleted",value:function(){return this.isManageProjectStepCompleted()&&this.pifValidationDetails&&this.pifValidationDetails.departHeadVisa===f.CB.Valid}},{key:"isSQAStepCompleted",value:function(){return this.isDepartmentHeadStepCompleted()&&this.pifValidationDetails&&this.pifValidationDetails.SQAVisa===f.CB.Valid}},{key:"editDecision",value:function(){this.editDecisionDialog=this.dialog.open(yt,{disableClose:!1,hasBackdrop:!0,width:"900px",height:"460px",data:{pifId:this.pifId}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(m.uw))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-decision"]],inputs:{pifId:"pifId",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},decls:17,vars:2,consts:[[1,"card"],[1,"card-header"],["matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-body"],[1,"ngb-accordion",3,"closeOthers"],["acc","ngbAccordion"],["id","ngb-open-p1"],["ngbPanelTitle",""],["ngbPanelContent",""],["id","ngb-open-p2"],["id","ngb-open-p3"],["matTooltip","Edit",3,"click"],[1,"label","f-right",3,"ngClass"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table","m-0"],[2,"padding","0px"],["scope","row"],[1,"text-left"],[1,"text-right"],["colspan","3",1,"text-left"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"h5"),S.\u0275\u0275text(3,"Manager Decision"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(4,Ct,2,0,"mat-icon",2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"div",3),S.\u0275\u0275elementStart(6,"ngb-accordion",4,5),S.\u0275\u0275elementStart(8,"ngb-panel",6),S.\u0275\u0275template(9,xt,5,6,"ng-template",7),S.\u0275\u0275template(10,It,14,4,"ng-template",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"ngb-panel",9),S.\u0275\u0275template(12,wt,5,6,"ng-template",7),S.\u0275\u0275template(13,Mt,19,5,"ng-template",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"ngb-panel",10),S.\u0275\u0275template(15,Pt,5,6,"ng-template",7),S.\u0275\u0275template(16,Dt,24,6,"ng-template",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",t.canEditProject&&t.isvisibleEditProject&&!t.isValidated),S.\u0275\u0275advance(2),S.\u0275\u0275property("closeOthers",!0))},directives:[o.NgIf,bt.gY,bt.Gk,bt.Cu,bt.gW,Re.Hw,oe.gM,o.NgClass],pipes:[Te.M],styles:["ngb-accordion[_ngcontent-%COMP%]     .card-body{padding:0 20px}ngb-accordion[_ngcontent-%COMP%]     .btn{padding:0}h6[_ngcontent-%COMP%]{position:relative;display:inline}.mat-step-icon[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff}mat-option.mat-selected[_ngcontent-%COMP%]{background-color:#3f629d}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.collapse[_ngcontent-%COMP%], .collapse.in[_ngcontent-%COMP%]{display:block!important;transition:all .25s ease-in-out}.collapse[_ngcontent-%COMP%]{opacity:0;height:0}.collapse.in[_ngcontent-%COMP%]{opacity:1;height:100%}"]}),e}(),kt=["documentForm"],Ot=["document"];function Ft(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",27),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function At(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"tr"),S.\u0275\u0275elementStart(1,"td",28),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(3,"td",28),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"td",29),S.\u0275\u0275text(6),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",28),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",28),S.\u0275\u0275elementStart(10,"em",30),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().deleteTypeElement(e.id)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit;S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i.typeDesc),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i.reference),S.\u0275\u0275advance(1),S.\u0275\u0275property("matTooltip",i.title),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.title),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i.editionDate)}}var _t=function(e){return{active:e}};function Vt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"li",32),S.\u0275\u0275elementStart(1,"a",33),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).setPage(e)}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(2,_t,r.pager.currentPage===i)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i)}}var Nt=function(e){return{disabled:e}};function Rt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"ul",31),S.\u0275\u0275elementStart(1,"li",32),S.\u0275\u0275elementStart(2,"a",33),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().setPage(1)}),S.\u0275\u0275text(3,"First"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"li",32),S.\u0275\u0275elementStart(5,"a",33),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.currentPage-1)}),S.\u0275\u0275text(6,"Previous"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,Vt,3,4,"li",34),S.\u0275\u0275elementStart(8,"li",32),S.\u0275\u0275elementStart(9,"a",33),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setNextPage(e.pager.currentPage+1)}),S.\u0275\u0275text(10,"Next"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"li",32),S.\u0275\u0275elementStart(12,"a",33),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.totalPages)}),S.\u0275\u0275text(13,"Last"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(5,Nt,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(7,Nt,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",i.pager.pages),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(9,Nt,i.pager.currentPage===i.pager.totalPages)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(11,Nt,i.pager.currentPage===i.pager.totalPages))}}var Tt=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.projectService=t,this.notificationService=i,this.dialogRef=r,this.pagerService=a,this.dialogData=o,this.documents=new Array,this.pager={},this.document=new f.BB,this.pifId=this.dialogData.pifId}return r(e,[{key:"ngOnInit",value:function(){this.GetTypeEntries(),0!==this.pifId&&void 0!==this.pifId&&this.getEntries(this.pifId)}},{key:"ngOnDestroy",value:function(){this.close()}},{key:"setPage",value:function(e){e<1||(this.pager=this.pagerService.getPager(this.documents.length,e),this.pagedItems=this.documents.slice(this.pager.startIndex,this.pager.endIndex+1))}},{key:"GetTypeEntries",value:function(){var e=this;this.projectService.getTypeEntries().subscribe(function(t){e.typeEntriesIdentifiers=t})}},{key:"add",value:function(e,t){var n=this;this.documentForm.valid?(this.document.pifId=this.pifId,this.document.typeId=this.selectedTypeEntrieIdentifier.id,this.projectService.insertTypeElement(this.document).subscribe(function(e){n.document.id=e,n.document.typeDesc=n.selectedTypeEntrieIdentifier.description,n.documents.unshift(n.document),n.selectedTypeEntrieIdentifier=new C.x,n.document=new f.BB,n.notificationService.success("Document added successfully!"),n.setPage(1),n.documentForm.resetForm()})):this.notificationService.danger("Please fill all required fields")}},{key:"getEntries",value:function(e){var t=this;this.projectService.getEntries(e).subscribe(function(e){t.documents=[],e.forEach(function(e){t.documents.push(Object.assign(new f.BB,e))}),t.setPage(1)})}},{key:"deleteTypeElement",value:function(e){var t=this;this.projectService.deleteTypeElement(e).subscribe(function(n){t.documents=t.documents.filter(function(t){return t.id!==e}),t.setPage(1)})}},{key:"close",value:function(){this.dialogRef.close(),this.projectService.reloadDocs.next()}},{key:"setPageDetails",value:function(){return this.documents.length>3}},{key:"setNextPage",value:function(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.documents.length,e),this.pagedItems=this.documents.slice(this.pager.startIndex,this.pager.endIndex+1)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(u.e9),S.\u0275\u0275directiveInject(m.WI))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-document"]],viewQuery:function(e,t){var n;(1&e&&(S.\u0275\u0275viewQuery(kt,7),S.\u0275\u0275viewQuery(Ot,7)),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.documentForm=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.selectedDocument=n.first))},inputs:{pifId:"pifId"},decls:48,vars:7,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["id","documentForm",3,"submit"],["documentForm","ngForm"],[1,"row"],[1,"col-sm-6"],["placeholder","Type","name","typeEntry","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Title","matInput","","name","title","required","","maxlength","200",3,"ngModel","ngModelChange"],["placeholder","Reference","matInput","","name","reference","maxlength","100","required","",3,"ngModel","ngModelChange"],["placeholder","Edition/Date","matInput","","name","editionDate","required","",3,"ngModel","ngModelChange"],[1,"col-lg-12"],[1,"row","f-right"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md"],[1,"row",2,"margin-top","25px"],[1,"col-sm-12"],["placement","bottom",1,"p-20","z-depth-bottom-5","waves-effect"],[1,"table-responsive"],[1,"table"],[2,"padding","0px"],["scope","col",1,"col-sm-2","th-table-style"],["scope","col",1,"col-sm-2","text-right"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[3,"value"],[1,"td-table-style"],[1,"td-title-style",3,"matTooltip"],[1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"],[1,"pagination",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3," Inputs Entries "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"span"),S.\u0275\u0275elementStart(5,"em",2),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(6,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",3),S.\u0275\u0275elementStart(8,"div",4),S.\u0275\u0275elementStart(9,"form",5,6),S.\u0275\u0275listener("submit",function(){return t.add()}),S.\u0275\u0275elementStart(11,"div",7),S.\u0275\u0275elementStart(12,"mat-form-field",8),S.\u0275\u0275elementStart(13,"mat-select",9),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedTypeEntrieIdentifier=e}),S.\u0275\u0275template(14,Ft,2,2,"mat-option",10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"mat-form-field",8),S.\u0275\u0275elementStart(16,"input",11),S.\u0275\u0275listener("ngModelChange",function(e){return t.document.title=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"div",7),S.\u0275\u0275elementStart(18,"mat-form-field",8),S.\u0275\u0275elementStart(19,"input",12),S.\u0275\u0275listener("ngModelChange",function(e){return t.document.reference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(20,"mat-form-field",8),S.\u0275\u0275elementStart(21,"input",13),S.\u0275\u0275listener("ngModelChange",function(e){return t.document.editionDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"div",7),S.\u0275\u0275elementStart(23,"div",14),S.\u0275\u0275elementStart(24,"div",15),S.\u0275\u0275elementStart(25,"div",14),S.\u0275\u0275elementStart(26,"button",16),S.\u0275\u0275text(27,"Add"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"div",17),S.\u0275\u0275elementStart(29,"div",18),S.\u0275\u0275elementStart(30,"div",19),S.\u0275\u0275elementStart(31,"div",20),S.\u0275\u0275elementStart(32,"table",21),S.\u0275\u0275element(33,"caption",22),S.\u0275\u0275elementStart(34,"thead"),S.\u0275\u0275elementStart(35,"tr"),S.\u0275\u0275elementStart(36,"th",23),S.\u0275\u0275text(37,"Type"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"th",23),S.\u0275\u0275text(39,"Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"th",23),S.\u0275\u0275text(41,"Title"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(42,"th",23),S.\u0275\u0275text(43,"Edition/Date"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(44,"th",24),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"tbody"),S.\u0275\u0275template(46,At,11,5,"tr",25),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(47,Rt,14,13,"ul",26),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(13),S.\u0275\u0275property("ngModel",t.selectedTypeEntrieIdentifier),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.typeEntriesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.document.title),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.document.reference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.document.editionDate),S.\u0275\u0275advance(25),S.\u0275\u0275property("ngForOf",t.pagedItems),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,I.gD,c.RequiredValidator,c.NgControlStatus,c.NgModel,o.NgForOf,x.Nt,c.DefaultValueAccessor,c.MaxLengthValidator,o.NgIf,M.ey,oe.gM,o.NgClass],styles:[".col-sm-2[_ngcontent-%COMP%]{width:auto}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-title-style[_ngcontent-%COMP%]{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e}();function Bt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).onClickEdit()}),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",i.getEditIcon(),"")}}function zt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",4),S.\u0275\u0275elementStart(1,"h5"),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(3,Bt,2,1,"mat-icon",5),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate2("",n.title," ",n.getItemsCount(),""),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",n.canEditProject&&n.isvisibleEditProject)}}var qt=function(e){return{active:e}};function Lt(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"li",10),S.\u0275\u0275elementStart(1,"a",13),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(3).setPage(e)}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(3);S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(2,qt,r.pager.currentPage===i)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i)}}var Qt=function(e){return{disabled:e}};function $t(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"ul",9),S.\u0275\u0275elementStart(1,"li",10),S.\u0275\u0275elementStart(2,"em",11),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext(2);return 1!==e.pager.currentPage&&e.setPage(1)}),S.\u0275\u0275text(3,"first_page"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"li",10),S.\u0275\u0275elementStart(5,"em",11),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext(2);return 1!==e.pager.currentPage&&e.setPage(e.pager.currentPage-1)}),S.\u0275\u0275text(6,"chevron_left"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,Lt,3,4,"li",12),S.\u0275\u0275elementStart(8,"li",10),S.\u0275\u0275elementStart(9,"em",11),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext(2);return e.pager.currentPage!==e.pager.totalPages&&e.setPage(e.pager.currentPage+1)}),S.\u0275\u0275text(10,"chevron_right"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"li",10),S.\u0275\u0275elementStart(12,"em",11),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext(2);return e.pager.currentPage!==e.pager.totalPages&&e.setPage(e.pager.totalPages)}),S.\u0275\u0275text(13,"last_page"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(5,Qt,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(7,Qt,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",i.pager.pages),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(9,Qt,i.pager.currentPage===i.pager.totalPages)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(11,Qt,i.pager.currentPage===i.pager.totalPages))}}function Ut(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",7),S.\u0275\u0275template(1,$t,14,13,"ul",8),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",n.pager.pages&&n.pager.pages.length)}}var Ht=["*"],Gt=function(){var e=function(){function e(t){n(this,e),this.pagerService=t,this.editEvent=new S.EventEmitter,this.itemsPerPage=5}return r(e,[{key:"ngOnInit",value:function(){}},{key:"getItemsCount",value:function(){return this.itemsList&&this.itemsList.length>0?"("+this.itemsList.length+")":""}},{key:"setpagedItems",value:function(e){this.itemsList=e}},{key:"setPage",value:function(e){e<1||(this.pager=this.pagerService.getPager(this.itemsList.length,e,this.itemsPerPage),this.pagedItems=this.itemsList.slice(this.pager.startIndex,this.pager.endIndex+1))}},{key:"isPagerRequired",value:function(){return this.itemsList&&this.itemsList.length>this.itemsPerPage}},{key:"getEditIcon",value:function(){return this.itemsList&&this.itemsList.length>0?"edit":"add"}},{key:"onClickEdit",value:function(){this.editEvent.emit()}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.e9))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-card"]],inputs:{title:"title",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},outputs:{editEvent:"editEvent"},ngContentSelectors:Ht,decls:5,vars:2,consts:[[1,"card"],["class","card-header ripple",4,"ngIf"],[1,"card-body"],["class","card-footer",4,"ngIf"],[1,"card-header","ripple"],["class","add-edit-ico","matTooltip","add",3,"click",4,"ngIf"],["matTooltip","add",1,"add-edit-ico",3,"click"],[1,"card-footer"],["class","pagination","style","float:right",4,"ngIf"],[1,"pagination",2,"float","right"],[3,"ngClass"],[1,"material-icons",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275projectionDef(),S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275template(1,zt,4,3,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275projection(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(4,Ut,2,1,"div",3),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.title),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",t.isPagerRequired()))},directives:[o.NgIf,Re.Hw,oe.gM,o.NgClass,o.NgForOf],styles:[".card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .add-edit-ico[_ngcontent-%COMP%]{font-size:20px;margin-right:15px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .show-hide-ico[_ngcontent-%COMP%]{font-size:25px;position:relative;top:-4px}.card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer}.card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{height:220px}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{cursor:pointer}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:pointer;vertical-align:middle;position:relative;top:3px;margin:0 15px}.card[_ngcontent-%COMP%]   .card-footer[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}"]}),e}();function Wt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"ul",2),S.\u0275\u0275elementStart(1,"li",3),S.\u0275\u0275elementStart(2,"div",4),S.\u0275\u0275element(3,"em",5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"div",6),S.\u0275\u0275elementStart(5,"h6"),S.\u0275\u0275text(6),S.\u0275\u0275elementStart(7,"em",7),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate2("",n.title," - ",n.typeDesc,": "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate2(" ",n.reference," (",n.editionDate,")")}}var Jt=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.notificationService=i,this.dialog=r,this.dateTimeService=a,this.documents=new Array}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.reloadDocumentSubscription=this.projectService.reloadDocs.subscribe(function(){e.getEntries()}),this.getEntries()}},{key:"ngOnDestroy",value:function(){this.reloadDocumentSubscription.unsubscribe(),this.dialog.closeAll()}},{key:"editDocument",value:function(){this.editDocumentDialog=this.dialog.open(Tt,{disableClose:!1,hasBackdrop:!0,width:"900px",height:"570px",data:{pifId:this.project.pifId}})}},{key:"getEntries",value:function(){var e=this;this.projectService.getEntries(this.project.pifId).subscribe(function(t){e.documents=[],t.forEach(function(t){e.documents.push(Object.assign(new f.BB,t))}),e.viewCard.setpagedItems(e.documents),e.viewCard.setPage(1)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(u.Cv))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-attached-document"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Gt,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.viewCard=n.first))},inputs:{project:"project",isProject:"isProject",canEditProject:"canEditProject",isvisibleEditProject:"isvisibleEditProject"},decls:2,vars:4,consts:[[3,"title","isvisibleEditProject","canEditProject","editEvent"],["class","media-list",4,"ngFor","ngForOf"],[1,"media-list"],[1,"media","d-flex","m-b-10"],[1,"m-r-5","v-middle","doc-icon"],[1,"text-muted","icofont","icofont-file-document"],[1,"media-body"],[1,"text-muted","m-b-0"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"app-view-card",0),S.\u0275\u0275listener("editEvent",function(){return t.editDocument()}),S.\u0275\u0275template(1,Wt,9,4,"ul",1),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275property("title","Inputs Entries")("isvisibleEditProject",t.isvisibleEditProject)("canEditProject",t.canEditProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.viewCard.pagedItems))},directives:[Gt,o.NgForOf],styles:["h6[_ngcontent-%COMP%]{position:relative;display:inline-block;font-size:14px}.doc-icon[_ngcontent-%COMP%]   .icofont[_ngcontent-%COMP%]{font-size:25px}"]}),e}(),Yt=["memberSelect"],Kt=["t"];function Xt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",29),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.memberName," ")}}function Zt(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",29),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.roleName," ")}}function en(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"em",34),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().deletePifMember(e)}),S.\u0275\u0275elementEnd()}}function tn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"tr"),S.\u0275\u0275elementStart(1,"td",30),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(3,"td",30),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"td",31),S.\u0275\u0275elementStart(6,"em",32),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().editPifMember(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",31),S.\u0275\u0275template(8,en,1,0,"em",33),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",i.memberName,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.memberName),S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",i.role,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.role),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",i.memberName!=r.pifValidationDetails.projectMngName)}}var nn=function(e){return{active:e}};function rn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"li",36),S.\u0275\u0275elementStart(1,"a",37),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).setPage(e)}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(2,nn,r.pager.currentPage===i)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i)}}var an=function(e){return{disabled:e}};function on(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"ul",35),S.\u0275\u0275elementStart(1,"li",36),S.\u0275\u0275elementStart(2,"a",37),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().setPage(1)}),S.\u0275\u0275text(3,"First"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"li",36),S.\u0275\u0275elementStart(5,"a",37),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.currentPage-1)}),S.\u0275\u0275text(6,"Previous"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,rn,3,4,"li",38),S.\u0275\u0275elementStart(8,"li",36),S.\u0275\u0275elementStart(9,"a",37),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setNextPage(e.pager.currentPage+1)}),S.\u0275\u0275text(10,"Next"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"li",36),S.\u0275\u0275elementStart(12,"a",37),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.totalPages)}),S.\u0275\u0275text(13,"Last"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(5,an,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(7,an,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",i.pager.pages),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(9,an,i.pager.currentPage===i.pager.totalPages)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(11,an,i.pager.currentPage===i.pager.totalPages))}}var ln=function(){var e=function(){function e(t,i,r,a,o,l){n(this,e),this.projectService=t,this.dateTimeService=i,this.notificationService=r,this.pagerService=a,this.dialogRef=o,this.dialogData=l,this.members=[],this.selectedMembers=[],this.roles=[],this.selectedRole=this.roles[0],this.pifMembers=[],this.pager={},this.isEdit=!1,this.memberFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ,this.filteredMembers=new p.tq(1),this.pifValidationDetails=new f.C2,this.pifId=this.dialogData.pifId,this.projectId=this.dialogData.projectId}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.getPifValidationDetails(),this.getAllRoles(),this.getMembers(),0!==this.pifId&&void 0!==this.pifId&&this.getPifProjectMembers(this.pifId),this.memberFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterMembers()})}},{key:"ngOnDestroy",value:function(){this.close()}},{key:"ngAfterViewInit",value:function(){this.setInitialValue()}},{key:"setPage",value:function(e){e<1||(this.pager=this.pagerService.getPager(this.pifMembers.length,e),this.pagedItems=this.pifMembers.slice(this.pager.startIndex,this.pager.endIndex+1))}},{key:"getPifValidationDetails",value:function(){var e=this;this.projectService.getPifValidationDetails(this.pifId).subscribe(function(t){e.pifValidationDetails=Object.assign(new f.C2,t[0])})}},{key:"getAllRoles",value:function(){var e=this;this.projectService.getAllRoles().subscribe(function(t){e.roles=[],t.forEach(function(t){e.roles.push(Object.assign(new f.jg,t))})})}},{key:"getPifProjectMembers",value:function(e){var t=this;this.projectService.getPifProjectMembers(e).subscribe(function(e){t.pifMembers=[],e.forEach(function(e){t.pifMembers.push(Object.assign(new f.J3,e))}),t.setPage(1)})}},{key:"insertOrUpdatePifProjectMembers",value:function(e,t,n){var i=this;if(e.valid&&this.selectedMembers.length>0)if(!1===this.isEdit){var r=new f.sA(this.pifId,this.selectedRole.roleId);r.membersId=this.selectedMembers.map(function(e){return e.memberId}),r.membersName=this.selectedMembers.map(function(e){return e.memberName}),this.projectService.insertPifProjectMembers(r).subscribe(function(t){if(i.getPifProjectMembers(i.pifId.toString()),i.setPage(1),0===t)i.selectedMembers=[],i.notificationService.success("Members added successfully.");else{var n=t.value.split(","),r="";n.forEach(function(e){var t=i.selectedMembers.find(function(t){return t.memberId===+e});r+="<br>- "+t.memberName}),i.notificationService.warning("Members already exist:"+r)}e.resetForm()},function(){i.notificationService.danger("Add members fails.")})}else{var a=new f.J3;a.memberId=this.selectedMembers[0].memberId,a.pifId=this.pifId,a.roleId=this.selectedRole.roleId,this.projectService.updatePifProjectMember(a).subscribe(function(t){i.getPifProjectMembers(i.pifId.toString()),i.setPage(1),e.resetForm(),i.isEdit=!1,i.selectedMembers=[],i.form.controls.selectedMembers.enable(),i.notificationService.success("Save member succeeded.")},function(){i.notificationService.danger("Save member fails.")})}else this.notificationService.danger("Please fill all required fields.")}},{key:"editPifMember",value:function(e){this.isEdit=!0,this.selectedMembers=[],this.selectedMembers.push(e),this.selectedRole=this.roles.find(function(t){return t.roleId===e.roleId}),this.form.controls.selectedMembers.disable()}},{key:"deletePifMember",value:function(e){var t=this;e.pifId=this.pifId,this.projectService.deletePifMember(e).subscribe(function(n){t.pifMembers=t.pifMembers.filter(function(t){return t.memberId!==e.memberId}),t.setPage(1)},function(e){t.notificationService.danger("Failed to delete member")})}},{key:"getMembers",value:function(){var e=this;this.projectService.getMembers().subscribe(function(t){e.members=[],t.forEach(function(t){e.members.push(Object.assign(new f.J3,t))}),e.filteredMembers.next(e.members.slice())})}},{key:"close",value:function(){this.projectService.reloadTeam.next(),this.dialogRef.close()}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"setPageDetails",value:function(){return this.pifMembers.length>3}},{key:"setNextPage",value:function(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.pifMembers.length,e),this.pagedItems=this.pifMembers.slice(this.pager.startIndex,this.pager.endIndex+1)}},{key:"setInitialValue",value:function(){var e=this;this.filteredMembers.pipe((0,qe.q)(1),(0,ze.R)(this._onDestroy)).subscribe(function(){e.memberSelect.compareWith=function(e,t){return e&&t&&e.memberId===t.memberId}})}},{key:"filterMembers",value:function(){if(this.members){var e=this.memberFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredMembers.next(this.members.filter(function(t){return t.memberName.toLowerCase().indexOf(e)>-1}))):this.filteredMembers.next(this.members.slice())}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.e9),S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(m.WI))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-team"]],viewQuery:function(e,t){var n;(1&e&&(S.\u0275\u0275viewQuery(Yt,7),S.\u0275\u0275viewQuery(Kt,7)),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.memberSelect=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.form=n.first))},decls:47,vars:11,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["novalidate","",3,"submit"],["t","ngForm"],[1,"row"],[1,"col-sm-10"],["placeholder","Members","name","selectedMembers","multiple","","required","",3,"ngModel","ngModelChange"],["memberSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-lg-2"],[1,"row","f-right"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md"],["placeholder","Roles","name","selectedRole","required","",3,"ngModel","ngModelChange"],[1,"row",2,"margin-top","25px"],[1,"col-lg-12"],["placement","bottom",1,"p-20","z-depth-bottom-5","waves-effect"],[1,"team-table","table-responsive"],[1,"table"],[2,"padding","0px"],["scope","col",1,"table-name","th-table-style"],["scope","col",1,"table-role","th-table-style"],["scope","col",1,"table-btn","th-table-style"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[3,"value"],[1,"td-table-style","span-ellipsis",3,"matTooltip"],[1,"td-table-style"],[1,"icofont","icofont-ui-edit","icon-pointer",3,"click"],["class","icofont icofont-ui-delete icon-pointer","style","color:#d84315",3,"click",4,"ngIf"],[1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"],[1,"pagination",2,"float","right"],[3,"ngClass"],[3,"click"],[3,"ngClass",4,"ngFor","ngForOf"]],template:function(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3," Team Members "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"span"),S.\u0275\u0275elementStart(5,"em",2),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(6,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",3),S.\u0275\u0275elementStart(8,"div",4),S.\u0275\u0275elementStart(9,"form",5,6),S.\u0275\u0275listener("submit",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275reference(10);return t.insertOrUpdatePifProjectMembers(e)}),S.\u0275\u0275elementStart(11,"div",7),S.\u0275\u0275elementStart(12,"mat-form-field",8),S.\u0275\u0275elementStart(13,"mat-select",9,10),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedMembers=e}),S.\u0275\u0275elementStart(15,"mat-option"),S.\u0275\u0275elementStart(16,"ngx-mat-select-search",11),S.\u0275\u0275elementStart(17,"mat-icon",12),S.\u0275\u0275text(18,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(19,Xt,2,2,"mat-option",13),S.\u0275\u0275pipe(20,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"div",14),S.\u0275\u0275elementStart(22,"div",15),S.\u0275\u0275elementStart(23,"div",14),S.\u0275\u0275elementStart(24,"button",16),S.\u0275\u0275text(25,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",7),S.\u0275\u0275elementStart(27,"mat-form-field",8),S.\u0275\u0275elementStart(28,"mat-select",17),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedRole=e}),S.\u0275\u0275template(29,Zt,2,2,"mat-option",13),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"div",18),S.\u0275\u0275elementStart(31,"div",19),S.\u0275\u0275elementStart(32,"div",20),S.\u0275\u0275elementStart(33,"div",21),S.\u0275\u0275elementStart(34,"table",22),S.\u0275\u0275element(35,"caption",23),S.\u0275\u0275elementStart(36,"thead"),S.\u0275\u0275elementStart(37,"tr"),S.\u0275\u0275elementStart(38,"th",24),S.\u0275\u0275text(39,"Members"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"th",25),S.\u0275\u0275text(41,"Roles"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(42,"th",26),S.\u0275\u0275element(43,"th",26),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"tbody"),S.\u0275\u0275template(45,tn,9,5,"tr",27),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(46,on,14,13,"ul",28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}2&e&&(S.\u0275\u0275advance(13),S.\u0275\u0275property("ngModel",t.selectedMembers),S.\u0275\u0275advance(3),S.\u0275\u0275property("formControl",t.memberFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(20,9,t.filteredMembers)),S.\u0275\u0275advance(9),S.\u0275\u0275property("ngModel",t.selectedRole),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.roles),S.\u0275\u0275advance(16),S.\u0275\u0275property("ngForOf",t.pagedItems),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,I.gD,c.RequiredValidator,c.NgControlStatus,c.NgModel,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,o.NgIf,oe.gM,o.NgClass],pipes:[o.AsyncPipe],styles:[".icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.team-table[_ngcontent-%COMP%]{text-align:center}.team-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;table-layout:fixed}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.table-name[_ngcontent-%COMP%]{width:35%!important}.table-role[_ngcontent-%COMP%]{width:35%!important}.table-btn[_ngcontent-%COMP%]{width:10%!important}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}.mat-select-panel[_ngcontent-%COMP%]{margin-bottom:1%}"]}),e}();function sn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"em",7),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext().$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.role," ")}}function cn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"ul",2),S.\u0275\u0275elementStart(1,"li",3),S.\u0275\u0275element(2,"img",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"h6"),S.\u0275\u0275text(5),S.\u0275\u0275template(6,sn,2,1,"em",6),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",n.memberName,": "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",n.role)}}var dn=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.notificationService=i,this.dateTimeService=r,this.dialog=a,this.pifMembers=[]}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.reloadTeamSubscription=this.projectService.reloadTeam.subscribe(function(){e.getPifProjectMembers(e.project.pifId)}),this.getPifProjectMembers(this.project.pifId)}},{key:"ngOnDestroy",value:function(){this.reloadTeamSubscription.unsubscribe(),this.dialog.closeAll()}},{key:"getPifProjectMembers",value:function(e){var t=this;this.projectService.getPifProjectMembers(e).subscribe(function(e){t.pifMembers=[],e.forEach(function(e){t.pifMembers.push(Object.assign(new f.J3,e))}),t.viewCard.setpagedItems(t.pifMembers),t.viewCard.setPage(1)})}},{key:"editTeamMembers",value:function(){this.editTeamMembersDialog=this.dialog.open(ln,{disableClose:!1,hasBackdrop:!0,width:"600px",height:"570px",data:{pifId:this.project.pifId,projectId:this.project.projectId,activityId:this.project.activityId}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(m.uw))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-team-members"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Gt,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.viewCard=n.first))},inputs:{project:"project",canEditProject:"canEditProject",isProject:"isProject",isvisibleEditProject:"isvisibleEditProject"},decls:2,vars:4,consts:[[3,"title","canEditProject","isvisibleEditProject","editEvent"],["class","media-list",4,"ngFor","ngForOf"],[1,"media-list"],[1,"media","d-flex","m-b-10"],["src","assets/images/avatar.png","alt","user image",1,"m-r-5"],[1,"d-inline-block"],["class","text-muted m-b-0",4,"ngIf"],[1,"text-muted","m-b-0"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"app-view-card",0),S.\u0275\u0275listener("editEvent",function(){return t.editTeamMembers()}),S.\u0275\u0275template(1,cn,7,2,"ul",1),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275property("title","Team Members")("canEditProject",t.canEditProject)("isvisibleEditProject",t.isvisibleEditProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.viewCard.pagedItems))},directives:[Gt,o.NgForOf,o.NgIf],styles:["img[_ngcontent-%COMP%]{vertical-align:middle;border-radius:100%;width:25px}h6[_ngcontent-%COMP%]{position:relative;display:inline-block;font-size:14px}"]}),e}();function mn(e,t){1&e&&S.\u0275\u0275element(0,"th",24)}function pn(e,t){1&e&&S.\u0275\u0275element(0,"th",25)}function un(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"span"),S.\u0275\u0275elementStart(1,"i",9),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().expandSubActivities(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(2,"i",10),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().compressSubActivities(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext().$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275property("hidden",!i.hidden),S.\u0275\u0275advance(1),S.\u0275\u0275property("hidden",i.hidden)}}function fn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"td",34),S.\u0275\u0275elementStart(1,"em",35),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().editActivity(e)}),S.\u0275\u0275text(2,"create"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(3," \xa0 "),S.\u0275\u0275elementStart(4,"em",36),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().deleteActivity(e)}),S.\u0275\u0275text(5,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}}function hn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"td",34),S.\u0275\u0275elementStart(1,"em",39),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext(2).editActivity(e)}),S.\u0275\u0275text(2,"create"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(3," \xa0 "),S.\u0275\u0275elementStart(4,"em",40),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext(2).deleteActivity(e)}),S.\u0275\u0275text(5,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}}function vn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"tr",37),S.\u0275\u0275element(1,"td",27),S.\u0275\u0275elementStart(2,"td",29),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"td",30),S.\u0275\u0275text(5),S.\u0275\u0275pipe(6,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",30),S.\u0275\u0275text(8),S.\u0275\u0275pipe(9,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(10,"td"),S.\u0275\u0275text(11),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"td",30),S.\u0275\u0275text(13),S.\u0275\u0275pipe(14,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"td",30),S.\u0275\u0275text(16),S.\u0275\u0275pipe(17,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(18,"td",30),S.\u0275\u0275text(19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(20,"td"),S.\u0275\u0275text(21),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"td"),S.\u0275\u0275text(23),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"td"),S.\u0275\u0275text(25),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"td",38),S.\u0275\u0275text(27),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(28,hn,6,0,"td",32),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext().$implicit,r=S.\u0275\u0275nextContext();S.\u0275\u0275property("hidden",i.hidden),S.\u0275\u0275advance(2),S.\u0275\u0275property("matTooltip",n.name),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.name," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(6,14,n.plannedStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(9,16,n.plannedEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",n.estimatedCharge," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(14,18,n.realStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(17,20,n.realEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",n.actualCost," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.advancement," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.spi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.cpi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.usersName," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",r.isSuperAdminOrManagerOrDH())}}function gn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"tbody"),S.\u0275\u0275elementStart(1,"tr",26),S.\u0275\u0275elementStart(2,"td",27),S.\u0275\u0275template(3,un,3,2,"span",28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"td",29),S.\u0275\u0275text(5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"td",30),S.\u0275\u0275text(7),S.\u0275\u0275pipe(8,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",30),S.\u0275\u0275text(10),S.\u0275\u0275pipe(11,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"td"),S.\u0275\u0275text(13),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"td",30),S.\u0275\u0275text(15),S.\u0275\u0275pipe(16,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"td",30),S.\u0275\u0275text(18),S.\u0275\u0275pipe(19,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(20,"td",30),S.\u0275\u0275text(21),S.\u0275\u0275pipe(22,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"td"),S.\u0275\u0275text(24),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"td"),S.\u0275\u0275text(26),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"td"),S.\u0275\u0275text(28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"td",31),S.\u0275\u0275text(30),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(31,fn,6,0,"td",32),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(32,vn,29,22,"tr",33),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275property("ngIf",0!=n.subActivities.length),S.\u0275\u0275advance(1),S.\u0275\u0275property("matTooltip",n.name),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.name," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(8,15,n.plannedStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(11,17,n.plannedEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",n.estimatedCharge," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(16,19,n.realStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(19,21,n.realEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(22,23,n.actualCost,"1.2-2")," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",n.advancement," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.spi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.cpi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.usersName," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isSuperAdminOrManagerOrDH()),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",n.subActivities)}}var Sn=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.dialog=t,this.projectService=i,this.dtService=r,this.notificationService=a,this.wbsGanttService=o,this.initializeTopActivityEvent=new S.EventEmitter,this.topActivity=new f.cS,this.activities=[],this.previousActivities=[],this.isSubActivitiesDisplayed=!1,this.compressedActivitiesCount=0,this.currentCompressedActivitiesCount=0}return r(e,[{key:"ngOnInit",value:function(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.getProjectActivities(this.project.projectId)}},{key:"ngOnDestroy",value:function(){this.dialog.closeAll()}},{key:"ngAfterViewInit",value:function(){var e=this;this.updateWbsData.subscribe(function(){e.getProjectActivities(e.project.projectId)})}},{key:"initializeTopActivity",value:function(e){var t=this;this.topActivity=new f.cS,this.topActivity.projectId=+this.project.projectId,this.topActivity.name=this.project.name,this.topActivity.plannedStartDate=this.project.plannedStartDate,this.topActivity.plannedEndDate=this.project.plannedEndDate,this.topActivity.description=this.project.description,this.topActivity.activityId=0,this.topActivity.level=1,this.topActivity.activityNumber="1",this.topActivity.showChilds=!0,this.topActivity.hasParent=!1,null!=e&&e.length>0&&(this.topActivity.subActivities=this.getSubActivities(e,this.topActivity),this.topActivity.hasChilds=this.topActivity.subActivities.length>0),this.initializeTopActivityEvent.emit(this.topActivity),this.calculateWbsAutoValues(),0===this.previousActivities.length&&this.topActivity.subActivities&&this.topActivity.subActivities.forEach(function(e){!0===e.hasChilds&&(t.compressedActivitiesCount++,t.currentCompressedActivitiesCount++)})}},{key:"getSubActivities",value:function(e,t){var n=this,i=[],r=1;return e.forEach(function(a){if(null===a.parentId&&(a.parentId=0),a.parentId===t.activityId){var o=new f.cS;o.phaseId=a.phaseId,o.categoryId=a.categoryId,o.projectId=a.projectId,o.activityId=a.activityId,o.parentId=a.parentId,o.name=a.name,o.description=a.description,o.activityNumber=t.activityNumber+"."+r.toString(),o.level=a.level+1,o.showChilds=a.level<2,o.hasAssignment=a.hasAssignment,o.estimatedCharge=a.estimatedCharge,o.plannedStartDate=a.plannedStartDate,o.plannedEndDate=a.plannedEndDate,o.advancement=a.advancement,o.actualCost=a.actualCost,o.realStartDate=a.realStartDate,o.realEndDate=a.realEndDate,o.hasParent=!0,o.hidden=a.hidden,o.usersName=a.usersName,o.subActivities=n.getSubActivities(e,o),o.hasChilds=o.subActivities.length>0,r++,i.push(o)}}),i}},{key:"getProjectActivities",value:function(e){var t=this;this.projectService.getProjectActivities(e).subscribe(function(e){0!==t.activities.length&&(t.previousActivities=t.topActivity.subActivities),t.activities=[],e.forEach(function(e){if(0!==t.previousActivities.length){var n=t.previousActivities.find(function(t){return t.activityId===e.activityId});n&&(e.hidden=n.hidden)}t.activities.push(Object.assign(new f.cS,e))}),t.initializeTopActivity(t.activities)})}},{key:"editActivity",value:function(e){this.openEditActivityDialog(e,"edit"),this.onActivityClick(e)}},{key:"openEditActivityDialog",value:function(e,t){var n=this;this.addEditActivitydialogRef=this.dialog.open(Oe,{disableClose:!1,hasBackdrop:!0,width:"800px",height:"590px",data:{mode:t,activity:e,departmentId:this.project.departmentId,parentStartDate:!0===e.hasChilds||e.level<=2?this.topActivity.plannedStartDate:e.plannedStartDate,parentEndDate:!0===e.hasChilds||e.level<=2?this.topActivity.plannedEndDate:e.plannedEndDate}}),this.addEditActivitydialogRef.afterClosed().subscribe(function(){n.getProjectActivities(n.project.projectId)})}},{key:"deleteActivity",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this task ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.projectService.deleteActivity(e.activityId).subscribe(function(){t.projectService.ActivityDeleted.next(e),t.notificationService.success("The task '"+e.name+"' is deleted successfully !"),t.getProjectActivities(t.project.projectId)},function(){t.notificationService.danger("Delete task failed")})}})}},{key:"calculateWbsAutoValues",value:function(){this.wbsGanttService.calculateWbsEstimCharge(this.topActivity),this.wbsGanttService.calculateWbsProgress(this.topActivity),this.wbsGanttService.calculateWbsStatus(this.topActivity),this.wbsGanttService.calculateWbsAcwpBcwpKpis(this.topActivity),this.wbsGanttService.calculateRealDates(this.topActivity),this.wbsGanttService.calculateElapsedDuration(this.topActivity),this.wbsGanttService.calculateWbsSpiCpiKpis(this.topActivity)}},{key:"onActivityClick",value:function(e){this.projectService.ActivitySelected.emit(e)}},{key:"isSuperAdminOrManagerOrDH",value:function(){return this.user.groupId===v.Fl.ProjectManager&&this.project.activityId===this.user.activityId||this.user.groupId===v.Fl.SuperAdmin||this.user.qualification===v._W.DepartmentHead}},{key:"expandSubActivities",value:function(e){var t=this;if(0===e.activityId)return void 0!==this.topActivity.subActivities&&this.topActivity.subActivities.forEach(function(e){e.hidden=!1,t.currentCompressedActivitiesCount=0}),this.isSubActivitiesDisplayed=!0,this.isSubActivitiesDisplayed;e.hidden=!1,this.currentCompressedActivitiesCount--,0===this.currentCompressedActivitiesCount&&(this.isSubActivitiesDisplayed=!0)}},{key:"compressSubActivities",value:function(e){var t=this;if(void 0!==this.topActivity.subActivities){if(0===e.activityId)return this.topActivity.subActivities.forEach(function(e){e.hidden=!0,t.currentCompressedActivitiesCount=t.compressedActivitiesCount}),this.isSubActivitiesDisplayed=!1,this.isSubActivitiesDisplayed;e.hidden=!0,this.currentCompressedActivitiesCount++,this.currentCompressedActivitiesCount===this.compressedActivitiesCount&&(this.isSubActivitiesDisplayed=!1)}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(h.u2))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-wbs-gantt"]],inputs:{project:"project",activity:"activity",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",smallSize:"smallSize",updateWbsData:"updateWbsData"},outputs:{initializeTopActivityEvent:"initializeTopActivityEvent"},decls:68,vars:26,consts:[[1,"main-content","m-t-10"],[1,"row"],[1,"col-md-12"],[1,"card"],[1,"card-body"],[1,"table","table-bordered","text-center","m-b-10"],[2,"padding","0px"],[1,"th"],["scope","row",2,"width","45px"],["aria-hidden","true",1,"fa","fa-plus","pointer",3,"hidden","click"],["aria-hidden","true",1,"fa","fa-minus","pointer",3,"hidden","click"],["scope","row","colspan","7"],["scope","row","colspan","2"],["scope","row"],["scope","row","colspan","4"],["scope","row","style","width:85px;",4,"ngIf"],["scope","row",1,"total",2,"width","45px"],["scope","row","colspan","7",1,"total",2,"text-align","left"],["scope","row","colspan","2",1,"total"],["scope","row",1,"total"],["scope","row","colspan","4",1,"total",2,"white-space","pre-line","text-align","left"],["scope","row","class","total","style","width:85px;",4,"ngIf"],[1,"tbody"],[4,"ngFor","ngForOf"],["scope","row",2,"width","85px"],["scope","row",1,"total",2,"width","85px"],[2,"text-align","center"],[2,"width","45px"],[4,"ngIf"],["colspan","7",2,"text-align","left",3,"matTooltip"],["colspan","2"],["colspan","4",2,"white-space","pre-line","text-align","left"],["class","pointer","style","width:85px;",4,"ngIf"],["style","background-color: #CAC7C5;",3,"hidden",4,"ngFor","ngForOf"],[1,"pointer",2,"width","85px"],["matTooltip","Edit Task",1,"material-icons",3,"click"],["matTooltip","Delete Task",1,"material-icons",3,"click"],[2,"background-color","#CAC7C5",3,"hidden"],["colspan","4",2,"text-align","left","white-space","pre-line"],["matTooltip","Edit Subtask",1,"material-icons",3,"click"],["matTooltip","Delete Subtask",1,"material-icons",3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"div",1),S.\u0275\u0275elementStart(6,"div",2),S.\u0275\u0275elementStart(7,"table",5),S.\u0275\u0275element(8,"caption",6),S.\u0275\u0275elementStart(9,"thead",7),S.\u0275\u0275elementStart(10,"th",8),S.\u0275\u0275elementStart(11,"i",9),S.\u0275\u0275listener("click",function(){return t.expandSubActivities(t.topActivity)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"i",10),S.\u0275\u0275listener("click",function(){return t.compressSubActivities(t.topActivity)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"th",11),S.\u0275\u0275text(14,"Name"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"th",12),S.\u0275\u0275text(16,"Est. Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"th",12),S.\u0275\u0275text(18,"Est. End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"th",13),S.\u0275\u0275text(20,"Est."),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"th",12),S.\u0275\u0275text(22,"Real Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"th",12),S.\u0275\u0275text(24,"Real End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"th",12),S.\u0275\u0275text(26,"Cost"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"th",13),S.\u0275\u0275text(28,"Prog."),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"th",13),S.\u0275\u0275text(30,"Spi"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"th",13),S.\u0275\u0275text(32,"Cpi"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"th",14),S.\u0275\u0275text(34,"Ressources"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(35,mn,1,0,"th",15),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"thead",7),S.\u0275\u0275element(37,"th",16),S.\u0275\u0275elementStart(38,"th",17),S.\u0275\u0275text(39," Total "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"th",18),S.\u0275\u0275text(41),S.\u0275\u0275pipe(42,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"th",18),S.\u0275\u0275text(44),S.\u0275\u0275pipe(45,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"th",19),S.\u0275\u0275text(47),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"th",18),S.\u0275\u0275text(49),S.\u0275\u0275pipe(50,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"th",18),S.\u0275\u0275text(52),S.\u0275\u0275pipe(53,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(54,"th",18),S.\u0275\u0275text(55),S.\u0275\u0275pipe(56,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"th",19),S.\u0275\u0275text(58),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(59,"th",19),S.\u0275\u0275text(60),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(61,"th",19),S.\u0275\u0275text(62),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(63,"th",20),S.\u0275\u0275text(64),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(65,pn,1,0,"th",21),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(66,"span",22),S.\u0275\u0275template(67,gn,33,26,"tbody",23),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(11),S.\u0275\u0275property("hidden",t.isSubActivitiesDisplayed),S.\u0275\u0275advance(1),S.\u0275\u0275property("hidden",!t.isSubActivitiesDisplayed),S.\u0275\u0275advance(23),S.\u0275\u0275property("ngIf",t.isSuperAdminOrManagerOrDH()),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(42,15,t.topActivity.plannedStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(45,17,t.topActivity.plannedEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",t.topActivity.estimatedCharge," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(50,19,t.topActivity.realStartDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(53,21,t.topActivity.realEndDate)," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(56,23,t.topActivity.actualCost,"1.2-2")," "),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",t.topActivity.advancement," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",t.topActivity.spi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",t.topActivity.cpi," "),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",t.topActivity.usersName," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isSuperAdminOrManagerOrDH()),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngForOf",t.topActivity.subActivities))},directives:[o.NgIf,o.NgForOf,oe.gM],pipes:[Te.M,o.DecimalPipe],styles:[".table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:.63rem .18rem}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:0 .18rem;vertical-align:middle;position:relative;font-size:.875em}.th[_ngcontent-%COMP%]{background-color:#3f629d;color:#fff;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6;font-size:.9em}td[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;border-top:0px solid #dee2e6;border-bottom:0px solid #dee2e6;height:40px}th[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.tr[_ngcontent-%COMP%]{text-align:center}.pointer[_ngcontent-%COMP%]{cursor:pointer}tbody[_ngcontent-%COMP%]{overflow:auto;overflow-y:scroll;width:100%}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}thead[_ngcontent-%COMP%]{width:calc(100% - 1.2em)}.tbody[_ngcontent-%COMP%]{display:block;max-height:calc(100vh - 392px);height:auto;overflow:auto;overflow-y:scroll}.total[_ngcontent-%COMP%]{color:#000;text-align:center;background-color:#fafad2}.icone-total[_ngcontent-%COMP%]{color:#455a64}"]}),e}(),yn=a(70480),bn=function(){var e=function(){function e(t,i,r){n(this,e),this.dialogRef=t,this.data=i,this.notificationService=r,this.activity=new f.cS,this.pager={},this.activity=this.data.activity}return r(e,[{key:"getLabelCssClass",value:function(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(m.WI),S.\u0275\u0275directiveInject(u.gq))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-display"]],decls:73,vars:10,consts:[[1,"modal-header"],[1,"modal-title"],[1,"modal-body"],[1,"table-responsive"],[1,"table","table-border","table-xs"],[2,"padding","0px"],["scope",""],["colspan","2",1,"text-right"],["scope","col"],[1,"text-right",2,"padding-right","0"],[3,"className"],[2,"width","10px","padding-right","0"],[1,"kpi-tooltip"],[1,"material-icons"],[1,"kpi-tooltip-content"],[1,"kpi-tooltip-text"],[1,"kpi-tooltip-inner"],[2,"display","block"],[1,"li-danger"],[1,"li-default"],[1,"li-success"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"div",2),S.\u0275\u0275elementStart(5,"div",3),S.\u0275\u0275elementStart(6,"table",4),S.\u0275\u0275element(7,"caption",5),S.\u0275\u0275elementStart(8,"tbody"),S.\u0275\u0275elementStart(9,"tr"),S.\u0275\u0275elementStart(10,"th",6),S.\u0275\u0275text(11,"Charge:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(12,"td",7),S.\u0275\u0275text(13),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"tr"),S.\u0275\u0275elementStart(15,"th",8),S.\u0275\u0275text(16,"Duration:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"td",7),S.\u0275\u0275text(18),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"tr"),S.\u0275\u0275elementStart(20,"th",8),S.\u0275\u0275text(21,"Progress:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"td",7),S.\u0275\u0275text(23),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"tr"),S.\u0275\u0275elementStart(25,"th",8),S.\u0275\u0275text(26,"Actual Cost:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"td",7),S.\u0275\u0275text(28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"tr"),S.\u0275\u0275elementStart(30,"th",8),S.\u0275\u0275text(31,"SPI:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"td",9),S.\u0275\u0275elementStart(33,"label",10),S.\u0275\u0275text(34),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"td",11),S.\u0275\u0275elementStart(36,"a",12),S.\u0275\u0275elementStart(37,"em",13),S.\u0275\u0275text(38,"info_outline"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(39,"span",14),S.\u0275\u0275elementStart(40,"span",15),S.\u0275\u0275elementStart(41,"span",16),S.\u0275\u0275elementStart(42,"span",17),S.\u0275\u0275text(43,"Schedule Performance Index (SPI) :"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"ul"),S.\u0275\u0275elementStart(45,"li",18),S.\u0275\u0275text(46,"\xa0- SPI < 1 : ahead of schedule"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(47,"li",19),S.\u0275\u0275text(48,"\xa0- SPI = 1 : on time"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(49,"li",20),S.\u0275\u0275text(50,"\xa0- SPI > 1 : behind schedule"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"tr"),S.\u0275\u0275elementStart(52,"th",8),S.\u0275\u0275text(53,"CPI:"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(54,"td",9),S.\u0275\u0275elementStart(55,"label",10),S.\u0275\u0275text(56),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"td",11),S.\u0275\u0275elementStart(58,"a",12),S.\u0275\u0275elementStart(59,"em",13),S.\u0275\u0275text(60,"info_outline"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(61,"span",14),S.\u0275\u0275elementStart(62,"span",15),S.\u0275\u0275elementStart(63,"span",16),S.\u0275\u0275elementStart(64,"span",17),S.\u0275\u0275text(65,"Cost Performance Index (CPI) :"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(66,"ul"),S.\u0275\u0275elementStart(67,"li",18),S.\u0275\u0275text(68,"\xa0- CPI < 1 : over budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(69,"li",19),S.\u0275\u0275text(70,"\xa0- CPI = 1 : on budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(71,"li",20),S.\u0275\u0275text(72,"\xa0- CPI > 1 : under budget"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate2("",t.activity.name," [",t.activity.activityNumber,"]"),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate1("",t.activity.estimatedCharge," MD"),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",t.activity.plannedDuration," Days"),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",t.activity.advancement," %"),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",t.activity.actualCost," MD"),S.\u0275\u0275advance(5),S.\u0275\u0275property("className",t.getLabelCssClass(t.activity.spi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.activity.spi," "),S.\u0275\u0275advance(21),S.\u0275\u0275property("className",t.getLabelCssClass(t.activity.cpi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.activity.cpi," "))},styles:['.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important}.modal-header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal-body[_ngcontent-%COMP%]{overflow:hidden}.modal-title[_ngcontent-%COMP%]{color:#fff;line-height:1}.table[_ngcontent-%COMP%]{margin:0}.table.table-xs[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], .table.table-xs[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px}.td-kpi-value[_ngcontent-%COMP%]{padding-right:0}.td-kpi-info[_ngcontent-%COMP%]{width:10px;padding-right:0}.table-responsive[_ngcontent-%COMP%]{overflow:visible}.kpi-tooltip[_ngcontent-%COMP%]{display:inline;position:relative;z-index:999}.kpi-tooltip[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-text[_ngcontent-%COMP%]{transition-delay:0s;transform:scale(1)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-inner[_ngcontent-%COMP%]{transition-delay:.3s;transform:translate(0)}.kpi-tooltip[_ngcontent-%COMP%]:hover   .kpi-tooltip-content[_ngcontent-%COMP%]{opacity:1;pointer-events:auto;transition-delay:0s}.kpi-tooltip-content[_ngcontent-%COMP%]{position:absolute;z-index:9999;width:220px;left:50%;bottom:100%;font-size:12px;line-height:1.4;font-weight:400;color:#fff;background:0 0;opacity:0;margin:0 0 20px -205px;cursor:default;pointer-events:none;-webkit-font-smoothing:antialiased;transition:opacity .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.kpi-tooltip-content[_ngcontent-%COMP%]:after{content:"";bottom:-20px;left:50%;border:solid transparent;height:0;width:0;position:absolute;pointer-events:none;border-color:#007bff transparent transparent;border-width:10px;margin-left:85px}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-text[_ngcontent-%COMP%]{border-bottom:10px solid #007bff;overflow:hidden;transform:scaleX(0);transition:transform .3s .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]{background:#2b2b2b;padding:10px;transform:translateY(100%);transition:transform .3s}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-danger[_ngcontent-%COMP%]{color:#ff5252}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-success[_ngcontent-%COMP%]{color:#11c15b}.kpi-tooltip-content[_ngcontent-%COMP%]   .kpi-tooltip-inner[_ngcontent-%COMP%]   .li-default[_ngcontent-%COMP%]{color:#d6d6d6}a.kpi-tooltip[_ngcontent-%COMP%]{font-weight:700;color:#007bff;z-index:9}']}),e}(),Cn=function(){var e=function(){function e(){n(this,e),this.defaultColor="transparent"}return r(e,[{key:"ngOnInit",value:function(){switch(this.levelNumber){case 1:this.backgroungColor="#FFF7C2",this.borderColor="#FECB16";break;case 2:this.backgroungColor="#CCECFF",this.borderColor="#5AB6FF";break;case 3:this.backgroungColor="#D2ECD2",this.borderColor="#2B920E";break;case 4:this.backgroungColor="#E5D4EB",this.borderColor="#A02A95";break;case 5:this.backgroungColor="#FFD9DA",this.borderColor="#A62B39";break;default:this.backgroungColor=this.defaultColor,this.borderColor="#0000"}}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=S.\u0275\u0275defineDirective({type:e,selectors:[["","activity-color",""]],hostVars:4,hostBindings:function(e,t){2&e&&S.\u0275\u0275styleProp("background-color",t.backgroungColor)("border-color",t.borderColor)},inputs:{defaultColor:"defaultColor",levelNumber:["activity-color","levelNumber"]}}),e}(),En=["activityCard"];function xn(e,t){1&e&&S.\u0275\u0275element(0,"div",15)}function In(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",16),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",null==n.activity?null:n.activity.activityNumber,"\n")}}function wn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"tr",17),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onActivityClick()}),S.\u0275\u0275elementStart(1,"td",18),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" Charge: ",i.activity.estimatedCharge," MD ")}}function Mn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"tr",19),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onActivityClick()}),S.\u0275\u0275elementStart(1,"td",20),S.\u0275\u0275elementStart(2,"label",21),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"label",22),S.\u0275\u0275text(5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"label",22),S.\u0275\u0275text(7),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",i.activity.advancement,"% "),S.\u0275\u0275advance(1),S.\u0275\u0275property("className",i.getLabelCssClass(i.activity.spi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" SPI: ",i.activity.spi," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("className",i.getLabelCssClass(i.activity.cpi)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" CPI: ",i.activity.cpi," ")}}function Pn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"em",25),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).showChilds(!0)}),S.\u0275\u0275text(1," add_circle_outline"),S.\u0275\u0275elementEnd()}}function Dn(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"em",25),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).showChilds(!1)}),S.\u0275\u0275text(1," remove_circle_outline"),S.\u0275\u0275elementEnd()}}function jn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",23),S.\u0275\u0275template(1,Pn,2,0,"em",24),S.\u0275\u0275template(2,Dn,2,0,"em",24),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!n.activity.showChilds),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",n.activity.showChilds)}}function kn(e,t){1&e&&S.\u0275\u0275element(0,"div",15)}var On=function(e,t){return{"selected-activity":e,"small-size-activity":t}},Fn=function(e){return{"tr-actions-shown":e}},An=function(e){return{"disabled-action":e}},_n=function(e,t){return{"disabled-action":e,"danger-action":t}},Vn=function(){var e=function(){function e(t,i,r){n(this,e),this.dialog=t,this.projectService=i,this.notificationService=r}return r(e,[{key:"showChilds",value:function(e){this.activity.showChilds=e}},{key:"ngOnDestroy",value:function(){this.dialog.closeAll()}},{key:"displayActivity",value:function(){var e={disableClose:!1,hasBackdrop:!0,width:"350px",height:"330px",data:{activity:this.activity}};this.onActivityClick(),this.displayActivityDialogRef=this.dialog.open(bn,e)}},{key:"editActivity",value:function(){this.onActivityClick()}},{key:"addActivity",value:function(){this.onActivityClick()}},{key:"deleteActivity",value:function(){var e=this;ne().fire({text:"Are you sure to delete this activity ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){e.projectService.deleteActivity(e.activity.activityId).subscribe(function(){e.projectService.ActivityDeleted.next(e.activity),e.notificationService.success("The task '"+e.activity.name+"' is deleted successfully !")},function(){e.notificationService.danger("Delete activity failed")})}})}},{key:"getLabelCssClass",value:function(e){return 0===e?"badge badge-default":e<1?"badge badge-danger":e>=1?"badge badge-success":void 0}},{key:"onActivityClick",value:function(){this.activity.isSelected=!this.activity.isSelected,this.activity.isSelected&&this.projectService.ActivitySelected.emit(this.activity)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-oc-activity"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(En,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.activityCard=n.first))},inputs:{activity:"activity",parentStartDate:"parentStartDate",parentEndDate:"parentEndDate",smallSize:"smallSize"},decls:38,vars:22,consts:[["class","activity-h-bar line-border",4,"ngIf"],["class","div-number",4,"ngIf"],[1,"activity-card",3,"activity-color","ngClass"],["activityCard",""],[1,"activity-card-table"],[2,"padding","0px"],[1,"tr-name",3,"click"],["colspan","4","scope","col",1,"activity-name"],["class","tr-charge",3,"click",4,"ngIf"],["class","tr-kpi-advancement",3,"click",4,"ngIf"],[1,"tr-actions",3,"ngClass"],[3,"click"],[1,"material-icons"],[3,"ngClass","click"],["class","show-childs-icon",4,"ngIf"],[1,"activity-h-bar","line-border"],[1,"div-number"],[1,"tr-charge",3,"click"],["colspan","4",1,"activity-charge"],[1,"tr-kpi-advancement",3,"click"],["colspan","4"],[1,"badge","badge-info"],[3,"className"],[1,"show-childs-icon"],["class","material-icons",3,"click",4,"ngIf"],[1,"material-icons",3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,xn,1,0,"div",0),S.\u0275\u0275template(1,In,2,1,"div",1),S.\u0275\u0275elementStart(2,"div",2,3),S.\u0275\u0275elementStart(4,"table",4),S.\u0275\u0275element(5,"caption",5),S.\u0275\u0275elementStart(6,"tr",6),S.\u0275\u0275listener("click",function(){return t.onActivityClick()}),S.\u0275\u0275elementStart(7,"th",7),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(9,wn,3,1,"tr",8),S.\u0275\u0275template(10,Mn,8,5,"tr",9),S.\u0275\u0275elementStart(11,"tr",10),S.\u0275\u0275elementStart(12,"td",11),S.\u0275\u0275listener("click",function(){return t.displayActivity()}),S.\u0275\u0275elementStart(13,"em",12),S.\u0275\u0275text(14,"visibility"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(15,"br"),S.\u0275\u0275elementStart(16,"label"),S.\u0275\u0275text(17,"Display"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(18,"td",11),S.\u0275\u0275listener("click",function(){return t.editActivity()}),S.\u0275\u0275elementStart(19,"em",12),S.\u0275\u0275text(20,"create"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(21,"br"),S.\u0275\u0275elementStart(22,"label"),S.\u0275\u0275text(23,"Edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"td",13),S.\u0275\u0275listener("click",function(){return!t.activity.hasAssignment&&5!=t.activity.level&&t.addActivity()}),S.\u0275\u0275elementStart(25,"em",12),S.\u0275\u0275text(26,"add"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(27,"br"),S.\u0275\u0275elementStart(28,"label"),S.\u0275\u0275text(29,"Add"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"td",13),S.\u0275\u0275listener("click",function(){return!t.activity.hasChilds&&t.deleteActivity()}),S.\u0275\u0275elementStart(31,"em",12),S.\u0275\u0275text(32,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(33,"br"),S.\u0275\u0275elementStart(34,"label"),S.\u0275\u0275text(35,"Delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(36,jn,3,2,"div",14),S.\u0275\u0275template(37,kn,1,0,"div",0)),2&e&&(S.\u0275\u0275property("ngIf",t.activity.hasParent),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",1!=(null==t.activity?null:t.activity.level)),S.\u0275\u0275advance(1),S.\u0275\u0275property("activity-color",null==t.activity?null:t.activity.level)("ngClass",S.\u0275\u0275pureFunction2(12,On,t.activity.isSelected,t.smallSize&&!t.activity.isSelected)),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate1(" ",t.activity.name," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.smallSize||t.activity.isSelected),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.smallSize||t.activity.isSelected),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(15,Fn,t.activity.isSelected)),S.\u0275\u0275advance(13),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(17,An,t.activity.hasAssignment||5==t.activity.level)),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction2(19,_n,t.activity.hasChilds,!t.activity.hasChilds)),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngIf",t.activity.hasChilds),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.activity.hasChilds&&t.activity.showChilds))},directives:[o.NgIf,Cn,o.NgClass],styles:["[_nghost-%COMP%]{margin:3px;display:flex;flex-direction:column;align-items:center}.activity-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:1.5px solid;border-radius:6px;width:182px;height:100px;position:relative;transition-duration:1s}.selected-activity[_ngcontent-%COMP%]{height:140px}.small-size-activity[_ngcontent-%COMP%]{width:120px;height:50px}.activity-card-table[_ngcontent-%COMP%]{widows:180px;height:100px;border:1.5px;overflow:hidden;vertical-align:middle;text-align:center}.activity-card[_ngcontent-%COMP%]:hover{box-shadow:0 0 20px #000}.activity-h-bar[_ngcontent-%COMP%]{height:.5em;z-index:2}.show-childs-icon[_ngcontent-%COMP%]{color:#555;cursor:pointer;z-index:1000}.line-border[_ngcontent-%COMP%]{border:1px solid gray}.div-number[_ngcontent-%COMP%]{font-family:sans-serif;font-size:11px}.tr-name[_ngcontent-%COMP%]{height:35px;vertical-align:middle}.tr-name[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-size:15px;font-family:sans-serif;font-weight:bold;color:#000}.tr-charge[_ngcontent-%COMP%]{height:20px;vertical-align:top}.tr-charge[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{font-family:sans-serif;font-size:12px;margin:3px}.tr-kpi-advancement[_ngcontent-%COMP%]{height:40px;vertical-align:top}.tr-actions[_ngcontent-%COMP%]{overflow:hidden;text-align:center;transition-duration:.2s;transition-delay:.2s;opacity:0;visibility:hidden}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{width:10px;padding:5px 5px 0;line-height:15px;overflow:hidden;z-index:10000;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:18px;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:12px;cursor:pointer}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#007bff}.tr-actions[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#007bff}.tr-actions[_ngcontent-%COMP%]   .danger-action[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:#dc3545}.tr-actions[_ngcontent-%COMP%]   .danger-action[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#dc3545}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]{cursor:not-allowed}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]:hover   label[_ngcontent-%COMP%]{color:gray}.tr-actions[_ngcontent-%COMP%]   .disabled-action[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:gray}.tr-actions-shown[_ngcontent-%COMP%]{visibility:visible;opacity:1;transition-duration:.3s;transition-delay:.3s}.tr-actions-shown[_ngcontent-%COMP%]   .activity-card[_ngcontent-%COMP%]{width:182px;height:100px}"]}),e}();function Nn(e,t){if(1&e&&S.\u0275\u0275element(0,"app-oc-activity",2),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("activity",n.topActivity)("parentStartDate",n.topActivityStartDate)("parentEndDate",n.topActivityEndDate)("smallSize",n.smallSize)}}function Rn(e,t){if(1&e&&(S.\u0275\u0275elementContainerStart(0),S.\u0275\u0275elementStart(1,"div",5),S.\u0275\u0275elementStart(2,"div",6),S.\u0275\u0275element(3,"div",7),S.\u0275\u0275element(4,"div",8),S.\u0275\u0275element(5,"div",7),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(6,"app-org-chart",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementContainerEnd()),2&e){var n=t.$implicit,i=t.first,r=t.last,a=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(3),S.\u0275\u0275styleProp("border-color",i?"transparent":""),S.\u0275\u0275advance(2),S.\u0275\u0275styleProp("border-color",r?"transparent":""),S.\u0275\u0275advance(1),S.\u0275\u0275property("topActivity",n)("topActivityStartDate",a.topActivity.plannedStartDate)("topActivityEndDate",a.topActivity.plannedEndDate)("smallSize",a.smallSize)}}function Tn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",3),S.\u0275\u0275template(1,Rn,7,8,"ng-container",4),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("@expandCollapse",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",null==n.topActivity?null:n.topActivity.subActivities)}}var Bn=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-org-chart"]],inputs:{topActivity:"topActivity",topActivityStartDate:"topActivityStartDate",topActivityEndDate:"topActivityEndDate",smallSize:"smallSize"},decls:2,vars:2,consts:[[3,"activity","parentStartDate","parentEndDate","smallSize",4,"ngIf"],["class","oc-reports","style","overflow: visible",4,"ngIf"],[3,"activity","parentStartDate","parentEndDate","smallSize"],[1,"oc-reports",2,"overflow","visible"],[4,"ngFor","ngForOf"],[1,"oc-org-container"],[1,"oc-h-bar-container"],[1,"oc-h-bar","oc-border"],[1,"oc-border"],[2,"margin-bottom","25px",3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,Nn,1,4,"app-oc-activity",0),S.\u0275\u0275template(1,Tn,2,2,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.topActivity),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.topActivity.showChilds))},directives:[o.NgIf,Vn,o.NgForOf,e],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;align-items:center}.oc-reports[_ngcontent-%COMP%]{display:flex;flex:1;overflow:visible}.oc-org-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}.oc-h-bar-container[_ngcontent-%COMP%]{display:flex}.oc-h-bar[_ngcontent-%COMP%]{flex:1}.oc-border[_ngcontent-%COMP%]{border:1px solid gray}"],data:{animation:[yn.D]}}),e}(),zn=["wbsContainer"];function qn(e,t){if(1&e&&S.\u0275\u0275element(0,"app-org-chart",10),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("topActivity",n.topActivity)("topActivityStartDate",n.topActivity.plannedStartDate)("topActivityEndDate",n.topActivity.plannedEndDate)("smallSize",n.wbsService.smallSize)}}var Ln=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.notificationService=i,this.dtService=r,this.wbsService=a,this.topActivity=new f.cS,this.selectedActivity=new f.cS,this.displayChildsOffset=400}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.GetActivitiesById(this.project.projectId),this.projectService.ActivityDetailsChanged.subscribe(function(){e.calculateWbsEstimCharge(e.topActivity),e.calculateWbsProgress(e.topActivity),e.calculateWbsAcwpBcwpKpis(e.topActivity)}),this.projectService.ActivitySelected.subscribe(function(t){e.deselectActivity(e.topActivity,t.activityId)}),this.addActivitySubscrip=this.projectService.ActivityAdded.subscribe(function(t){e.addActivity(t)}),this.deleteActivitySubscrip=this.projectService.ActivityDeleted.subscribe(function(t){e.deleteActivity(t)})}},{key:"ngOnDestroy",value:function(){this.deleteActivitySubscrip.unsubscribe(),this.addActivitySubscrip.unsubscribe()}},{key:"onResize",value:function(e){this.wbsService.onWbsContainerResize()}},{key:"addActivity",value:function(e){var t=this.getParentActivity(e.activityNumber);t.subActivities.push(e),t.showChilds=!0,t.hasChilds=!0,e.hasParent=!0,this.calculateWbsAutoValues(),this.wbsService.autoZooming()}},{key:"deleteActivity",value:function(e){var t=this.getParentActivity(e.activityNumber);t.subActivities=t.subActivities.filter(function(t){return t.activityId!==e.activityId}),t.subActivities.length>0?this.updateSubActivitiesNumber(t):(t.estimatedCharge=0,t.advancement=0,t.hasChilds=!1),this.calculateWbsAutoValues()}},{key:"GetActivitiesById",value:function(e){var t=this;this.projectService.getProjectActivities(e).subscribe(function(e){var n=[];e.forEach(function(e){n.push(Object.assign(new f.cS,e))}),t.initializeTopActivity(n),t.calculateWbsAutoValues(),t.wbsService.init(t.wbsContainer,t.topActivity),t.wbsService.autoZooming()})}},{key:"initializeTopActivity",value:function(e){this.topActivity.projectId=+this.project.projectId,this.topActivity.name=this.project.name,this.topActivity.plannedStartDate=this.project.plannedStartDate,this.topActivity.plannedEndDate=this.project.plannedEndDate,this.topActivity.description=this.project.description,this.topActivity.activityId=0,this.topActivity.level=1,this.topActivity.activityNumber="1",this.topActivity.showChilds=!0,this.topActivity.hasParent=!1,null!=e&&e.length>0&&(this.topActivity.subActivities=this.getSubActivities(e,this.topActivity),this.topActivity.hasChilds=this.topActivity.subActivities.length>0)}},{key:"getSubActivities",value:function(e,t){var n=this,i=[],r=1;return e.forEach(function(a){if(null===a.parentId&&(a.parentId=0),a.parentId===t.activityId){var o=new f.cS;o.projectId=a.projectId,o.activityId=a.activityId,o.parentId=a.parentId,o.name=a.name,o.description=a.description,o.activityNumber=t.activityNumber+"."+r.toString(),o.level=a.level+1,o.showChilds=a.level<2,o.hasAssignment=a.hasAssignment,o.estimatedCharge=a.estimatedCharge,o.plannedStartDate=a.plannedStartDate,o.plannedEndDate=a.plannedEndDate,o.advancement=a.advancement,o.actualCost=a.actualCost,o.realStartDate=a.realStartDate,o.realEndDate=a.realEndDate,o.hasParent=!0,o.subActivities=n.getSubActivities(e,o),o.hasChilds=o.subActivities.length>0,r++,i.push(o)}}),i}},{key:"getParentActivity",value:function(e){var t=e.split("."),n=this.topActivity;if(t.length>2)for(var i=1;i<t.length-1;i++)n=n.subActivities[+t[i]-1];return n}},{key:"updateSubActivitiesNumber",value:function(e){for(var t=0;t<e.subActivities.length;t++)e.subActivities[t].activityNumber=e.activityNumber+"."+(t+1).toString(),e.subActivities[t].subActivities.length>0&&this.updateSubActivitiesNumber(e.subActivities[t])}},{key:"calculateWbsAutoValues",value:function(){this.calculateWbsEstimCharge(this.topActivity),this.calculateWbsProgress(this.topActivity),this.calculateWbsStatus(this.topActivity),this.calculateWbsAcwpBcwpKpis(this.topActivity),this.calculateElapsedDuration(this.topActivity),this.calculateWbsSpiCpiKpis(this.topActivity),this.calculateWbsColumnNumber(this.topActivity),this.calculateWbsColumnNumberDisplayed(this.topActivity),this.calculateWbsMaxLevel(this.topActivity),this.calculateWbsMaxLevelDisplayed(this.topActivity)}},{key:"calculateWbsEstimCharge",value:function(e){var t=this;e.hasChilds&&(e.estimatedCharge=0,e.subActivities.forEach(function(n){t.calculateWbsEstimCharge(n),e.estimatedCharge+=+n.estimatedCharge}))}},{key:"calculateWbsProgress",value:function(e){var t=this;e.hasChilds&&e.estimatedCharge>0&&(e.advancement=0,e.subActivities.forEach(function(n){t.calculateWbsProgress(n),e.advancement+=n.estimatedCharge/e.estimatedCharge*n.advancement}),e.advancement=+e.advancement.toFixed())}},{key:"calculateWbsStatus",value:function(e){var t=this;e.status=this.dtService.isAfter(e.plannedStartDate,this.dtService.today())?f.fU.NotStarted:100===e.advancement?f.fU.Completed:f.fU.Started,e.hasChilds&&e.subActivities.forEach(function(e){t.calculateWbsStatus(e)})}},{key:"calculateWbsAcwpBcwpKpis",value:function(e){var t=this;e.hasChilds?(e.actualCost=0,e.earnedValue=0,e.subActivities.forEach(function(n){t.calculateWbsAcwpBcwpKpis(n),e.actualCost+=n.actualCost,e.earnedValue+=n.earnedValue})):e.earnedValue=+(e.advancement/100*e.estimatedCharge).toFixed(2)}},{key:"calculateWbsSpiCpiKpis",value:function(e){var t=this;e.spi=e.elapsedDuration>0?+(e.advancement/100*e.plannedDuration/e.elapsedDuration).toFixed(2):0,e.cpi=e.actualCost>0?+(e.earnedValue/e.actualCost).toFixed(2):0,e.hasChilds&&e.subActivities.forEach(function(e){t.calculateWbsSpiCpiKpis(e)})}},{key:"calculateElapsedDuration",value:function(e){var t=this;switch(e.status){case f.fU.NotStarted:e.elapsedDuration=0;break;case f.fU.Started:e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,this.dtService.today(),!1);break;case f.fU.Completed:if(e.hasChilds){var n=null;e.subActivities.forEach(function(e){t.calculateElapsedDuration(e),100===e.advancement&&(n=t.dtService.getMaxDate(n,e.realEndDate))}),e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,n),e.realEndDate=n}else e.elapsedDuration=this.dtService.getBusinessDays(e.plannedStartDate,e.realEndDate)}e.hasChilds&&e.subActivities.forEach(function(e){t.calculateElapsedDuration(e)})}},{key:"calculateWbsColumnNumber",value:function(e){var t=this;e.hasChilds?(e.columnNumber=0,e.subActivities.forEach(function(n){t.calculateWbsColumnNumber(n),e.columnNumber+=n.columnNumber})):e.columnNumber=1}},{key:"calculateWbsColumnNumberDisplayed",value:function(e){var t=this;e.hasChilds&&e.showChilds?(e.columnNumberDisplayed=0,e.subActivities.forEach(function(n){t.calculateWbsColumnNumberDisplayed(n),e.columnNumberDisplayed+=n.columnNumberDisplayed})):e.columnNumberDisplayed=1}},{key:"calculateWbsMaxLevel",value:function(e){var t=this;e.hasChilds?(e.maxLevel=0,e.subActivities.forEach(function(n){t.calculateWbsMaxLevel(n),e.maxLevel=Math.max(e.maxLevel,+n.level)})):e.maxLevel=+e.level}},{key:"calculateWbsMaxLevelDisplayed",value:function(e){var t=this;e.hasChilds&&e.showChilds?(e.maxLevelDisplayed=0,e.subActivities.forEach(function(n){t.calculateWbsMaxLevelDisplayed(n),e.maxLevelDisplayed=Math.max(e.maxLevelDisplayed,n.maxLevelDisplayed)})):e.maxLevelDisplayed=+e.level}},{key:"showAllChilds",value:function(){this.topActivity.hasChilds&&(this.showChilds(this.topActivity,0),this.topActivity.columnNumberDisplayed=this.topActivity.columnNumber)}},{key:"showChilds",value:function(e,t){var n=this;if(setTimeout(function(){e.showChilds=!0},t),e.hasChilds){var i=t+this.displayChildsOffset;e.subActivities.forEach(function(e){n.showChilds(e,i)})}}},{key:"hideAllChilds",value:function(){this.topActivity.hasChilds&&(this.calculateWbsMaxLevelDisplayed(this.topActivity),this.hideChilds(this.topActivity,this.displayChildsOffset*(this.topActivity.maxLevelDisplayed-1)))}},{key:"hideChilds",value:function(e,t){var n=this;if(setTimeout(function(){e.showChilds=!1},t),e.hasChilds){var i=t-this.displayChildsOffset;e.subActivities.forEach(function(e){n.hideChilds(e,i)})}}},{key:"autoSizing",value:function(){this.calculateWbsColumnNumberDisplayed(this.topActivity),this.wbsService.autoSizing()}},{key:"zoomIn",value:function(){this.wbsService.zoomIn()}},{key:"zoomOut",value:function(){this.wbsService.zoomOut()}},{key:"moveLeft",value:function(){this.wbsService.moveLeft()}},{key:"moveRight",value:function(){this.wbsService.moveRight()}},{key:"deselectActivity",value:function(e,t){var n=this;e.isSelected=e.activityId===t,e.hasChilds&&e.subActivities.forEach(function(e){n.deselectActivity(e,t)})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(h.Bo))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-wbs"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(zn,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.wbsContainer=n.first))},hostBindings:function(e,t){1&e&&S.\u0275\u0275listener("resize",function(e){return t.onResize(e)},!1,S.\u0275\u0275resolveWindow)},inputs:{project:"project"},decls:23,vars:5,consts:[[1,"row","m-b-15","m-t-15"],[1,"col-xl-12"],[1,"card"],[1,"card-body"],[1,"wbs-actions"],[3,"click"],[1,"wbs-container"],[1,"col-md-12","wbs-transition"],["wbsContainer",""],[3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize",4,"ngIf"],[3,"topActivity","topActivityStartDate","topActivityEndDate","smallSize"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.moveLeft()}),S.\u0275\u0275text(6,"chevron_left"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.moveRight()}),S.\u0275\u0275text(8,"chevron_right"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.hideAllChilds()}),S.\u0275\u0275text(10,"unfold_less"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.showAllChilds()}),S.\u0275\u0275text(12,"unfold_more"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.autoSizing()}),S.\u0275\u0275text(14,"zoom_out_map"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.zoomOut()}),S.\u0275\u0275text(16,"zoom_out"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"mat-icon",5),S.\u0275\u0275listener("click",function(){return t.zoomIn()}),S.\u0275\u0275text(18,"zoom_in"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"div",6),S.\u0275\u0275elementStart(20,"div",7,8),S.\u0275\u0275template(22,qn,1,4,"app-org-chart",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(20),S.\u0275\u0275styleProp("zoom",t.wbsService.zoomValue,"%")("transform","translateX("+t.wbsService.translateValue+"px)"),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.topActivity))},directives:[Re.Hw,o.NgIf,Bn],styles:[".wbs-container[_ngcontent-%COMP%]{padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#3f629d;padding:13px;color:#fff;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.card-body[_ngcontent-%COMP%]{padding:25px}table[_ngcontent-%COMP%], th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{font-size:12px;padding:6px;border:1px solid #BBBBBB}.tr-project[_ngcontent-%COMP%]{text-align:left;color:#fff;font-weight:600}.generic[_ngcontent-%COMP%]{background-color:#8e0089}.non-generic[_ngcontent-%COMP%]{background-color:#5489a5}.th-days[_ngcontent-%COMP%]{background-color:#069;color:#fff}.th-totals[_ngcontent-%COMP%]{background-color:#ccc;color:#000}.td-total-activity[_ngcontent-%COMP%]{font-weight:600;color:#000}mat-icon[_ngcontent-%COMP%]{cursor:pointer}.select-current-week[_ngcontent-%COMP%]{color:#3f629d}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%] + tbody[_ngcontent-%COMP%]{border-top:0px}.select-row[_ngcontent-%COMP%]{margin-top:30px;margin-bottom:40px}.label[_ngcontent-%COMP%]{padding:5px}.f-w-600[_ngcontent-%COMP%]{cursor:pointer}.modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer;margin:0}.modal-close[_ngcontent-%COMP%]:hover{color:red}.md-dialog-container[_ngcontent-%COMP%]{width:1400px;height:700px}"]}),e}(),Qn=a(4885),$n=a(55750),Un=a(39924),Hn=a(11494),Gn=a(32789);function Wn(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Resource"),S.\u0275\u0275elementEnd())}function Jn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",26),S.\u0275\u0275elementStart(1,"span",27),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.userName),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.userName)}}function Yn(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Qualification"),S.\u0275\u0275elementEnd())}function Kn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",26),S.\u0275\u0275elementStart(1,"span",27),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.userQualification),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.userQualification)}}function Xn(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Role"),S.\u0275\u0275elementEnd())}function Zn(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",26),S.\u0275\u0275elementStart(1,"span",27),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.userRole),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.userRole)}}function ei(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Year"),S.\u0275\u0275elementEnd())}function ti(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.year," ")}}function ni(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Jan"),S.\u0275\u0275elementEnd())}function ii(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month1," ",n.currencySymbol," ")}}function ri(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Feb"),S.\u0275\u0275elementEnd())}function ai(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month2," ",n.currencySymbol," ")}}function oi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Mar"),S.\u0275\u0275elementEnd())}function li(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month3," ",n.currencySymbol," ")}}function si(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Apr"),S.\u0275\u0275elementEnd())}function ci(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month4," ",n.currencySymbol," ")}}function di(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"May"),S.\u0275\u0275elementEnd())}function mi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month5," ",n.currencySymbol," ")}}function pi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Jun"),S.\u0275\u0275elementEnd())}function ui(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month6," ",n.currencySymbol," ")}}function fi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Jul"),S.\u0275\u0275elementEnd())}function hi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month7," ",n.currencySymbol," ")}}function vi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Aug"),S.\u0275\u0275elementEnd())}function gi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month8," ",n.currencySymbol," ")}}function Si(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Sep"),S.\u0275\u0275elementEnd())}function yi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month9," ",n.currencySymbol," ")}}function bi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Oct"),S.\u0275\u0275elementEnd())}function Ci(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month10," ",n.currencySymbol," ")}}function Ei(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Nov"),S.\u0275\u0275elementEnd())}function xi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month11," ",n.currencySymbol," ")}}function Ii(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",25),S.\u0275\u0275text(1,"Dec"),S.\u0275\u0275elementEnd())}function wi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.month12," ",n.currencySymbol," ")}}function Mi(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function Pi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",28),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275elementStart(2,"em",29),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(4," \xa0\xa0 "),S.\u0275\u0275elementStart(5,"button",30),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().deletePrice(e)}),S.\u0275\u0275elementStart(6,"em",29),S.\u0275\u0275text(7,"delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext();S.\u0275\u0275advance(5),S.\u0275\u0275property("disabled",!r.allowDeletePrice(i.userQuit))}}function Di(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",31)}function ji(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}var ki=function(){var e=function(){function e(t,i,r,a){n(this,e),this.invoicingService=t,this.notificationService=i,this.dialog=r,this.searchFilterService=a,this.displayedColumns=["userName","userQualification","userRole","year","month1","month2","month3","month4","month5","month6","month7","month8","month9","month10","month11","month12","buttons"],this.dataSource=new Gn.by,this.priceState=new S.EventEmitter}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditPrice=!1,this.listView=!0,this.dataSource=new Gn.by(this.prices),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.dataSource.sort=this.sort}},{key:"toggleEditDetails",value:function(e){this.isEditPrice=!0,this.priceState.emit(e)}},{key:"deletePrice",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this price?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.invoicingService.deleteUserPrices(e.priceId).subscribe(function(){t.notificationService.success("User prices deleted"),t.invoicingService.reloadPrices.next()},function(){t.notificationService.danger("Delete prices failed")})}})}},{key:"onSortData",value:function(e){this.invoicingService.sortPrices.next(e)}},{key:"allowDeletePrice",value:function(e){return(null==this.isvisibleEditProject||this.isvisibleEditProject)&&0===e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-prices"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Hn.YE,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.sort=n.first))},inputs:{project:"project",prices:"prices",priceEditable:"priceEditable",isvisibleEditProject:"isvisibleEditProject"},outputs:{priceState:"priceState"},decls:55,vars:4,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","userName"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","userQualification"],["matColumnDef","userRole"],["matColumnDef","year"],[4,"matCellDef"],["matColumnDef","month1"],["matColumnDef","month2"],["matColumnDef","month3"],["matColumnDef","month4"],["matColumnDef","month5"],["matColumnDef","month6"],["matColumnDef","month7"],["matColumnDef","month8"],["matColumnDef","month9"],["matColumnDef","month10"],["matColumnDef","month11"],["matColumnDef","month12"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit price",1,"btn","btn-mini","btn-primary","ripple","f-center","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete price",1,"btn","btn-mini","btn-danger","ripple","f-center","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-table",0,1),S.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),S.\u0275\u0275elementContainerStart(2,2),S.\u0275\u0275template(3,Wn,2,0,"mat-header-cell",3),S.\u0275\u0275template(4,Jn,3,2,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(5,5),S.\u0275\u0275template(6,Yn,2,0,"mat-header-cell",3),S.\u0275\u0275template(7,Kn,3,2,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(8,6),S.\u0275\u0275template(9,Xn,2,0,"mat-header-cell",3),S.\u0275\u0275template(10,Zn,3,2,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(11,7),S.\u0275\u0275template(12,ei,2,0,"mat-header-cell",3),S.\u0275\u0275template(13,ti,2,1,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(14,9),S.\u0275\u0275template(15,ni,2,0,"mat-header-cell",3),S.\u0275\u0275template(16,ii,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(17,10),S.\u0275\u0275template(18,ri,2,0,"mat-header-cell",3),S.\u0275\u0275template(19,ai,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(20,11),S.\u0275\u0275template(21,oi,2,0,"mat-header-cell",3),S.\u0275\u0275template(22,li,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(23,12),S.\u0275\u0275template(24,si,2,0,"mat-header-cell",3),S.\u0275\u0275template(25,ci,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(26,13),S.\u0275\u0275template(27,di,2,0,"mat-header-cell",3),S.\u0275\u0275template(28,mi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(29,14),S.\u0275\u0275template(30,pi,2,0,"mat-header-cell",3),S.\u0275\u0275template(31,ui,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(32,15),S.\u0275\u0275template(33,fi,2,0,"mat-header-cell",3),S.\u0275\u0275template(34,hi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(35,16),S.\u0275\u0275template(36,vi,2,0,"mat-header-cell",3),S.\u0275\u0275template(37,gi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(38,17),S.\u0275\u0275template(39,Si,2,0,"mat-header-cell",3),S.\u0275\u0275template(40,yi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(41,18),S.\u0275\u0275template(42,bi,2,0,"mat-header-cell",3),S.\u0275\u0275template(43,Ci,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(44,19),S.\u0275\u0275template(45,Ei,2,0,"mat-header-cell",3),S.\u0275\u0275template(46,xi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(47,20),S.\u0275\u0275template(48,Ii,2,0,"mat-header-cell",3),S.\u0275\u0275template(49,wi,2,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(50,21),S.\u0275\u0275template(51,Mi,1,0,"mat-header-cell",22),S.\u0275\u0275template(52,Pi,8,1,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(53,Di,1,0,"mat-header-row",23),S.\u0275\u0275template(54,ji,1,0,"mat-row",24),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275property("dataSource",t.dataSource),S.\u0275\u0275advance(53),S.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,Gn.XQ,Gn.Gk],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-userName[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-userQualification[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-userRole[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-year[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month1[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month2[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month3[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month4[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month5[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month6[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month7[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month8[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month9[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month10[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month11[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-month12[_ngcontent-%COMP%]{text-align:center;justify-content:center}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e}(),Oi=a(90046),Fi=a(64576),Ai=["priceDetailsForm"];function _i(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",18),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.memberName," ")}}function Vi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",18),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Ni(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",18),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var Ri=function(){var e=function(){function e(t,i,r){n(this,e),this.projectService=t,this.notificationService=i,this.invoicingService=r,this.isSavedPrice=new S.EventEmitter,this.mutliClickDisable=!1,this.servicesDisabled=!1,this.projectMembers=[],this.selectedProjectMembers=[],this.months=[{id:1,description:"January"},{id:2,description:"February"},{id:3,description:"Mars"},{id:4,description:"April"},{id:5,description:"May"},{id:6,description:"June"},{id:7,description:"July"},{id:8,description:"August"},{id:9,description:"September"},{id:10,description:"October"},{id:11,description:"November"},{id:12,description:"December"}],this.fromMonth={id:1,description:"January"},this.toMonth={id:12,description:"December"}}return r(e,[{key:"ngOnInit",value:function(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.year=this.isEditPrice?this.selectedPrice.year:(new Date).getFullYear(),this.isNewPrice=!this.isEditPrice,this.yearMin=(new Date).getFullYear()-10,this.yearMax=(new Date).getFullYear()+10,this.getProjectMembers(this.project.pifId)}},{key:"getProjectMembers",value:function(e){var t=this;this.projectService.getPifProjectMembers(e).subscribe(function(e){if(t.projectMembers=[],e.forEach(function(e){t.projectMembers.push(Object.assign(new f.J3,e))}),t.isEditPrice){var n=t.projectMembers.find(function(e){return e.memberId===+t.selectedPrice.userId});void 0===n&&((n=new f.J3).memberId=+t.selectedPrice.userId,n.memberName=t.selectedPrice.userName),t.projectMembers.push(n),t.projectMembers.sort(function(e,t){return e.memberName.localeCompare(t.memberName)}),t.selectedProjectMembers.push(n),t.detailsForm.controls.selectedProjectMembers.disable()}})}},{key:"save",value:function(){var e=this;this.mutliClickDisable=!0,setTimeout(function(){e.mutliClickDisable=!1},1e3),this.validPrice()&&this.invoicingService.saveUsersPrices(this.getNewPrice()).subscribe(function(t){0!==t?(e.notificationService.success("Prices saved successfully"),e.isSavedPrice.emit(!0)):e.notificationService.danger("Prices not saved!")},function(){e.notificationService.danger("Prices not saved!")})}},{key:"validPrice",value:function(){if(this.detailsForm.valid)if(this.fromMonth.id<=this.toMonth.id){if(this.year>=this.yearMin&&this.year<=this.yearMax)return!0;this.notificationService.danger("Year must be between ".concat(this.yearMin," and ").concat(this.yearMax,"!"))}else this.notificationService.danger("To Month must be greater than From Month!");else this.notificationService.danger("Please fill all required fields!");return!1}},{key:"getNewPrice",value:function(){var e=new Oi.tA;return e.projectId=this.project.projectId,e.userId=this.selectedProjectMembers.map(function(e){return e.memberId}).join(","),e.year=this.year,e.month1=this.getMonthPrice(1),e.month2=this.getMonthPrice(2),e.month3=this.getMonthPrice(3),e.month4=this.getMonthPrice(4),e.month5=this.getMonthPrice(5),e.month6=this.getMonthPrice(6),e.month7=this.getMonthPrice(7),e.month8=this.getMonthPrice(8),e.month9=this.getMonthPrice(9),e.month10=this.getMonthPrice(10),e.month11=this.getMonthPrice(11),e.month12=this.getMonthPrice(12),e}},{key:"getMonthPrice",value:function(e){return this.fromMonth.id<=e&&this.toMonth.id>=e?+this.monthPrice:-1}},{key:"yearChanged",value:function(e){this.year=new Date(e).getFullYear()}},{key:"numberOnly",value:function(e){var t=e.which?e.which:e.keyCode;return!(t>31&&(t<44||t>57)||45===t||47===t)}},{key:"onCancel",value:function(){this.isSavedPrice.emit(!0)}},{key:"allowSavePrice",value:function(){return null==this.isvisibleEditProject||this.isvisibleEditProject}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(Ne.X))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-price"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Ai,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.detailsForm=n.first))},inputs:{project:"project",isNewPrice:"isNewPrice",isEditPrice:"isEditPrice",selectedPrice:"selectedPrice",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedPrice:"isSavedPrice"},decls:29,vars:12,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],[1,"main-color","card-header"],[1,"card-header-text",2,"color","white"],[1,"card-body"],["id","priceDetailsForm"],["priceDetailsForm","ngForm"],["placeholder","Project Members","name","selectedProjectMembers","multiple","","required","",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-3"],[3,"enabled","year","displayPlaceHolder","yearChange"],["placeholder","From Month","name","fromMonth","required","",3,"ngModel","ngModelChange"],["placeholder","To Month","name","toMonth","required","",3,"ngModel","ngModelChange"],["placeholder","Price","matInput","","name","monthPrice","required","","appNumberValidator","",3,"ngModel","inputValue","ngModelChange","keypress"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"h5",4),S.\u0275\u0275text(5," Add / Update Price "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"form",6,7),S.\u0275\u0275elementStart(9,"div",0),S.\u0275\u0275elementStart(10,"mat-form-field",1),S.\u0275\u0275elementStart(11,"mat-select",8),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedProjectMembers=e}),S.\u0275\u0275template(12,_i,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"div",0),S.\u0275\u0275elementStart(14,"div",10),S.\u0275\u0275elementStart(15,"app-input-year",11),S.\u0275\u0275listener("yearChange",function(e){return t.yearChanged(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",10),S.\u0275\u0275elementStart(17,"mat-select",12),S.\u0275\u0275listener("ngModelChange",function(e){return t.fromMonth.id=e}),S.\u0275\u0275template(18,Vi,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"mat-form-field",10),S.\u0275\u0275elementStart(20,"mat-select",13),S.\u0275\u0275listener("ngModelChange",function(e){return t.toMonth.id=e}),S.\u0275\u0275template(21,Ni,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"mat-form-field",10),S.\u0275\u0275elementStart(23,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.monthPrice=e})("keypress",function(e){return t.numberOnly(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"div",15),S.\u0275\u0275elementStart(25,"button",16),S.\u0275\u0275listener("click",function(){return t.save()}),S.\u0275\u0275text(26,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"button",17),S.\u0275\u0275listener("click",function(){return t.onCancel()}),S.\u0275\u0275text(28,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(11),S.\u0275\u0275property("ngModel",t.selectedProjectMembers),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.projectMembers),S.\u0275\u0275advance(3),S.\u0275\u0275property("enabled",t.isNewPrice)("year",t.year)("displayPlaceHolder",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.fromMonth.id),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.months),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.toMonth.id),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.months),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.monthPrice)("inputValue",t.monthPrice),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",!t.allowSavePrice()||t.mutliClickDisable))},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,I.gD,c.RequiredValidator,c.NgControlStatus,c.NgModel,o.NgForOf,Fi.G,x.Nt,c.DefaultValueAccessor,$e.z,M.ey],styles:["form[_ngcontent-%COMP%]{padding:10px 20px}.main-color[_ngcontent-%COMP%]{background:#3f629d}"]}),e}(),Ti=a(34239);function Bi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",2),S.\u0275\u0275elementStart(1,"div",3),S.\u0275\u0275elementStart(2,"nav",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"button",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().AddPriceView()}),S.\u0275\u0275element(5,"em",7),S.\u0275\u0275text(6," Price "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",8),S.\u0275\u0275element(8,"app-paginator",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!i.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("pageSize",i.searchFilterService.pageSize)("pageIndex",i.searchFilterService.pageIndex)("length",i.lengthPrices)}}function zi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-prices",11),S.\u0275\u0275listener("priceState",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("prices",S.\u0275\u0275pipeBind3(2,3,i.prices,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("project",i.project)("isvisibleEditProject",i.isvisibleEditProject)}}function qi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-edit-price",12),S.\u0275\u0275listener("isSavedPrice",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().savedPrice(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("isNewPrice",!i.listView)("isEditPrice",i.isEditPrice)("selectedPrice",i.selectedPrice)("isvisibleEditProject",i.isvisibleEditProject)}}var Li=function(){var e=function(){function e(t,i,r){n(this,e),this.sortService=t,this.invoicingService=i,this.searchFilterService=r,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.subscription=new p.w0}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.listView=!0,this.isEditPrice=!1,this.subscription.add(this.invoicingService.sortPrices.subscribe(function(t){e.onSortData(t)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.getPricesByProject(),this.subscription.add(this.invoicingService.reloadPrices.subscribe(function(){e.getPricesByProject()}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"AddPriceView",value:function(){this.listView=!1,this.isEditPrice=!1}},{key:"toggleEditDetails",value:function(e){this.isEditPrice=!0,this.selectedPrice=e}},{key:"savedPrice",value:function(e){var t=this;this.invoicingService.getPricesByProject(this.project.projectId).subscribe(function(n){t.prices=n,t.listView=e,t.isEditPrice=!e,t.lengthPrices=t.prices.length})}},{key:"getPricesByProject",value:function(){var e=this;this.invoicingService.getPricesByProject(this.project.projectId).subscribe(function(t){e.prices=t,e.lengthPrices=e.prices.length})}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.prices&&this.prices.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"userName":return t.sortService.compare(n.userName,i.userName,r,!1);case"userQualification":return t.sortService.compare(n.userQualification,i.userQualification,r,!1);case"userRole":return t.sortService.compare(n.userRole,i.userRole,r,!1);case"year":return t.sortService.compare(n.year,i.year,r,!0);case"month1":return t.sortService.compare(n.month1,i.month1,r,!0);case"month2":return t.sortService.compare(n.month2,i.month2,r,!0);case"month3":return t.sortService.compare(n.month3,i.month3,r,!0);case"month4":return t.sortService.compare(n.month4,i.month4,r,!0);case"month5":return t.sortService.compare(n.month5,i.month5,r,!0);case"month6":return t.sortService.compare(n.month6,i.month6,r,!0);case"month7":return t.sortService.compare(n.month7,i.month7,r,!0);case"month8":return t.sortService.compare(n.month8,i.month8,r,!0);case"month9":return t.sortService.compare(n.month9,i.month9,r,!0);case"month10":return t.sortService.compare(n.month10,i.month10,r,!0);case"month11":return t.sortService.compare(n.month11,i.month11,r,!0);case"month12":return t.sortService.compare(n.month12,i.month12,r,!0);default:return 0}}),this.paginatorPipe.transform(this.prices,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-price"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-edit"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"prices","project","isvisibleEditProject","priceState"],[3,"project","isNewPrice","isEditPrice","selectedPrice","isvisibleEditProject","isSavedPrice"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,Bi,9,4,"div",0),S.\u0275\u0275template(1,zi,3,7,"div",1),S.\u0275\u0275template(2,qi,2,5,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.listView&&!t.isEditPrice),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView&&!t.isEditPrice),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.listView||t.isEditPrice))},directives:[o.NgIf,bt.M2,Un.J,ki,Ri],pipes:[Ti.R],encapsulation:2}),e}(),Qi=a(60657),$i=a(42352),Ui=a(88136);function Hi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",2),S.\u0275\u0275elementStart(1,"div",3),S.\u0275\u0275elementStart(2,"nav",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"button",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().AddEstimateView()}),S.\u0275\u0275element(5,"em",7),S.\u0275\u0275text(6," Quotation "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",8),S.\u0275\u0275element(8,"app-paginator",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!i.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("pageSize",i.searchFilterService.pageSize)("pageIndex",i.searchFilterService.pageIndex)("length",i.lengthEstimates)}}function Gi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-estimates",11),S.\u0275\u0275listener("estimateState",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("contractDetails",!1)("estimates",S.\u0275\u0275pipeBind3(2,4,i.estimates,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("project",i.projects)("isvisibleEditProject",i.isvisibleEditProject)}}function Wi(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-edit-estimate",12),S.\u0275\u0275listener("isSavedEstimate",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().savedEstimate(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("isNewEstimate",!i.listView)("isEditEstimate",i.isEditEstimate)("selectedEstimate",i.selectedEstimate)("isvisibleEditProject",i.isvisibleEditProject)}}var Ji=function(){var e=function(){function e(t,i,r,a){n(this,e),this.sortService=t,this.invoicingService=i,this._avRoute=r,this.searchFilterService=a,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.estimateEditable=!1,this.subscription=new p.w0}return r(e,[{key:"ngOnInit",value:function(){var e=this,t=this._avRoute.snapshot.paramMap.get("title");null!=t&&"estimates"===t?(this.listView=!1,this.isEditEstimate=!0):(this.listView=!0,this.isEditEstimate=!1),this.subscription.add(this.invoicingService.sortEstimates.subscribe(function(t){e.onSortData(t)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.projects=this.project,this.getEstimateListByProject(),this.subscription.add(this.invoicingService.reloadEstimates.subscribe(function(t){e.getEstimateListByProject()}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"AddEstimateView",value:function(){this.listView=!1,this.isEditEstimate=!1}},{key:"toggleEditDetails",value:function(e){this.isEditEstimate=!0,this.selectedEstimate=e}},{key:"savedEstimate",value:function(e){var t=this;this.invoicingService.getEstimateListByProject(this.project.projectId).subscribe(function(n){t.estimates=n,t.listView=e,t.isEditEstimate=!e,t.lengthEstimates=t.estimates.length})}},{key:"getEstimateListByProject",value:function(){var e=this;this.invoicingService.getEstimateListByProject(this.project.projectId).subscribe(function(t){e.estimates=t,e.lengthEstimates=e.estimates.length})}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.estimates&&this.estimates.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"estimateReference":return t.sortService.compare(n.estimateReference,i.estimateReference,r,!1);case"estimateDesc":return t.sortService.compare(n.estimateDesc,i.estimateDesc,r,!1);case"estimateEdit":return t.sortService.compare(n.estimateEdit,i.estimateEdit,r,!1);case"estimateDate":return t.sortService.compare(n.estimateDate,i.estimateDate,r,!1);case"clientName":return t.sortService.compare(n.clientName,i.clientName,r,!1);case"estimateState":return t.sortService.compare(n.estimateState,i.estimateState,r,!1);case"contractReference":return t.sortService.compare(n.contractReference,i.contractReference,r,!1);case"orderDate":return t.sortService.compare(n.orderDate,i.orderDate,r,!1);case"amount":return t.sortService.compare(n.estimateAmount,i.estimateAmount,r,!0);default:return 0}}),this.paginatorPipe.transform(this.estimates,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(Qi.K),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-estimate"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"contractDetails","estimates","project","isvisibleEditProject","estimateState"],[3,"project","isNewEstimate","isEditEstimate","selectedEstimate","isvisibleEditProject","isSavedEstimate"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,Hi,9,4,"div",0),S.\u0275\u0275template(1,Gi,3,8,"div",1),S.\u0275\u0275template(2,Wi,2,5,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.listView&&!t.isEditEstimate),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView&&!t.isEditEstimate),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.listView||t.isEditEstimate))},directives:[o.NgIf,bt.M2,Un.J,$i.N,Ui.c],pipes:[Ti.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.wbs-container[_ngcontent-%COMP%]{min-height:75vh;padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.ngb-accordion[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding-left:5px}.ngb-accordion[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   .a[_ngcontent-%COMP%]{font-size:15px}"]}),e}(),Yi=a(17224);function Ki(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Order Reference"),S.\u0275\u0275elementEnd())}function Xi(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",19),S.\u0275\u0275elementStart(1,"span",20),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.contractReference),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.contractReference)}}function Zi(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Quotation Reference"),S.\u0275\u0275elementEnd())}function er(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",19),S.\u0275\u0275elementStart(1,"span",20),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.estimateRef),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1("",n.estimateRef," ")}}function tr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Followed By"),S.\u0275\u0275elementEnd())}function nr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",19),S.\u0275\u0275elementStart(1,"span",20),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.contractName),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.contractName,"")}}function ir(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Type"),S.\u0275\u0275elementEnd())}function rr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.contractTypeName," ")}}function ar(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Date"),S.\u0275\u0275elementEnd())}function or(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.contractDate)," ")}}function lr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Amount"),S.\u0275\u0275elementEnd())}function sr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"numberForm"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.contractAmount)," ")}}function cr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Conforme?"),S.\u0275\u0275elementEnd())}function dr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.offreConfDesc,"")}}function mr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1," Addressed to "),S.\u0275\u0275elementEnd())}function pr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.contractClientRef," ")}}function ur(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function fr(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",21),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().EditDetails(e)}),S.\u0275\u0275elementStart(2,"em",22),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(4," \xa0\xa0 "),S.\u0275\u0275elementStart(5,"button",23),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().deleteOrder(e.contractId)}),S.\u0275\u0275elementStart(6,"em",22),S.\u0275\u0275text(7,"delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(5),S.\u0275\u0275property("disabled",!i.isvisibleEditProject)}}function hr(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",24)}function vr(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}var gr=function(){var e=function(){function e(t,i,r,a){n(this,e),this.searchFilterService=t,this.invoicingService=i,this.notificationService=r,this.dialog=a,this.displayedColumns=["Contract-Reference","Estimate-Reference","Name","Reference-Client","Amount","Type","Date","Conforme","buttons"],this.dataSource=new Gn.by,this.OrderState=new S.EventEmitter,this.isEditableOrder=!1}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.listView=!0,this.user=JSON.parse(localStorage.getItem("currentUser")),this.dataSource=new Gn.by(this.orders),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){this.dataSource.sort=this.sort}},{key:"EditDetails",value:function(e){this.isEditableOrder=!0,this.OrderState.emit(e),this.selectedOrder=e}},{key:"deleteOrder",value:function(e){var t=this;this.invoicingService.getContractBatches(e).subscribe(function(n){0===n[0].batchesCount?ne().fire({text:"Are you sure to delete this order ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.invoicingService.deleteConract(e).subscribe(function(){t.invoicingService.reloadOrders.next(),t.notificationService.success("This Order is deleted")},function(){t.notificationService.danger("Delete order failed")})}}):t.notificationService.danger("Delete order failed,this order has a batch")})}},{key:"onSortData",value:function(e){this.invoicingService.sortOrders.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.uw))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-orders"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Hn.YE,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.sort=n.first))},inputs:{project:"project",orders:"orders",orderEditable:"orderEditable",isvisibleEditProject:"isvisibleEditProject"},outputs:{OrderState:"OrderState"},decls:32,vars:4,consts:[[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","Contract-Reference"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","Estimate-Reference"],["matColumnDef","Name"],["matColumnDef","Type"],[4,"matCellDef"],["matColumnDef","Date"],["matColumnDef","Amount"],["matColumnDef","Conforme"],["matColumnDef","Reference-Client"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit Order",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete order ",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"mat-table",1,2),S.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),S.\u0275\u0275elementContainerStart(3,3),S.\u0275\u0275template(4,Ki,2,0,"mat-header-cell",4),S.\u0275\u0275template(5,Xi,3,2,"mat-cell",5),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(6,6),S.\u0275\u0275template(7,Zi,2,0,"mat-header-cell",4),S.\u0275\u0275template(8,er,3,2,"mat-cell",5),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(9,7),S.\u0275\u0275template(10,tr,2,0,"mat-header-cell",4),S.\u0275\u0275template(11,nr,3,2,"mat-cell",5),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(12,8),S.\u0275\u0275template(13,ir,2,0,"mat-header-cell",4),S.\u0275\u0275template(14,rr,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(15,10),S.\u0275\u0275template(16,ar,2,0,"mat-header-cell",4),S.\u0275\u0275template(17,or,3,3,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(18,11),S.\u0275\u0275template(19,lr,2,0,"mat-header-cell",4),S.\u0275\u0275template(20,sr,3,3,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(21,12),S.\u0275\u0275template(22,cr,2,0,"mat-header-cell",4),S.\u0275\u0275template(23,dr,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(24,13),S.\u0275\u0275template(25,mr,2,0,"mat-header-cell",4),S.\u0275\u0275template(26,pr,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(27,14),S.\u0275\u0275template(28,ur,1,0,"mat-header-cell",15),S.\u0275\u0275template(29,fr,8,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(30,hr,1,0,"mat-header-row",16),S.\u0275\u0275template(31,vr,1,0,"mat-row",17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(1),S.\u0275\u0275property("dataSource",t.dataSource),S.\u0275\u0275advance(29),S.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,Gn.XQ,Gn.Gk],pipes:[Te.M,Yi.$],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.mat-column-Contract-Reference[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-Estimate-Reference[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important}.mat-column-Date[_ngcontent-%COMP%]{justify-content:center}.mat-column-Type[_ngcontent-%COMP%]{justify-content:center}.mat-column-Conforme[_ngcontent-%COMP%]{justify-content:center}.mat-column-Amount[_ngcontent-%COMP%]{text-align:right;justify-content:flex-end}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e}(),Sr=a(92340),yr=["editOrderForm"],br=["EstimateSelect"];function Cr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"h5",45),S.\u0275\u0275text(1," Add Order "),S.\u0275\u0275elementEnd())}function Er(e,t){1&e&&(S.\u0275\u0275elementStart(0,"h5",45),S.\u0275\u0275text(1," Edit Order "),S.\u0275\u0275elementEnd())}function xr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"div",46),S.\u0275\u0275elementStart(2,"h5"),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate(n.order.projectName)}}function Ir(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",47),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function wr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",47),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Mr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",47),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Pr(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",36),S.\u0275\u0275elementStart(1,"button",48),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().previewFile()}),S.\u0275\u0275element(2,"em",49),S.\u0275\u0275text(3,"Preview"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",i.fileChange||null===i.order.contractFileName)}}var Dr=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.invoicingService=t,this.notificationService=i,this.dateTimeService=r,this._avRoute=a,this.fileService=o,this.isSavedOrder=new S.EventEmitter,this.conformesIdentifiers=[{id:1,description:"Ok"},{id:2,description:"Exemption"}],this.fileChange=!1,this.mutliClickDisable=!1,this.order=new Oi.KM,this.estimateFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ,this.filteredEstimates=new p.tq(1)}return r(e,[{key:"ngOnDestroy",value:function(){this.invoicingService.goToOrder.next()}},{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.getRefEstimateByProject(),this.getContractsType();var t=+this._avRoute.snapshot.paramMap.get("contractId");this.isEditableOrder&&void 0===this.selectedOrder&&this.invoicingService.getContract(t).subscribe(function(t){e.order=Object.assign(new Oi.KM,t[0])}),this.isEditableOrder?(this.order=Object.assign(new Oi.KM,this.selectedOrder),this.invoicingService.getContractFile(this.order.contractId).subscribe(function(t){0!==t.length&&(e.order.contractFileData=t[0].contractFileData,e.order.contractFileName=t[0].contractFileName,e.order.contractFileType=t[0].contractFileType)})):this.isEditableOrder||(this.order=new Oi.KM,(1===this.project.categoryId||2===this.project.categoryId)&&(this.order.contractTypeId=this.project.categoryId)),this.estimateFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterEstimates()})}},{key:"getRefEstimateByProject",value:function(){var e=this;this.invoicingService.getRefEstimateByProject(this.project.projectId).subscribe(function(t){null!=t&&(e.estimatesIdentifiers=t,1===e.estimatesIdentifiers.length&&0===e.order.contractId&&(e.order.estimateId=e.estimatesIdentifiers[0].id),e.filteredEstimates.next(e.estimatesIdentifiers.slice()))})}},{key:"getContractsType",value:function(){var e=this;this.invoicingService.getContractsType().subscribe(function(t){null!=t&&(e.ordersTypesIndentifiers=t)})}},{key:"onFileChange",value:function(e){var t=this,n=new FileReader;if(e.target.files&&e.target.files.length>0){var i=e.target.files[0];i.size<1024*Sr.N.maxOrderFileSize?(this.fileChange=!0,n.readAsDataURL(i),n.onload=function(){t.order.contractFileName=i.name,t.order.contractFileType=i.type,t.order.contractFileData=t.fileService.FromFileToDbFormat(n.result.toString().split(",")[1]),t.order.contractFileChanged=1}):(this.order.contractFileData=null,this.notificationService.warning("File must be lower the size of ".concat(Sr.N.maxOrderFileSize," Kilobytes")))}}},{key:"previewFile",value:function(){var e=this.fileService.FromDbToFileFormat(this.order.contractFileData,this.order.contractFileType),t=window.URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download=this.order.contractFileName,n.click(),window.URL.revokeObjectURL(t)}},{key:"save",value:function(){var e=this;this.mutliClickDisable=!0,setTimeout(function(){e.mutliClickDisable=!1},1e3),this.editOrder.valid&&0!==this.order.offreConfId?2===this.order.offreConfId&&null===this.order.offreConfDesc?this.notificationService.warning("Please fill Comment"):(null==this.project||(this.order.projectId=this.project.projectId),this.order.contractAmount=+this.order.contractAmount.toString().replace(",","."),this.invoicingService.insertOrUpdateContract(this.order).subscribe(function(){e.isSavedOrder.emit(!0),e.notificationService.success("Order is saved successfully")},function(t){e.notificationService.danger("Save order failed")})):this.notificationService.danger("Please fill all required fields")}},{key:"cancel",value:function(){this.isSavedOrder.emit(!0)}},{key:"isDespliyedTitle",value:function(){return null==this.project}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"filterEstimates",value:function(){if(this.estimatesIdentifiers){var e=this.estimateFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredEstimates.next(this.estimatesIdentifiers.filter(function(t){return t.description.toLowerCase().indexOf(e)>-1}))):this.filteredEstimates.next(this.estimatesIdentifiers.slice())}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(u.Ip))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-order"]],viewQuery:function(e,t){var n;(1&e&&(S.\u0275\u0275viewQuery(yr,7),S.\u0275\u0275viewQuery(br,7)),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.editOrder=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.EstimateSelect=n.first))},inputs:{project:"project",isEditableOrder:"isEditableOrder",selectedOrder:"selectedOrder",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedOrder:"isSavedOrder"},decls:66,vars:29,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],["_ngcontent-c17","",1,"main-color","card-header","ng-tns-c17-6","ng-star-inserted"],["_ngcontent-c17","","class","card-header-text","style","color: #ffffff;",4,"ngIf"],[1,"card-body"],[1,"wbs-actions"],["id","editOrderForm"],["editOrderForm","ngForm"],["class","row m-b-15",4,"ngIf"],[1,"row","m-b-15"],[1,"col-sm-4"],["placeholder","Order Reference","matInput","","name","orderRef","required","",3,"ngModel","ngModelChange"],["required","","placeholder","Quotation Reference","name","estimateReference",3,"ngModel","ngModelChange"],["EstimateSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["color","red",1,"col-sm-2"],["placeholder","Amount","matInput","","name","amount","appNumberValidator","","required","",3,"ngModel","inputValue","ngModelChange"],[1,"col-sm-2"],["placeholder","Type","name","type",3,"ngModel","ngModelChange"],["placeholder","Followed By","matInput","","name","name","appTextValidator","","maxlength","50","required","",3,"ngModel","ngModelChange"],["color","red",1,"col-sm-4"],["placeholder","Addressed To","matInput","","name","client","appTextValidator","","maxlength","50","required","","type","text",3,"ngModel","ngModelChange"],["matInput","","placeholder","Date","name","date","required","",3,"matDatepicker","ngModel","ngModelChange","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["placeholder","Conformity","name","orderConforme","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Description","name","description","maxlength","255","required","",3,"ngModel","ngModelChange"],["placeholder","Path","matInput","","name","Link","disabled","",3,"ngModel","ngModelChange"],["color","red",1,"col-sm-12"],["placeholder","Comment","matInput","","name","comment",3,"ngModel","ngModelChange"],[1,"col-sm-10"],["required","","placeholder","File Name","matInput","","name","File","disabled","",3,"ngModel","ngModelChange"],[1,"col-sm-1"],[1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple","file-upload-button",2,"font-size","inherit"],["type","file","id","av","accept","application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document",3,"click","change"],["fileInput",""],[1,"icofont","icofont-upload-alt","mr-0","mr-md-2"],["class","col-sm-1",4,"ngIf"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],["_ngcontent-c17","",1,"card-header-text",2,"color","#ffffff"],[1,"card-header"],[3,"value"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-eye-alt","mr-0","mr-md-2"]],template:function(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275template(4,Cr,2,0,"h5",4),S.\u0275\u0275template(5,Er,2,0,"h5",4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"div",6),S.\u0275\u0275elementStart(8,"form",7,8),S.\u0275\u0275template(10,xr,4,1,"div",9),S.\u0275\u0275elementStart(11,"div",10),S.\u0275\u0275elementStart(12,"mat-form-field",11),S.\u0275\u0275elementStart(13,"input",12),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"mat-form-field",11),S.\u0275\u0275elementStart(15,"mat-select",13,14),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.estimateId=e}),S.\u0275\u0275elementStart(17,"mat-option"),S.\u0275\u0275elementStart(18,"ngx-mat-select-search",15),S.\u0275\u0275elementStart(19,"mat-icon",16),S.\u0275\u0275text(20,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(21,Ir,2,2,"mat-option",17),S.\u0275\u0275pipe(22,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"mat-form-field",18),S.\u0275\u0275elementStart(24,"input",19),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractAmount=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"mat-form-field",20),S.\u0275\u0275elementStart(26,"mat-select",21),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractTypeId=e}),S.\u0275\u0275template(27,wr,2,2,"mat-option",17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"div",10),S.\u0275\u0275elementStart(29,"mat-form-field",11),S.\u0275\u0275elementStart(30,"input",22),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractName=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"mat-form-field",23),S.\u0275\u0275elementStart(32,"input",24),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractClientRef=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"mat-form-field",20),S.\u0275\u0275elementStart(34,"input",25),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractDate=e})("keypress",function(e){return t.dateOnly(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(35,"mat-datepicker-toggle",26),S.\u0275\u0275element(36,"mat-datepicker",27,28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"mat-form-field",18),S.\u0275\u0275elementStart(39,"mat-select",29),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.offreConfId=e}),S.\u0275\u0275template(40,Mr,2,2,"mat-option",17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(41,"div",10),S.\u0275\u0275elementStart(42,"mat-form-field",1),S.\u0275\u0275elementStart(43,"textarea",30),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractDesc=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"div",10),S.\u0275\u0275elementStart(45,"mat-form-field",1),S.\u0275\u0275elementStart(46,"input",31),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractLink=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(47,"div",10),S.\u0275\u0275elementStart(48,"mat-form-field",32),S.\u0275\u0275elementStart(49,"textarea",33),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.commentaire=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(50,"div",10),S.\u0275\u0275elementStart(51,"mat-form-field",34),S.\u0275\u0275elementStart(52,"input",35),S.\u0275\u0275listener("ngModelChange",function(e){return t.order.contractFileName=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"div",36),S.\u0275\u0275elementStart(54,"button",37),S.\u0275\u0275elementStart(55,"input",38,39),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275reference(56).value=null})("change",function(e){return t.onFileChange(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"span"),S.\u0275\u0275element(58,"em",40),S.\u0275\u0275text(59,"Select"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(60,Pr,4,1,"div",41),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(61,"div",42),S.\u0275\u0275elementStart(62,"button",43),S.\u0275\u0275listener("click",function(){return t.save()}),S.\u0275\u0275text(63,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(64,"button",44),S.\u0275\u0275listener("click",function(){return t.cancel()}),S.\u0275\u0275text(65,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275reference(37);S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",!t.isEditableOrder),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isEditableOrder),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngIf",t.isDespliyedTitle()),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.order.estimateId),S.\u0275\u0275advance(3),S.\u0275\u0275property("formControl",t.estimateFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(22,27,t.filteredEstimates)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractAmount)("inputValue",t.order.contractAmount),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.order.contractTypeId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.ordersTypesIndentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractName),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.order.contractClientRef),S.\u0275\u0275advance(2),S.\u0275\u0275property("matDatepicker",i)("ngModel",t.order.contractDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.offreConfId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.conformesIdentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractDesc),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractLink),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.commentaire),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.order.contractFileName),S.\u0275\u0275advance(8),S.\u0275\u0275property("ngIf",t.isEditableOrder),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",!t.isvisibleEditProject||t.mutliClickDisable)}},directives:[o.NgIf,c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,x.Nt,c.DefaultValueAccessor,c.RequiredValidator,c.NgControlStatus,c.NgModel,I.gD,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,$e.z,Le.s,c.MaxLengthValidator,w.hl,w.nW,E.R9,w.Mq],pipes:[o.AsyncPipe],styles:['.mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.file-upload-button[_ngcontent-%COMP%]{overflow:hidden;position:relative}.file-upload-button[_ngcontent-%COMP%]:after{content:"Upload";color:#fff;font-size:1.5rem;text-align:center}.file-upload-button[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{font-size:100px;left:0;opacity:0;position:absolute;top:0}.file-info[_ngcontent-%COMP%]{color:#999;font-family:Arial,Helvetica,sans-serif;margin-left:.3rem}.main-color[_ngcontent-%COMP%]{background:#3f629d}']}),e}();function jr(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",2),S.\u0275\u0275elementStart(1,"div",3),S.\u0275\u0275elementStart(2,"nav",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"button",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().addOrderView()}),S.\u0275\u0275element(5,"em",7),S.\u0275\u0275text(6," Order "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",8),S.\u0275\u0275element(8,"app-paginator",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!i.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("pageSize",i.searchFilterService.pageSize)("pageIndex",i.searchFilterService.pageIndex)("length",i.lengthOrders)}}function kr(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-orders",11),S.\u0275\u0275listener("OrderState",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("orders",S.\u0275\u0275pipeBind3(2,4,i.orders,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("orderEditable",i.orderEditable)("project",i.project)("isvisibleEditProject",i.isvisibleEditProject)}}function Or(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-edit-order",12),S.\u0275\u0275listener("isSavedOrder",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().savedOrder(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("isEditableOrder",i.isEditableOrder)("selectedOrder",i.selectedOrder)("isvisibleEditProject",i.isvisibleEditProject)}}var Fr=function(){var e=function(){function e(t,i,r,a){n(this,e),this.sortService=t,this.searchFilterService=i,this.invoicingService=r,this._avRoute=a,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.isEditableOrder=!1,this.orderEditable=!1,this.subscription=new p.w0}return r(e,[{key:"ngOnInit",value:function(){var e=this,t=this._avRoute.snapshot.paramMap.get("title");null!=t&&"orders"===t?(this.listView=!1,this.isEditableOrder=!0):(this.listView=!0,this.isEditableOrder=!1),this.subscription.add(this.invoicingService.sortOrders.subscribe(function(t){e.onSortData(t)})),this.invoicingService.getContractsByProject(this.project.projectId).subscribe(function(t){if(e.orders=t,e.lengthOrders=e.orders.length,null!=e.orderId){var n=e.orders.find(function(t){return t.contractId===e.orderId});e.toggleEditDetails(n)}}),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.OrderEditable(),this.getContractsByProject(),this.subscription.add(this.invoicingService.reloadOrders.subscribe(function(t){e.getContractsByProject()}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"addOrderView",value:function(){this.listView=!1,this.isEditableOrder=!1}},{key:"toggleEditDetails",value:function(e){this.isEditableOrder=!0,this.selectedOrder=e}},{key:"OrderEditable",value:function(){return this.orderEditable=this.user.groupId===v.Fl.ProjectManager||this.user.groupId===v.Fl.SuperAdmin||this.user.groupId===v.Fl.Finance||this.user.groupId===v.Fl.Facturation||this.user.qualification===v._W.DepartmentHead,this.orderEditable}},{key:"savedOrder",value:function(e){this.getContractsByProject(),this.listView=e,this.isEditableOrder=!e}},{key:"getContractsByProject",value:function(){var e=this;this.invoicingService.getContractsByProject(this.project.projectId).subscribe(function(t){e.orders=t,e.lengthOrders=e.orders.length})}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.orders&&this.orders.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"Contract-Reference":return t.sortService.compare(n.contractReference,i.contractReference,r,!1);case"Estimate-Reference":return t.sortService.compare(n.estimateRef,i.estimateRef,r,!1);case"Name":return t.sortService.compare(n.contractName,i.contractName,r,!1);case"Type":return t.sortService.compare(n.contractTypeName,i.contractTypeName,r,!1);case"Date":return t.sortService.compare(n.contractDate,i.contractDate,r,!1);case"Amount":return t.sortService.compare(n.contractAmount,i.contractAmount,r,!0);case"Conforme":return t.sortService.compare(n.offreConfDesc,i.offreConfDesc,r,!1);case"Reference-Client":return t.sortService.compare(n.contractClientRef,i.contractClientRef,r,!1);default:return 0}}),this.paginatorPipe.transform(this.orders,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(s.gz))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-order"]],inputs:{orderId:"orderId",project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"orders","orderEditable","project","isvisibleEditProject","OrderState"],[3,"project","isEditableOrder","selectedOrder","isvisibleEditProject","isSavedOrder"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,jr,9,4,"div",0),S.\u0275\u0275template(1,kr,3,8,"div",1),S.\u0275\u0275template(2,Or,2,4,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.listView&&!t.isEditableOrder),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView&&!t.isEditableOrder),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.listView||t.isEditableOrder))},directives:[o.NgIf,bt.M2,Un.J,gr,Dr],pipes:[Ti.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;color:#0f65fa;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}"]}),e}();function Ar(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Reference"),S.\u0275\u0275elementEnd())}var _r=function(e){return{background:e}};function Vr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",16),S.\u0275\u0275elementStart(1,"span",17),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275propertyInterpolate("matTooltip",n.batchReference),S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(3,_r,i.color(n))),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.batchReference," ")}}function Nr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Quotation Reference"),S.\u0275\u0275elementEnd())}function Rr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",16),S.\u0275\u0275elementStart(1,"span",17),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275propertyInterpolate("matTooltip",n.estimateReference),S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(3,_r,i.color(n))),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.estimateReference," ")}}function Tr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Order Reference"),S.\u0275\u0275elementEnd())}function Br(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",16),S.\u0275\u0275elementStart(1,"span",17),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275propertyInterpolate("matTooltip",n.contractReference),S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(3,_r,i.color(n))),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.contractReference," ")}}function zr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Delivery Date"),S.\u0275\u0275elementEnd())}function qr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(4,_r,i.color(n))),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,2,n.batchDeliveryDate)," ")}}function Lr(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Addressed To"),S.\u0275\u0275elementEnd())}function Qr(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(2,_r,i.color(n))),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.batchAdressedTo," ")}}function $r(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",15),S.\u0275\u0275text(1,"Amount"),S.\u0275\u0275elementEnd())}function Ur(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(3,_r,i.color(n))),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.batchAmount," ",n.currency," ")}}function Hr(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function Gr(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275elementStart(1,"button",19),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275elementStart(2,"em",20),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(4," \xa0 "),S.\u0275\u0275elementStart(5,"button",21),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().deleteBatch(e)}),S.\u0275\u0275elementStart(6,"em",20),S.\u0275\u0275text(7,"delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(8," \xa0 "),S.\u0275\u0275elementStart(9,"button",22),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext().invoicingBatch(e)}),S.\u0275\u0275elementStart(10,"em",20),S.\u0275\u0275text(11,"attach_money"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext();S.\u0275\u0275property("ngStyle",S.\u0275\u0275pureFunction1(3,_r,r.color(i))),S.\u0275\u0275advance(5),S.\u0275\u0275property("disabled",null!==i.invoiceSaariReference||!r.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",r.invoicedBatch(i))}}function Wr(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",23)}function Jr(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}var Yr=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.invoicingService=t,this.dialog=i,this.searchFilterService=r,this.notificationService=a,this.mailService=o,this.displayedColumns=["batchReference","estimateRefference","contractReference","batchDelevryDate","batchAdressedTo","batchAmount","buttons"],this.dataSource=new Gn.by,this.batchState=new S.EventEmitter,this.isSavedBatch=new S.EventEmitter,this.checked=!0,this.invoicingBatches=[]}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.selectedBatchId=0,this.dataSource=new Gn.by(this.batches),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"toggleEditDetails",value:function(e){this.isEditBatch=!0,this.batchState.emit(e)}},{key:"deleteBatch",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this batch ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){var n;0!==e.invoiceId&&null!=e.invoiceId&&t.invoicingService.getInvoice(e.invoiceId).subscribe(function(e){n=Object.assign(new Oi.mw,e[0])}),t.invoicingService.deleteBatch(e.batchId).subscribe(function(){t.notificationService.success("this Batch is deleted"),t.invoicingService.reloadBatches.next(),0!==e.invoiceId&&t.mailService.invoiceDeleted(n)},function(){t.notificationService.danger("Delete batch failed")})}})}},{key:"invoicingBatch",value:function(e){this.invoicingService.invoiceBatch.next(e.batchId)}},{key:"color",value:function(e){return 0===e.invoiceId||null==e.invoiceId?"white":"lightgray"}},{key:"invoicedBatch",value:function(e){return!(0===e.invoiceId||null==e.invoiceId)}},{key:"onSortData",value:function(e){this.invoicingService.sortBatches.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.YT))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-batches"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Hn.YE,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.sort=n.first))},inputs:{project:"project",batches:"batches",isvisibleEditProject:"isvisibleEditProject"},outputs:{batchState:"batchState",isSavedBatch:"isSavedBatch"},decls:25,vars:4,consts:[["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","batchReference"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"ngStyle","matTooltip",4,"matCellDef"],["matColumnDef","estimateRefference"],["matColumnDef","contractReference"],["matColumnDef","batchDelevryDate"],[3,"ngStyle",4,"matCellDef"],["matColumnDef","batchAdressedTo"],["matColumnDef","batchAmount"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"ngStyle","matTooltip"],[1,"span-ellipsis"],[3,"ngStyle"],["type","button","matTooltip","Edit",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],["type","button","matTooltip","Invoice",1,"btn","btn-mini","btn-primary","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-table",0,1),S.\u0275\u0275listener("matSortChange",function(e){return t.onSortData(e)}),S.\u0275\u0275elementContainerStart(2,2),S.\u0275\u0275template(3,Ar,2,0,"mat-header-cell",3),S.\u0275\u0275template(4,Vr,3,5,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(5,5),S.\u0275\u0275template(6,Nr,2,0,"mat-header-cell",3),S.\u0275\u0275template(7,Rr,3,5,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(8,6),S.\u0275\u0275template(9,Tr,2,0,"mat-header-cell",3),S.\u0275\u0275template(10,Br,3,5,"mat-cell",4),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(11,7),S.\u0275\u0275template(12,zr,2,0,"mat-header-cell",3),S.\u0275\u0275template(13,qr,3,6,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(14,9),S.\u0275\u0275template(15,Lr,2,0,"mat-header-cell",3),S.\u0275\u0275template(16,Qr,2,4,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(17,10),S.\u0275\u0275template(18,$r,2,0,"mat-header-cell",3),S.\u0275\u0275template(19,Ur,2,5,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(20,11),S.\u0275\u0275template(21,Hr,1,0,"mat-header-cell",12),S.\u0275\u0275template(22,Gr,12,5,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(23,Wr,1,0,"mat-header-row",13),S.\u0275\u0275template(24,Jr,1,0,"mat-row",14),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275property("dataSource",t.dataSource),S.\u0275\u0275advance(23),S.\u0275\u0275property("matHeaderRowDef",t.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",t.displayedColumns))},directives:[Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,o.NgStyle,oe.gM,Gn.XQ,Gn.Gk],pipes:[Te.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 16%!important;width:16%!important}.mat-column-estimateRefference[_ngcontent-%COMP%]{flex:0 0 20%!important;width:20%!important}.mat-column-contractReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-batchDelevryDate[_ngcontent-%COMP%]{flex:0 0 14%!important;width:14%!important;justify-content:center}.mat-column-batchAdressedTo[_ngcontent-%COMP%]{flex:0 0 16%!important;width:16%!important}.mat-column-batchAmount[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%;text-align:right;padding-right:1%;justify-content:flex-end}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important;justify-content:center}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}  .mat-sort-header-arrow{color:#fff}"]}),e}(),Kr=["batchDetailsForm"],Xr=["EstimateSelect"],Zr=["OrderSelect"];function ea(e,t){1&e&&(S.\u0275\u0275elementStart(0,"h5",30),S.\u0275\u0275text(1," Add Invoicing Batch "),S.\u0275\u0275elementEnd())}function ta(e,t){1&e&&(S.\u0275\u0275elementStart(0,"h5",30),S.\u0275\u0275text(1," Edit Invoicing Batch "),S.\u0275\u0275elementEnd())}function na(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",9),S.\u0275\u0275elementStart(1,"div",31),S.\u0275\u0275elementStart(2,"h5"),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate(n.batch.projectName)}}function ia(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",32),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function ra(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",32),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function aa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",32),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var oa=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.notificationService=t,this.dateTimeService=i,this.invoicingService=r,this._avRoute=a,this.mailService=o,this.isSavedBatch=new S.EventEmitter,this.batch=new Oi.El,this.mutliClickDisable=!1,this.estimateFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ,this.filteredEstimates=new p.tq(1),this.orderFilterCtrl=new c.FormControl,this.filteredOrders=new p.tq(1)}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.getBatchesType(),this.getListCurrency();var t=+this._avRoute.snapshot.paramMap.get("batchId");this.isEditBatch&&void 0===this.selectedBatch?this.invoicingService.getBatch(t).subscribe(function(t){e.batch=Object.assign(new Oi.El,t[0]),e.getContracts(e.project.projectId)}):this.isEditBatch&&0===t||void 0!==this.selectedBatch?(this.batch=Object.assign(new Oi.El,this.selectedBatch),this.getContracts(this.project.projectId)):(this.getContracts(this.project.projectId),this.batch=new Oi.El,this.batch.currencyId=Oi.F.Euro),this.orderFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterOrders()})}},{key:"getContracts",value:function(e){var t=this;this.invoicingService.getContracts(e).subscribe(function(e){null!=e&&(t.ordersIdentifiers=e,t.filteredOrders.next(t.ordersIdentifiers.slice()),1===t.ordersIdentifiers.length&&0===t.batch.batchId&&(t.selectedOrderIdentifier=t.ordersIdentifiers[0],t.batch.contractId=t.selectedOrderIdentifier.id,t.batch.estimateId=t.selectedOrderIdentifier.estimateId,t.batch.estimateReference=t.selectedOrderIdentifier.estimateReference,t.hasOrderFile()))})}},{key:"getBatchesType",value:function(){var e=this;this.invoicingService.getBatchesType().subscribe(function(t){e.batchesTypesIdentifiers=t})}},{key:"getListCurrency",value:function(){var e=this;this.invoicingService.getCurrencies().subscribe(function(t){e.currenciesIdentifiers=t})}},{key:"onChangeOrder",value:function(e){this.selectedOrderIdentifier=this.ordersIdentifiers.find(function(t){return t.id===e}),this.batch.estimateId=this.selectedOrderIdentifier.estimateId,this.batch.estimateReference=this.selectedOrderIdentifier.estimateReference,this.hasOrderFile()}},{key:"save",value:function(e){var t=this;this.mutliClickDisable=!0,setTimeout(function(){t.mutliClickDisable=!1},1e3),this.detailsForm.valid?(this.selectedOrderIdentifier=this.ordersIdentifiers.find(function(e){return e.id===t.batch.contractId}),!this.isEditBatch&&!(null==this.project)&&(this.batch.projectId=this.project.projectId),this.batch.invoiceId||(this.batch.invoiceId=0),this.batch.batchAmount=+this.batch.batchAmount.toString().replace(",","."),this.invoicingService.saveBatchDetails(this.batch).subscribe(function(){t.notificationService.success("Invoicing Batch is saved successfully"),t.isSavedBatch.emit(!0)},function(e){t.notificationService.danger("Save batch failed")})):this.notificationService.danger("Please fill all required fields")}},{key:"onCancel",value:function(){this.isSavedBatch.emit(!0)}},{key:"isDespliyedTitle",value:function(){return null==this.project}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"filterOrders",value:function(){if(this.ordersIdentifiers){var e=this.orderFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredOrders.next(this.ordersIdentifiers.filter(function(t){return t.description.toLowerCase().indexOf(e)>-1}))):this.filteredOrders.next(this.ordersIdentifiers.slice())}}},{key:"hasOrderFile",value:function(){null==this.selectedOrderIdentifier.contractFileName&&(this.notificationService.warning("You will be redirected to the selected order. Please select a document."),this.invoicingService.goToOrder.next(this.selectedOrderIdentifier.id))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(u.YT))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-batch"]],viewQuery:function(e,t){var n;(1&e&&(S.\u0275\u0275viewQuery(Kr,7),S.\u0275\u0275viewQuery(Xr,7),S.\u0275\u0275viewQuery(Zr,7)),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.detailsForm=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.EstimateSelect=n.first),S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.OrderSelect=n.first))},inputs:{project:"project",isNewBatch:"isNewBatch",selectedBatch:"selectedBatch",isEditBatch:"isEditBatch",selectedBatchId:"selectedBatchId",isvisibleEditProject:"isvisibleEditProject"},outputs:{isSavedBatch:"isSavedBatch"},decls:48,vars:25,consts:[[1,"row"],[1,"col-sm-12"],[1,"card"],["_ngcontent-c17","",1,"main-color","card-header","ng-tns-c17-6","ng-star-inserted"],["_ngcontent-c17","","class","card-header-text","style","color: #ffffff;",4,"ngIf"],[1,"card-body"],["id","batchDetailsForm"],["batchDetailsForm","ngForm"],["class","row m-b-15",4,"ngIf"],[1,"row","m-b-15"],[1,"col-sm-3"],["placeholder","Batch Reference","matInput","","name","batchReference","maxlength","20","required","",3,"ngModel","ngModelChange"],["placeholder","Order Reference","name","orderReference","required","",3,"ngModel","selectionChange","ngModelChange"],["OrderSelect",""],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["placeholder","Quotation Reference","matInput","","name","EstimateReference","disabled","",3,"ngModel","ngModelChange"],["placeholder","Type","name","type","required","",3,"ngModel","ngModelChange"],["placeholder","Amount","matInput","","name","Amount","appNumberValidator","","required","",3,"ngModel","inputValue","ngModelChange"],["placeholder","Currency","name","currency","required","",3,"ngModel","ngModelChange"],["placeholder","Addressed To","matInput","","name","AdressedTo","appTextValidator","","maxlength","50","required","",3,"ngModel","ngModelChange"],["matInput","","placeholder","Delivery Date","name","batchDeliveryDate","required","",3,"matDatepicker","ngModel","ngModelChange","keypress"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","Description","name","description","maxlength","255","required","",3,"ngModel","ngModelChange"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],["_ngcontent-c17","",1,"card-header-text",2,"color","#ffffff"],[1,"card-header"],[3,"value"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275template(4,ea,2,0,"h5",4),S.\u0275\u0275template(5,ta,2,0,"h5",4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"form",6,7),S.\u0275\u0275template(9,na,4,1,"div",8),S.\u0275\u0275elementStart(10,"div",9),S.\u0275\u0275elementStart(11,"mat-form-field",10),S.\u0275\u0275elementStart(12,"input",11),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"mat-form-field",10),S.\u0275\u0275elementStart(14,"mat-select",12,13),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangeOrder(e.value)})("ngModelChange",function(e){return t.batch.contractId=e}),S.\u0275\u0275elementStart(16,"mat-option"),S.\u0275\u0275elementStart(17,"ngx-mat-select-search",14),S.\u0275\u0275elementStart(18,"mat-icon",15),S.\u0275\u0275text(19,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(20,ia,2,2,"mat-option",16),S.\u0275\u0275pipe(21,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"mat-form-field",10),S.\u0275\u0275elementStart(23,"input",17),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.estimateReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",10),S.\u0275\u0275elementStart(25,"mat-select",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchTypeId=e}),S.\u0275\u0275template(26,ra,2,2,"mat-option",16),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"div",9),S.\u0275\u0275elementStart(28,"mat-form-field",10),S.\u0275\u0275elementStart(29,"input",19),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchAmount=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"mat-form-field",10),S.\u0275\u0275elementStart(31,"mat-select",20),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.currencyId=e}),S.\u0275\u0275template(32,aa,2,2,"mat-option",16),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"mat-form-field",10),S.\u0275\u0275elementStart(34,"input",21),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchAdressedTo=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"mat-form-field",10),S.\u0275\u0275elementStart(36,"input",22),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchDeliveryDate=e})("keypress",function(e){return t.dateOnly(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(37,"mat-datepicker-toggle",23),S.\u0275\u0275element(38,"mat-datepicker",24,25),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"div",9),S.\u0275\u0275elementStart(41,"mat-form-field",1),S.\u0275\u0275elementStart(42,"textarea",26),S.\u0275\u0275listener("ngModelChange",function(e){return t.batch.batchDescription=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"div",27),S.\u0275\u0275elementStart(44,"button",28),S.\u0275\u0275listener("click",function(){return t.save(t.batch)}),S.\u0275\u0275text(45,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"button",29),S.\u0275\u0275listener("click",function(){return t.onCancel()}),S.\u0275\u0275text(47,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(39);S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",!t.isEditBatch),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isEditBatch),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",t.isDespliyedTitle()),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.batch.batchReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.batch.contractId),S.\u0275\u0275advance(3),S.\u0275\u0275property("formControl",t.orderFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(21,23,t.filteredOrders)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.batch.estimateReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.batch.batchTypeId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.batchesTypesIdentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.batch.batchAmount)("inputValue",t.batch.batchAmount),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.batch.currencyId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.currenciesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.batch.batchAdressedTo),S.\u0275\u0275advance(2),S.\u0275\u0275property("matDatepicker",n)("ngModel",t.batch.batchDeliveryDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngModel",t.batch.batchDescription),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",!t.isvisibleEditProject||null!==t.batch.invoiceSaariReference||t.mutliClickDisable)}},directives:[o.NgIf,c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,x.Nt,c.DefaultValueAccessor,c.MaxLengthValidator,c.RequiredValidator,c.NgControlStatus,c.NgModel,I.gD,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,$e.z,Le.s,w.hl,w.nW,E.R9,w.Mq],pipes:[o.AsyncPipe],styles:[".main-color[_ngcontent-%COMP%]{background:#3f629d}"]}),e}();function la(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",2),S.\u0275\u0275elementStart(1,"div",3),S.\u0275\u0275elementStart(2,"nav",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"button",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().AddBatchView()}),S.\u0275\u0275element(5,"em",7),S.\u0275\u0275text(6," Batch "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",8),S.\u0275\u0275element(8,"app-paginator",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!i.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("pageSize",i.searchFilterService.pageSize)("pageIndex",i.searchFilterService.pageIndex)("length",i.lengthBatches)}}function sa(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-batches",11),S.\u0275\u0275listener("batchEditable",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().InvoicingbatchEditable})("batchState",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("batches",S.\u0275\u0275pipeBind3(2,3,i.batches,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("project",i.project)("isvisibleEditProject",i.isvisibleEditProject)}}function ca(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-edit-batch",12),S.\u0275\u0275listener("isSavedBatch",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().savedBatch(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("isNewBatch",!i.listView)("isEditBatch",i.isEditBatch)("selectedBatch",i.selectedBatch)("isvisibleEditProject",i.isvisibleEditProject)}}var da=function(){var e=function(){function e(t,i,r,a){n(this,e),this.sortService=t,this.invoicingService=i,this._avRoute=r,this.searchFilterService=a,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.subscription=new p.w0}return r(e,[{key:"ngOnInit",value:function(){var e=this,t=this._avRoute.snapshot.paramMap.get("title");null!=t&&"batches"===t?(this.listView=!1,this.isEditBatch=!0):(this.listView=!0,this.isEditBatch=!1),this.subscription.add(this.invoicingService.sortBatches.subscribe(function(t){e.onSortData(t)})),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.InvoicingbatchEditable(),this.subscription.add(this.invoicingService.reloadBatches.subscribe(function(t){e.getBatchesByProject()})),null==this.project||this.getBatchesByProject()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"AddBatchView",value:function(){this.listView=!1,this.isEditBatch=!1,this.selectedBatch=void 0}},{key:"InvoicingbatchEditable",value:function(){return this.batchEditable=this.user.groupId===v.Fl.ProjectManager||this.user.groupId===v.Fl.SuperAdmin||this.user.groupId===v.Fl.Finance||this.user.groupId===v.Fl.Facturation||this.user.qualification===v._W.DepartmentHead,this.batchEditable}},{key:"toggleEditDetails",value:function(e){this.isEditBatch=!0,this.selectedBatch=e}},{key:"savedBatch",value:function(e){this.getBatchesByProject(),this.listView=e,this.isEditBatch=!e}},{key:"getBatchesByProject",value:function(){var e=this;this.invoicingService.getBatchesByProject(this.project.projectId).subscribe(function(t){e.batches=t,e.lengthBatches=e.batches.length})}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.batches&&this.batches.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"batchReference":return t.sortService.compare(n.batchReference,i.batchReference,r,!1);case"estimateRefference":return t.sortService.compare(n.estimateRefference,i.estimateRefference,r,!1);case"contractReference":return t.sortService.compare(n.contractReference,i.contractReference,r,!1);case"batchDelevryDate":return t.sortService.compare(n.batchDeliveryDate,i.batchDeliveryDate,r,!1);case"batchAdressedTo":return t.sortService.compare(n.batchAdressedTo,i.batchAdressedTo,r,!1);case"batchAmount":return t.sortService.compare(n.batchAmount,i.batchAmount,r,!0);default:return 0}}),this.paginatorPipe.transform(this.batches,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-batch"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"batches","project","isvisibleEditProject","batchEditable","batchState"],[3,"project","isNewBatch","isEditBatch","selectedBatch","isvisibleEditProject","isSavedBatch"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,la,9,4,"div",0),S.\u0275\u0275template(1,sa,3,7,"div",1),S.\u0275\u0275template(2,ca,2,5,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.listView&&!t.isEditBatch),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView&&!t.isEditBatch),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.listView||t.isEditBatch))},directives:[o.NgIf,bt.M2,Un.J,Yr,oa],pipes:[Ti.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 70px}.mat-column-batchAdressedTo[_ngcontent-%COMP%]{flex:0 0 120px;margin-left:50px}.amount-right[_ngcontent-%COMP%]{justify-content:flex-end}.mat-column-batchAmount[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-batchDelevryDate[_ngcontent-%COMP%]{flex:0 0 250px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.wbs-container[_ngcontent-%COMP%]{min-height:75vh;padding:20px;overflow:hidden;border-radius:5px;margin-top:10px;vertical-align:middle;border-color:#f0ebe8;border-style:solid;border-width:1px}.wbs-container[_ngcontent-%COMP%]   .wbs-transition[_ngcontent-%COMP%]{transition-duration:.6s}.wbs-actions[_ngcontent-%COMP%]{text-align:right;background-color:#fff;padding:13px;color:#0f65fa;border-radius:5px}.wbs-actions[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:25px;cursor:pointer}.wbs-actions[_ngcontent-%COMP%]   .list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}.wbs-actions[_ngcontent-%COMP%]   .add-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:30px}"]}),e}();function ma(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Invoice Ref."),S.\u0275\u0275elementEnd())}function pa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",23),S.\u0275\u0275elementStart(1,"span",24),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.invoiceReference),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.invoiceReference)}}function ua(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Batch Ref."),S.\u0275\u0275elementEnd())}function fa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",23),S.\u0275\u0275elementStart(1,"span",24),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.batchReference),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.batchReference)}}function ha(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Order Ref."),S.\u0275\u0275elementEnd())}function va(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",23),S.\u0275\u0275elementStart(1,"span",24),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.contractReference),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.contractReference)}}function ga(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Addressed To"),S.\u0275\u0275elementEnd())}function Sa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.invoiceAdressedTo," ")}}function ya(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Amount"),S.\u0275\u0275elementEnd())}function ba(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.invoiceAmount," ",n.currency," ")}}function Ca(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Net to pay"),S.\u0275\u0275elementEnd())}function Ea(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate2(" ",n.invoiceNetToBePayed," ",n.currency," ")}}function xa(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Delivery"),S.\u0275\u0275elementEnd())}function Ia(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.invoiceDeliveryDate)," ")}}function wa(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Status"),S.\u0275\u0275elementEnd())}var Ma=function(e,t){return{"label-success":e,"label-danger":t}};function Pa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"label",25),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction2(2,Ma,1===n.invoiceDeposit,1!==n.invoiceDeposit)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(i.getValidationState(n.invoiceDeposit))}}function Da(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Saari Ref."),S.\u0275\u0275elementEnd())}function ja(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",26),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.invoiceSaariReference," ")}}function ka(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",22),S.\u0275\u0275text(1,"Cashed On"),S.\u0275\u0275elementEnd())}function Oa(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",26),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.invoiceCashedOn)," ")}}function Fa(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function Aa(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",27),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).toggleEditDetails(e)}),S.\u0275\u0275elementStart(2,"em",28),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(4," \xa0\xa0 "),S.\u0275\u0275elementStart(5,"button",29),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).deleteInvoice(e)}),S.\u0275\u0275elementStart(6,"em",28),S.\u0275\u0275text(7,"delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(5),S.\u0275\u0275property("disabled",null!==i.invoiceSaariReference||!r.isvisibleEditProject)}}function _a(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",30)}function Va(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}function Na(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",1),S.\u0275\u0275elementStart(1,"mat-table",2,3),S.\u0275\u0275listener("matSortChange",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onSortData(e)}),S.\u0275\u0275elementContainerStart(3,4),S.\u0275\u0275template(4,ma,2,0,"mat-header-cell",5),S.\u0275\u0275template(5,pa,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(6,7),S.\u0275\u0275template(7,ua,2,0,"mat-header-cell",5),S.\u0275\u0275template(8,fa,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(9,8),S.\u0275\u0275template(10,ha,2,0,"mat-header-cell",5),S.\u0275\u0275template(11,va,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(12,9),S.\u0275\u0275template(13,ga,2,0,"mat-header-cell",5),S.\u0275\u0275template(14,Sa,2,1,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(15,11),S.\u0275\u0275template(16,ya,2,0,"mat-header-cell",5),S.\u0275\u0275template(17,ba,2,2,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(18,12),S.\u0275\u0275template(19,Ca,2,0,"mat-header-cell",5),S.\u0275\u0275template(20,Ea,2,2,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(21,13),S.\u0275\u0275template(22,xa,2,0,"mat-header-cell",5),S.\u0275\u0275template(23,Ia,3,3,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(24,14),S.\u0275\u0275template(25,wa,2,0,"mat-header-cell",5),S.\u0275\u0275template(26,Pa,3,5,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(27,15),S.\u0275\u0275template(28,Da,2,0,"mat-header-cell",5),S.\u0275\u0275template(29,ja,2,1,"mat-cell",16),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(30,17),S.\u0275\u0275template(31,ka,2,0,"mat-header-cell",5),S.\u0275\u0275template(32,Oa,3,3,"mat-cell",16),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(33,18),S.\u0275\u0275template(34,Fa,1,0,"mat-header-cell",19),S.\u0275\u0275template(35,Aa,8,1,"mat-cell",10),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(36,_a,1,0,"mat-header-row",20),S.\u0275\u0275template(37,Va,1,0,"mat-row",21),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("dataSource",i.dataSource),S.\u0275\u0275advance(35),S.\u0275\u0275property("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",i.displayedColumns)}}var Ra=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.invoicingService=t,this.dialog=i,this.notificationService=r,this.searchFilterService=a,this.mailService=o,this.invoiceState=new S.EventEmitter,this.displayedColumns=["invoiceReference","batchReference","contractReference","invoiceAdressedTo","invoiceAmount","invoiceNetToBePayed","invoiceDeliveryDate","validation","invoiceSaariReference","invoiceCashedOn","buttons"],this.dataSource=new Gn.by}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.user=JSON.parse(localStorage.getItem("currentUser")),this.isEditInvoice=!1,this.listView=!0,this.dataSource=new Gn.by(this.invoices),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"toggleEditDetails",value:function(e){this.isEditInvoice=!0,this.invoiceState.emit(e),this.selectedInvoice=e}},{key:"deleteInvoice",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this invoice ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.invoicingService.deleteInvoice(e.invoiceId).subscribe(function(){t.notificationService.success("This Invoice is deleted"),t.mailService.invoiceDeleted(e),t.invoicingService.reloadInvoices.next()},function(){t.notificationService.danger("Delete invoice failed")})}})}},{key:"getValidationState",value:function(e){return 1===e?"validated":"pending"}},{key:"onSortData",value:function(e){this.invoicingService.sortInvoices.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(u.YT))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-invoices"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Hn.YE,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.sort=n.first))},inputs:{project:"project",InvoiceEditable:"InvoiceEditable",invoices:"invoices",isvisibleEditProject:"isvisibleEditProject"},outputs:{invoiceState:"invoiceState"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","invoiceReference",1,"table-hover","table-striped","table-styling"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","batchReference"],["matColumnDef","contractReference"],["matColumnDef","invoiceAdressedTo"],[4,"matCellDef"],["matColumnDef","invoiceAmount"],["matColumnDef","invoiceNetToBePayed"],["matColumnDef","invoiceDeliveryDate"],["matColumnDef","validation"],["matColumnDef","invoiceSaariReference"],["floatLabel","never",4,"matCellDef"],["matColumnDef","invoiceCashedOn"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],[1,"label",3,"ngClass"],["floatLabel","never"],["type","button","matTooltip","Edit Invoice",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete Invoice",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&S.\u0275\u0275template(0,Na,38,4,"div",0),2&e&&S.\u0275\u0275property("ngIf",t.listView)},directives:[o.NgIf,Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,o.NgClass,Gn.XQ,Gn.Gk],pipes:[Te.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}table[_ngcontent-%COMP%]{width:100%}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-groupHeader[_ngcontent-%COMP%]{color:#030303;background-color:#eceaea;font-weight:bolder;font-size:medium;font-family:Arial,Helvetica,sans-serif}.mat-column-invoiceReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-batchReference[_ngcontent-%COMP%]{flex:0 0 12%!important;width:12%!important}.mat-column-contractReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceAdressedTo[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceSaariReference[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important}.mat-column-invoiceAmount[_ngcontent-%COMP%]{flex:0 0 7%!important;width:7%!important;text-align:right;justify-content:flex-end}.mat-column-invoiceNetToBePayed[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;text-align:right;justify-content:flex-end}.mat-column-invoiceDeliveryDate[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}.mat-column-validation[_ngcontent-%COMP%]{justify-content:center}.mat-column-invoiceCashedOn[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e}(),Ta=a(27205);function Ba(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",2),S.\u0275\u0275elementStart(1,"div",3),S.\u0275\u0275elementStart(2,"nav",4),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"button",6),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().addInvoiceView()}),S.\u0275\u0275element(5,"em",7),S.\u0275\u0275text(6," Invoice "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",8),S.\u0275\u0275element(8,"app-paginator",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",!i.hasBatches||!i.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("pageSize",i.searchFilterService.pageSize)("pageIndex",i.searchFilterService.pageIndex)("length",i.lengthInvoices)}}function za(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-invoices",11),S.\u0275\u0275listener("invoiceState",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditDetails(e)}),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("InvoiceEditable",i.InvoiceEditable)("invoices",S.\u0275\u0275pipeBind3(2,4,i.invoices,i.searchFilterService.pageIndex,i.searchFilterService.pageSize))("isvisibleEditProject",i.isvisibleEditProject)}}function qa(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",10),S.\u0275\u0275elementStart(1,"app-edit-invoice",12),S.\u0275\u0275listener("isSavedInvoice",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().savedInvoice(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("isNewInvoice",!i.listView)("batchId",i.batchId)("isEditInvoice",i.isEditInvoice)("selectedInvoice",i.selectedInvoice)("isvisibleEditProject",i.isvisibleEditProject)}}var La=function(){var e=function(){function e(t,i,r,a){n(this,e),this.sortService=t,this._avRoute=i,this.invoicingService=r,this.searchFilterService=a,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.subscription=new p.w0}return r(e,[{key:"ngOnInit",value:function(){var e=this,t=this._avRoute.snapshot.paramMap.get("title");null!=t&&"invoices"===t?(this.listView=!1,this.isEditInvoice=!0):(this.listView=!0,this.isEditInvoice=!1),this.subscription.add(this.invoicingService.sortInvoices.subscribe(function(t){e.onSortData(t)})),this.projectHasBatches(),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.user=JSON.parse(localStorage.getItem("currentUser")),this.invoicesEditable(),this.getInvoiceByProject(),this.subscription.add(this.invoicingService.reloadInvoices.subscribe(function(t){e.getInvoiceByProject()}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"addInvoiceView",value:function(){this.listView=!1,this.isEditInvoice=!1,this.selectedInvoice=void 0}},{key:"invoicesEditable",value:function(){return this.InvoiceEditable=this.user.groupId===v.Fl.ProjectManager||this.user.groupId===v.Fl.SuperAdmin||this.user.groupId===v.Fl.Finance||this.user.groupId===v.Fl.Facturation||this.user.qualification===v._W.DepartmentHead,this.InvoiceEditable}},{key:"toggleEditDetails",value:function(e){this.isEditInvoice=!0,this.listView=!1,this.selectedInvoice=e}},{key:"savedInvoice",value:function(e){this.getInvoiceByProject(),this.listView=e,this.isEditInvoice=!e}},{key:"getInvoiceByProject",value:function(){var e=this;this.invoicingService.getInvoiceByProject(this.project.projectId).subscribe(function(t){e.invoices=[],0!==t.length&&t.forEach(function(t){var n=Object.assign(new Oi.mw,t);n.invoiceAmount&&(n.invoiceAmount=n.invoiceAmount.toString().replace(",",".")),null!=n.invoiceNetToBePayed&&(n.invoiceNetToBePayed=n.invoiceNetToBePayed.replace(",",".")),e.invoices.push(n)}),e.lengthInvoices=e.invoices.length,null!=e.batchId&&(e.listView=!1,e.isEditInvoice=!1,e.selectedInvoice=void 0)}),this.projectHasBatches()}},{key:"projectHasBatches",value:function(){var e=this;this.invoicingService.getBatchNotInvoiced(this.project.projectId).subscribe(function(t){e.hasBatches=null!=t&&0!==t.length})}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.invoices&&this.invoices.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"batchReference":return t.sortService.compare(n.batchReference,i.batchReference,r,!1);case"invoiceReference":return t.sortService.compare(n.invoiceReference,i.invoiceReference,r,!1);case"contractReference":return t.sortService.compare(n.contractReference,i.contractReference,r,!1);case"invoiceAdressedTo":return t.sortService.compare(n.invoiceAdressedTo,i.invoiceAdressedTo,r,!1);case"invoiceAmount":return t.sortService.compare(n.invoiceAmount,i.invoiceAmount,r,!0);case"invoiceNetToBePayed":return t.sortService.compare(n.invoiceNetToBePayed,i.invoiceNetToBePayed,r,!0);case"invoiceDeliveryDate":return t.sortService.compare(n.invoiceDeliveryDate,i.invoiceDeliveryDate,r,!1);case"validation":return n.invoiceDeposit=t.updateInvoiceDeposit(n),i.invoiceDeposit=t.updateInvoiceDeposit(i),t.sortService.compare(n.invoiceDeposit,i.invoiceDeposit,r,!0);case"invoiceSaariReference":return t.sortService.compare(n.invoiceSaariReference,i.invoiceSaariReference,r,!1);case"invoiceCashedOn":return t.sortService.compare(n.invoiceCashedOn,i.invoiceCashedOn,r,!1);default:return 0}}),this.paginatorPipe.transform(this.invoices,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"updateInvoiceDeposit",value:function(e){return 1!==e.invoiceDeposit&&(e.invoiceDeposit=0),e.invoiceDeposit}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(Ne.X),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-invoice"]],inputs:{project:"project",isvisibleEditProject:"isvisibleEditProject",batchId:"batchId"},decls:3,vars:3,consts:[["class","row m-b-10",4,"ngIf"],["class","example-container mat-elevation-z8",4,"ngIf"],[1,"row","m-b-10"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"navbar","navbar-light","bg-faded","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-disable","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[1,"example-container","mat-elevation-z8"],[3,"project","InvoiceEditable","invoices","isvisibleEditProject","invoiceState"],[3,"project","isNewInvoice","batchId","isEditInvoice","selectedInvoice","isvisibleEditProject","isSavedInvoice"]],template:function(e,t){1&e&&(S.\u0275\u0275template(0,Ba,9,4,"div",0),S.\u0275\u0275template(1,za,3,8,"div",1),S.\u0275\u0275template(2,qa,2,6,"div",1)),2&e&&(S.\u0275\u0275property("ngIf",t.listView),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isEditInvoice||!t.listView))},directives:[o.NgIf,bt.M2,Un.J,Ra,Ta.b],pipes:[Ti.R],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-column-activityName[_ngcontent-%COMP%]{flex:0 0 250px}.mat-column-buttons[_ngcontent-%COMP%]{flex:0 0 80px}.mat-column-status[_ngcontent-%COMP%]{flex:0 0 120px}.pdf-ico[_ngcontent-%COMP%]{font-size:35px;margin-bottom:25px}.date-field[_ngcontent-%COMP%]{font-size:14px}"]}),e}(),Qa=["ngbNav"];function $a(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",17),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).deletepif()}),S.\u0275\u0275element(1,"em",18),S.\u0275\u0275elementEnd()}}function Ua(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",19),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).addActivity()}),S.\u0275\u0275element(1,"em",20),S.\u0275\u0275text(2," Task "),S.\u0275\u0275elementEnd()}}function Ha(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",21),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).displayProjectDetails()}),S.\u0275\u0275element(1,"em",22),S.\u0275\u0275elementEnd()}}function Ga(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",23),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).displayWbsGantt()}),S.\u0275\u0275element(1,"em",24),S.\u0275\u0275elementEnd()}}function Wa(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",25),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).displayWbs()}),S.\u0275\u0275element(1,"em",24),S.\u0275\u0275elementEnd()}2&e&&S.\u0275\u0275property("hidden",!0)}function Ja(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",26),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).displayInvoicing()}),S.\u0275\u0275element(1,"em",27),S.\u0275\u0275elementEnd()}}var Ya=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}},Ka=function(e,t,n,i,r){return{"label-primary":e,"label-success":t,"label-warning":n,"label-danger":i,"label-default":r}};function Xa(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",4),S.\u0275\u0275elementStart(1,"div",5),S.\u0275\u0275elementStart(2,"div",6),S.\u0275\u0275elementStart(3,"h5"),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"label",7),S.\u0275\u0275text(6),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"label",7),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"div",8),S.\u0275\u0275elementStart(10,"button",9),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().goBack()}),S.\u0275\u0275element(11,"em",10),S.\u0275\u0275text(12," Projects "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(13,$a,2,0,"button",11),S.\u0275\u0275template(14,Ua,3,0,"button",12),S.\u0275\u0275template(15,Ha,2,0,"button",13),S.\u0275\u0275template(16,Ga,2,0,"button",14),S.\u0275\u0275template(17,Wa,2,1,"button",15),S.\u0275\u0275template(18,Ja,2,0,"button",16),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate2("",i.project.name," [",i.project.abreviation,"]"),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(12,Ya,i.project.SQAVisa===i.PifVisa.Valid,i.project.SQAVisa===i.PifVisa.Invalid,i.project.SQAVisa===i.PifVisa.InProgress)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",i.project.SQAVisa," "),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction5(16,Ka,i.project.status===i.ProjectStatusLabel.Planned,i.project.status===i.ProjectStatusLabel.InProgress,i.project.status===i.ProjectStatusLabel.Completed,i.project.status===i.ProjectStatusLabel.Blocked,i.project.status===i.ProjectStatusLabel.Closed)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1("",i.project.status," "),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngIf",void 0!==i.isProject&&!0!==i.isProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isdisplayedWbsGantt&&i.isSuperAdminOrManagerOrDH()&&i.isProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isProject&&i.isInvoicingUser()),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isProject&&i.isInvoicingUser()),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",i.isProject&&i.isInvoicingUser())}}function Za(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",39),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(3).toggleEditDetails()}),S.\u0275\u0275text(1," edit "),S.\u0275\u0275elementEnd()}}function eo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"span"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(3);S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(n.project.description)}}function to(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",4),S.\u0275\u0275elementStart(1,"div"),S.\u0275\u0275template(2,Za,2,0,"mat-icon",36),S.\u0275\u0275elementStart(3,"div"),S.\u0275\u0275elementStart(4,"h5",37),S.\u0275\u0275text(5,"Project Details"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(6,eo,2,1,"span",38),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",!n.isEditDetails&&n.isvisibleEditProject),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",!n.isEditDetails)}}function no(e,t){if(1&e&&S.\u0275\u0275element(0,"app-view-details",40),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("project",n.project)("isProject",n.isProject)}}function io(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"app-edit-details",41),S.\u0275\u0275listener("projectEvent",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext(2).projectEvent(e)}),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("project",i.project)("projectId",i.project.projectId)("pifId",i.project.pifId)("isProject",i.isProject)("isNewPif",i.isNewPif)}}function ro(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",42),S.\u0275\u0275element(1,"app-view-decision",43),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("pifId",n.project.pifId)("isvisibleEditProject",n.isvisibleEditProject)("canEditProject",n.canEditProject)}}function ao(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",46),S.\u0275\u0275element(1,"app-team-members",47),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(3);S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)("canEditProject",n.canEditProject)("isProject",n.isProject)}}function oo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",44),S.\u0275\u0275template(1,ao,2,4,"div",45),S.\u0275\u0275elementStart(2,"div",46),S.\u0275\u0275element(3,"app-attached-document",47),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!n.isNewPif),S.\u0275\u0275advance(2),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)("canEditProject",n.canEditProject)("isProject",n.isProject)}}var lo=function(e,t){return{"col-sm-12":e,"col-sm-8":t}};function so(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",28),S.\u0275\u0275elementStart(1,"div",29),S.\u0275\u0275elementStart(2,"div",5),S.\u0275\u0275elementStart(3,"div",30),S.\u0275\u0275elementStart(4,"div",0),S.\u0275\u0275template(5,to,7,2,"div",1),S.\u0275\u0275elementStart(6,"div",31),S.\u0275\u0275template(7,no,1,2,"app-view-details",32),S.\u0275\u0275template(8,io,1,5,"app-edit-details",33),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(9,ro,2,3,"div",34),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(10,oo,4,5,"div",35),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction2(7,lo,n.isNewPif,!n.isNewPif)),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",!n.isNewPif),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",!(n.isNewPif||n.isEditDetails)),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",n.isNewPif||n.isEditDetails),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!n.isNewPif),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!n.isNewPif)}}function co(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",28),S.\u0275\u0275elementStart(1,"app-wbs-gantt",48),S.\u0275\u0275listener("initializeTopActivityEvent",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().initializeTopActivity(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("updateWbsData",i.updateWbsData)}}function mo(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",28),S.\u0275\u0275elementStart(1,"app-wbs",48),S.\u0275\u0275listener("initializeTopActivityEvent",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().initializeTopActivity(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("project",i.project)("updateWbsData",i.updateWbsData)}}function po(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",57),S.\u0275\u0275elementStart(1,"div",58),S.\u0275\u0275elementStart(2,"div",59),S.\u0275\u0275elementStart(3,"div",5),S.\u0275\u0275elementStart(4,"div",60),S.\u0275\u0275element(5,"mat-spinner"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function uo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",29),S.\u0275\u0275element(1,"app-price",61),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)}}function fo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",29),S.\u0275\u0275element(1,"app-estimate",61),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)}}function ho(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",29),S.\u0275\u0275element(1,"app-order",62),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)("orderId",n.selectedOrderId)}}function vo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",29),S.\u0275\u0275element(1,"app-batch",61),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)}}function go(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",29),S.\u0275\u0275element(1,"app-invoice",63),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("@fadeInOutTranslate",void 0),S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n.project)("isvisibleEditProject",n.isvisibleEditProject)("batchId",n.selectedBatchId)}}function So(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",49),S.\u0275\u0275template(1,po,6,0,"div",50),S.\u0275\u0275elementStart(2,"ul",51,52),S.\u0275\u0275listener("activeIdChange",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().activeId=e}),S.\u0275\u0275elementStart(4,"li",53),S.\u0275\u0275elementStart(5,"a",54),S.\u0275\u0275elementStart(6,"mat-icon"),S.\u0275\u0275text(7,"monetization_on"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(8," Prices "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(9,uo,2,3,"ng-template",55),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(10,"li",53),S.\u0275\u0275elementStart(11,"a",54),S.\u0275\u0275elementStart(12,"mat-icon"),S.\u0275\u0275text(13,"assignment"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(14," Quotations "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(15,fo,2,3,"ng-template",55),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"li",53),S.\u0275\u0275elementStart(17,"a",54),S.\u0275\u0275elementStart(18,"mat-icon"),S.\u0275\u0275text(19,"assignment_turned_in"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(20," Orders "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(21,ho,2,4,"ng-template",55),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"li",53),S.\u0275\u0275elementStart(23,"a",54),S.\u0275\u0275elementStart(24,"mat-icon"),S.\u0275\u0275text(25,"card_travel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(26," Batches "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(27,vo,2,3,"ng-template",55),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"li",53),S.\u0275\u0275elementStart(29,"a",54),S.\u0275\u0275elementStart(30,"mat-icon"),S.\u0275\u0275text(31,"library_books"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(32," Invoices "),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(33,go,2,4,"ng-template",55),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(34,"div",56),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275reference(3),r=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",r.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("activeId",r.activeId),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngbNavItem",1),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngbNavItem",2),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngbNavItem",3),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngbNavItem",4),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngbNavItem",5),S.\u0275\u0275advance(6),S.\u0275\u0275property("ngbNavOutlet",i)}}var yo=function(){var e=function(){function e(t,i){n(this,e),this.cdRef=i,this.isProject=void 0,this.isPif=!1,this.isNewPif=!1,this.canEditProject=!0,this.isvisibleEditProject=!1,this.editDetailsIcon="icofont-edit",this.pifCost=new c.FormControl("",[c.Validators.required,c.Validators.min(0)]),this.isdisplayedProjectDetails=!0,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1,this.updateWbsData=new p.xQ,this.isActivityManager=!1,this.subscription=new p.w0,this.activeId=1,this.PifVisa=f.CB,this.ProjectStatusLabel=f.tU,this.previousState={getPrevious:!1,type:null,pageIndex:null,pageSize:null},this._avRoute=t.get(s.gz),this._router=t.get(s.F0),this.activeRoute=t.get(s.gz),this.dtService=t.get(u.Cv),this.location=t.get(o.Location),this.projectService=t.get(h.Y4),this.dialog=t.get(m.uw),this.invoicingService=t.get(Ne.X),this.notificationService=t.get(u.gq)}return r(e,[{key:"ngOnInit",value:function(){var e=this;null!=this._avRoute.snapshot.paramMap.get("title")&&(this.isdisplayedInvoicing=!0,this.isdisplayedProjectDetails=!1),this.user=JSON.parse(localStorage.getItem("currentUser")),this._avRoute.params.subscribe(function(t){e.project=new f.IK,e.project.pifId=t.pifId,e.project.projectId=t.projectId,t.pifId?e.getProjectDetails(t.pifId,t.projectId):(e.isNewPif=!0,e.isProject=!1,e.isEditDetails=!0,e.project=new f.IK,e.project.status=f.tU.Planned,e.project.managerId=+e.user.userId,e.project.managerName=e.user.userName,e.project.activityId=e.user.activityId)}),this.projectService.toggleEditDetails.subscribe(function(){e.toggleEditDetails()}),this.projectService.pifIsApproved.subscribe(function(t){0!==t&&(e.isProject=!0),e.project.projectId=t,e.location.go("/project-management/project/edit/"+e.project.pifId+"/"+e.project.projectId),e.projectService.reloadTeam.next(),e.getProjectDetails(e.project.pifId,e.project.projectId)}),this.subscription.add(this.invoicingService.goToOrder.subscribe(function(t){t&&(e.selectedOrderId=t,e.isLoading=!0,setTimeout(function(){e.isLoading=!1},1e3),e.activeId=3),e.selectedOrderId=t})),this.subscription.add(this.invoicingService.invoiceBatch.subscribe(function(t){t&&(e.selectedBatchId=t,e.isLoading=!0,setTimeout(function(){e.isLoading=!1},1e3),e.activeId=5),e.selectedBatchId=t})),this.subscription.add(this.projectService.previousState.subscribe(function(t){t&&(e.previousState.pageIndex=t.pageIndex,e.previousState.type=t.type,e.previousState.pageSize=t.pageSize)}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"ngAfterViewInit",value:function(){var e=this._avRoute.snapshot.paramMap.get("title");null!=e&&("invoices"===e&&(this.activeId=5),"batches"===e&&(this.activeId=4),"orders"===e&&(this.activeId=3),"estimates"===e&&(this.activeId=2),"costs"===e&&(this.activeId=1))}},{key:"ngAfterViewChecked",value:function(){this.cdRef.detectChanges()}},{key:"getProjectDetails",value:function(e,t){var n=this;this.projectService.getProjectDetails(e,t).subscribe(function(e){null==e[0]||(n.project=Object.assign(new f.IK,e[0]),n.isEditDetails=!1,n.isPif=0===n.project.projectId,n.isProject=0!==n.project.projectId,n.canEditProject=n.project.status!==f.tU.Closed,n.isNewPif=!1,n.isPif&&(n.project.realStartDate=null,n.project.realEndDate=null),n.isActivityManagersPifProject(n.user.activityId,n.project.pifId))})}},{key:"canDeactivate",value:function(){return!0}},{key:"addNewProject",value:function(){this._router.navigate(["../../../add"],{relativeTo:this.activeRoute})}},{key:"toggleEditDetails",value:function(){this.isEditDetails=!this.isEditDetails}},{key:"VisibleEditProject",value:function(){this.user=JSON.parse(localStorage.getItem("currentUser")),(this.project.managerId===+this.user.userId||this.user.groupId===v.Fl.SuperAdmin||this.isActivityManager)&&(this.isvisibleEditProject=!0)}},{key:"projectEvent",value:function(e){this.getProjectDetails(e.pifId,e.projectId)}},{key:"initializeTopActivity",value:function(e){this.topActivity=e}},{key:"addActivity",value:function(){var e=this;this.addActivitydialogRef=this.dialog.open(Oe,{disableClose:!1,hasBackdrop:!0,width:"800px",height:"590px",data:{mode:"add",departmentId:this.project.departmentId,activity:this.topActivity,parentStartDate:this.project.plannedStartDate,parentEndDate:this.project.plannedEndDate}}),this.addActivitydialogRef.afterClosed().subscribe(function(){e.updateWbsData.next()})}},{key:"displayProjectDetails",value:function(){this.isdisplayedProjectDetails=!0,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1}},{key:"displayWbsGantt",value:function(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!0,this.isdisplayedInvoicing=!1}},{key:"displayWbs",value:function(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!1}},{key:"displayInvoicing",value:function(){this.isdisplayedProjectDetails=!1,this.isdisplayedWbs=!1,this.isdisplayedWbsGantt=!1,this.isdisplayedInvoicing=!0}},{key:"isSuperAdminOrManagerOrDH",value:function(){return this.user.groupId===v.Fl.ProjectManager||this.user.groupId===v.Fl.SuperAdmin||this.user.qualification===v._W.DepartmentHead}},{key:"isInvoicingUser",value:function(){return void 0!==this.user.functionsId.find(function(e){return e===v.FI.Invoice})}},{key:"isActivityManagersPifProject",value:function(e,t){var n=this;this.projectService.isActivityManagersPifProject(e,t).subscribe(function(e){0!==e[0].count&&n.user.groupId===v.Fl.ProjectManager&&(n.isActivityManager=!0),n.VisibleEditProject()})}},{key:"deletepif",value:function(){var e=this;ne().fire({text:"Are you sure to delete this Pif ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){e.projectService.deletePif(e.project.pifId).subscribe(function(){e.notificationService.success("Pif is successfully deleted"),e._router.navigate(["/project-management/project/list"])},function(){e.notificationService.danger("Delete pif failed")})}})}},{key:"goBack",value:function(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.projectService.previousState.next(this.previousState)),this._router.navigate(["/project-management/project/list"])}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(S.Injector),S.\u0275\u0275directiveInject(S.ChangeDetectorRef))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-project"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Qa,5),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.ngbNav=n.first))},decls:6,vars:5,consts:[[1,"card"],["class","card-header",4,"ngIf"],["class","md-tabs md-card-tabs",4,"ngIf"],["class","md-tabs md-card-tabs m-t-10",4,"ngIf"],[1,"card-header"],[1,"row"],[1,"col-md-7"],[1,"label",3,"ngClass"],[1,"col-md-5",2,"text-align","right"],["type","button","matTooltip","Back to Projects",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-reply"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Delete Pif",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Add task",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Project Details",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Wbs Gantt",3,"click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary m-r-10 ripple light","style","font-size:inherit;","matTooltip","Wbs",3,"hidden","click",4,"ngIf"],["type","button","class","btn btn-sm btn-primary ripple light","style","font-size:inherit;","matTooltip","Invoicing",3,"click",4,"ngIf"],["type","button","matTooltip","Delete Pif",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-bin"],["type","button","matTooltip","Add task",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],["type","button","matTooltip","Project Details",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-listine-dots"],["type","button","matTooltip","Wbs Gantt",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-table"],["type","button","matTooltip","Wbs",1,"btn","btn-sm","btn-primary","m-r-10","ripple","light",2,"font-size","inherit",3,"hidden","click"],["type","button","matTooltip","Invoicing",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-cur-dollar"],[1,"md-tabs","md-card-tabs"],[1,"m-t-10"],[3,"ngClass"],[1,"card-body"],[3,"project","isProject",4,"ngIf"],[3,"project","projectId","pifId","isProject","isNewPif","projectEvent",4,"ngIf"],["class","col-sm-4",4,"ngIf"],["class","row m-t-10",4,"ngIf"],["class","edit-project-ico","matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-header-text"],[4,"ngIf"],["matTooltip","Edit",1,"edit-project-ico",3,"click"],[3,"project","isProject"],[3,"project","projectId","pifId","isProject","isNewPif","projectEvent"],[1,"col-sm-4"],[3,"pifId","isvisibleEditProject","canEditProject"],[1,"row","m-t-10"],["class","col-xl-6 col-md-12",4,"ngIf"],[1,"col-xl-6","col-md-12"],[3,"project","isvisibleEditProject","canEditProject","isProject"],[3,"project","updateWbsData","initializeTopActivityEvent"],[1,"md-tabs","md-card-tabs","m-t-10"],["class","overlay",4,"ngIf"],["ngbNav","",1,"nav-tabs",3,"activeId","activeIdChange"],["nav","ngbNav"],[3,"ngbNavItem"],["ngbNavLink",""],["ngbNavContent",""],[3,"ngbNavOutlet"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[3,"project","isvisibleEditProject"],[3,"project","isvisibleEditProject","orderId"],[3,"project","isvisibleEditProject","batchId"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275template(1,Xa,19,22,"div",1),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(2,so,11,10,"div",2),S.\u0275\u0275template(3,co,2,2,"div",2),S.\u0275\u0275template(4,mo,2,2,"div",2),S.\u0275\u0275template(5,So,35,8,"div",3)),2&e&&(S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.isNewPif),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isdisplayedProjectDetails),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isdisplayedWbsGantt),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isdisplayedWbs),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.isdisplayedInvoicing))},directives:[o.NgIf,o.NgClass,oe.gM,Re.Hw,Be,rt,jt,Jt,dn,Sn,Ln,bt.Pz,bt.nv,bt.Vx,bt.uN,bt.tO,Qn.$g,Li,Ji,Fr,da,La],styles:[".card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.card-header[_ngcontent-%COMP%]   .add-project-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:25px}.card-header[_ngcontent-%COMP%]   .projects-list-ico[_ngcontent-%COMP%]{margin-left:15px;font-size:25px}.card-header[_ngcontent-%COMP%]   .edit-project-ico[_ngcontent-%COMP%]{margin-left:15px}.card-body[_ngcontent-%COMP%]{padding:0 20px}.details-card[_ngcontent-%COMP%]{min-height:534px}.btn-circle.btn-xl[_ngcontent-%COMP%]{width:40px;height:40px;padding:8px 10px;border-radius:35px;font-size:18px;line-height:1.33}.btn-circle[_ngcontent-%COMP%]{width:30px;height:30px;padding:6px 0;border-radius:15px;text-align:center;font-size:12px;line-height:1.42857}.material-icons[_ngcontent-%COMP%]{font-size:25px}.overlay[_ngcontent-%COMP%]{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;justify-items:center}#loader[_ngcontent-%COMP%]{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}"],data:{animation:[(0,d.X$)("fadeInOutTranslate",[(0,d.eR)(":enter",[(0,d.oB)({opacity:0}),(0,d.jt)("400ms ease-in-out",(0,d.oB)({opacity:1}))]),(0,d.eR)(":leave",[(0,d.oB)({transform:"translate(0)"}),(0,d.jt)("400ms ease-in-out",(0,d.oB)({opacity:0}))])])]}}),e}(),bo=a(63753),Co=a(19992),Eo=a(67827);function xo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Reference"),S.\u0275\u0275elementEnd())}function Io(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",19),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.missionReference),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.missionReference," ")}}function wo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Resource"),S.\u0275\u0275elementEnd())}function Mo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.ressourceName," ")}}function Po(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Customer"),S.\u0275\u0275elementEnd())}function Do(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",19),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.clientName),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.clientName," ")}}function jo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Start Date"),S.\u0275\u0275elementEnd())}function ko(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.missionStartDate)," ")}}function Oo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1," End Date"),S.\u0275\u0275elementEnd())}function Fo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.missionEndDate)," ")}}function Ao(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Invoicing"),S.\u0275\u0275elementEnd())}function _o(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.isInvoiced," ")}}function Vo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",18),S.\u0275\u0275text(1,"Status"),S.\u0275\u0275elementEnd())}var No=function(e,t){return{"label-default":e,"label-info":t}};function Ro(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"label",20),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction2(2,No,1===n.missionAnnuler,0===n.missionAnnuler)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.etatMission,"")}}function To(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function Bo(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",21),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).toggleEditDetails(e.missionId)}),S.\u0275\u0275elementStart(2,"em",22),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(4," \xa0\xa0 "),S.\u0275\u0275elementStart(5,"button",23),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).deleteMission(e)}),S.\u0275\u0275elementStart(6,"em",22),S.\u0275\u0275text(7,"delete"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(8," \xa0\xa0 "),S.\u0275\u0275elementStart(9,"button",24),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).cancelMission(e)}),S.\u0275\u0275elementStart(10,"em",22),S.\u0275\u0275text(11,"cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(5),S.\u0275\u0275property("disabled",r.forbiddenDeleteCancel),S.\u0275\u0275advance(4),S.\u0275\u0275property("disabled",r.forbiddenDeleteCancel||1===i.missionAnnuler)}}function zo(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",25)}function qo(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}function Lo(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",1),S.\u0275\u0275elementStart(1,"mat-table",2,3),S.\u0275\u0275listener("matSortChange",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onSortData(e)}),S.\u0275\u0275elementContainerStart(3,4),S.\u0275\u0275template(4,xo,2,0,"mat-header-cell",5),S.\u0275\u0275template(5,Io,2,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(6,7),S.\u0275\u0275template(7,wo,2,0,"mat-header-cell",5),S.\u0275\u0275template(8,Mo,2,1,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(9,9),S.\u0275\u0275template(10,Po,2,0,"mat-header-cell",5),S.\u0275\u0275template(11,Do,2,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(12,10),S.\u0275\u0275template(13,jo,2,0,"mat-header-cell",5),S.\u0275\u0275template(14,ko,3,3,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(15,11),S.\u0275\u0275template(16,Oo,2,0,"mat-header-cell",5),S.\u0275\u0275template(17,Fo,3,3,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(18,12),S.\u0275\u0275template(19,Ao,2,0,"mat-header-cell",5),S.\u0275\u0275template(20,_o,2,1,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(21,13),S.\u0275\u0275template(22,Vo,2,0,"mat-header-cell",5),S.\u0275\u0275template(23,Ro,3,5,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(24,14),S.\u0275\u0275template(25,To,1,0,"mat-header-cell",15),S.\u0275\u0275template(26,Bo,12,2,"mat-cell",8),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(27,zo,1,0,"mat-header-row",16),S.\u0275\u0275template(28,qo,1,0,"mat-row",17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("dataSource",i.dataSource),S.\u0275\u0275advance(26),S.\u0275\u0275property("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",i.displayedColumns)}}var Qo=function(){var e=function(){function e(t,i,r,a,o,l){n(this,e),this.notificationService=t,this.dialog=i,this.searchFilterService=r,this.router=a,this.missionService=o,this.mailService=l,this.displayedColumns=["missionReference","ressourceName","clientName","missionStartDate","missionEndDate","invoice","etatMission","buttons"],this.dataSource=new Gn.by,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenDeleteCancel=!0,this.listView=!1}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.forbiddenDeleteCancel=this.currentUser.groupId!==v.Fl.SuperAdmin&&this.currentUser.groupId!==v.Fl.ProjectManager,0!==this.missions.length&&(this.listView=!0),this.selectedMissionId=0,this.dataSource=new Gn.by(this.missions),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"toggleEditDetails",value:function(e){this.missionService.previousState.next({pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["/project-management/project/edit-mission/"+e])}},{key:"deleteMission",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this Mission for ".concat(e.ressourceName," ?"),icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.missionService.deleteMission(e.missionId).subscribe(function(e){0!==e?(t.notificationService.success("This Mission is deleted"),t.missionService.savedMission.next("refresh")):t.notificationService.danger("Delete Mission failed")},function(){t.notificationService.danger("Delete Mission failed")})}})}},{key:"cancelMission",value:function(e){var t=this;ne().fire({text:"Are you sure to cancel this Mission for ".concat(e.ressourceName," ?"),icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!",cancelButtonText:"No",showLoaderOnConfirm:!0,preConfirm:function(){t.missionService.cancelMission(e.missionId).subscribe(function(n){0!==n?(t.notificationService.success("This Mission is canceled"),t.missionService.savedMission.next("refresh"),t.mailService.missionCanceled(e)):t.notificationService.danger("Cancel Mission failed")},function(){t.notificationService.danger("Cancel Mission failed")})}})}},{key:"onSortData",value:function(e){this.missionService.sortMissions.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.YT))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-missions-table"]],inputs:{missions:"missions"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","missionReference",1,"table-hover","table-striped","table-styling"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","ressourceName"],[4,"matCellDef"],["matColumnDef","clientName"],["matColumnDef","missionStartDate"],["matColumnDef","missionEndDate"],["matColumnDef","invoice"],["matColumnDef","etatMission"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"label",3,"ngClass"],["type","button","matTooltip","Edit Mission",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],[1,"material-icons"],["type","button","matTooltip","Delete Mission",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],["type","button","matTooltip","Cancel Mission",1,"btn","btn-mini","btn-danger","ripple","light",3,"disabled","click"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&S.\u0275\u0275template(0,Lo,29,4,"div",0),2&e&&S.\u0275\u0275property("ngIf",t.listView)},directives:[o.NgIf,Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,o.NgClass,Gn.XQ,Gn.Gk],pipes:[Te.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.material-icons[_ngcontent-%COMP%]{font-size:15px}table[_ngcontent-%COMP%]{width:100%}.mat-column-missionReference[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-Ressource[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-clientName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 20%!important;width:20%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-missionStartDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-missionEndDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-invoicing[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 9%!important;width:9%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-etatMission[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 11%!important;width:11%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-buttons[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 12%!important;width:12%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}  .mat-sort-header-arrow{color:#fff}"]}),e}();function $o(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"h1"),S.\u0275\u0275text(2,"No Result Found"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function Uo(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",35),S.\u0275\u0275elementStart(1,"div",36),S.\u0275\u0275elementStart(2,"div",37),S.\u0275\u0275elementStart(3,"div",1),S.\u0275\u0275elementStart(4,"div",38),S.\u0275\u0275element(5,"mat-spinner"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function Ho(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",39),S.\u0275\u0275element(1,"app-missions-table",40),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275classProp("blurred",n.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("missions",S.\u0275\u0275pipeBind3(2,3,n.missions,n.searchFilterService.pageIndex,n.searchFilterService.pageSize))}}var Go=function(){var e=function(){function e(t){n(this,e),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.dropdownSettings={},this.dropdownSettingsStatus={},this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.statusIdentifiers=[{id:f.rs.Active,description:"Active"},{id:f.rs.Canceled,description:"Canceled"}],this.selectedStatusesIdentifiers=[],this.forbiddenAddMission=!0,this.missions=[],this.isLoading=!1,this.destroyed=new p.xQ,this.missionService=t.get(h.Fn),this.projectService=t.get(h.Y4),this.searchFilterService=t.get(u.nJ),this.sortService=t.get(u.Kx),this.excelService=t.get(u.xB),this.dateTimeService=t.get(u.Cv),this.router=t.get(s.F0),this.paginatorPipe=new $n.Ry(this.searchFilterService)}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.forbiddenAddMission=this.currentUser.groupId!==v.Fl.SuperAdmin&&this.currentUser.groupId!==v.Fl.ProjectManager,this.listView=!1,this.emptyResult=!1,this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownSettingsStatus={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.selectedStatusesIds=this.statusIdentifiers.map(function(e){return e.id}).join(","),this.getClients(),this.subscription=this.missionService.sortMissions.subscribe(function(t){e.onSortData(t)}),this.getPersistedFilter(),this.refreshSubscription=this.missionService.savedMission.subscribe(function(t){"refresh"===t&&(e.getPersistedFilter(),e.getMissions(),e.missionService.savedMission.next("done"))}),this.subscription.add(this.missionService.previousState.pipe((0,ze.R)(this.destroyed)).subscribe(function(t){t&&t.getPrevious&&(e.filterMissionButton(),e.searchFilterService.pageSize=t.pageSize,e.searchFilterService.pageIndex=t.pageIndex,e.destroyed.next(),e.missionService.previousState.next())}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.refreshSubscription.unsubscribe()}},{key:"getClients",value:function(){var e=this;this.projectService.getClients().subscribe(function(t){null!=t&&(e.customersIdentifiers=t,null==e.selectedCustomersIds||(e.selectedCustomersIds=e.customersIdentifiers.map(function(e){return e.id}).join(",")))})}},{key:"filterMissionButton",value:function(){this.searchFilterService.pageIndex=0,this.persistFilter(),this.getMissions()}},{key:"onResetAllFilters",value:function(){sessionStorage.removeItem("missionSearch");var e=new Date;this.fromDate=new Date(e.getFullYear(),e.getMonth()-1,1),this.toDate=new Date(e.getFullYear(),e.getMonth()+2,0),this.resourceName="",this.missionReference="",this.selectedStatusesIdentifiers=[],this.selectedCustomersIdentifiers=[]}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.missions&&this.missions.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"missionReference":return t.sortService.compare(n.missionReference,i.missionReference,r,!1);case"ressourceName":return t.sortService.compare(n.ressourceName,i.ressourceName,r,!1);case"clientName":return t.sortService.compare(n.clientName,i.clientName,r,!1);case"missionStartDate":return t.sortService.compare(n.missionStartDate,i.missionStartDate,r,!1);case"missionEndDate":return t.sortService.compare(n.missionEndDate,i.missionEndDate,r,!1);case"invoice":return t.sortService.compare(n.isInvoiced,i.isInvoiced,r,!1);case"etatMission":return t.sortService.compare(n.etatMission,i.etatMission,r,!1);default:return 0}}),this.paginatorPipe.transform(this.missions,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"addMission",value:function(){this.router.navigate(["/project-management/project/add-mission"])}},{key:"onClickingEnter",value:function(e){"Enter"===e.key&&this.filterMissionButton()}},{key:"persistFilter",value:function(){var e=new f.sf;e.periodFrom=this.fromDate,e.periodTo=this.toDate,e.resourceName=this.resourceName,e.missionReference=this.missionReference,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,sessionStorage.setItem("missionSearch",JSON.stringify(e))}},{key:"getPersistedFilter",value:function(){var e=JSON.parse(sessionStorage.getItem("missionSearch"));if(null!==e)null!=e.periodFrom&&(this.fromDate=e.periodFrom),null!=e.periodTo&&(this.toDate=e.periodTo),this.resourceName=e.resourceName,this.missionReference=e.missionReference,this.selectedStatusesIdentifiers=e.selectedStatusesIdentifiers,this.selectedCustomersIdentifiers=e.selectedCustomersIdentifiers;else{var t=new Date;this.fromDate=new Date(t.getFullYear(),t.getMonth()-1,1),this.toDate=new Date(t.getFullYear(),t.getMonth()+2,0)}}},{key:"getMissions",value:function(){var e=this;this.isLoading=!0,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.missionService.getMissions(21===this.currentUser.groupId?this.currentUser.activityId:0,this.resourceName,this.missionReference,this.selectedCustomersIds,this.fromDate,this.toDate,this.selectedStatusesIds).subscribe(function(t){null!=t&&(e.missions=t,e.lengthMissions=e.missions.length,e.listView=0!==t.length),e.isLoading=!1})}},{key:"exportToExcel",value:function(){var e=this;void 0!==this.missions&&0!==this.missions.length&&(this.isLoading=!0,this.getPersistedFilter(),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.missionService.getMissionsDetailsToExport(21===this.currentUser.groupId?this.currentUser.activityId:0,this.resourceName,this.missionReference,this.selectedCustomersIds,this.fromDate,this.toDate,this.selectedStatusesIds).subscribe(function(t){if(void 0!==t&&0!==t.length){var n=[],i=[];i.push({cell:"A1",font:{bold:!0}},{cell:"B1",font:{bold:!0}},{cell:"C1",font:{bold:!0}},{cell:"D1",font:{bold:!0}},{cell:"E1",font:{bold:!0}},{cell:"F1",font:{bold:!0}},{cell:"G1",font:{bold:!0}},{cell:"H1",font:{bold:!0}},{cell:"I1",font:{bold:!0}},{cell:"J1",font:{bold:!0}},{cell:"K1",font:{bold:!0}},{cell:"L1",font:{bold:!0}},{cell:"M1",font:{bold:!0}},{cell:"N1",font:{bold:!0}},{cell:"O1",font:{bold:!0}},{cell:"P1",font:{bold:!0}},{cell:"Q1",font:{bold:!0}},{cell:"R1",font:{bold:!0}}),t.forEach(function(t){var i=[];i.push(t.userNumber),i.push(t.userName),i.push(t.clientName),i.push(t.projectName),i.push(e.dateFormat(t.missionStartDate)),i.push(e.dateFormat(t.missionEndDate)),i.push(t.status),i.push(t.missionOrderReference),i.push(t.companyName),i.push(t.servedAmountTnd),i.push(t.servedAmountEuro),i.push(t.ticketCostTnd),i.push(t.ticketCostEuro),i.push(t.stampCostTnd),i.push(t.stampCostEuro),i.push(t.assuranceTnd),i.push(t.assuranceEuro),i.push(t.currencyRate),n.push(i)}),e.excelService.generateExcel([{header:"Matricule",key:"userNumber",width:10},{header:"Resource",key:"userName",width:30},{header:"Customer",key:"clientName",width:25},{header:"Project",key:"projectName",width:30},{header:"Start Date",key:"missionStartDate",width:12},{header:"End Date",key:"missionEndDate",width:12},{header:"Status",key:"status",width:10},{header:"Mission Order Ref.",key:"missionOrderReference",width:25},{header:"Company",key:"companyName",width:25},{header:"Served TND",key:"servedAmountTnd",width:12},{header:"Served \u20ac",key:"servedAmountEuro",width:12},{header:"Ticket TND",key:"ticketCostTnd",width:12},{header:"Ticket \u20ac",key:"ticketCostEuro",width:12},{header:"Stamp Tnd",key:"stampCostTnd",width:12},{header:"Stamp \u20ac",key:"stampCostEuro",width:12},{header:"Assur. TND",key:"assuranceTnd",width:12},{header:"Assur. \u20ac",key:"assuranceEuro",width:12},{header:"Rate \u20ac/TND",key:"currencyRate",width:12}],n,[],i,"Missions")}e.isLoading=!1},function(){e.notificationService.danger("Failed to export missions"),e.isLoading=!1}))}},{key:"dateFormat",value:function(e){return null==e||"0001-01-01T00:00:00"===e?"":this.dateTimeService.getShortFormat(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(S.Injector))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-missions"]],decls:66,vars:25,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From",3,"matDatepicker","max","ngModel","keypress","ngModelChange","keydown"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To",3,"matDatepicker","min","ngModel","keypress","ngModelChange","keydown"],["picker22",""],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","ngModelChange","keydown"],[1,"col-sm-10"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"disabled","click"],[1,"icofont","icofont-plus"],["type","button",1,"export","btn","btn-sm","btn-primary","m-r-10",2,"font-size","inherit",3,"click"],[1,"fa","fa-file-excel-o",2,"font-size","medium"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"loaded-content"],[3,"missions"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"div",1),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"mat-list"),S.\u0275\u0275elementStart(8,"mat-list-item"),S.\u0275\u0275elementStart(9,"h3",6),S.\u0275\u0275text(10,"Period"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"mat-form-field",7),S.\u0275\u0275elementStart(12,"input",8),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.fromDate=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(13,"mat-datepicker-toggle",9),S.\u0275\u0275element(14,"mat-datepicker",null,10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",7),S.\u0275\u0275elementStart(17,"input",11),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.toDate=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(18,"mat-datepicker-toggle",9),S.\u0275\u0275element(19,"mat-datepicker",null,12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"mat-list-item"),S.\u0275\u0275elementStart(22,"h3",6),S.\u0275\u0275text(23,"Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",13),S.\u0275\u0275elementStart(25,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionReference=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",5),S.\u0275\u0275elementStart(27,"mat-list"),S.\u0275\u0275elementStart(28,"mat-list-item"),S.\u0275\u0275elementStart(29,"h3",6),S.\u0275\u0275text(30,"Customer"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"div",15),S.\u0275\u0275elementStart(32,"ng-multiselect-dropdown",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedCustomersIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"mat-list-item"),S.\u0275\u0275elementStart(34,"h3",6),S.\u0275\u0275text(35,"Resource"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-form-field",13),S.\u0275\u0275elementStart(37,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.resourceName=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"div",17),S.\u0275\u0275elementStart(39,"mat-list"),S.\u0275\u0275elementStart(40,"mat-list-item"),S.\u0275\u0275elementStart(41,"h3",6),S.\u0275\u0275text(42,"Status"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"div",15),S.\u0275\u0275elementStart(44,"ng-multiselect-dropdown",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"div",19),S.\u0275\u0275elementStart(46,"div",20),S.\u0275\u0275elementStart(47,"button",21),S.\u0275\u0275listener("click",function(){return t.filterMissionButton()}),S.\u0275\u0275text(48,"Search"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(49,"div",20),S.\u0275\u0275elementStart(50,"button",22),S.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),S.\u0275\u0275text(51,"Reset"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(52,"nav",23),S.\u0275\u0275elementStart(53,"div",24),S.\u0275\u0275elementStart(54,"button",25),S.\u0275\u0275listener("click",function(){return t.addMission()}),S.\u0275\u0275element(55,"em",26),S.\u0275\u0275text(56," Mission "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"button",27),S.\u0275\u0275listener("click",function(){return t.exportToExcel()}),S.\u0275\u0275element(58,"em",28),S.\u0275\u0275text(59," Export "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(60,"div",29),S.\u0275\u0275element(61,"app-paginator",30),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(62,$o,3,0,"div",31),S.\u0275\u0275elementStart(63,"div",32),S.\u0275\u0275template(64,Uo,6,0,"div",33),S.\u0275\u0275template(65,Ho,3,7,"div",34),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(15),i=S.\u0275\u0275reference(20);S.\u0275\u0275advance(12),S.\u0275\u0275property("matDatepicker",n)("max",t.toDate)("ngModel",t.fromDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(4),S.\u0275\u0275property("matDatepicker",i)("min",t.fromDate)("ngModel",t.toDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(7),S.\u0275\u0275property("ngModel",t.missionReference),S.\u0275\u0275advance(7),S.\u0275\u0275property("placeholder","Select...")("data",t.customersIdentifiers)("ngModel",t.selectedCustomersIdentifiers)("settings",t.dropdownSettings),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngModel",t.resourceName),S.\u0275\u0275advance(7),S.\u0275\u0275property("placeholder","Select...")("settings",t.dropdownSettingsStatus)("data",t.statusIdentifiers)("ngModel",t.selectedStatusesIdentifiers),S.\u0275\u0275advance(10),S.\u0275\u0275property("disabled",t.forbiddenAddMission),S.\u0275\u0275advance(7),S.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthMissions),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",0===t.lengthMissions),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView)}},directives:[Co.i$,Co.Tg,E.KE,x.Nt,w.hl,c.DefaultValueAccessor,c.NgControlStatus,c.NgModel,w.nW,E.R9,w.Mq,Eo.OP,bt.M2,Un.J,o.NgIf,Qn.$g,Qo],pipes:[Ti.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e}(),Wo=a(60428),Jo=["missionExpenseForm"];function Yo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",30),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var Ko=function(){var e=function(){function e(t,i,r,a,o,l){n(this,e),this.missionService=t,this.projectService=i,this.notificationService=r,this.numberFormatter=a,this.dialogRef=o,this.data=l,this.missionExpense=new f.gS,this.currentMission=new f.$U,this.missionSpent=new f.Nu,this.missionSpents=[],this.isEdit=!1}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.data&&(this.isEdit=this.data.isEdit,this.isEdit?(this.missionExpense=Object.assign(new f.gS,this.data.missionExpense),this.prepareMissionExpenseToEdit()):(this.missionExpense.missionId=this.data.missionId,this.missionService.getMissionExpenses(this.missionExpense.missionId).subscribe(function(t){0!==t.length&&(e.missionExpense.companyId=t[0].companyId)})),this.getCompanies(),this.getCurrentMission(this.missionExpense.missionId))}},{key:"getCompanies",value:function(){var e=this;this.projectService.getCompanies().subscribe(function(t){null!=t&&(e.companiesIdentifiers=t)})}},{key:"onChangeCompany",value:function(e){this.missionService.campanyChanged.next(e),this.selectedCompanyIdentifier=this.companiesIdentifiers.find(function(t){return t.id===e})}},{key:"getCurrentMission",value:function(e){var t=this;this.missionService.getMission(e).subscribe(function(e){t.currentMission=Object.assign(new f.$U,e[0])})}},{key:"close",value:function(){this.dialogRef.close()}},{key:"cancel",value:function(){this.close()}},{key:"insertOrUpdateMissionExpense",value:function(e){var t=this;this.missionExpenseForm.valid&&!0===this.isMissionExpenseValid(e)?(this.prepareMissionExpenseToEdit(),this.missionService.insertOrUpdateMissionExpense(this.missionExpense).subscribe(function(n){e.missionFraisId=n,t.notificationService.success("Mission expense saved succefully."),t.missionService.refresh.next(),[{expenseType:"servedAmount"},{expenseType:"ticketCost"},{expenseType:"stampCost"},{expenseType:"assurance"}].forEach(function(e){t.missionExpense.companyId&&t.missionExpense.companyId>0&&t.prepareMissionSpent(e.expenseType)}),t.missionService.insertOrUpdateMissionSpent(t.missionSpents).subscribe(function(e){t.notificationService.success("Mission spents saved succefully."),t.missionService.refresh.next()},function(){t.notificationService.danger("Mission spents not saved.")}),t.close()},function(){t.notificationService.danger("Mission expense not saved.")})):this.notificationService.danger("Please fill all required fields.")}},{key:"prepareMissionSpent",value:function(e){switch(this.missionSpent=new f.Nu,this.missionSpent.missionFraisId=this.missionExpense.missionFraisId,this.missionSpent.spentCreatorId=JSON.parse(localStorage.getItem("currentUser")).userId,this.missionSpent.spentCompanyId=this.missionExpense.companyId,this.missionSpent.missionStartDate=this.currentMission.missionStartDate,this.missionSpent.missionEndDate=this.currentMission.missionEndDate,e){case"servedAmount":this.missionSpent.expenseType="servedAmount",this.missionSpent.spentReference=this.missionExpense.gdDeclaredServed,this.missionSpent.spentAmount=this.missionExpense.servedAmount,this.missionSpent.spentDescription="FM ";break;case"ticketCost":this.missionSpent.expenseType="ticketCost",this.missionSpent.spentReference=this.missionExpense.gdDeclaredTicket,this.missionSpent.spentAmount=this.missionExpense.ticketCost,this.missionSpent.spentDescription="BA ";break;case"stampCost":this.missionSpent.expenseType="stampCost",this.missionSpent.spentReference=this.missionExpense.gdDeclaredStamp,this.missionSpent.spentAmount=this.missionExpense.stampCost,this.missionSpent.spentDescription="TF ";break;case"assurance":this.missionSpent.expenseType="assurance",this.missionSpent.spentReference=this.missionExpense.gdDeclaredAssurance,this.missionSpent.spentAmount=this.missionExpense.assurance,this.missionSpent.spentDescription="AV "}this.missionSpent.spentDescription+="de "+this.currentMission.ressourceName+" selon OMN\xb0"+this.missionExpense.missionReference,this.missionSpents.push(this.missionSpent)}},{key:"isMissionExpenseValid",value:function(e){if((e.servedAmountEuro>0||e.ticketCost>0||e.stampCost>0||e.assurance>0)&&e.currencyRate>0)return!0}},{key:"prepareMissionExpenseToEdit",value:function(){this.missionExpense.servedAmountEuro=this.numberFormatter.round(this.missionExpense.servedAmountEuro,2),this.missionExpense.servedAmount=this.numberFormatter.round(this.missionExpense.servedAmountEuro*this.missionExpense.currencyRate,3),this.missionExpense.ticketCost=this.numberFormatter.round(this.missionExpense.ticketCost,3),this.missionExpense.ticketCostEuro=this.numberFormatter.round(this.missionExpense.ticketCost/this.missionExpense.currencyRate,2),this.missionExpense.stampCost=this.numberFormatter.round(this.missionExpense.stampCost,3),this.missionExpense.stampCostEuro=this.numberFormatter.round(this.missionExpense.stampCost/this.missionExpense.currencyRate,2),this.missionExpense.assurance=this.numberFormatter.round(this.missionExpense.assurance,3),this.missionExpense.assuranceEuro=this.numberFormatter.round(this.missionExpense.assurance/this.missionExpense.currencyRate,2)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(Wo.e),S.\u0275\u0275directiveInject(m.so),S.\u0275\u0275directiveInject(m.WI))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-expenses"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Jo,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.missionExpenseForm=n.first))},decls:56,vars:32,consts:[[1,"modal_header"],[1,"modal_title"],[1,"material-icons","modal-close",3,"click"],[1,"modal_body"],["placement","bottom",1,"p-20","z-depth-top-0","waves-effect"],["id","missionExpenseForm"],["missionExpenseForm","ngForm"],[1,"row","m-b-6"],[1,"col-sm-4"],["placeholder","Mission order reference","matInput","","name","Mission order reference","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Company","name","company","required","",3,"ngModel","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["placeholder","Rate","matInput","","name","CurrencyRate","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Served amount \u20ac","matInput","","name","Served amount \u20ac","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Served amount DT","matInput","","name","Served amount DT","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Declared Served","matInput","","name","Declared Served","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Ticket Cost \u20ac","matInput","","name","Ticket Cost \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Ticket Cost DT","matInput","","name","Ticket Cost DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Ticket","matInput","","name","Declared Ticket","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Fiscal stamp \u20ac","matInput","","name","Fiscal stamp \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Fiscal stamp DT","matInput","","name","Fiscal stamp DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Stamp","matInput","","name","Declared Stamp","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Assurance \u20ac","matInput","","name","Assurance \u20ac","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],["placeholder","Assurance DT","matInput","","name","Assurance DT","maxlength","200","required","",3,"ngModel","ngModelChange"],["placeholder","Declared Assurance","matInput","","name","Declared Assurance","maxlength","200",3,"ngModel","readonly","disabled","ngModelChange"],[1,"row","m-t-20"],[1,"col-lg-12"],[1,"row","f-right"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","submit",1,"btn","btn-primary","ripple","light","btn-md",3,"click"],[3,"value"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span"),S.\u0275\u0275text(3," Mission Expense "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"span"),S.\u0275\u0275elementStart(5,"em",2),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(6,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"div",3),S.\u0275\u0275elementStart(8,"div",4),S.\u0275\u0275elementStart(9,"form",5,6),S.\u0275\u0275elementStart(11,"div",7),S.\u0275\u0275elementStart(12,"mat-form-field",8),S.\u0275\u0275elementStart(13,"input",9),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.missionReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"mat-form-field",8),S.\u0275\u0275elementStart(15,"mat-select",10),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.companyId=e})("selectionChange",function(e){return t.onChangeCompany(e.value)}),S.\u0275\u0275template(16,Yo,2,2,"mat-option",11),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"mat-form-field",8),S.\u0275\u0275elementStart(18,"input",12),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.currencyRate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"div",7),S.\u0275\u0275elementStart(20,"mat-form-field",8),S.\u0275\u0275elementStart(21,"input",13),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.servedAmountEuro=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"mat-form-field",8),S.\u0275\u0275elementStart(23,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.servedAmount=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",8),S.\u0275\u0275elementStart(25,"input",15),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredServed=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",7),S.\u0275\u0275elementStart(27,"mat-form-field",8),S.\u0275\u0275elementStart(28,"input",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.ticketCostEuro=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"mat-form-field",8),S.\u0275\u0275elementStart(30,"input",17),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.ticketCost=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"mat-form-field",8),S.\u0275\u0275elementStart(32,"input",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredTicket=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"div",7),S.\u0275\u0275elementStart(34,"mat-form-field",8),S.\u0275\u0275elementStart(35,"input",19),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.stampCostEuro=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-form-field",8),S.\u0275\u0275elementStart(37,"input",20),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.stampCost=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"mat-form-field",8),S.\u0275\u0275elementStart(39,"input",21),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredStamp=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"div",7),S.\u0275\u0275elementStart(41,"mat-form-field",8),S.\u0275\u0275elementStart(42,"input",22),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.assuranceEuro=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"mat-form-field",8),S.\u0275\u0275elementStart(44,"input",23),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.assurance=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"mat-form-field",8),S.\u0275\u0275elementStart(46,"input",24),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionExpense.gdDeclaredAssurance=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(47,"div",25),S.\u0275\u0275elementStart(48,"div",26),S.\u0275\u0275elementStart(49,"div",27),S.\u0275\u0275elementStart(50,"div",26),S.\u0275\u0275elementStart(51,"button",28),S.\u0275\u0275listener("click",function(){return t.cancel()}),S.\u0275\u0275text(52,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(53," \xa0 \xa0 "),S.\u0275\u0275elementStart(54,"button",29),S.\u0275\u0275listener("click",function(){return t.insertOrUpdateMissionExpense(t.missionExpense)}),S.\u0275\u0275text(55," Save "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(13),S.\u0275\u0275property("ngModel",t.missionExpense.missionReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.companyId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.companiesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.currencyRate),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionExpense.servedAmountEuro),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.servedAmount)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredServed)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionExpense.ticketCostEuro)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.ticketCost),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredTicket)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionExpense.stampCostEuro)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.stampCost),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredStamp)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionExpense.assuranceEuro)("readonly",!0)("disabled",!0),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.assurance),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionExpense.gdDeclaredAssurance)("readonly",!0)("disabled",!0))},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,x.Nt,c.DefaultValueAccessor,c.MaxLengthValidator,c.RequiredValidator,c.NgControlStatus,c.NgModel,I.gD,o.NgForOf,M.ey],styles:[".col-sm-2[_ngcontent-%COMP%]{width:auto}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}.th-firstCell-style[_ngcontent-%COMP%]{font-weight:bolder}.th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-title-style[_ngcontent-%COMP%]{max-width:250px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;text-align:center}.mat-dialog-container[_ngcontent-%COMP%]{border-radius:5px!important;padding:0!important;overflow:hidden}.modal_body[_ngcontent-%COMP%]{overflow:hidden}.modal_header[_ngcontent-%COMP%]{height:50px;background-color:#3f629d;padding:18px 15px}.modal_header[_ngcontent-%COMP%]   .modal_title[_ngcontent-%COMP%]{color:#fff;line-height:1}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]{float:right;cursor:pointer}.modal_header[_ngcontent-%COMP%]   .modal-close[_ngcontent-%COMP%]:hover{color:red}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]{cursor:not-allowed;color:#dcdcdc}.modal_header[_ngcontent-%COMP%]   .modal-close-disabled[_ngcontent-%COMP%]:hover{color:#dcdcdc}"]}),e}();function Xo(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"tr"),S.\u0275\u0275elementStart(1,"td",11),S.\u0275\u0275text(2),S.\u0275\u0275pipe(3,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"td",11),S.\u0275\u0275text(5),S.\u0275\u0275pipe(6,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",11),S.\u0275\u0275text(8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(3,3,n.visasStartDate)),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(6,5,n.visasEndDate)),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate(n.destination)}}var Zo=function(e){return{active:e}};function el(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"li",13),S.\u0275\u0275elementStart(1,"a",16),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).setPage(e)}),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(2,Zo,r.pager.currentPage===i)),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(i)}}var tl=function(e){return{disabled:e}};function nl(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"ul",12),S.\u0275\u0275elementStart(1,"li",13),S.\u0275\u0275elementStart(2,"em",14),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().setPage(1)}),S.\u0275\u0275text(3,"first_page"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"li",13),S.\u0275\u0275elementStart(5,"em",14),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.currentPage-1)}),S.\u0275\u0275text(6,"chevron_left"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(7,el,3,4,"li",15),S.\u0275\u0275elementStart(8,"li",13),S.\u0275\u0275elementStart(9,"em",14),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setNextPage(e.pager.currentPage+1)}),S.\u0275\u0275text(10,"chevron_right"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"li",13),S.\u0275\u0275elementStart(12,"em",14),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext();return e.setPage(e.pager.totalPages)}),S.\u0275\u0275text(13,"last_page"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(5,tl,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(7,tl,1===i.pager.currentPage)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",i.pager.pages),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(9,tl,i.pager.currentPage===i.pager.totalPages)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction1(11,tl,i.pager.currentPage===i.pager.totalPages))}}var il=function(){var e=function(){function e(t,i,r){n(this,e),this.missionService=t,this.dateTimeService=i,this.pagerService=r,this.subscription=new p.w0,this.pager={}}return r(e,[{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"ngOnInit",value:function(){var e=this;this.visa=[],this.subscription=this.missionService.resourceChanged.subscribe(function(t){e.visa=[],t&&e.missionService.getVisas(t).subscribe(function(t){t&&(t.forEach(function(t){e.dateTimeService.isNullDate(t.visasStartDate)&&e.dateTimeService.isNullDate(t.visasEndDate)&&null==t.destination||e.visa.push(t)}),e.setPage(1))})})}},{key:"setPageDetails",value:function(){return this.visa.length>2}},{key:"setNextPage",value:function(e){if(this.pager.totalPages<e)return null;this.pager=this.pagerService.getPager(this.visa.length,e,2),this.pagedItems=this.visa.slice(this.pager.startIndex,this.pager.endIndex+1)}},{key:"setPage",value:function(e){e<1||(this.pager=this.pagerService.getPager(this.visa.length,e,2),this.pagedItems=this.visa.slice(this.pager.startIndex,this.pager.endIndex+1))}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(u.e9))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-visa"]],decls:22,vars:2,consts:[[1,"card"],[1,"card-header"],[1,"card-body"],[1,"row","m-b-15"],[1,"col-sm-12"],[1,"table-scroll"],[1,"table"],[2,"padding","0px"],["scope","col",1,"col-sm-2","th-table-style"],[4,"ngFor","ngForOf"],["class","pagination","style","float:right",4,"ngIf"],[1,"td-table-style"],[1,"pagination",2,"float","right"],[3,"ngClass"],[1,"material-icons",3,"click"],[3,"ngClass",4,"ngFor","ngForOf"],[1,"pointer",3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"h5"),S.\u0275\u0275text(3,"Visa"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"div",2),S.\u0275\u0275elementStart(5,"div",3),S.\u0275\u0275elementStart(6,"div",4),S.\u0275\u0275elementStart(7,"div",5),S.\u0275\u0275elementStart(8,"table",6),S.\u0275\u0275element(9,"caption",7),S.\u0275\u0275elementStart(10,"thead"),S.\u0275\u0275elementStart(11,"tr"),S.\u0275\u0275elementStart(12,"th",8),S.\u0275\u0275text(13,"Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"th",8),S.\u0275\u0275text(15,"End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"th",8),S.\u0275\u0275text(17,"Destination"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(18,"tbody"),S.\u0275\u0275template(19,Xo,9,7,"tr",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(20,"div"),S.\u0275\u0275template(21,nl,14,13,"ul",10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(19),S.\u0275\u0275property("ngForOf",t.pagedItems),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.setPageDetails()))},directives:[o.NgForOf,o.NgIf,o.NgClass],pipes:[Te.M],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}tbody[_ngcontent-%COMP%]{display:block;max-height:250px;overflow:auto;overflow-y:auto;border-bottom:1px solid #bbbbbb}.pointer[_ngcontent-%COMP%]{cursor:pointer}.material-icons[_ngcontent-%COMP%]{cursor:pointer;vertical-align:middle;position:relative;top:3px;margin:0 15px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{cursor:not-allowed;color:gray}"]}),e}();function rl(e,t){1&e&&S.\u0275\u0275element(0,"th",6)}function al(e,t){1&e&&S.\u0275\u0275element(0,"th",6)}function ol(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"td",11),S.\u0275\u0275elementStart(1,"em",13),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().editMissionExpense(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}}function ll(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"td",11),S.\u0275\u0275elementStart(1,"em",14),S.\u0275\u0275listener("click",function(){S.\u0275\u0275restoreView(n);var e=S.\u0275\u0275nextContext().$implicit;return S.\u0275\u0275nextContext().deleteMissionExpense(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}}function sl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"tr"),S.\u0275\u0275elementStart(1,"td",9),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(3,"td",9),S.\u0275\u0275text(4),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"td",10),S.\u0275\u0275text(6),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(7,"td",11),S.\u0275\u0275text(8),S.\u0275\u0275pipe(9,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(10,"td",11),S.\u0275\u0275text(11),S.\u0275\u0275pipe(12,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"td",11),S.\u0275\u0275text(14),S.\u0275\u0275pipe(15,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"td",11),S.\u0275\u0275text(17),S.\u0275\u0275pipe(18,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"td",11),S.\u0275\u0275text(20),S.\u0275\u0275pipe(21,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"td",11),S.\u0275\u0275text(23),S.\u0275\u0275pipe(24,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"td",11),S.\u0275\u0275text(26),S.\u0275\u0275pipe(27,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"td",11),S.\u0275\u0275text(29),S.\u0275\u0275pipe(30,"number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(31,ol,2,0,"td",12),S.\u0275\u0275template(32,ll,2,0,"td",12),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",n.missionReference,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.missionReference,""),S.\u0275\u0275advance(1),S.\u0275\u0275propertyInterpolate1("matTooltip"," ",n.companyName,""),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.companyName,""),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.currencyRate,""),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(9,15,n.servedAmountEuro,"1.0-2"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(12,18,n.servedAmount,"1.0-3"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(15,21,n.ticketCostEuro,"1.0-2"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(18,24,n.ticketCost,"1.0-3"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(21,27,n.stampCostEuro,"1.0-2"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(24,30,n.stampCost,"1.0-3"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(27,33,n.assuranceEuro,"1.0-2"),""),S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind2(30,36,n.assurance,"1.0-3"),""),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",!i.forbiddenEditDelete),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!i.forbiddenEditDelete)}}var cl=function(){var e=function(){function e(t,i,r){n(this,e),this.missionService=t,this.notificationService=i,this.dialog=r,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenEditDelete=!0}return r(e,[{key:"ngOnInit",value:function(){this.forbiddenEditDelete=this.currentUser.groupId!==v.Fl.SuperAdmin}},{key:"editMissionExpense",value:function(e){this.openEditMissionExpenseDialog(e)}},{key:"openEditMissionExpenseDialog",value:function(e){this.addEditMissionExpenseDialog=this.dialog.open(Ko,{disableClose:!1,hasBackdrop:!0,width:"700px",height:"470px",data:{missionExpense:e,isEdit:!0}})}},{key:"deleteMissionExpense",value:function(e){var t=this;ne().fire({text:"Are you sure to delete this mission expense ?",icon:"error",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",showLoaderOnConfirm:!0,preConfirm:function(){t.missionService.deleteMissionExpense(e.missionFraisId).subscribe(function(){t.notificationService.success("This mission expense is deleted"),t.missionService.refresh.next()},function(){t.notificationService.danger("Delete mission expense failed")})}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(m.uw))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-expenses"]],inputs:{missionExpenses:"missionExpenses"},decls:33,vars:3,consts:[[1,"row"],[1,"col-sm-12"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","col"],["scope","col",1,"th-table-style"],["class","th-table-style","scope","col",4,"ngIf"],[4,"ngFor","ngForOf"],[1,"td-reference-style",3,"matTooltip"],[1,"td-rate-style"],[1,"td-table-style"],["class","td-table-style",4,"ngIf"],["matTooltip","Edit",1,"icofont","icofont-ui-edit","icon-pointer",3,"click"],["matTooltip","Delete",1,"icofont","icofont-ui-delete","icon-pointer",2,"color","#d84315",3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"table",3),S.\u0275\u0275element(4,"caption",4),S.\u0275\u0275elementStart(5,"thead"),S.\u0275\u0275elementStart(6,"tr"),S.\u0275\u0275elementStart(7,"th",5),S.\u0275\u0275text(8,"Mission Order Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"th",5),S.\u0275\u0275text(10,"Company"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"th",6),S.\u0275\u0275text(12,"Rate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"th",6),S.\u0275\u0275text(14,"Served \u20ac"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(15,"th",6),S.\u0275\u0275text(16,"Served TND"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"th",6),S.\u0275\u0275text(18,"Ticket \u20ac"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"th",6),S.\u0275\u0275text(20,"Ticket TND"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"th",6),S.\u0275\u0275text(22,"Stamp \u20ac"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"th",6),S.\u0275\u0275text(24,"Stamp TND"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"th",6),S.\u0275\u0275text(26,"Assurance \u20ac"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"th",6),S.\u0275\u0275text(28,"Assurance TND"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(29,rl,1,0,"th",7),S.\u0275\u0275template(30,al,1,0,"th",7),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"tbody"),S.\u0275\u0275template(32,sl,33,39,"tr",8),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(29),S.\u0275\u0275property("ngIf",!t.forbiddenEditDelete),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.forbiddenEditDelete),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngForOf",t.missionExpenses))},directives:[o.NgIf,o.NgForOf,oe.gM],pipes:[o.DecimalPipe],styles:[".table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}.th-table-style[_ngcontent-%COMP%]{text-align:center}.td-table-style[_ngcontent-%COMP%]{text-align:center}.td-reference-style[_ngcontent-%COMP%]{max-width:120px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.td-rate-style[_ngcontent-%COMP%]{width:50px;text-align:center}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}(),dl=a(7539),ml=["missionDetailsForm"];function pl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function ul(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function fl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var hl=function(){var e=function(){function e(t,i,r,a,o,l,s){n(this,e),this.router=t,this.coreDataService=i,this.missionService=r,this.notificationService=a,this.mailService=o,this.projectService=l,this.dateTimeService=s,this.initialMission=new f.$U,this.clientsIdentifiers=[],this.resourcesIdentifiers=[],this.countriesIdentifiers=[],this.filteredClients=new p.tq(1),this.clientFilterCtrl=new c.FormControl,this.filteredResources=new p.tq(1),this.resourceFilterCtrl=new c.FormControl,this.filteredCountries=new p.tq(1),this.countryFilterCtrl=new c.FormControl,this.filteredProjects=new p.tq(1),this.projectFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.mission?(this.mission=Object.assign(new f.$U,this.mission),this.initialMission=Object.assign(new f.$U,this.mission),this.isInvoiceChecked="False"!==this.mission.isInvoiced):this.mission=new f.$U,this.user=JSON.parse(localStorage.getItem("currentUser")),this.getClients(),this.getCountries(),this.getActiveUsers(),this.clientFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterIdentifiers(e.clientsIdentifiers,e.filteredClients,e.clientFilterCtrl)}),this.countryFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterIdentifiers(e.countriesIdentifiers,e.filteredCountries,e.countryFilterCtrl)}),this.resourceFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterIdentifiers(e.resourcesIdentifiers,e.filteredResources,e.resourceFilterCtrl)})}},{key:"getClients",value:function(){var e=this;this.projectService.getClients().subscribe(function(t){e.clientsIdentifiers=t,e.filteredClients.next(e.clientsIdentifiers.slice())})}},{key:"getActiveUsers",value:function(){var e=this;this.coreDataService.getActiveUsers().subscribe(function(t){e.resourcesIdentifiers=t,-1===e.resourcesIdentifiers.findIndex(function(t){return t.id===e.mission.missionRessource})&&(e.resourcesIdentifiers.push({id:e.mission.missionRessource,description:e.mission.ressourceName+" (Quit)"}),e.resourcesIdentifiers.sort(function(e,t){var n=e.description.toUpperCase(),i=t.description.toUpperCase();return n<i?-1:n>i?1:0})),e.filteredResources.next(e.resourcesIdentifiers.slice())})}},{key:"getCountries",value:function(){var e=this;this.missionService.getCountries().subscribe(function(t){e.countriesIdentifiers=t,e.filteredCountries.next(e.countriesIdentifiers.slice())})}},{key:"onChangeCustomer",value:function(e){this.selectedClientIdentifier=this.clientsIdentifiers.find(function(t){return t.id===e})}},{key:"onChangeResource",value:function(e){this.missionService.resourceChanged.next(e),this.selectedResourceIdentifier=this.resourcesIdentifiers.find(function(t){return t.id===e})}},{key:"dateChanged",value:function(e){if(null!=this.mission.missionEndDate){var t=new Date(this.mission.missionStartDate),n=new Date(this.mission.missionEndDate);this.mission.nightsNumber=(n.getTime()-t.getTime())/864e5}}},{key:"onChangeCountry",value:function(e){this.selectedCountryIdentifier=this.countriesIdentifiers.find(function(t){return t.id===e})}},{key:"filterIdentifiers",value:function(e,t,n){if(e){var i=n.value;i?(i=i.toLowerCase(),t.next(e.filter(function(e){return e.description.toLowerCase().indexOf(i)>-1}))):t.next(e.slice())}}},{key:"save",value:function(){var e=this;this.missionDetailsForm.valid?(0===this.mission.missionId&&(this.mission.missionCreator=this.user.userId.toString()),this.mission.isInvoiced=!0===this.isInvoiceChecked?"True":"False",this.mission.affectedToPrj="true",this.mission.etatMission=1,this.missionService.insertOrUpdateMission(this.mission).subscribe(function(t){if(e.missionService.refresh.next(),e.router.navigate(["/project-management/project/edit-mission/"+t]),e.notificationService.success("Mission is saved successfully"),e.missionService.toggleMissionDetail.next(),0===e.mission.missionId)e.prepareMissionForNotification(e.mission),e.mailService.missionAdded(e.mission);else{e.initialMission.ressourceName=e.resourcesIdentifiers.find(function(t){return t.id===e.initialMission.missionRessource}).description;var n=e.prepareModification(e.initialMission,e.mission);0!==n.length&&e.mailService.missionModified(e.mission,n,e.initialMission)}})):this.notificationService.danger("Please fill all required fields")}},{key:"prepareModification",value:function(e,t){var n="";return e.missionObject!==t.missionObject&&(n=n.concat(this.modifLongInfoBuilder("Object",e.missionObject,t.missionObject))),e.missionRessource!==t.missionRessource&&(n=n.concat(this.modifInfoBuilder("Ressource",e.ressourceName,this.resourcesIdentifiers.find(function(e){return e.id===t.missionRessource}).description))),e.clientId!==t.clientId&&(n=n.concat(this.modifInfoBuilder("Client",e.clientName,this.clientsIdentifiers.find(function(e){return e.id===t.clientId}).description))),e.isInvoiced!==t.isInvoiced&&(n=n.concat(this.modifInfoBuilder("To be Invoiced",e.isInvoiced,t.isInvoiced))),t.missionStartDate!==e.missionStartDate&&(n=n.concat(this.modifInfoBuilder("Start Date",this.dateTimeService.getShortFormat(e.missionStartDate),this.dateTimeService.getShortFormat(t.missionStartDate)))),t.missionEndDate!==e.missionEndDate&&(n=n.concat(this.modifInfoBuilder("End Date",this.dateTimeService.getShortFormat(e.missionEndDate),this.dateTimeService.getShortFormat(t.missionEndDate)))),e.nightsNumber!==t.nightsNumber&&(n=n.concat(this.modifInfoBuilder("Nights Number",e.nightsNumber,t.nightsNumber))),e.missionCountry!==t.missionCountry&&(n=n.concat(this.modifInfoBuilder("Country",e.missionCountryName,this.countriesIdentifiers.find(function(e){return e.id===t.missionCountry}).description))),e.missionVille!==t.missionVille&&(n=n.concat(this.modifInfoBuilder("Ville",e.missionVille,t.missionVille))),e.invoiceNote!==t.invoiceNote&&(n=n.concat(this.modifLongInfoBuilder("Invoice Note",e.invoiceNote,t.invoiceNote))),e.supportNote!==t.supportNote&&(n=n.concat(this.modifLongInfoBuilder("Support Note",e.supportNote,t.supportNote))),n}},{key:"modifInfoBuilder",value:function(e,t,n){return'<span style="color: #0000ff;">'+e+': <span style="color: #000000;">'+(t=null==t?"":t.toString())+'<span style="color: #FF0000;"> =&gt; </span><strong><span style="color: #000000;">'+(n=null==n?"":n.toString())+"</span></strong><br> "}},{key:"modifLongInfoBuilder",value:function(e,t,n){return'<span style="color: #0000ff;">'+e+': <br><span style="color: #000000;">'+(t=null==t?"":t.toString())+'<br><span style="color: #FF0000;"> =&gt; <br></span><strong><span style="color: #000000;">'+(n=null==n?"":n.toString())+"</span></strong><br> "}},{key:"cancel",value:function(){0!==this.mission.missionId?(this.missionService.refresh.next(),this.missionService.toggleMissionDetail.next()):this.router.navigate(["/project-management/project/missions"])}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"prepareMissionForNotification",value:function(e){this.mission.ressourceName=this.resourcesIdentifiers.find(function(t){return t.id===e.missionRessource}).description,this.mission.clientName=this.clientsIdentifiers.find(function(t){return t.id===e.clientId}).description,this.mission.missionCountryName=this.countriesIdentifiers.find(function(t){return t.id===e.missionCountry}).description}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(u.YY),S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.YT),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-details"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(ml,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.missionDetailsForm=n.first))},inputs:{mission:"mission"},decls:59,vars:37,consts:[["id","missionDetailsForm"],["missionDetailsForm","ngForm"],[1,"row","m-b-15","m-t-15"],[1,"col-md-12"],["placeholder","Object","matInput","","name","missionObject","appTextValidator","","maxlength","254","required","",3,"ngModel","ngModelChange"],[1,"row","m-b-15"],[1,"col-sm-5"],["placeholder","Resource","name","resource","required","",3,"ngModel","selectionChange","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-md-5"],["placeholder","Customer","name","customer","required","",3,"ngModel","selectionChange","ngModelChange"],[1,"col-sm-2"],["name","invoice",1,"checkbox-invoice",3,"ngModel","ngModelChange"],["matInput","","placeholder","Start Date","name","missionStartDate","required","",3,"matDatepicker","ngModel","max","dateInput","keypress","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay",""],["matInput","","placeholder","End Date","name","missionEndDate","required","",3,"matDatepicker","ngModel","min","dateInput","keypress","ngModelChange"],["PickerEndDay",""],["type","text","placeholder","Nights Number","matInput","","name","nights","disabled","","required","",3,"ngModel","ngModelChange"],[1,"col-sm-3"],["placeholder","Country","name","country","required","",3,"ngModel","selectionChange","ngModelChange"],["placeholder","City","matInput","","name","city",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["matInput","","placeholder","Invoice Note","name","note",3,"ngModel","ngModelChange"],["matInput","","placeholder","Support Note","name","sendSupport",3,"ngModel","ngModelChange"],[1,"text-center","m-b-15"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"click"],["type","button",1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"form",0,1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"mat-form-field",3),S.\u0275\u0275elementStart(4,"input",4),S.\u0275\u0275listener("ngModelChange",function(e){return t.mission.missionObject=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"div",5),S.\u0275\u0275elementStart(6,"mat-form-field",6),S.\u0275\u0275elementStart(7,"mat-select",7),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangeResource(e.value)})("ngModelChange",function(e){return t.mission.missionRessource=e}),S.\u0275\u0275elementStart(8,"mat-option"),S.\u0275\u0275elementStart(9,"ngx-mat-select-search",8),S.\u0275\u0275elementStart(10,"mat-icon",9),S.\u0275\u0275text(11,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(12,pl,2,2,"mat-option",10),S.\u0275\u0275pipe(13,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"mat-form-field",11),S.\u0275\u0275elementStart(15,"mat-select",12),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCustomer(e.value)})("ngModelChange",function(e){return t.mission.clientId=e}),S.\u0275\u0275elementStart(16,"mat-option"),S.\u0275\u0275elementStart(17,"ngx-mat-select-search",8),S.\u0275\u0275elementStart(18,"mat-icon",9),S.\u0275\u0275text(19,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(20,ul,2,2,"mat-option",10),S.\u0275\u0275pipe(21,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"div",13),S.\u0275\u0275elementStart(23,"mat-checkbox",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.isInvoiceChecked=e}),S.\u0275\u0275text(24,"To be invoiced "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"div",5),S.\u0275\u0275elementStart(26,"mat-form-field",13),S.\u0275\u0275elementStart(27,"input",15),S.\u0275\u0275listener("dateInput",function(e){return t.dateChanged(e)})("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.mission.missionStartDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(28,"mat-datepicker-toggle",16),S.\u0275\u0275element(29,"mat-datepicker",17,18),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"mat-form-field",13),S.\u0275\u0275elementStart(32,"input",19),S.\u0275\u0275listener("dateInput",function(e){return t.dateChanged(e)})("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.mission.missionEndDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(33,"mat-datepicker-toggle",16),S.\u0275\u0275element(34,"mat-datepicker",17,20),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-form-field",13),S.\u0275\u0275elementStart(37,"input",21),S.\u0275\u0275listener("ngModelChange",function(e){return t.mission.nightsNumber=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"mat-form-field",22),S.\u0275\u0275elementStart(39,"mat-select",23),S.\u0275\u0275listener("selectionChange",function(e){return t.onChangeCountry(e.value)})("ngModelChange",function(e){return t.mission.missionCountry=e}),S.\u0275\u0275elementStart(40,"mat-option"),S.\u0275\u0275elementStart(41,"ngx-mat-select-search",8),S.\u0275\u0275elementStart(42,"mat-icon",9),S.\u0275\u0275text(43,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(44,fl,2,2,"mat-option",10),S.\u0275\u0275pipe(45,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"mat-form-field",22),S.\u0275\u0275elementStart(47,"input",24),S.\u0275\u0275listener("ngModelChange",function(e){return t.mission.missionVille=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"div",5),S.\u0275\u0275elementStart(49,"mat-form-field",25),S.\u0275\u0275elementStart(50,"input",26),S.\u0275\u0275listener("ngModelChange",function(e){return t.mission.invoiceNote=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"div",5),S.\u0275\u0275elementStart(52,"mat-form-field",25),S.\u0275\u0275elementStart(53,"textarea",27),S.\u0275\u0275listener("ngModelChange",function(e){return t.mission.supportNote=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(54,"div",28),S.\u0275\u0275elementStart(55,"button",29),S.\u0275\u0275listener("click",function(){return t.save()}),S.\u0275\u0275text(56,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"button",30),S.\u0275\u0275listener("click",function(){return t.cancel()}),S.\u0275\u0275text(58,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(30),i=S.\u0275\u0275reference(35);S.\u0275\u0275advance(4),S.\u0275\u0275property("ngModel",t.mission.missionObject),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.missionRessource),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.resourceFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(13,31,t.filteredResources)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.clientId),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.clientFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(21,33,t.filteredClients)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.isInvoiceChecked),S.\u0275\u0275advance(4),S.\u0275\u0275property("matDatepicker",n)("ngModel",t.mission.missionStartDate)("max",t.mission.missionEndDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("matDatepicker",i)("ngModel",t.mission.missionEndDate)("min",t.mission.missionStartDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.nightsNumber),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.mission.missionCountry),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.countryFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(45,35,t.filteredCountries)),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.missionVille),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.invoiceNote),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.mission.supportNote)}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,x.Nt,c.DefaultValueAccessor,Le.s,c.MaxLengthValidator,c.RequiredValidator,c.NgControlStatus,c.NgModel,I.gD,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,dl.oG,w.hl,w.nW,E.R9,w.Mq],pipes:[o.AsyncPipe],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}.checkbox-invoice[_ngcontent-%COMP%]{margin-top:15px!important}"]}),e}(),vl=function(){var e=function(){function e(){n(this,e)}return r(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-details"]],inputs:{mission:"mission"},decls:47,vars:11,consts:[[1,"row"],[1,"col-sm-6"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"table",3),S.\u0275\u0275element(4,"caption",4),S.\u0275\u0275elementStart(5,"tbody"),S.\u0275\u0275elementStart(6,"tr"),S.\u0275\u0275elementStart(7,"th",5),S.\u0275\u0275text(8,"Resource"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",6),S.\u0275\u0275text(10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"tr"),S.\u0275\u0275elementStart(12,"th",5),S.\u0275\u0275text(13,"Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"td",7),S.\u0275\u0275text(15),S.\u0275\u0275pipe(16,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(17,"th",5),S.\u0275\u0275text(18,"End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"td",7),S.\u0275\u0275text(20),S.\u0275\u0275pipe(21,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"tr"),S.\u0275\u0275elementStart(23,"th",5),S.\u0275\u0275text(24,"Country"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"td",6),S.\u0275\u0275text(26),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"div",1),S.\u0275\u0275elementStart(28,"div",2),S.\u0275\u0275elementStart(29,"table",3),S.\u0275\u0275element(30,"caption",4),S.\u0275\u0275elementStart(31,"tbody"),S.\u0275\u0275elementStart(32,"tr"),S.\u0275\u0275elementStart(33,"th",5),S.\u0275\u0275text(34,"Customer"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"td",6),S.\u0275\u0275text(36),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(37,"tr"),S.\u0275\u0275elementStart(38,"th",5),S.\u0275\u0275text(39,"Nights Number"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"td",7),S.\u0275\u0275text(41),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(42,"tr"),S.\u0275\u0275elementStart(43,"th",5),S.\u0275\u0275text(44,"City"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"td",6),S.\u0275\u0275text(46),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate1("",t.mission.ressourceName," "),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(16,7,t.mission.missionStartDate)," "),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",S.\u0275\u0275pipeBind1(21,9,t.mission.missionEndDate)," "),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate1(" ",t.mission.missionCountryName," "),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate1(" ",t.mission.clientName," "),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1(" ",t.mission.nightsNumber," "),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1(" ",t.mission.missionVille," "))},pipes:[Te.M],styles:[".table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}"]}),e}(),gl=function(){var e=function(){function e(){n(this,e)}return r(e,[{key:"ngOnInit",value:function(){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-view-mission-project"]],inputs:{missionProject:"missionProject"},decls:63,vars:12,consts:[[1,"row"],[1,"col-sm-3"],[1,"table-responsive","m-l-10","m-r-10"],[1,"table"],[2,"padding","0px"],["scope","row"],["colspan","3",1,"text-left"],[1,"text-left"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"table",3),S.\u0275\u0275element(4,"caption",4),S.\u0275\u0275elementStart(5,"tbody"),S.\u0275\u0275elementStart(6,"tr"),S.\u0275\u0275elementStart(7,"th",5),S.\u0275\u0275text(8,"Project"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(9,"td",6),S.\u0275\u0275text(10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"tr"),S.\u0275\u0275elementStart(12,"th",5),S.\u0275\u0275text(13,"Order Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"td",6),S.\u0275\u0275text(15),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"div",1),S.\u0275\u0275elementStart(17,"div",2),S.\u0275\u0275elementStart(18,"table",3),S.\u0275\u0275element(19,"caption",4),S.\u0275\u0275elementStart(20,"tbody"),S.\u0275\u0275elementStart(21,"tr"),S.\u0275\u0275elementStart(22,"th",5),S.\u0275\u0275text(23," Start"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"td",7),S.\u0275\u0275text(25),S.\u0275\u0275pipe(26,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"tr"),S.\u0275\u0275elementStart(28,"th",5),S.\u0275\u0275text(29,"Invoice Reference"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"td",6),S.\u0275\u0275text(31),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"div",1),S.\u0275\u0275elementStart(33,"div",2),S.\u0275\u0275elementStart(34,"table",3),S.\u0275\u0275element(35,"caption",4),S.\u0275\u0275elementStart(36,"tbody"),S.\u0275\u0275elementStart(37,"tr"),S.\u0275\u0275elementStart(38,"th",5),S.\u0275\u0275text(39," End"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(40,"td",7),S.\u0275\u0275text(41),S.\u0275\u0275pipe(42,"shortDate"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"tr"),S.\u0275\u0275elementStart(44,"th",5),S.\u0275\u0275text(45,"Invoice Amount"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"td",6),S.\u0275\u0275text(47),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"div",1),S.\u0275\u0275elementStart(49,"div",2),S.\u0275\u0275elementStart(50,"table",3),S.\u0275\u0275element(51,"caption",4),S.\u0275\u0275elementStart(52,"tbody"),S.\u0275\u0275elementStart(53,"tr"),S.\u0275\u0275elementStart(54,"th",5),S.\u0275\u0275text(55,"Days Numbers"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(56,"td",6),S.\u0275\u0275text(57),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(58,"tr"),S.\u0275\u0275elementStart(59,"th",5),S.\u0275\u0275text(60,"Ticket Cost"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(61,"td",6),S.\u0275\u0275text(62),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate1("",t.missionProject.projectName," "),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.missionProject.orderReference),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(26,8,t.missionProject.missionStartDate)),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate(t.missionProject.invoiceReference),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate(S.\u0275\u0275pipeBind1(42,10,t.missionProject.missionEndDate)),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate(t.missionProject.invoiceAmount),S.\u0275\u0275advance(10),S.\u0275\u0275textInterpolate(t.missionProject.daysNumbers),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate(t.missionProject.ticketCost))},pipes:[Te.M],styles:[".td-description[_ngcontent-%COMP%]{white-space:pre-wrap;word-wrap:break-word}.table-responsive[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{width:25%}.row[_ngcontent-%COMP%]{padding:0 15px 10px}"]}),e}(),Sl=["missionDetailsForm"];function yl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",22),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var bl=function(){var e=function(){function e(t,i,r,a){n(this,e),this.missionService=t,this.notificationService=i,this.projectService=r,this.dateTimeService=a,this.displayMissionProject=new S.EventEmitter,this.missionProject=new f.vl,this.filteredProjects=new p.tq(1),this.projectFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.missionProject=Object.assign(new f.vl,this.missionProject),this.missionProject.missionId=this.mission.missionId,0===this.missionProject.missionProjectId&&(this.missionProject.missionStartDate=this.mission.missionStartDate,this.missionProject.missionEndDate=this.mission.missionEndDate,this.daysNumbers()),this.getListProject(),this.projectFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterIdentifiers(e.projectsIdentifiers,e.filteredProjects,e.projectFilterCtrl)})}},{key:"getListProject",value:function(){var e=this;this.projectService.getProjectNames().subscribe(function(t){e.projectsIdentifiers=t,e.filteredProjects.next(e.projectsIdentifiers.slice())})}},{key:"filterIdentifiers",value:function(e,t,n){if(e){var i=n.value;i?(i=i.toLowerCase(),t.next(e.filter(function(e){return e.description.toLowerCase().indexOf(i)>-1}))):t.next(e.slice())}}},{key:"saveMissionProjects",value:function(){var e=this;this.detailsForm.valid?this.missionService.insertOrUpdateMissionProject(this.missionProject).subscribe(function(t){e.displayMissionProject.next(),e.notificationService.success("The mission project was saved successfully.")},function(){e.notificationService.danger("The mission project was not saved")}):this.notificationService.danger("Please fill all required fields")}},{key:"cancel",value:function(){this.displayMissionProject.next()}},{key:"daysNumbers",value:function(){if(null!=this.missionProject.missionEndDate){var e=new Date(this.missionProject.missionStartDate),t=new Date(this.missionProject.missionEndDate);this.missionProject.daysNumbers=(t.getTime()-e.getTime())/864e5}}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.Cv))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission-project"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Sl,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.detailsForm=n.first))},inputs:{missionProject:"missionProject",mission:"mission"},outputs:{displayMissionProject:"displayMissionProject"},decls:37,vars:24,consts:[["id","missionDetailsForm"],["missionDetailsForm","ngForm"],[1,"row","m-b-15"],[1,"col-sm-3"],["placeholder","Project","name","project","required","",3,"ngModel","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],["matInput","","placeholder","Start Date","name","missionStartDate","required","",3,"matDatepicker","ngModel","max","keypress","dateInput","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerStartDay1",""],["matInput","","placeholder","End Date","name","missionEndDate","required","",3,"matDatepicker","ngModel","min","keypress","dateInput","ngModelChange"],["PickerEndDay11",""],["placeholder","Days Numbers","matInput","","name","daysNumbers","appNumberValidator","","required","",3,"ngModel","ngModelChange"],["placeholder","Order Reference","matInput","","name","orderReference",3,"ngModel","ngModelChange"],["placeholder","Invoice Reference","matInput","","name","invoiceReference",3,"ngModel","ngModelChange"],["placeholder","Invoice Amount \u20ac","matInput","","name","amount","appNumberValidator","",3,"ngModel","inputValue","ngModelChange"],["placeholder","Ticket Amount DT","matInput","","name","ticketAmount","appNumberValidator","",3,"ngModel","inputValue","ngModelChange"],[1,"text-center","m-b-15"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"click"],[1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"form",0,1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"mat-form-field",3),S.\u0275\u0275elementStart(4,"mat-select",4),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.projectId=e}),S.\u0275\u0275elementStart(5,"mat-option"),S.\u0275\u0275elementStart(6,"ngx-mat-select-search",5),S.\u0275\u0275elementStart(7,"mat-icon",6),S.\u0275\u0275text(8,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(9,yl,2,2,"mat-option",7),S.\u0275\u0275pipe(10,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"mat-form-field",3),S.\u0275\u0275elementStart(12,"input",8),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("dateInput",function(){return t.daysNumbers()})("ngModelChange",function(e){return t.missionProject.missionStartDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(13,"mat-datepicker-toggle",9),S.\u0275\u0275element(14,"mat-datepicker",10,11),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",3),S.\u0275\u0275elementStart(17,"input",12),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("dateInput",function(){return t.daysNumbers()})("ngModelChange",function(e){return t.missionProject.missionEndDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(18,"mat-datepicker-toggle",9),S.\u0275\u0275element(19,"mat-datepicker",10,13),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"mat-form-field",3),S.\u0275\u0275elementStart(22,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.daysNumbers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"div",2),S.\u0275\u0275elementStart(24,"mat-form-field",3),S.\u0275\u0275elementStart(25,"input",15),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.orderReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"mat-form-field",3),S.\u0275\u0275elementStart(27,"input",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.invoiceReference=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"mat-form-field",3),S.\u0275\u0275elementStart(29,"input",17),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.invoiceAmount=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(30,"mat-form-field",3),S.\u0275\u0275elementStart(31,"input",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.missionProject.ticketCost=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"div",19),S.\u0275\u0275elementStart(33,"button",20),S.\u0275\u0275listener("click",function(){return t.saveMissionProjects()}),S.\u0275\u0275text(34,"Save"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(35,"button",21),S.\u0275\u0275listener("click",function(){return t.cancel()}),S.\u0275\u0275text(36,"Cancel"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(15),i=S.\u0275\u0275reference(20);S.\u0275\u0275advance(4),S.\u0275\u0275property("ngModel",t.missionProject.projectId),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.projectFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(10,22,t.filteredProjects)),S.\u0275\u0275advance(3),S.\u0275\u0275property("matDatepicker",n)("ngModel",t.missionProject.missionStartDate)("max",t.missionProject.missionEndDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("matDatepicker",i)("ngModel",t.missionProject.missionEndDate)("min",t.missionProject.missionStartDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionProject.daysNumbers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.missionProject.orderReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionProject.invoiceReference),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionProject.invoiceAmount)("inputValue",t.missionProject.invoiceAmount),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.missionProject.ticketCost)("inputValue",t.missionProject.ticketCost)}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,I.gD,c.RequiredValidator,c.NgControlStatus,c.NgModel,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,x.Nt,w.hl,c.DefaultValueAccessor,w.nW,E.R9,w.Mq,$e.z],pipes:[o.AsyncPipe],encapsulation:2}),e}(),Cl=["missionDetailsForm"];function El(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",22),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().toggleEditMissionDetails()}),S.\u0275\u0275text(1," edit "),S.\u0275\u0275elementEnd()}}function xl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"span"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(n.mission.missionObject)}}function Il(e,t){if(1&e&&S.\u0275\u0275element(0,"app-edit-mission-details",23),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("mission",n.mission)}}function wl(e,t){if(1&e&&S.\u0275\u0275element(0,"app-view-mission-details",23),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("mission",n.mission)}}function Ml(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",24),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().editMissionProject()}),S.\u0275\u0275text(1," edit "),S.\u0275\u0275elementEnd()}}function Pl(e,t){if(1&e&&S.\u0275\u0275element(0,"app-view-mission-project",25),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275property("missionProject",n.missionProject)}}function Dl(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"app-edit-mission-project",26),S.\u0275\u0275listener("displayMissionProject",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().displayMissionProject()}),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275property("missionProject",i.missionProject)("mission",i.mission)}}function jl(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-icon",27),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().addMissionExpenses()}),S.\u0275\u0275text(1," add "),S.\u0275\u0275elementEnd()}}var kl=function(){var e=function(){function e(t,i,r,a){n(this,e),this.missionService=t,this.dialog=i,this.route=r,this.router=a,this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.forbiddenEditMission=!0,this.forbiddenAddMissionExpenses=!0,this.mission=new f.$U,this.missionProject=new f.vl,this.missionExpense=new f.gS,this.missionExpenses=[],this.previousState={getPrevious:!1,type:null,pageIndex:null,pageSize:null}}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.forbiddenEditMission=this.currentUser.groupId!==v.Fl.SuperAdmin&&this.currentUser.groupId!==v.Fl.ProjectManager,this.forbiddenAddMissionExpenses=this.currentUser.groupId!==v.Fl.SuperAdmin,this.route.params.subscribe(function(t){null==t.missionId||(e.missionId=+t.missionId,e.getMission(e.missionId),e.getMissionProject(e.missionId),e.getMissionExpenses(e.missionId))}),this.subscription=this.missionService.refresh.subscribe(function(){e.getMission(e.mission.missionId),e.getMissionProject(e.mission.missionId),e.getMissionExpenses(e.mission.missionId)}),this.missionService.toggleMissionDetail.subscribe(function(){e.toggleEditMissionDetails()}),this.subscription.add(this.missionService.previousState.subscribe(function(t){t&&(e.previousState.pageIndex=t.pageIndex,e.previousState.pageSize=t.pageSize)}))}},{key:"getMissionExpenses",value:function(e){var t=this;this.missionService.getMissionExpenses(e).subscribe(function(e){t.missionExpenses=[],0!==e.length&&e.forEach(function(e){t.missionExpenses.push(Object.assign(new f.gS,e))})})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"editMissionProject",value:function(){this.displayEditMissionProject=!0}},{key:"toggleEditMissionDetails",value:function(){this.EditMissionDetails=!this.EditMissionDetails}},{key:"displayMissionProject",value:function(){this.displayEditMissionProject=!1,this.getMissionProject(this.missionId)}},{key:"goBack",value:function(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.missionService.previousState.next(this.previousState)),this.router.navigate(["/project-management/project/missions"])}},{key:"getMission",value:function(e){var t=this;this.missionService.getMission(e).subscribe(function(e){t.mission=Object.assign(new f.$U,e[0]),t.missionService.resourceChanged.next(t.mission.missionRessource)})}},{key:"getMissionProject",value:function(e){var t=this;this.missionService.getMissionProject(e).subscribe(function(e){0!==e.length&&(t.missionProject=Object.assign(new f.vl,e[0]))})}},{key:"addMissionExpenses",value:function(){this.addEditMissionExpensesDialog=this.dialog.open(Ko,{disableClose:!1,hasBackdrop:!0,width:"700px",height:"470px",data:{missionId:this.missionId,isEdit:!1}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(m.uw),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-mission"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Cl,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.missionDetailsForm=n.first))},decls:55,vars:11,consts:[[1,"card"],[1,"card-header"],[1,"row"],[1,"col-md-10"],[1,"col-md-2",2,"text-align","right"],["type","button","matTooltip","Back to Projects",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-reply"],[1,"md-tabs","md-card-tabs"],[1,"m-t-10"],[1,"col-sm-8"],["class","edit-project-ico","matTooltip","Edit",3,"click",4,"ngIf"],[1,"card-header-text"],[4,"ngIf"],[1,"card-body"],[3,"mission",4,"ngIf"],[1,"col-sm-4"],[1,"col-sm-12"],["class","edit-mission-ico","matTooltip","Edit",3,"click",4,"ngIf"],[3,"missionProject",4,"ngIf"],[3,"missionProject","mission","displayMissionProject",4,"ngIf"],["class","edit-mission-ico","matTooltip","add",3,"click",4,"ngIf"],[3,"missionExpenses"],["matTooltip","Edit",1,"edit-project-ico",3,"click"],[3,"mission"],["matTooltip","Edit",1,"edit-mission-ico",3,"click"],[3,"missionProject"],[3,"missionProject","mission","displayMissionProject"],["matTooltip","add",1,"edit-mission-ico",3,"click"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"h5"),S.\u0275\u0275text(5),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(6,"div",4),S.\u0275\u0275elementStart(7,"button",5),S.\u0275\u0275listener("click",function(){return t.goBack()}),S.\u0275\u0275element(8,"em",6),S.\u0275\u0275text(9," Missions "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(10,"div"),S.\u0275\u0275elementStart(11,"div",7),S.\u0275\u0275elementStart(12,"div",8),S.\u0275\u0275elementStart(13,"div",2),S.\u0275\u0275elementStart(14,"div",9),S.\u0275\u0275elementStart(15,"div",0),S.\u0275\u0275elementStart(16,"div",1),S.\u0275\u0275elementStart(17,"div"),S.\u0275\u0275template(18,El,2,0,"mat-icon",10),S.\u0275\u0275elementStart(19,"div"),S.\u0275\u0275elementStart(20,"h5",11),S.\u0275\u0275text(21,"Mission Details"),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(22,xl,2,1,"span",12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(23,"div",13),S.\u0275\u0275template(24,Il,1,1,"app-edit-mission-details",14),S.\u0275\u0275template(25,wl,1,1,"app-view-mission-details",14),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",15),S.\u0275\u0275element(27,"app-visa"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(28,"div",7),S.\u0275\u0275elementStart(29,"div",8),S.\u0275\u0275elementStart(30,"div",2),S.\u0275\u0275elementStart(31,"div",16),S.\u0275\u0275elementStart(32,"div",0),S.\u0275\u0275elementStart(33,"div",1),S.\u0275\u0275elementStart(34,"div"),S.\u0275\u0275template(35,Ml,2,0,"mat-icon",17),S.\u0275\u0275elementStart(36,"div"),S.\u0275\u0275elementStart(37,"h5",11),S.\u0275\u0275text(38,"Mission Project"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(39,"div",13),S.\u0275\u0275template(40,Pl,1,1,"app-view-mission-project",18),S.\u0275\u0275template(41,Dl,1,2,"app-edit-mission-project",19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(42,"div",7),S.\u0275\u0275elementStart(43,"div",8),S.\u0275\u0275elementStart(44,"div",2),S.\u0275\u0275elementStart(45,"div",16),S.\u0275\u0275elementStart(46,"div",0),S.\u0275\u0275elementStart(47,"div",1),S.\u0275\u0275elementStart(48,"div"),S.\u0275\u0275template(49,jl,2,0,"mat-icon",20),S.\u0275\u0275elementStart(50,"div"),S.\u0275\u0275elementStart(51,"h5",11),S.\u0275\u0275text(52,"Mission Expenses"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"div",13),S.\u0275\u0275element(54,"app-view-mission-expenses",21),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e&&(S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate2("",t.mission.missionReference," [",t.mission.missionObject,"]"),S.\u0275\u0275advance(13),S.\u0275\u0275property("ngIf",!t.EditMissionDetails&&!t.forbiddenEditMission),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngIf",!t.EditMissionDetails),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.EditMissionDetails),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.EditMissionDetails),S.\u0275\u0275advance(10),S.\u0275\u0275property("ngIf",!t.displayEditMissionProject&&!t.forbiddenEditMission),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngIf",!t.displayEditMissionProject),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.displayEditMissionProject),S.\u0275\u0275advance(8),S.\u0275\u0275property("ngIf",!t.forbiddenAddMissionExpenses),S.\u0275\u0275advance(5),S.\u0275\u0275property("missionExpenses",t.missionExpenses))},directives:[oe.gM,o.NgIf,il,cl,Re.Hw,hl,vl,gl,bl],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}.card-header[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{float:right;cursor:pointer;font-size:20px}.card-header[_ngcontent-%COMP%]   .edit-mission-ico[_ngcontent-%COMP%]{margin-left:15px}.card-body[_ngcontent-%COMP%]{width:100%;padding:0 20px}.details-card[_ngcontent-%COMP%]{min-height:534px}.btn-circle.btn-xl[_ngcontent-%COMP%]{width:40px;height:40px;padding:8px 10px;border-radius:35px;font-size:18px;line-height:1.33}.btn-circle[_ngcontent-%COMP%]{width:30px;height:30px;padding:6px 0;border-radius:15px;text-align:center;font-size:12px;line-height:1.42857}.material-icons[_ngcontent-%COMP%]{font-size:25px}.icon-pointer[_ngcontent-%COMP%]{cursor:pointer}"]}),e}(),Ol=function(e,t,n,i,r){return{"label-warning":e,"label-primary":t,"label-success":n,"label-danger":i,"label-default":r}},Fl=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}},Al=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.searchFilterService=i,this.activeRoute=r,this.router=a,this.PifVisa=f.CB,this.ProjectStatusLabel=f.tU}return r(e,[{key:"ngOnInit",value:function(){this.state=this.project.state}},{key:"editProject",value:function(e,t){this.projectService.previousState.next({type:"card",pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["../edit/"+e.toString()+"/"+t.toString()],{relativeTo:this.activeRoute})}},{key:"trancateDescription",value:function(e){return null==e?"N/A":e.length>100?e.substr(0,100)+" ...":e}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-project-card"]],inputs:{project:"project"},decls:37,vars:19,consts:[[1,"card"],[1,"card-header"],[1,"thick",2,"display","inline"],[1,"n","f-right"],[1,"label",3,"ngClass"],[1,"card-body"],[1,"row"],[1,"col-sm-12"],[1,"list","list-unstyled","text1"],[1,"thick"],[1,"card-footer"],[1,"task-list-table"],[1,"task-due"],[1,"label","label-pink"],[1,"task-board"],["type","button",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],["matTooltip","Edit",1,"material-icons","pen-icon"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"span",2),S.\u0275\u0275text(3),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(4,"div",3),S.\u0275\u0275elementStart(5,"div"),S.\u0275\u0275elementStart(6,"label",4),S.\u0275\u0275text(7),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(8,"div",5),S.\u0275\u0275elementStart(9,"div",6),S.\u0275\u0275elementStart(10,"div",7),S.\u0275\u0275elementStart(11,"ul",8),S.\u0275\u0275elementStart(12,"li"),S.\u0275\u0275text(13),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(14,"li"),S.\u0275\u0275elementStart(15,"strong",9),S.\u0275\u0275text(16," Customer : "),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(17),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(18,"li"),S.\u0275\u0275elementStart(19,"strong",9),S.\u0275\u0275text(20," Cost : "),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(21),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(22,"li"),S.\u0275\u0275elementStart(23,"strong",9),S.\u0275\u0275text(24," Pif : "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(25,"label",4),S.\u0275\u0275text(26),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"div",10),S.\u0275\u0275elementStart(28,"div",11),S.\u0275\u0275elementStart(29,"p",12),S.\u0275\u0275elementStart(30,"strong",13),S.\u0275\u0275text(31),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(32,"div",14),S.\u0275\u0275elementStart(33,"button",15),S.\u0275\u0275listener("click",function(){return t.editProject(t.project.pifId,t.project.projectId)}),S.\u0275\u0275elementStart(34,"em",16),S.\u0275\u0275text(35,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(36,"br")),2&e&&(S.\u0275\u0275advance(3),S.\u0275\u0275textInterpolate1(" ",t.project.name," "),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction5(9,Ol,t.state===t.ProjectStatusLabel.Completed,t.state===t.ProjectStatusLabel.Planned,t.state===t.ProjectStatusLabel.InProgress,t.state===t.ProjectStatusLabel.Blocked,t.state===t.ProjectStatusLabel.Closed)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(t.state),S.\u0275\u0275advance(6),S.\u0275\u0275textInterpolate(t.trancateDescription(t.project.description)),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate1(" ",t.project.customerName," "),S.\u0275\u0275advance(4),S.\u0275\u0275textInterpolate1(" ",t.project.cost," "),S.\u0275\u0275advance(4),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(15,Fl,t.project.SQAVisa===t.PifVisa.Valid,t.project.SQAVisa===t.PifVisa.Invalid,t.project.SQAVisa===t.PifVisa.InProgress)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",t.project.SQAVisa,""),S.\u0275\u0275advance(5),S.\u0275\u0275textInterpolate1("",t.project.activityName," "))},directives:[o.NgClass,oe.gM],styles:[".thick[_ngcontent-%COMP%]{font-weight:900}.text1[_ngcontent-%COMP%]{font-size:14px}.pen-icon-button[_ngcontent-%COMP%]{width:10px;height:10px}.pen-icon[_ngcontent-%COMP%]{font-size:15px}.card-header[_ngcontent-%COMP%]{padding:13px;border-bottom:1px solid rgba(0,0,0,.125)}.label-pink[_ngcontent-%COMP%]{background:#e83e8c}.card-body[_ngcontent-%COMP%]{padding-bottom:5px}.card-footer[_ngcontent-%COMP%]{padding-top:10px;padding-bottom:10px}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0}.task-board[_ngcontent-%COMP%]{margin-top:0}"]}),e}();function _l(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Name"),S.\u0275\u0275elementEnd())}function Vl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",21),S.\u0275\u0275elementStart(1,"span",22),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.name),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.name)}}function Nl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Activity"),S.\u0275\u0275elementEnd())}function Rl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",21),S.\u0275\u0275elementStart(1,"span",22),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.activityName),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.activityName)}}function Tl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Start Date"),S.\u0275\u0275elementEnd())}function Bl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.plannedStartDate)," ")}}function zl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"End Date"),S.\u0275\u0275elementEnd())}function ql(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.plannedEndDate)," ")}}function Ll(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Customer"),S.\u0275\u0275elementEnd())}function Ql(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",21),S.\u0275\u0275elementStart(1,"span",22),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.customerName),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.customerName," ")}}function $l(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Reference"),S.\u0275\u0275elementEnd())}function Ul(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",21),S.\u0275\u0275elementStart(1,"span",22),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.reference),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.reference," ")}}function Hl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Cost"),S.\u0275\u0275elementEnd())}function Gl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.cost," ")}}function Wl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Pif"),S.\u0275\u0275elementEnd())}var Jl=function(e,t,n){return{"label-success":e,"label-danger":t,"label-primary":n}};function Yl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"label",23),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction3(2,Jl,n.SQAVisa===i.PifVisa.Valid,n.SQAVisa===i.PifVisa.Invalid,n.SQAVisa===i.PifVisa.InProgress)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(n.SQAVisa)}}function Kl(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",20),S.\u0275\u0275text(1,"Status"),S.\u0275\u0275elementEnd())}var Xl=function(e,t,n,i,r){return{"label-warning":e,"label-primary":t,"label-success":n,"label-danger":i,"label-default":r}};function Zl(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"label",23),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit,i=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("ngClass",S.\u0275\u0275pureFunction5(2,Xl,n.state===i.ProjectStatusLabel.Completed,n.state===i.ProjectStatusLabel.Planned,n.state===i.ProjectStatusLabel.InProgress,n.state===i.ProjectStatusLabel.Blocked,n.state===i.ProjectStatusLabel.Closed)),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(n.state)}}function es(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function ts(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",24),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).editProject(e.pifId,e.projectId)}),S.\u0275\u0275elementStart(2,"em",25),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}}function ns(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",26)}function is(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}function rs(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",1),S.\u0275\u0275elementStart(1,"mat-table",2,3),S.\u0275\u0275listener("matSortChange",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onSortData(e)}),S.\u0275\u0275elementContainerStart(3,4),S.\u0275\u0275template(4,_l,2,0,"mat-header-cell",5),S.\u0275\u0275template(5,Vl,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(6,7),S.\u0275\u0275template(7,Nl,2,0,"mat-header-cell",5),S.\u0275\u0275template(8,Rl,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(9,8),S.\u0275\u0275template(10,Tl,2,0,"mat-header-cell",5),S.\u0275\u0275template(11,Bl,3,3,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(12,10),S.\u0275\u0275template(13,zl,2,0,"mat-header-cell",5),S.\u0275\u0275template(14,ql,3,3,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(15,11),S.\u0275\u0275template(16,Ll,2,0,"mat-header-cell",5),S.\u0275\u0275template(17,Ql,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(18,12),S.\u0275\u0275template(19,$l,2,0,"mat-header-cell",5),S.\u0275\u0275template(20,Ul,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(21,13),S.\u0275\u0275template(22,Hl,2,0,"mat-header-cell",5),S.\u0275\u0275template(23,Gl,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(24,14),S.\u0275\u0275template(25,Wl,2,0,"mat-header-cell",5),S.\u0275\u0275template(26,Yl,3,6,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(27,15),S.\u0275\u0275template(28,Kl,2,0,"mat-header-cell",5),S.\u0275\u0275template(29,Zl,3,8,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(30,16),S.\u0275\u0275template(31,es,1,0,"mat-header-cell",17),S.\u0275\u0275template(32,ts,4,0,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(33,ns,1,0,"mat-header-row",18),S.\u0275\u0275template(34,is,1,0,"mat-row",19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("dataSource",i.dataSource),S.\u0275\u0275advance(32),S.\u0275\u0275property("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",i.displayedColumns)}}var as=function(){var e=function(){function e(t,i,r,a){n(this,e),this.projectService=t,this.searchFilterService=i,this.activeRoute=r,this.router=a,this.displayedColumns=["name","activityName","plannedStartDate","plannedEndDate","customerName","reference","cost","sqa","status","buttons"],this.dataSource=new Gn.by,this.PifVisa=f.CB,this.ProjectStatusLabel=f.tU}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.dataSource=new Gn.by(this.projects),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"editProject",value:function(e,t){this.projectService.previousState.next({type:"table",pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize}),this.router.navigate(["../edit/"+e.toString()+"/"+t.toString()],{relativeTo:this.activeRoute})}},{key:"onSortData",value:function(e){this.projectService.sortProjects.next(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-projects-table"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Hn.YE,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.sort=n.first))},inputs:{projects:"projects"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8",4,"ngIf"],[1,"example-container","mat-elevation-z8"],["matSort","","matSortDirection","asc","matSortDisableClear","",3,"dataSource","matSortChange"],["table",""],["matColumnDef","name"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","activityName"],["matColumnDef","plannedStartDate"],[4,"matCellDef"],["matColumnDef","plannedEndDate"],["matColumnDef","customerName"],["matColumnDef","reference"],["matColumnDef","cost"],["matColumnDef","sqa"],["matColumnDef","status"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],[1,"label",3,"ngClass"],["type","button",1,"btn","btn-mini","btn-primary","ripple","light",3,"click"],["matTooltip","edit",1,"material-icons"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&S.\u0275\u0275template(0,rs,35,4,"div",0),2&e&&S.\u0275\u0275property("ngIf",void 0!==t.projects&&0!==t.projects.length)},directives:[o.NgIf,Gn.BZ,Hn.YE,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,o.NgClass,Gn.XQ,Gn.Gk],pipes:[Te.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.material-icons[_ngcontent-%COMP%]{font-size:15px}table[_ngcontent-%COMP%]{width:100%}.mat-column-name[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 25%!important;width:25%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-activityName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 10%!important;width:10%!important;overflow-wrap:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-plannedStartDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-plannedEndDate[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-customerName[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 17%!important;width:17%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-reference[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 8%!important;width:8%!important;overflow-wrap:break-word;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-cost[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 5%!important;width:5%!important;overflow-wrap:break-word;word-break:break-word;text-align:right;justify-content:flex-end;-webkit-hyphens:auto;hyphens:auto}.mat-column-status[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 7%!important;width:7%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-sqa[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 7%!important;width:7%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}.mat-column-buttons[_ngcontent-%COMP%]{word-wrap:break-word!important;white-space:unset!important;flex:0 0 5%!important;width:5%!important;overflow-wrap:break-word;justify-content:center;word-break:break-word;-webkit-hyphens:auto;hyphens:auto}  .mat-sort-header-arrow{color:#fff}"]}),e}();function os(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"button",40),S.\u0275\u0275listener("click",function(){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().addProject()}),S.\u0275\u0275element(1,"em",41),S.\u0275\u0275text(2," Project "),S.\u0275\u0275elementEnd()}}function ls(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"h1"),S.\u0275\u0275text(2,"No Result Found"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function ss(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",42),S.\u0275\u0275elementStart(1,"div",43),S.\u0275\u0275elementStart(2,"div",44),S.\u0275\u0275elementStart(3,"div",1),S.\u0275\u0275elementStart(4,"div",45),S.\u0275\u0275element(5,"mat-spinner"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function cs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",48),S.\u0275\u0275element(1,"app-project-card",49),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275property("project",n)}}function ds(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",46),S.\u0275\u0275template(1,cs,2,1,"div",47),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275classProp("blurred",n.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind3(2,3,n.projects,n.searchFilterService.pageIndex,n.searchFilterService.pageSize))}}function ms(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",50),S.\u0275\u0275element(1,"app-projects-table",51),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275classProp("blurred",n.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("projects",S.\u0275\u0275pipeBind3(2,3,n.projects,n.searchFilterService.pageIndex,n.searchFilterService.pageSize))}}var ps=function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.sortService=t,this.projectService=i,this.searchFilterService=r,this.dateTimeService=a,this.router=o,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.cardView=!0,this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.customersIdentifiers=[],this.selectedCustomersIdentifiers=[],this.statusIdentifiers=[],this.selectedStatusesIdentifiers=[],this.projectName="",this.dropdownSettings={},this.dropdownSettingsState={},this.subscription=new p.w0,this.sqaStates=[{id:f.Es.InProgress,description:f.CB.InProgress},{id:f.Es.Valid,description:f.CB.Valid},{id:f.Es.Invalid,description:f.CB.Invalid}],this.selectedSqaStates=[],this.myProjects=!1,this.destroyed=new p.xQ}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.searchFilterService.pageSize=24;var t=JSON.parse(sessionStorage.getItem("projectSearch"));null!==t&&(this.projectName=t.projectName,this.selectedActivitiesIdentifiers=t.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),this.selectedCustomersIdentifiers=t.selectedCustomersIdentifiers,this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.selectedStatusesIdentifiers=t.selectedStatusesIdentifiers,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),this.selectedSqaStates=t.selectedSqaStates,this.selectedSqaStatusesIds=this.selectedSqaStates.map(function(e){return e.description}).join(","),null!=t.periodFrom&&(this.searchFilterService.periodFrom=t.periodFrom),null!=t.periodTo&&(this.searchFilterService.periodTo=t.periodTo),this.myProjects=t.myProjects),this.subscription.add(this.projectService.previousState.pipe((0,ze.R)(this.destroyed)).subscribe(function(t){t&&t.getPrevious&&(e.searchButton(),e.searchFilterService.pageSize=t.pageSize,e.searchFilterService.pageIndex=t.pageIndex,e.cardView="card"===t.type,e.destroyed.next(),e.projectService.previousState.next())})),this.subscription.add(this.projectService.sortProjects.subscribe(function(t){e.onSortData(t)})),this.user=JSON.parse(localStorage.getItem("currentUser")),this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownSettingsState={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.selectedSqaStatusesIds=this.selectedSqaStates.map(function(e){return e.id}).join(","),this.getActivities(),this.getClients(),this.getStatuses()}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.searchFilterService.showingDataLastFilter=[],this.searchFilterService.periodFrom=null,this.searchFilterService.periodTo=null}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){if(null!=t&&(e.activitiesIdentifiers=t,e.selectedActivitiesIds=e.activitiesIdentifiers.map(function(e){return e.id}).join(","),e.onChangeActivity(e.selectedActivitiesIds),null===JSON.parse(sessionStorage.getItem("projectSearch")))){var n=[];e.activitiesIdentifiers.find(function(t){return t.id===e.user.activityId})&&(n.push(e.activitiesIdentifiers.find(function(t){return t.id===e.user.activityId})),e.selectedActivitiesIdentifiers=n)}})}},{key:"getStatuses",value:function(){var e=this;this.projectService.getProjectStates().subscribe(function(t){null!=t&&(e.statusIdentifiers=t,null===JSON.parse(sessionStorage.getItem("projectSearch"))&&(e.selectedStatusesIdentifiers=e.statusIdentifiers.filter(function(e){return e.id===f.kJ.Planned||e.id===f.kJ.InProgress})))})}},{key:"getClients",value:function(){var e=this;this.projectService.getClients().subscribe(function(t){null!=t&&(e.customersIdentifiers=t,null===e.selectedCustomersIds||e.selectedCustomersIds||(e.selectedCustomersIds=e.customersIdentifiers.map(function(e){return e.id}).join(","),e.onChangeCustomer(e.selectedCustomersIds)))})}},{key:"onResetName",value:function(){this.projectName=void 0}},{key:"onResetStatus",value:function(){this.selectedStatusesIdentifiers=this.statusIdentifiers.filter(function(e){return e.id===f.kJ.Planned||e.id===f.kJ.InProgress})}},{key:"onResetSqaStatus",value:function(){this.selectedSqaStates=[]}},{key:"onResetCustomers",value:function(){this.selectedCustomersIdentifiers=[]}},{key:"onResetStartDateRange",value:function(){this.searchFilterService.periodFrom=null}},{key:"onResetEndDateRange",value:function(){this.searchFilterService.periodTo=null}},{key:"onResetActivity",value:function(){var e=this,t=[];t.push(this.activitiesIdentifiers.find(function(t){return t.id===e.user.activityId})),this.selectedActivitiesIdentifiers=t}},{key:"onResetMyProjects",value:function(){this.myProjects=!1}},{key:"onResetAllFilters",value:function(){sessionStorage.removeItem("projectSearch"),this.onResetName(),this.onResetCustomers(),this.onResetStatus(),this.onResetSqaStatus(),this.onResetStartDateRange(),this.onResetEndDateRange(),this.onResetActivity(),this.onResetMyProjects()}},{key:"onViewModeCard",value:function(){this.cardView=!0}},{key:"onViewModeTable",value:function(){this.cardView=!1}},{key:"onChangeActivity",value:function(e){this.selectedActivitiesIds=e}},{key:"onChangeCustomer",value:function(e){this.selectedCustomersIds=e}},{key:"onChangeStatus",value:function(e){this.selectedStatusesIds=e}},{key:"searchButton",value:function(){this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),this.selectedSqaStatusesIds=this.selectedSqaStates.map(function(e){return e.description}).join(","),this.selectedCustomersIds=this.selectedCustomersIdentifiers.map(function(e){return e.id}).join(","),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),this.user=JSON.parse(localStorage.getItem("currentUser"));var e=new f.bA;e.projectName=this.projectName,e.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,e.selectedCustomersIdentifiers=this.selectedCustomersIdentifiers,e.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,e.selectedSqaStates=this.selectedSqaStates,e.periodFrom=this.searchFilterService.periodFrom,e.periodTo=this.searchFilterService.periodTo,e.myProjects=this.myProjects,sessionStorage.setItem("projectSearch",JSON.stringify(e)),this.getProjects(e)}},{key:"getProjects",value:function(e){var t=this,n=this.user.groupId===v.Fl.SuperAdmin||this.user.groupId===v.Fl.Finance||this.user.groupId===v.Fl.Facturation||this.user.activityId===v.RS.Quality||this.user.qualification===v._W.DepartmentHead,i=this.user.qualification===v._W.Director,r=this.user.qualification===v._W.Engineer||this.user.qualification===v._W.ProjectManager||this.user.groupId===v.Fl.ProjectManager||this.user.groupId===v.Fl.TeamLeader||this.user.groupId===v.Fl.Developer||this.user.groupId===v.Fl.Validator;this.searchFilterService.pageIndex=0,this.isLoading=!0,!0===this.myProjects||!n&&r?this.projectService.getMemberProjects(this.user.userId,e).subscribe(function(e){t.refreshProjects(e)}):n?this.projectService.getProjects(e).subscribe(function(e){t.refreshProjects(e)}):i&&this.projectService.getActivityProjects(this.user.userId,this.user.activityId,e).subscribe(function(e){t.refreshProjects(e)})}},{key:"refreshProjects",value:function(e){this.isLoading=!1,this.projects=e,this.lengthProjects=this.projects.length,this.setProjectStatus()}},{key:"addProject",value:function(){this.router.navigate(["project-management/project/add"])}},{key:"addIsVisible",value:function(){return-1!==this.user.functionsId.indexOf(v.FI.AddProject)}},{key:"onClickingEnter",value:function(e){"Enter"===e.key&&this.searchButton()}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.projects&&this.projects.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"name":return t.sortService.compare(n.name,i.name,r,!1);case"activityName":return t.sortService.compare(n.activityName,i.activityName,r,!1);case"plannedStartDate":return t.sortService.compare(n.plannedStartDate,i.plannedStartDate,r,!1);case"plannedEndDate":return t.sortService.compare(n.plannedEndDate,i.plannedEndDate,r,!1);case"customerName":return t.sortService.compare(n.customerName,i.customerName,r,!1);case"reference":return t.sortService.compare(n.reference,i.reference,r,!1);case"cost":return t.sortService.compare(n.cost,i.cost,r,!0);case"sqa":return t.sortService.compare(n.SQAVisa,i.SQAVisa,r,!1);case"status":return t.sortService.compare(n.state,i.state,r,!1);default:return 0}}),this.paginatorPipe.transform(this.projects,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"setProjectStatus",value:function(){this.projects&&this.projects.forEach(function(e){switch(e.statusId){case f.kJ.InProgress:e.state=f.tU.InProgress;break;case f.kJ.Blocked:e.state=f.tU.Blocked;break;case f.kJ.Closed:e.state=f.tU.Closed;break;case f.kJ.Planned:e.state=f.tU.Planned;break;case f.kJ.Completed:e.state=f.tU.Completed}})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-projects"]],decls:75,vars:34,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From",3,"matDatepicker","max","ngModel","keypress","ngModelChange"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To",3,"matDatepicker","min","ngModel","keypress","ngModelChange"],["picker22",""],[1,"search-input","col-sm-7"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","keydown","ngModelChange"],[1,"col-sm-3"],[3,"ngModel","ngModelChange"],[1,"col-sm-10"],[1,"multi-search",2,"width","120%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"multi-search",2,"width","100%",3,"placeholder","settings","data","ngModel","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"nav-item","nav-grid","col-sm-4"],["type","button","data-toggle","tooltip","data-placement","top","matTooltip","Card View",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-listine-dots"],["type","button","data-toggle","tooltip","data-placement","top","matTooltip","Table View",1,"btn","btn-sm","btn-primary","ripple","light",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-table"],["type","button","class","btn btn-sm btn-primary waves-light m-r-10 ripple","style","font-size:inherit;",3,"click",4,"ngIf"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","row div-scrollable loaded-content",3,"blurred",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"row","div-scrollable","loaded-content"],["class","col-sm-4 p-r-0",4,"ngFor","ngForOf"],[1,"col-sm-4","p-r-0"],[3,"project"],[1,"loaded-content"],[3,"projects"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"div",1),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"mat-list"),S.\u0275\u0275elementStart(8,"mat-list-item"),S.\u0275\u0275elementStart(9,"h3",6),S.\u0275\u0275text(10,"Period"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"mat-form-field",7),S.\u0275\u0275elementStart(12,"input",8),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.searchFilterService.periodFrom=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(13,"mat-datepicker-toggle",9),S.\u0275\u0275element(14,"mat-datepicker",null,10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",7),S.\u0275\u0275elementStart(17,"input",11),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.searchFilterService.periodTo=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(18,"mat-datepicker-toggle",9),S.\u0275\u0275element(19,"mat-datepicker",null,12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"mat-list-item"),S.\u0275\u0275elementStart(22,"h3",6),S.\u0275\u0275text(23,"Project"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",13),S.\u0275\u0275elementStart(25,"input",14),S.\u0275\u0275listener("keydown",function(e){return t.onClickingEnter(e)})("ngModelChange",function(e){return t.projectName=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",15),S.\u0275\u0275elementStart(27,"mat-checkbox",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.myProjects=e}),S.\u0275\u0275text(28," Mines "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"div",5),S.\u0275\u0275elementStart(30,"mat-list"),S.\u0275\u0275elementStart(31,"mat-list-item"),S.\u0275\u0275elementStart(32,"h3",6),S.\u0275\u0275text(33,"Activity"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(34,"div",17),S.\u0275\u0275elementStart(35,"ng-multiselect-dropdown",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedActivitiesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-list-item"),S.\u0275\u0275elementStart(37,"h3",6),S.\u0275\u0275text(38,"Customer"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(39,"div",17),S.\u0275\u0275elementStart(40,"ng-multiselect-dropdown",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedCustomersIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(41,"div",19),S.\u0275\u0275elementStart(42,"mat-list"),S.\u0275\u0275elementStart(43,"mat-list-item"),S.\u0275\u0275elementStart(44,"h3",6),S.\u0275\u0275text(45,"Status"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(46,"div",17),S.\u0275\u0275elementStart(47,"ng-multiselect-dropdown",20),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"mat-list-item"),S.\u0275\u0275elementStart(49,"h3",6),S.\u0275\u0275text(50,"Pif "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(51,"div",17),S.\u0275\u0275elementStart(52,"ng-multiselect-dropdown",21),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedSqaStates=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"div",22),S.\u0275\u0275elementStart(54,"div",23),S.\u0275\u0275elementStart(55,"button",24),S.\u0275\u0275listener("click",function(){return t.searchButton()}),S.\u0275\u0275text(56,"Search"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"div",23),S.\u0275\u0275elementStart(58,"button",25),S.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),S.\u0275\u0275text(59,"Reset"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(60,"nav",26),S.\u0275\u0275elementStart(61,"div",27),S.\u0275\u0275elementStart(62,"button",28),S.\u0275\u0275listener("click",function(){return t.onViewModeCard()}),S.\u0275\u0275element(63,"em",29),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(64,"button",30),S.\u0275\u0275listener("click",function(){return t.onViewModeTable()}),S.\u0275\u0275element(65,"em",31),S.\u0275\u0275elementEnd(),S.\u0275\u0275text(66," \xa0 "),S.\u0275\u0275template(67,os,3,0,"button",32),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(68,"div",33),S.\u0275\u0275element(69,"app-paginator",34),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(70,ls,3,0,"div",35),S.\u0275\u0275elementStart(71,"div",36),S.\u0275\u0275template(72,ss,6,0,"div",37),S.\u0275\u0275template(73,ds,3,7,"div",38),S.\u0275\u0275template(74,ms,3,7,"div",39),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(15),i=S.\u0275\u0275reference(20);S.\u0275\u0275advance(12),S.\u0275\u0275property("matDatepicker",n)("max",t.searchFilterService.periodTo)("ngModel",t.searchFilterService.periodFrom),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(4),S.\u0275\u0275property("matDatepicker",i)("min",t.searchFilterService.periodFrom)("ngModel",t.searchFilterService.periodTo),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(7),S.\u0275\u0275property("ngModel",t.projectName),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.myProjects),S.\u0275\u0275advance(8),S.\u0275\u0275property("placeholder","Select...")("data",t.activitiesIdentifiers)("ngModel",t.selectedActivitiesIdentifiers)("settings",t.dropdownSettings),S.\u0275\u0275advance(5),S.\u0275\u0275property("placeholder","Select...")("data",t.customersIdentifiers)("ngModel",t.selectedCustomersIdentifiers)("settings",t.dropdownSettings),S.\u0275\u0275advance(7),S.\u0275\u0275property("placeholder","Select...")("data",t.statusIdentifiers)("ngModel",t.selectedStatusesIdentifiers)("settings",t.dropdownSettingsState),S.\u0275\u0275advance(5),S.\u0275\u0275property("placeholder","Select...")("settings",t.dropdownSettingsState)("data",t.sqaStates)("ngModel",t.selectedSqaStates),S.\u0275\u0275advance(15),S.\u0275\u0275property("ngIf",t.addIsVisible()),S.\u0275\u0275advance(2),S.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthProjects),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",0===t.lengthProjects),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.cardView),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",!t.cardView)}},directives:[Co.i$,Co.Tg,E.KE,x.Nt,w.hl,c.DefaultValueAccessor,c.NgControlStatus,c.NgModel,w.nW,E.R9,w.Mq,dl.oG,Eo.OP,bt.M2,oe.gM,o.NgIf,Un.J,Qn.$g,o.NgForOf,Al,as],pipes:[Ti.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-divider{margin-top:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.div-scrollable{overflow-y:auto;margin-right:0;max-height:calc(100vh - 392px)}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}.mat-checkbox-layout{margin-bottom:0}.mat-checkbox-layout .mat-checkbox-label{font-size:15px;font-weight:bolder;color:#0000008a}\n"],encapsulation:2}),e}();function us(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1,"Reference"),S.\u0275\u0275elementEnd())}function fs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275elementStart(1,"span",19),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.referenceCode),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate(n.referenceCode)}}function hs(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1,"Title"),S.\u0275\u0275elementEnd())}function vs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275elementStart(1,"span",19),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.title),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.title," ")}}function gs(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1,"Edition"),S.\u0275\u0275elementEnd())}function Ss(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.edition," ")}}function ys(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1,"Date"),S.\u0275\u0275elementEnd())}function bs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275pipe(2,"shortDate"),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",S.\u0275\u0275pipeBind1(2,1,n.creationDate)," ")}}function Cs(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1," Status"),S.\u0275\u0275elementEnd())}function Es(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.state," ")}}function xs(e,t){1&e&&(S.\u0275\u0275elementStart(0,"mat-header-cell",17),S.\u0275\u0275text(1," Type"),S.\u0275\u0275elementEnd())}function Is(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-cell",18),S.\u0275\u0275elementStart(1,"span",19),S.\u0275\u0275text(2),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275propertyInterpolate("matTooltip",n.type),S.\u0275\u0275advance(2),S.\u0275\u0275textInterpolate1(" ",n.type," ")}}function ws(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-cell")}function Ms(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"mat-cell"),S.\u0275\u0275elementStart(1,"button",20),S.\u0275\u0275listener("click",function(){var e=S.\u0275\u0275restoreView(n).$implicit;return S.\u0275\u0275nextContext(2).navigateToEdit(e)}),S.\u0275\u0275elementStart(2,"em",21),S.\u0275\u0275text(3,"edit"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=t.$implicit,r=S.\u0275\u0275nextContext(2);S.\u0275\u0275advance(1),S.\u0275\u0275property("disabled",!r.isEditable(i))}}function Ps(e,t){1&e&&S.\u0275\u0275element(0,"mat-header-row",22)}function Ds(e,t){1&e&&S.\u0275\u0275element(0,"mat-row")}function js(e,t){if(1&e){var n=S.\u0275\u0275getCurrentView();S.\u0275\u0275elementStart(0,"div",1),S.\u0275\u0275listener("matSortChange",function(e){return S.\u0275\u0275restoreView(n),S.\u0275\u0275nextContext().onSortData(e)}),S.\u0275\u0275elementStart(1,"mat-table",2,3),S.\u0275\u0275elementContainerStart(3,4),S.\u0275\u0275template(4,us,2,0,"mat-header-cell",5),S.\u0275\u0275template(5,fs,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(6,7),S.\u0275\u0275template(7,hs,2,0,"mat-header-cell",5),S.\u0275\u0275template(8,vs,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(9,8),S.\u0275\u0275template(10,gs,2,0,"mat-header-cell",5),S.\u0275\u0275template(11,Ss,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(12,10),S.\u0275\u0275template(13,ys,2,0,"mat-header-cell",5),S.\u0275\u0275template(14,bs,3,3,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(15,11),S.\u0275\u0275template(16,Cs,2,0,"mat-header-cell",5),S.\u0275\u0275template(17,Es,2,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(18,12),S.\u0275\u0275template(19,xs,2,0,"mat-header-cell",5),S.\u0275\u0275template(20,Is,3,2,"mat-cell",6),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275elementContainerStart(21,13),S.\u0275\u0275template(22,ws,1,0,"mat-header-cell",14),S.\u0275\u0275template(23,Ms,4,1,"mat-cell",9),S.\u0275\u0275elementContainerEnd(),S.\u0275\u0275template(24,Ps,1,0,"mat-header-row",15),S.\u0275\u0275template(25,Ds,1,0,"mat-row",16),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()}if(2&e){var i=S.\u0275\u0275nextContext();S.\u0275\u0275advance(1),S.\u0275\u0275property("dataSource",i.dataSource),S.\u0275\u0275advance(23),S.\u0275\u0275property("matHeaderRowDef",i.displayedColumns)("matHeaderRowDefSticky",!0),S.\u0275\u0275advance(1),S.\u0275\u0275property("matRowDefColumns",i.displayedColumns)}}var ks=function(){var e=function(){function e(t,i,r,a){n(this,e),this.searchFilterService=t,this.referenceService=i,this.router=r,this.route=a,this.displayedColumns=["referenceCode","title","edition","creationDate","state","type","buttons"],this.dataSource=new Gn.by,this.listView=!1}return r(e,[{key:"ngOnInit",value:function(){var e=this;0!==this.references.length&&(this.listView=!0),this.dataSource=new Gn.by(this.references),this.subscription=this.searchFilterService.resultChanged.subscribe(function(){e.dataSource=new Gn.by(e.searchFilterService.showingDataLastFilter)})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"onSortData",value:function(e){this.referenceService.sortReferences.next(e)}},{key:"navigateToEdit",value:function(e){this.router.navigate(["/project-management/project/edit-reference/"+e.referenceId.toString()]),this.referenceService.savedReference.next({getPrevious:!1,pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize})}},{key:"isEditable",value:function(e){return e.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.nJ),S.\u0275\u0275directiveInject(h.q8),S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(s.gz))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-references-table"]],inputs:{references:"references"},decls:1,vars:1,consts:[["class","example-container mat-elevation-z8","matSort","","matSortDirection","asc","matSortDisableClear","",3,"matSortChange",4,"ngIf"],["matSort","","matSortDirection","asc","matSortDisableClear","",1,"example-container","mat-elevation-z8",3,"matSortChange"],[3,"dataSource"],["table",""],["matColumnDef","referenceCode"],["mat-sort-header","",4,"matHeaderCellDef"],[3,"matTooltip",4,"matCellDef"],["matColumnDef","title"],["matColumnDef","edition"],[4,"matCellDef"],["matColumnDef","creationDate"],["matColumnDef","state"],["matColumnDef","type"],["matColumnDef","buttons"],[4,"matHeaderCellDef"],["class"," table-primary table-*",4,"matHeaderRowDef","matHeaderRowDefSticky"],[4,"matRowDef","matRowDefColumns"],["mat-sort-header",""],[3,"matTooltip"],[1,"span-ellipsis"],["type","button","matTooltip","Edit reference",1,"btn","btn-mini","btn-primary","ripple","light",3,"disabled","click"],[1,"material-icons"],[1,"table-primary","table-*"]],template:function(e,t){1&e&&S.\u0275\u0275template(0,js,26,4,"div",0),2&e&&S.\u0275\u0275property("ngIf",t.listView)},directives:[o.NgIf,Hn.YE,Gn.BZ,Gn.w1,Gn.fO,Gn.Dz,Gn.as,Gn.nj,Gn.ge,Hn.nU,Gn.ev,oe.gM,Gn.XQ,Gn.Gk],pipes:[Te.M],styles:[".mat-table[_ngcontent-%COMP%]{overflow:auto;border-radius:4px;max-height:calc(100vh - 392px)}.table[_ngcontent-%COMP%]{width:100%}.material-icons[_ngcontent-%COMP%]{font-size:15px}.mat-header-cell[_ngcontent-%COMP%]{color:#fff;font-size:15px;font-weight:600}.span-ellipsis[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.mat-column-referenceCode[_ngcontent-%COMP%]{flex:0 0 20%!important;width:20%!important}.mat-column-title[_ngcontent-%COMP%]{flex:0 0 26%!important;width:26%!important}.mat-column-edition[_ngcontent-%COMP%]{flex:0 0 5%!important;width:5%!important;justify-content:center}.mat-column-creationDate[_ngcontent-%COMP%]{flex:0 0 10%!important;width:10%!important;justify-content:center}.mat-column-state[_ngcontent-%COMP%]{flex:0 0 8%!important;width:8%!important;justify-content:center}.mat-column-type[_ngcontent-%COMP%]{flex:0 0 25%!important;width:25%!important}.mat-column-buttons[_ngcontent-%COMP%]{flex:4 0 5%!important;width:5%!important;justify-content:center}  .mat-sort-header-arrow{color:#fff}"]}),e}();function Os(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div"),S.\u0275\u0275elementStart(1,"h1"),S.\u0275\u0275text(2,"No Result Found"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function Fs(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",33),S.\u0275\u0275elementStart(1,"div",34),S.\u0275\u0275elementStart(2,"div",35),S.\u0275\u0275elementStart(3,"div",1),S.\u0275\u0275elementStart(4,"div",36),S.\u0275\u0275element(5,"mat-spinner"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())}function As(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",37),S.\u0275\u0275element(1,"app-references-table",38),S.\u0275\u0275pipe(2,"paginator"),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275nextContext();S.\u0275\u0275classProp("blurred",n.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("references",S.\u0275\u0275pipeBind3(2,3,n.references,n.searchFilterService.pageIndex,n.searchFilterService.pageSize))}}var _s=function(){var e=function(){function e(t,i,r,a,o,l,s){n(this,e),this.notificationService=t,this.dateTimeService=i,this.sortService=r,this.referenceService=a,this.projectService=o,this.router=l,this.searchFilterService=s,this.paginatorPipe=new $n.Ry(this.searchFilterService),this.statusesIdentifiers=[],this.selectedStatusesIdentifiers=[],this.typesIdentifiers=[],this.selectedTypesIdentifiers=[],this.activitiesIdentifiers=[],this.selectedActivitiesIdentifiers=[],this.referenceCode="",this.title="",this.dropdownSettings={},this.dropdownStatusSettings={},this.references=[],this.listView=!1,this.destroyed=new p.xQ}return r(e,[{key:"ngOnInit",value:function(){var e=this;this.getStatuses(),this.getTypes(),this.getActivities(),this.searchFilterService.pageIndex=0,this.searchFilterService.pageSize=24,this.dropdownSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!0,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.dropdownStatusSettings={singleSelection:!1,idField:"id",textField:"description",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:1,enableCheckAll:!0,allowSearchFilter:!1,maxHeight:150,placeholder:"criteria",searchPlaceholderText:"Search..."},this.subscription=this.referenceService.sortReferences.subscribe(function(t){e.onSortData(t)}),this.periodTo=this.dateTimeService.today(),this.periodFrom=this.dateTimeService.getFirstDayFromPreviousMonth();var t=JSON.parse(sessionStorage.getItem("referenceSearch"));null!==t&&(this.title=t.title,this.referenceCode=t.referenceCode,this.selectedStatusesIdentifiers=t.selectedStatusesIdentifiers,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),this.selectedTypesIdentifiers=t.selectedTypesIdentifiers,this.selectedTypesIds=this.selectedTypesIdentifiers.map(function(e){return e.id}).join(","),this.selectedActivitiesIdentifiers=t.selectedActivitiesIdentifiers,this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(","),null!=t.periodFrom&&(this.periodFrom=t.periodFrom),null!=t.periodTo&&(this.periodTo=t.periodTo)),this.refreshSubscription=this.referenceService.savedReference.pipe((0,ze.R)(this.destroyed)).subscribe(function(t){t&&!0===t.getPrevious&&(e.searchButton(),e.searchFilterService.pageSize=t.pageSize,e.searchFilterService.pageIndex=t.pageIndex,e.destroyed.next(),e.referenceService.savedReference.next())})}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe(),this.refreshSubscription.unsubscribe(),this.searchFilterService.showingDataLastFilter=[]}},{key:"onResetAllFilters",value:function(){this.onResetTitle(),this.onResetReference(),this.onResetStatus(),this.onResetType(),this.onResetStartDateRange(),this.onResetEndDateRange(),this.onResetActivity()}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){if(null!=t&&(e.activitiesIdentifiers=t,e.selectedActivitiesIds=e.activitiesIdentifiers.map(function(e){return e.id}).join(","),null===JSON.parse(sessionStorage.getItem("referenceSearch")))){var n=[];e.activitiesIdentifiers.find(function(e){return e.id===JSON.parse(localStorage.getItem("currentUser")).activityId})&&(n.push(e.activitiesIdentifiers.find(function(e){return e.id===JSON.parse(localStorage.getItem("currentUser")).activityId})),e.selectedActivitiesIdentifiers=n)}})}},{key:"getStatuses",value:function(){var e=this;this.referenceService.getDocumentStates().subscribe(function(t){null!=t&&(e.statusesIdentifiers=t,null!=e.selectedStatusesIds&&(e.selectedStatusesIds=e.statusesIdentifiers.map(function(e){return e.id}).join(",")))})}},{key:"getTypes",value:function(){var e=this;this.referenceService.getTypesDocuments().subscribe(function(t){null!=t&&(e.typesIdentifiers=t,null==e.selectedTypesIds||(e.selectedTypesIds=e.typesIdentifiers.map(function(e){return e.id}).join(",")))})}},{key:"onResetTitle",value:function(){this.title=void 0}},{key:"onResetActivity",value:function(){var e=[];e.push(this.activitiesIdentifiers.find(function(e){return e.id===JSON.parse(localStorage.getItem("currentUser")).activityId})),this.selectedActivitiesIdentifiers=e,sessionStorage.removeItem("referenceSearch")}},{key:"onResetReference",value:function(){this.referenceCode=void 0}},{key:"onResetStatus",value:function(){this.selectedStatusesIdentifiers=[]}},{key:"onResetType",value:function(){this.selectedTypesIdentifiers=[]}},{key:"onResetStartDateRange",value:function(){this.periodFrom=this.dateTimeService.getFirstDayFromPreviousMonth()}},{key:"onResetEndDateRange",value:function(){this.periodTo=this.dateTimeService.today()}},{key:"searchButton",value:function(){var e=this;if(null!==this.periodFrom&&null!==this.periodTo){this.searchFilterService.pageIndex=0,this.selectedStatusesIds=this.selectedStatusesIdentifiers.map(function(e){return e.id}).join(","),this.selectedTypesIds=this.selectedTypesIdentifiers.map(function(e){return e.id}).join(","),this.selectedActivitiesIds=this.selectedActivitiesIdentifiers.map(function(e){return e.id}).join(",");var t=new f.oU;t.title=this.title,t.referenceCode=this.referenceCode,t.selectedStatusesIdentifiers=this.selectedStatusesIdentifiers,t.selectedTypesIdentifiers=this.selectedTypesIdentifiers,t.selectedActivitiesIdentifiers=this.selectedActivitiesIdentifiers,t.periodFrom=this.periodFrom,t.periodTo=this.periodTo,sessionStorage.setItem("referenceSearch",JSON.stringify(t)),this.isLoading=!0,this.referenceService.getReferencesProjects(this.title,this.referenceCode,this.selectedStatusesIds,this.selectedTypesIds,this.selectedActivitiesIds,this.periodFrom,this.periodTo).subscribe(function(t){e.isLoading=!1,e.references=t,e.lengthReferences=e.references.length,e.listView=0!==t.length})}else this.notificationService.danger("Please fill dates fields")}},{key:"onClickingEnter",value:function(e){"Enter"===e.key&&this.searchButton()}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}},{key:"onSortData",value:function(e){var t=this;e.active&&""!==e.direction&&void 0!==this.references&&this.references.sort(function(n,i){var r="asc"===e.direction;switch(e.active){case"referenceCode":return t.sortService.compare(n.referenceCode,i.referenceCode,r,!1);case"title":return t.sortService.compare(n.title,i.title,r,!1);case"edition":return t.sortService.compare(n.edition,i.edition,r,!0);case"creationDate":return t.sortService.compare(n.creationDate,i.creationDate,r,!1);case"state":return t.sortService.compare(n.state,i.state,r,!1);case"type":return t.sortService.compare(n.type,i.type,r,!1);default:return 0}}),this.paginatorPipe.transform(this.references,this.searchFilterService.pageIndex,this.searchFilterService.pageSize)}},{key:"AddReference",value:function(){this.router.navigate(["/project-management/project/add-reference"]),void 0!==this.lengthReferences&&0!==this.lengthReferences&&this.referenceService.savedReference.next({getPrevious:!1,pageIndex:this.searchFilterService.pageIndex,pageSize:this.searchFilterService.pageSize})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(u.Kx),S.\u0275\u0275directiveInject(h.q8),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(u.nJ))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-references"]],decls:68,vars:28,consts:[[1,"page-body"],[1,"row"],[1,"col-xl-12","col-lg-12","filter-bar"],[1,"card","m-b-10"],[1,"card-body","p-t-10"],[1,"col-xl-4","col-lg-12"],[1,"mat-subheader","col-sm-2"],[1,"date-field","col-sm-5"],["matInput","","placeholder","From","required","",3,"matDatepicker","max","ngModel","keypress","ngModelChange","keydown"],["matSuffix","",3,"for"],["picker11",""],["matInput","","placeholder","To","required","",3,"matDatepicker","min","ngModel","keypress","ngModelChange","keydown"],["picker22",""],[1,"search-input","col-sm-10"],["placeholder","Search here...","matInput","","name","searchInput",3,"ngModel","ngModelChange","keydown"],[1,"col-sm-10"],[1,"multi-search",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-3","col-lg-12"],[1,"multi-search",2,"width","100%",3,"placeholder","data","ngModel","settings","ngModelChange"],[1,"col-xl-1","col-lg-12"],[1,"text-center"],[1,"btn","btn-md","btn-primary","ripple","m-t-5",3,"click"],[1,"btn","btn-md","btn-default","ripple","light","m-t-10",3,"click"],[1,"navbar","navbar-light","bg-faded","m-b-10","p-10"],[1,"col-sm-4"],["type","button",1,"btn","btn-sm","btn-primary","waves-light","m-r-10","ripple",2,"font-size","inherit",3,"click"],[1,"icofont","icofont-plus"],[1,"col-sm-8"],[3,"pageSize","pageIndex","length"],[4,"ngIf"],[1,"wrapper"],["class","overlay",4,"ngIf"],["class","loaded-content",3,"blurred",4,"ngIf"],[1,"overlay"],[1,"spinner-wrapper"],[1,"container"],["id","loader"],[1,"loaded-content"],[3,"references"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"div",1),S.\u0275\u0275elementStart(6,"div",5),S.\u0275\u0275elementStart(7,"mat-list"),S.\u0275\u0275elementStart(8,"mat-list-item"),S.\u0275\u0275elementStart(9,"h3",6),S.\u0275\u0275text(10,"Period"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(11,"mat-form-field",7),S.\u0275\u0275elementStart(12,"input",8),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.periodFrom=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(13,"mat-datepicker-toggle",9),S.\u0275\u0275element(14,"mat-datepicker",null,10),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",7),S.\u0275\u0275elementStart(17,"input",11),S.\u0275\u0275listener("keypress",function(e){return t.dateOnly(e)})("ngModelChange",function(e){return t.periodTo=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(18,"mat-datepicker-toggle",9),S.\u0275\u0275element(19,"mat-datepicker",null,12),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(21,"mat-list-item"),S.\u0275\u0275elementStart(22,"h3",6),S.\u0275\u0275text(23,"Ref."),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(24,"mat-form-field",13),S.\u0275\u0275elementStart(25,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.referenceCode=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(26,"div",5),S.\u0275\u0275elementStart(27,"mat-list"),S.\u0275\u0275elementStart(28,"mat-list-item"),S.\u0275\u0275elementStart(29,"h3",6),S.\u0275\u0275text(30,"Activity"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(31,"div",15),S.\u0275\u0275elementStart(32,"ng-multiselect-dropdown",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedActivitiesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(33,"mat-list-item"),S.\u0275\u0275elementStart(34,"h3",6),S.\u0275\u0275text(35,"Title"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"mat-form-field",13),S.\u0275\u0275elementStart(37,"input",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.title=e})("keydown",function(e){return t.onClickingEnter(e)}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(38,"div",17),S.\u0275\u0275elementStart(39,"mat-list"),S.\u0275\u0275elementStart(40,"mat-list-item"),S.\u0275\u0275elementStart(41,"h3",6),S.\u0275\u0275text(42,"Status"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(43,"div",15),S.\u0275\u0275elementStart(44,"ng-multiselect-dropdown",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedStatusesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(45,"mat-list-item"),S.\u0275\u0275elementStart(46,"h3",6),S.\u0275\u0275text(47,"Type"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(48,"div",15),S.\u0275\u0275elementStart(49,"ng-multiselect-dropdown",18),S.\u0275\u0275listener("ngModelChange",function(e){return t.selectedTypesIdentifiers=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(50,"div",19),S.\u0275\u0275elementStart(51,"div",20),S.\u0275\u0275elementStart(52,"button",21),S.\u0275\u0275listener("click",function(){return t.searchButton()}),S.\u0275\u0275text(53,"Search"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(54,"div",20),S.\u0275\u0275elementStart(55,"button",22),S.\u0275\u0275listener("click",function(){return t.onResetAllFilters()}),S.\u0275\u0275text(56,"Reset"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(57,"nav",23),S.\u0275\u0275elementStart(58,"div",24),S.\u0275\u0275elementStart(59,"button",25),S.\u0275\u0275listener("click",function(){return t.AddReference()}),S.\u0275\u0275element(60,"em",26),S.\u0275\u0275text(61," Reference "),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(62,"div",27),S.\u0275\u0275element(63,"app-paginator",28),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(64,Os,3,0,"div",29),S.\u0275\u0275elementStart(65,"div",30),S.\u0275\u0275template(66,Fs,6,0,"div",31),S.\u0275\u0275template(67,As,3,7,"div",32),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(15),i=S.\u0275\u0275reference(20);S.\u0275\u0275advance(12),S.\u0275\u0275property("matDatepicker",n)("max",t.periodTo)("ngModel",t.periodFrom),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(4),S.\u0275\u0275property("matDatepicker",i)("min",t.periodFrom)("ngModel",t.periodTo),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",i),S.\u0275\u0275advance(7),S.\u0275\u0275property("ngModel",t.referenceCode),S.\u0275\u0275advance(7),S.\u0275\u0275property("placeholder","Select...")("data",t.activitiesIdentifiers)("ngModel",t.selectedActivitiesIdentifiers)("settings",t.dropdownSettings),S.\u0275\u0275advance(5),S.\u0275\u0275property("ngModel",t.title),S.\u0275\u0275advance(7),S.\u0275\u0275property("placeholder","Select...")("data",t.statusesIdentifiers)("ngModel",t.selectedStatusesIdentifiers)("settings",t.dropdownStatusSettings),S.\u0275\u0275advance(5),S.\u0275\u0275property("placeholder","Select...")("data",t.typesIdentifiers)("ngModel",t.selectedTypesIdentifiers)("settings",t.dropdownSettings),S.\u0275\u0275advance(14),S.\u0275\u0275property("pageSize",t.searchFilterService.pageSize)("pageIndex",t.searchFilterService.pageIndex)("length",t.lengthReferences),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",0===t.lengthReferences),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngIf",t.isLoading),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngIf",t.listView)}},directives:[Co.i$,Co.Tg,E.KE,x.Nt,w.hl,c.DefaultValueAccessor,c.RequiredValidator,c.NgControlStatus,c.NgModel,w.nW,E.R9,w.Mq,Eo.OP,bt.M2,Un.J,o.NgIf,Qn.$g,ks],pipes:[Ti.R],styles:[".filter-button{text-align:center;width:100%;margin:2%}.search-input{font-size:14px}.date-field{font-size:14px}.pointer{cursor:pointer}.reset-all-btn{cursor:pointer;font-size:20px}.reset-all-btn:hover{color:red}.arrow-icon{font-size:10px}.close-icon{float:right;font-size:22px}.multi-search{width:100%}.ngb-accordion .card .card-header{padding-left:5px}.ngb-accordion .card .card-header .a{font-size:15px}.mat-list .mat-subheader{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.mat-list-header{height:40px;padding:0 5px;font-size:15px;font-weight:bolder}.wrapper{width:100%;height:100%}.overlay{position:absolute;z-index:1002;background-color:#ffffff80;width:100%;height:100%}.spinner-wrapper{display:flex;justify-content:center;justify-items:center}#loader{bottom:0;height:175px;left:0;margin:auto;position:absolute;right:0;top:0;width:175px}\n"],encapsulation:2}),e}(),Vs=["referenceForm"];function Ns(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Rs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}function Ts(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.code),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.name," ")}}function Bs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.value),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.value," ")}}function zs(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"mat-option",31),S.\u0275\u0275text(1),S.\u0275\u0275elementEnd()),2&e){var n=t.$implicit;S.\u0275\u0275property("value",n.id),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate1(" ",n.description," ")}}var qs=function(){var e=function(){function e(t,i,r,a,o,l){n(this,e),this.notificationService=t,this.projectService=i,this.referenceService=r,this._avRoute=a,this.router=o,this.dateTimeService=l,this.reference=new f.s3,this.disableGenerator=!0,this.subscription=new p.w0,this.isSameActivity=!0,this.filteredDocumentTypes=new p.tq(1),this.documentTypeFilterCtrl=new c.FormControl,this.filteredAbbreviations=new p.tq(1),this.abbrivationFilterCtrl=new c.FormControl,this._onDestroy=new p.xQ,this.previousState={getPrevious:!1,pageIndex:null,pageSize:null}}return r(e,[{key:"ngOnInit",value:function(){var e=this;0!==this.reference.referenceId?this.isSameActivity=this.reference.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId:this.disableGenerator=!1,this._avRoute.params.subscribe(function(t){null!=t.referenceId&&e.getReferenceProject(+t.referenceId)}),this.currentUser=JSON.parse(localStorage.getItem("currentUser")),this.reference.creationDate=this.dateTimeService.today(),this.getActivities(),this.getDocumentTypes(),this.getStates(),this.getConfidentialities(),this.abbrivationFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterAbbreviations()}),this.documentTypeFilterCtrl.valueChanges.pipe((0,ze.R)(this._onDestroy)).subscribe(function(){e.filterDocumentTypes()}),this.subscription.add(this.referenceService.savedReference.subscribe(function(t){t&&(e.previousState=t)}))}},{key:"ngOnDestroy",value:function(){this.subscription.unsubscribe()}},{key:"getDocumentTypes",value:function(){var e=this;this.referenceService.getTypesDocuments().subscribe(function(t){null!=t&&(e.documentTypesIdentifiers=t,e.filteredDocumentTypes.next(e.documentTypesIdentifiers.slice()))})}},{key:"getActivities",value:function(){var e=this;this.projectService.getActivities().subscribe(function(t){null!=t&&(e.activitiesIdentifiers=t,0===e.reference.referenceId&&(e.reference.activityId=e.currentUser.activityId,e.getProjectAbbreviationByActivity(e.reference.activityId)))})}},{key:"getStates",value:function(){var e=this;this.referenceService.getDocumentStates().subscribe(function(t){null!=t&&(e.documentStatesIdentifiers=t)})}},{key:"getConfidentialities",value:function(){var e=this;this.referenceService.GetDocumentConfidentialities().subscribe(function(t){null!=t&&(e.documentConfidentialitiesIdentifiers=t)})}},{key:"getProjectAbbreviationByActivity",value:function(e){var t=this;this.referenceService.getActivityAbbriviations(e).subscribe(function(e){null!=e&&(t.projectsAbrreviation=e,t.filteredAbbreviations.next(t.projectsAbrreviation.slice()))})}},{key:"getReferenceProject",value:function(e){var t=this;this.disableGenerator=!0,this.referenceService.getReferenceProject(e).subscribe(function(e){t.reference=Object.assign(new f.s3,e[0]),t.isSameActivity=t.reference.activityId===JSON.parse(localStorage.getItem("currentUser")).activityId;var n=t.getReferenceParts(t.reference.referenceCode);t.projectAbrreviation=n[2],t.confidentialityCode=n[4].split(" ")[1]})}},{key:"onActivtyChange",value:function(e){this.getProjectAbbreviationByActivity(e)}},{key:"buildReferenceToSave",value:function(e){var t=this,n=new f.s3;if(n.referenceId=this.reference.referenceId,n.referenceCode=this.reference.referenceCode,n.title=this.reference.title,n.edition=this.reference.edition,n.creationDate=this.reference.creationDate,n.stateId=this.reference.stateId,n.note=this.reference.note,n.archiving=this.reference.archiving,n.userId=this.reference.userId,n.activityId=this.reference.activityId,n.typeId=this.reference.typeId,0===this.reference.referenceId){var i=this.documentTypesIdentifiers.filter(function(e){return e.id===t.reference.typeId})[0].description.split("/")[0],r=new Date(this.reference.creationDate).getFullYear().toString().substring(2);n.referenceCode=i+"."+e+"."+this.projectAbrreviation.toUpperCase()+".*****."+r+" "+this.confidentialityCode}return n}},{key:"getLabelSubmit",value:function(){return this.disableGenerator?"Save":"Generate & Save"}},{key:"saveReference",value:function(){var e=this;this.referenceForm.valid?this.referenceService.getActivityCode(this.reference.activityId).subscribe(function(t){var n=0!==t.length?t[0].activityCode:"TXA";e.reference.userId=+e.currentUser.userId,e.reference.edition=+e.reference.edition.toString().replace(",",".");var i=e.buildReferenceToSave(n);e.referenceService.saveReferenceGenerator(i).subscribe(function(t){e.notificationService.success("Reference saved successfully"),0===e.reference.referenceId?e.getReferenceProject(+t):e.close()})}):this.notificationService.danger("Please fill all required fields")}},{key:"close",value:function(){null!=this.previousState.pageIndex&&(this.previousState.getPrevious=!0,this.referenceService.savedReference.next(this.previousState)),this.router.navigate(["/project-management/project/references"])}},{key:"filterAbbreviations",value:function(){if(this.projectsAbrreviation){var e=this.abbrivationFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredAbbreviations.next(this.projectsAbrreviation.filter(function(t){return t.value.toLowerCase().indexOf(e)>-1}))):this.filteredAbbreviations.next(this.projectsAbrreviation.slice())}}},{key:"filterDocumentTypes",value:function(){if(this.documentTypesIdentifiers){var e=this.documentTypeFilterCtrl.value;e?(e=e.toLowerCase(),this.filteredDocumentTypes.next(this.documentTypesIdentifiers.filter(function(t){return t.description.toLowerCase().indexOf(e)>-1}))):this.filteredDocumentTypes.next(this.documentTypesIdentifiers.slice())}}},{key:"getReferenceParts",value:function(e){var t=e.split("."),n=t.length,i=[];if(n>5){var r=1,a="";t.forEach(function(e){a+=""===a?e:"."+e,(r<3||r>=n-2)&&(i.push(a),a=""),r++})}else i=t;return i}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(h.Y4),S.\u0275\u0275directiveInject(h.q8),S.\u0275\u0275directiveInject(s.gz),S.\u0275\u0275directiveInject(s.F0),S.\u0275\u0275directiveInject(u.Cv))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-edit-reference"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Vs,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.referenceForm=n.first))},decls:55,vars:39,consts:[[1,"card"],[1,"card-body"],["id","referenceForm"],["referenceForm","ngForm"],[1,"row","m-b-15"],[1,"col-sm-6"],["placeholder","Document Type","name","documentType","required","",3,"disabled","ngModel","ngModelChange"],[3,"formControl","placeholderLabel","noEntriesFoundLabel"],["ngxMatSelectSearchClear",""],[3,"value",4,"ngFor","ngForOf"],[1,"col-sm-4"],["placeholder","Activity","name","activity","required","",3,"disabled","ngModel","ngModelChange","selectionChange"],[1,"col-sm-2"],["placeholder","Confidentiality","name","confidentiality","required","",3,"disabled","ngModel","ngModelChange"],["placeholder","Project Abreviation","name","projectAbreviation",3,"disabled","ngModel","ngModelChange"],["matInput","","placeholder","Project Abreviation","name","projectAbreviationInput","required","",3,"disabled","ngModel","ngModelChange"],["matInput","","placeholder","Creation Date","name","creationDate","required","",3,"disabled","matDatepicker","ngModel","ngModelChange"],["matSuffix","",3,"for"],[3,"startView"],["PickerCreationDate",""],["matInput","","disabled","","laceholder","Reference Value","name","referenceCode",3,"ngModel","ngModelChange"],[1,"col-sm-8"],["matInput","","placeholder","Title","name","title",3,"ngModel","ngModelChange"],["matInput","","appNumberValidator","","placeholder","Edition","name","edition","required","",3,"inputValue","ngModel","ngModelChange"],["placeholder","Status","name","state","required","",3,"ngModel","ngModelChange"],[1,"col-sm-12"],["matInput","","placeholder","Remarks","name","Remarks",3,"ngModel","ngModelChange"],["matInput","","placeholder","Archiving","name","Archiving",3,"ngModel","ngModelChange"],[1,"text-center"],["type","submit",1,"btn","btn-md","btn-primary","ripple","light","m-r-20",3,"disabled","click"],["type","reset",1,"btn","btn-md","btn-default","ripple",3,"click"],[3,"value"]],template:function(e,t){if(1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"form",2,3),S.\u0275\u0275elementStart(4,"div",4),S.\u0275\u0275elementStart(5,"mat-form-field",5),S.\u0275\u0275elementStart(6,"mat-select",6),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.typeId=e}),S.\u0275\u0275elementStart(7,"mat-option"),S.\u0275\u0275elementStart(8,"ngx-mat-select-search",7),S.\u0275\u0275elementStart(9,"mat-icon",8),S.\u0275\u0275text(10,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(11,Ns,2,2,"mat-option",9),S.\u0275\u0275pipe(12,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(13,"mat-form-field",10),S.\u0275\u0275elementStart(14,"mat-select",11),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.activityId=e})("selectionChange",function(e){return t.onActivtyChange(e.value)}),S.\u0275\u0275template(15,Rs,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(16,"mat-form-field",12),S.\u0275\u0275elementStart(17,"mat-select",13),S.\u0275\u0275listener("ngModelChange",function(e){return t.confidentialityCode=e}),S.\u0275\u0275template(18,Ts,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(19,"mat-form-field",12),S.\u0275\u0275elementStart(20,"mat-select",14),S.\u0275\u0275listener("ngModelChange",function(e){return t.projectAbrreviation=e}),S.\u0275\u0275elementStart(21,"mat-option"),S.\u0275\u0275elementStart(22,"ngx-mat-select-search",7),S.\u0275\u0275elementStart(23,"mat-icon",8),S.\u0275\u0275text(24,"close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275template(25,Bs,2,2,"mat-option",9),S.\u0275\u0275pipe(26,"async"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(27,"mat-form-field",12),S.\u0275\u0275elementStart(28,"input",15),S.\u0275\u0275listener("ngModelChange",function(e){return t.projectAbrreviation=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(29,"mat-form-field",12),S.\u0275\u0275elementStart(30,"input",16),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.creationDate=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275element(31,"mat-datepicker-toggle",17),S.\u0275\u0275element(32,"mat-datepicker",18,19),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(34,"mat-form-field",5),S.\u0275\u0275elementStart(35,"input",20),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.referenceCode=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(36,"div",4),S.\u0275\u0275elementStart(37,"mat-form-field",21),S.\u0275\u0275elementStart(38,"input",22),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.title=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(39,"mat-form-field",12),S.\u0275\u0275elementStart(40,"input",23),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.edition=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(41,"mat-form-field",12),S.\u0275\u0275elementStart(42,"mat-select",24),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.stateId=e}),S.\u0275\u0275template(43,zs,2,2,"mat-option",9),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(44,"div",4),S.\u0275\u0275elementStart(45,"mat-form-field",25),S.\u0275\u0275elementStart(46,"input",26),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.note=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(47,"div",4),S.\u0275\u0275elementStart(48,"mat-form-field",25),S.\u0275\u0275elementStart(49,"input",27),S.\u0275\u0275listener("ngModelChange",function(e){return t.reference.archiving=e}),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(50,"div",28),S.\u0275\u0275elementStart(51,"button",29),S.\u0275\u0275listener("click",function(){return t.saveReference()}),S.\u0275\u0275text(52),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(53,"button",30),S.\u0275\u0275listener("click",function(){return t.close()}),S.\u0275\u0275text(54,"Close"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd()),2&e){var n=S.\u0275\u0275reference(33);S.\u0275\u0275advance(6),S.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.reference.typeId),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.documentTypeFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(12,35,t.filteredDocumentTypes)),S.\u0275\u0275advance(3),S.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.reference.activityId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.activitiesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.confidentialityCode),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.documentConfidentialitiesIdentifiers),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.projectAbrreviation),S.\u0275\u0275advance(2),S.\u0275\u0275property("formControl",t.abbrivationFilterCtrl)("placeholderLabel","Search")("noEntriesFoundLabel","No options found"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngForOf",S.\u0275\u0275pipeBind1(26,37,t.filteredAbbreviations)),S.\u0275\u0275advance(3),S.\u0275\u0275property("disabled",t.disableGenerator)("ngModel",t.projectAbrreviation),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",t.disableGenerator)("matDatepicker",n)("ngModel",t.reference.creationDate),S.\u0275\u0275advance(1),S.\u0275\u0275property("for",n),S.\u0275\u0275advance(1),S.\u0275\u0275property("startView","month"),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.reference.referenceCode),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.reference.title),S.\u0275\u0275advance(2),S.\u0275\u0275property("inputValue",t.reference.edition)("ngModel",t.reference.edition),S.\u0275\u0275advance(2),S.\u0275\u0275property("ngModel",t.reference.stateId),S.\u0275\u0275advance(1),S.\u0275\u0275property("ngForOf",t.documentStatesIdentifiers),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.reference.note),S.\u0275\u0275advance(3),S.\u0275\u0275property("ngModel",t.reference.archiving),S.\u0275\u0275advance(2),S.\u0275\u0275property("disabled",!t.isSameActivity),S.\u0275\u0275advance(1),S.\u0275\u0275textInterpolate(t.getLabelSubmit())}},directives:[c.\u0275NgNoValidate,c.NgControlStatusGroup,c.NgForm,E.KE,I.gD,c.RequiredValidator,c.NgControlStatus,c.NgModel,M.ey,Qe.nu,c.FormControlDirective,Re.Hw,Qe.w5,o.NgForOf,x.Nt,c.DefaultValueAccessor,w.hl,w.nW,E.R9,w.Mq,$e.z],pipes:[o.AsyncPipe],styles:[".mat-button[_ngcontent-%COMP%]{min-width:0px}"]}),e}(),Ls=["missionDetailsForm"],Qs=[{path:"",data:{title:"Project",function:v.FI.Project,status:!1},canActivate:[bo.a1],children:[{path:"add",component:yo,data:{title:"Add Project",icon:"icon-home",function:v.FI.AddProject,status:!0},canActivate:[bo.a1]},{path:"edit/:pifId/:projectId",component:yo,data:{title:"Edit Project",icon:"icon-home",function:v.FI.ProjectDetails,status:!0},canActivate:[bo.a1]},{path:"list",component:ps,data:{title:"Projects",icon:"icon-home",caption:"",function:v.FI.Projects,status:!0},canActivate:[bo.a1]},{path:"missions",component:Go,data:{title:"Missions",icon:"icon-home",caption:"",function:v.FI.Missions,status:!0},canActivate:[bo.a1]},{path:"add-mission",component:function(){var e=function(){function e(t,i,r,a,o){n(this,e),this.missionService=t,this.dateTimeService=i,this._formBuilder=r,this.notificationService=a,this.router=o,this.mission=new f.$U,this.clientsIdentifiers=[],this.resourcesIdentifiers=[],this.countriesIdentifiers=[],this.filteredClients=new p.tq(1),this.clientFilterCtrl=new c.FormControl,this.filteredResources=new p.tq(1),this.resourceFilterCtrl=new c.FormControl,this.filteredCountries=new p.tq(1),this.countryFilterCtrl=new c.FormControl,this.filteredProjects=new p.tq(1),this.projectFilterCtrl=new c.FormControl}return r(e,[{key:"ngOnInit",value:function(){this.user=JSON.parse(localStorage.getItem("currentUser")),this.projectManagerFormGroup=this._formBuilder.group({name:["",c.Validators.required],date:[this.dateTimeService.today(),c.Validators.required],departmentHead:[null,c.Validators.required]})}},{key:"insertOrUpdateMission",value:function(){var e=this;this.missionService.insertOrUpdateMission(this.mission).subscribe(function(t){e.notificationService.success("Mission is updated successfully"),0!==e.mission.missionId&&e.missionService.savedMission.next("refresh"),e.router.navigate(["/project-management/project/missions"])},function(t){e.notificationService.danger("Update mission failed")})}},{key:"cancel",value:function(){0!==this.mission.missionId?this.missionService.savedMission.next("refresh"):this.router.navigate(["/project-management/project/missions"])}},{key:"dateOnly",value:function(e){return this.dateTimeService.dateOnly(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)(S.\u0275\u0275directiveInject(h.Fn),S.\u0275\u0275directiveInject(u.Cv),S.\u0275\u0275directiveInject(c.FormBuilder),S.\u0275\u0275directiveInject(u.gq),S.\u0275\u0275directiveInject(s.F0))},e.\u0275cmp=S.\u0275\u0275defineComponent({type:e,selectors:[["app-add-mission"]],viewQuery:function(e,t){var n;(1&e&&S.\u0275\u0275viewQuery(Ls,7),2&e)&&(S.\u0275\u0275queryRefresh(n=S.\u0275\u0275loadQuery())&&(t.missionDetailsForm=n.first))},decls:7,vars:0,consts:[[1,"row"],[1,"col-md-9"],[1,"card"],[1,"card-body"],[1,"col-md-3"]],template:function(e,t){1&e&&(S.\u0275\u0275elementStart(0,"div",0),S.\u0275\u0275elementStart(1,"div",1),S.\u0275\u0275elementStart(2,"div",2),S.\u0275\u0275elementStart(3,"div",3),S.\u0275\u0275element(4,"app-edit-mission-details"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementStart(5,"div",4),S.\u0275\u0275element(6,"app-visa"),S.\u0275\u0275elementEnd(),S.\u0275\u0275elementEnd())},directives:[hl,il],styles:[".th-table-style[_ngcontent-%COMP%]{text-align:center;font-weight:bolder}.col-sm-2[_ngcontent-%COMP%]{width:auto}.td-table-style[_ngcontent-%COMP%]{text-align:center}"]}),e}(),data:{title:"Add Mission",icon:"icon-home",function:v.FI.Missions,status:!0},canActivate:[bo.a1]},{path:"edit-mission/:missionId",component:kl,data:{title:"Edit Mission",icon:"icon-home",function:v.FI.Missions,status:!0},canActivate:[bo.a1]},{path:"references",component:_s,data:{title:"References",icon:"icon-home",function:v.FI.References,status:!0},canActivate:[bo.a1]},{path:"edit-reference/:referenceId",component:qs,data:{title:"Edit Reference",icon:"icon-home",function:v.FI.References,status:!0},canActivate:[bo.a1]},{path:"add-reference",component:qs,data:{title:"Add Reference",icon:"icon-home",function:v.FI.References,status:!0},canActivate:[bo.a1]}]}],$s=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({imports:[[s.Bz.forChild(Qs)],s.Bz]}),e}(),Us=a(36063),Hs=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,l.q]]}),e}(),Gs=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Bo],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Hs]]}),e}(),Ws=a(36332),Js=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,Ws.o,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is]]}),e}(),Ys=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is]]}),e}(),Ks=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Ys]]}),e}(),Xs=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Ys]]}),e}(),Zs=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is]]}),e}(),ec=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is]]}),e}(),tc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is]]}),e}(),nc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[u.gq,Ri],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,m.Is,Ws.o,Hn.JX],Hn.JX]}),e}(),ic=a(82480),rc=a(88720),ac=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[u.gq,Ne.X],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,m.Is,Ws.o,Hn.JX],Hn.JX]}),e}(),oc=a(81040),lc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Y4,u.gq],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,ec,Gs,m.Is,Js,Ks,Xs,Zs,Ys,tc,nc,ic.w,rc.b,ac,oc.U]]}),e}(),sc=a(91841),cc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Fn,u.nJ],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Eo.ZQ.forRoot(),sc.HttpClientModule,Ws.o]]}),e}(),dc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({imports:[[o.CommonModule,Eo.ZQ,Ws.o,l.m,l.q,c.FormsModule,c.ReactiveFormsModule,m.Is]]}),e}(),mc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({imports:[[o.CommonModule,Eo.ZQ,Ws.o,l.m,l.q,c.FormsModule,c.ReactiveFormsModule,m.Is]]}),e}(),pc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({imports:[[o.CommonModule,Eo.ZQ,Ws.o,l.m,l.q,c.FormsModule,c.ReactiveFormsModule,m.Is]]}),e}(),uc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Fn,u.nJ],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Eo.ZQ.forRoot(),sc.HttpClientModule,Ws.o,dc,mc,pc]]}),e}(),fc=a(38458),hc=a(1464),vc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[hc.q],imports:[[o.CommonModule,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,Eo.ZQ.forRoot(),sc.HttpClientModule,Ws.o]]}),e}(),gc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Fn],imports:[[dc,mc,o.CommonModule,Eo.ZQ,sc.HttpClientModule,Ws.o,l.m,l.q]]}),e}(),Sc={parse:{dateInput:"L"},display:{dateInput:"L",monthYearLabel:"MMM YYYY",dateA11yLabel:"LL",monthYearA11yLabel:"MMMM YYYY"}},yc=function(){var e=function e(){n(this,e)};return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=S.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=S.\u0275\u0275defineInjector({providers:[h.Y4,u.n4,{provide:M.Ad,useValue:"fr-FR"},{provide:M._A,useClass:Us.t7,deps:[M.Ad]},{provide:M.sG,useValue:Sc}],imports:[[o.CommonModule,$s,l.m,c.FormsModule,c.ReactiveFormsModule,l.q,m.Is,lc,fc.l,cc,uc,vc,gc]]}),e}()},85718:function(e,t,i){i.d(t,{x:function(){return r}});var r=function e(){n(this,e)}}}])}();